!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="0460539d-f98e-425f-af46-aa28008fca37",e._sentryDebugIdIdentifier="sentry-dbid-0460539d-f98e-425f-af46-aa28008fca37")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5615],{20149:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GLUON_VERSION=void 0,t.GLUON_VERSION="2.9.1"},37992:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseAsyncDetail=void 0;var i=r(22970),n=r(57665),o=r(62436),a=function(){function e(e){this._getDetails=e,this._incrementingId=new o.IncrementingId,this._currentId=this._incrementingId.getNext()}return e.prototype.getCachedDetails=function(){return this._details},e.prototype.clearCachedDetails=function(){this._currentId=this._incrementingId.getNext(),this._details=void 0,this._detailsPromise=void 0},e.prototype.getDetails=function(){return void 0!==this._details?this._details:this._getDetailsSyncOrAsync()},e.prototype._getDetailsSyncOrAsync=function(){var e=this;if(void 0===this._detailsPromise&&(this._detailsPromise=this._getDetails()),this._detailsPromise instanceof Promise){var t=this._currentId;return this._getDetailsAsync(this._detailsPromise).then(function(r){return t===e._currentId&&(e._details=r),r})}return this._details=this._detailsPromise,this._details},e.prototype._getDetailsAsync=function(e){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e];case 1:return[2,r.sent()];case 2:throw t=r.sent(),this._details=void 0,this._detailsPromise=void 0,n.WrappedError.wrap(t,"AsyncDetailsError");case 3:return[2]}})})},e}();t.BaseAsyncDetail=a},20220:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseManifestMaker=void 0;var i=r(22970),n=r(28210),o=r(47632),a=r(27574),s=r(88309),u=r(54965),c=r(28521),d=r(69964),l=function(e){function t(t,r,i,n,o,a,s){var u=e.call(this,o,function(){return u._offsetStream.getDetails()})||this;return u._playerUtil=t,u._manifestUtil=r,u._manifestLoad=i,u._periodMap=n,u._offsetStream=o,u._offsetMap=a,u._trimMap=s,u}return i.__extends(t,e),t.prototype.getDetails=function(){return i.__awaiter(this,void 0,void 0,function(){var t,r,n,o,a,s,u,d=this;return i.__generator(this,function(i){switch(i.label){case 0:return[4,e.prototype.getDetails.call(this)];case 1:for(s=0,t=i.sent(),r=0,n=this._manifestLoad.getManifest(),o=function(e){var i=[];a._playerUtil.iteratePeriodStreams(e,function(e){var r=e===d?t:e.getCachedDetails();void 0!==r&&i.push(r)});for(var n=a._periodMap.tryGet(e),o=0;o<i.length;o++){var s=i[o];if(a._offsetMap.has(s)||(a._manifestUtil.setStreamDetailsPosition(s,r),a._offsetMap.add(s)),"audio"===s.type||"video"===s.type){var u=h.STREAM_DELTA_WARNING_SECONDS,l=a._playerUtil.getRangeOfStream(s);void 0===n?n=l:void 0!==l&&Math.abs(n.end-l.end)>u&&a._manifestLoad.onWarning.emit(new c.WarningError("Existing stream end ".concat(n.end," differs from other streams end ").concat(l.end)))}}if(void 0===n)return"break";a._periodMap.contains(e)||a._periodMap.set(e,n);for(var p=0;p<i.length;p++){var s=i[p];a._trimMap.has(s)||(a._trimMap.add(s),a._trimStreamEnd(s,n.end))}r=n.end},a=this,u=n.periods;s<u.length&&"break"!==o(u[s]);s++);return[2,t]}})})},t.prototype._trimStreamEnd=function(e,t){if(!this._playerUtil.isEmptyStream(e)){for(r=e.segments.length;r>0;r--){var r;if(e.segments.getTiming(r-1).start<t)break}e.segments.setSubView(void 0,r),e.segments.durationFill=t}},t}(r(26958).StreamMetadata),h=function(){function e(){this._wasEverDynamic=!1,this._manifestUtil=new n.ManifestUtil,this._playerUtil=new a.PlayerUtil,this._arrayUtil=new d.ArrayUtil}return e.prototype.getManifestLoad=function(e){var t=this;return this._wasEverDynamic||void 0===e.dynamicInfo||(this._wasEverDynamic=!0),{getManifest:function(){return e},getImage:function(r){return t.getImage(e,r)},refresh:function(e){return t.refresh(e)},onWarning:new o.Emitter}},e.prototype.getImage=function(e,t){return i.__awaiter(this,void 0,void 0,function(){var r,n,o;return i.__generator(this,function(i){switch(i.label){case 0:if(void 0===(r=this._playerUtil.getPeriodForTime(e.periods,t.timeSeconds))||void 0===(n=this._playerUtil.getClosestSizeStream(r.image,t.targetWidth,t.targetHeight)))return[2];return[4,n.getDetails()];case 1:return o=i.sent(),[2,this._playerUtil.getSegmentByTime(o.segments,t.timeSeconds)]}})})},e.prototype.applyPeriodOffsetsForStatic=function(e){this._wasEverDynamic||this._applyPeriodOffsets(e)},e.prototype._applyPeriodOffsets=function(e){for(var t=this,r=new s.Set,i=new s.Set,n=new u.Map,o=e.getManifest(),a=0,c=o.periods;a<c.length;a++){var d=c[a];this._playerUtil.replacePeriodStreams(d,function(o){return new l(t._playerUtil,t._manifestUtil,e,n,o,r,i)})}},e.STREAM_DELTA_WARNING_SECONDS=1,e}();t.BaseManifestMaker=h},64215:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContainerConstants=void 0;var r=function(){function e(){}return e.DEFAULT_TEXT_MIME_TYPE="text/vtt",e.DEFAULT_TEXT_CODECS="",e.DEFAULT_IMAGE_MIME_TYPE="image/jpeg",e.DEFAULT_IMAGE_CODECS="jpeg",e}();t.ContainerConstants=r},62436:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IncrementingId=void 0;var r=function(){function e(){this._current=0}return e.prototype.getNext=function(){return this._current++},e}();t.IncrementingId=r},8533:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentCollection=void 0;var i=r(22970),n=r(15302),o=r(62436),a=function(){function e(t){this._raw=t,this.id=e._incrementingId.getNext(),this._dummySegment={id:"".concat(this.id,"-dummy"),position:0,start:0,end:0,presentationTimeOffset:0,originalStart:0,originalEnd:0,keyId:void 0,createUri:"",initSegment:void 0}}return Object.defineProperty(e.prototype,"length",{get:function(){var e=this._mapLength();return 0===e?1:e},enumerable:!1,configurable:!0}),e.prototype.setSubView=function(e,t){var r=this.length;if(void 0!==e&&(e<0||e>=r))throw new n.InvalidOperationError("Invalid subview start start=".concat(e," end=").concat(t," with length=").concat(this.length," (subview ").concat(this._subViewStart,"-").concat(this._subViewEnd,")"));if(void 0!==t&&(t<0||t>r||(null!=e?e:0)>t))throw new n.InvalidOperationError("Invalid subview end start=".concat(e," end=").concat(t," with length=").concat(this.length," (subview ").concat(this._subViewStart,"-").concat(this._subViewEnd,")"));var i=void 0===e?this._subViewStart:this._mapIndex(e),o=void 0===t?this._subViewEnd:this._mapIndex(t);this._subViewStart=i,this._subViewEnd=o},e.prototype.refresh=function(e){this._subViewStart=e._subViewStart,this._subViewEnd=e._subViewEnd,this.startTime=e.startTime,this.origin=e.origin,this.durationFill=e.durationFill},e.prototype.getTiming=function(e){var t=this.tryGetTiming(e);if(void 0===t)throw new n.InvalidOperationError("Unable to get segment range at idx=".concat(e," length=").concat(this.length," (subview ").concat(this._subViewStart,"-").concat(this._subViewEnd,")"));return t},e.prototype.tryGetTiming=function(e){if(0===e&&this._isDummySegmentCollection())return this._getDummySegment();if(!(e<0)&&!(e>=this.length)){var t=this._mapIndex(e),r=this._raw.tryGetTiming(t);if(void 0!==r)return this._mapTiming(r,e)}},e.prototype.getSegment=function(e){var t=this.tryGetSegment(e);if(void 0===t)throw new n.InvalidOperationError("Unable to get segment at idx=".concat(e," length=").concat(this.length," (subview ").concat(this._subViewStart,"-").concat(this._subViewEnd,")"));return t},e.prototype.tryGetSegment=function(e){if(0===e&&this._isDummySegmentCollection())return this._getDummySegment();if(!(e<0)&&!(e>=this.length)){var t=this._mapIndex(e),r=this._raw.tryGetSegment(t);if(void 0!==r){var n=this._mapTiming(r,e);return i.__assign(i.__assign({},r),n)}}},e.prototype._getDummySegment=function(){var e=this._mapTiming(this._dummySegment,0);return i.__assign(i.__assign(i.__assign({},this._dummySegment),e),{end:e.start})},e.prototype._mapLength=function(){var e=this._raw.getLength();return void 0!==this._subViewEnd&&this._subViewEnd<e&&(e=this._subViewEnd),void 0!==this._subViewStart&&(e-=this._subViewStart),e},e.prototype._mapIndex=function(e){return void 0!==this._subViewStart&&(e+=this._subViewStart),e},e.prototype._mapTiming=function(e,t){var r,i,n,o=e.start,a=e.end,s=e.presentationTimeOffset;if(void 0!==this.startTime){var u=null!==(r=this.origin)&&void 0!==r?r:0===t?o:null!==(n=null===(i=this._raw.tryGetTiming(this._mapIndex(0)))||void 0===i?void 0:i.start)&&void 0!==n?n:0,c=this.startTime-u;0!==c&&(s+=c,o+=c,a+=c)}return void 0!==this.durationFill&&t===this.length-1&&o<this.durationFill&&(a=this.durationFill),{start:o,end:a,presentationTimeOffset:s,originalStart:e.originalStart,originalEnd:e.originalEnd}},e.prototype._isDummySegmentCollection=function(){return 0===this._mapLength()},e._incrementingId=new o.IncrementingId,e}();t.SegmentCollection=a},26958:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamMetadata=void 0;var i=r(22970),n=function(e){function t(t,r){var i=e.call(this,r)||this;return i.id=t.id,i.type=t.type,i.codecs=t.codecs,i.language=t.language,i.mimeType=t.mimeType,i.attributes=t.attributes,i.bandwidth=t.bandwidth,i.channelsCount=t.channelsCount,i.frameRate=t.frameRate,i.width=t.width,i.height=t.height,i.label=t.label,i.name=t.name,i.default=t.default,i.initialStartTime=t.initialStartTime,i.initialOriginTime=t.initialOriginTime,i.drmInfo=t.drmInfo,i.embeddedCaptions=t.embeddedCaptions,i}return i.__extends(t,e),t.prototype.getDetails=function(){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(r){switch(r.label){case 0:return[4,e.prototype.getDetails.call(this)];case 1:return t=r.sent(),void 0!==this.initialStartTime&&(t.segments.startTime=this.initialStartTime),void 0!==this.initialOriginTime&&(t.segments.origin=this.initialOriginTime),[2,t]}})})},t}(r(37992).BaseAsyncDetail);t.StreamMetadata=n},54459:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormatChangedError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,"Format ".concat(r," is not compatible with ").concat(i))||this}return i.__extends(t,e),t.NAME="FormatChanged",t}(r(57665).WrappedError);t.FormatChangedError=n},35509:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidDynamicManifestError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="InvalidDynamicManifest",t}(r(57665).WrappedError);t.InvalidDynamicManifestError=n},81907:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ManifestParserError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="ManifestParser",t}(r(57665).WrappedError);t.ManifestParserError=n},17395:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ManifestProcessingError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="ManifestProcessing",t}(r(57665).WrappedError);t.ManifestProcessingError=n},58468:function(e,t){"use strict";var r,i;t.o=void 0,(i=r||(t.o=r={})).SCTE35="scte35",i.SCHEME="scheme"},77219:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DrmInfoUtil=void 0;var i=r(17590),n=function(){function e(){this._stringUtil=new i.StringUtil}return e.prototype.makeCbcsFairPlayInfo=function(e){for(var t=this._stringUtil.fromHexString(e),r=this._stringUtil.toCharCode(this._stringUtil.fromStandardBase64("AAAADGZybWFhdmMxAAAAFHNjaG0AAAAAY2JjcwABAAAAAAA5c2NoaQAAADF0ZW5jAQAAAAAZAQABAmzzYYHinT4oNJzAu3T2EEwLDN0gjSw/7IlxACf059I=")),i=56;i<72;i++)r[i]=t[i-56];var n=this._stringUtil.fromCharCode(r);return{keyFormat:"com.apple.streamingkeydelivery",keySystem:"com.apple.fps.2_0",scheme:"cbc",initData:this._stringUtil.toCharCode(JSON.stringify({sinf:[this._stringUtil.toStandardBase64(n)]})),initDataType:"sinf",keyId:e}},e}();t.DrmInfoUtil=n},44445:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DashManifestDynamicParser=void 0;var i=r(1679),n=r(81055),o=function(){function e(){this._nodeUtil=new n.DashUtil}return e.prototype.getDynamicInformation=function(e){for(var t,r,n,o,a,s,u=0;u<e.length;u++)for(var c=e[u],d=0,l=c.attributes;d<l.length;d++){var h=l[d];this._nodeUtil.startsWith(h,"minimumUpdatePeriod=")?t=this._nodeUtil.getAttributeValue(h):this._nodeUtil.startsWith(h,"suggestedPresentationDelay=")?r=this._nodeUtil.getAttributeValue(h):this._nodeUtil.startsWith(h,"availabilityStartTime=")?n=i.DateUtil.parseDate(this._nodeUtil.getAttributeValue(h)):this._nodeUtil.startsWith(h,"publishTime=")&&(o=i.DateUtil.parseDate(this._nodeUtil.getAttributeValue(h)))}return void 0!==r&&(s=this._nodeUtil.parseSecondsFromISO8601(r)),void 0!==t&&(a={minUpdateSeconds:this._nodeUtil.parseSecondsFromISO8601(t),suggestedPresentationDelaySeconds:s,presentationStartTime:n,publishedTime:o}),a},e}();t.DashManifestDynamicParser=o},71180:function(e,t,r){"use strict";t.F=void 0;var i=r(22970),n=r(17590),o=r(16754),a=r(17395),s=r(60064),u=r(71791),c=r(56535),d=r(22555),l=r(44445),h=r(62436),p=r(20220),f=r(81907),_=r(70387),v=r(6246),m=r(94306),g=function(e){function t(t,r,i,a){void 0===a&&(a={});var u=e.call(this)||this;return u._stringUtil=new n.StringUtil,u._system=t,u._drmInfo=i,u._network=new s.NetworkUtil(t),u._url=new o.Uri(r),u._options=a,u}return i.__extends(t,e),t.prototype.applyTemplateDecodeTimeshift=function(e){this._templateDecodeTimeshift=e},t.prototype.refresh=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,n,o,a,s,u,c,d;return i.__generator(this,function(i){switch(i.label){case 0:if(0===e.length)throw new f.ManifestParserError("Refresh called with an empty period collection");for(r=1,t=new v.HashSet;r<e.length-1;r++)t.add(e[r].id);return[4,this._getManifestData(t)];case 1:return n=i.sent(),o=e[e.length-1],a=this._arrayUtil.findFirstIndex(n.periods,function(e){return e.id===o.id}),s=n.dynamicInfo,u=n.periods[0],-1===a?d=n.periods.slice():(c=n.periods[a],d=n.periods.slice(a+1)),[2,{dynamicInfo:s,currentFirstPeriod:u,previousLastPeriod:c,currentAddedPeriods:d}]}})})},t.prototype.load=function(){return i.__awaiter(this,void 0,void 0,function(){var e,t;return i.__generator(this,function(r){switch(r.label){case 0:return[4,this._getManifestData()];case 1:return e=r.sent(),t=this.getManifestLoad(e),this.applyPeriodOffsetsForStatic(t),[2,t]}})})},t.prototype._getMpdNodes=function(){return i.__awaiter(this,void 0,void 0,function(){var e,t,r;return i.__generator(this,function(i){switch(i.label){case 0:return[4,this._network.makeNetworkClient({resource:this._url.toString(),method:"GET",type:"manifest",timeoutMS:this._options.timeoutMS,progressTimeoutMS:this._options.progressTimeoutMS,manifestContext:{format:"DASH",objectType:"manifest"},cmcd:this._options.cmcd}).payloadString()];case 1:if(e=i.sent(),!_.NetworkHelpers.isSuccessfulResponseCode(e.status))throw new a.ManifestProcessingError("did not get a manifest response ".concat(e.status));return t=e.data,r=this._stringUtil.removeNewlines(t),[2,new u.NodeParser(r).getRecursiveChildrenByType("MPD")]}})})},t.prototype._getStreamInfs=function(e,r,i){for(var n=new c.DashManifestPeriodParser(this._system),o=[],a=0;a<e.length;a++){var s=e[a];n.parsePeriods(o,s,this._url,this._templateDecodeTimeshift,i)}return!0!==this._options.periodsFlattening||r||t._tryToMergeStreams(this._system,o),o},t.prototype._getManifestData=function(e){var t,r;return i.__awaiter(this,void 0,void 0,function(){var n,o,a,s,u,c,p,_,v,m,g,y,S,E,b,w,P;return i.__generator(this,function(i){switch(i.label){case 0:return n=new l.DashManifestDynamicParser,[4,this._getMpdNodes()];case 1:if(0===(o=i.sent()).length)throw new f.ManifestParserError("No nodes found for manifest");for(m=0,a=n.getDynamicInformation(o),s=this._getStreamInfs(o,void 0!==a,e),u=[],c=new h.IncrementingId,p=[],_=new d.DashManifestVariantParser(this._options),v=null!==(r=null===(t=s[0])||void 0===t?void 0:t.periodStart)&&void 0!==r?r:0,g=s;m<g.length;m++)y=g[m],S=[],E=[],b=[],w=[],P={id:y.periodId,audio:S,video:E,text:b,image:w,events:[]},u.push(P),p.push(_.parseVariants(P,y,void 0!==a,this._drmInfo,this._network,c,v));return[4,Promise.all(p)];case 2:if(i.sent(),0===u.length)throw new f.ManifestParserError("No periods found in manifest");return[2,{url:this._url,periods:u,dynamicInfo:a}]}})})},t._compareStreamsSource=function(e,t,r){var i,n;if(void 0!==e.template&&void 0!==t.template){var o=void 0,a=void 0,s=void 0;return(e.template.segmentTimes.length>0&&(o=e.template.segmentTimes[0],s=e.template.segmentTimes[e.template.segmentTimes.length-1]),t.template.segmentTimes.length>0&&(a=t.template.segmentTimes[0]),"audio"===r||"video"===r)?e.template.uriTemplate===t.template.uriTemplate&&e.template.timescale===t.template.timescale&&void 0!==o&&void 0!==a&&void 0!==s&&a.position===s.position+1&&Math.round((null!==(i=t.template.representationTimeOffset)&&void 0!==i?i:0)*t.template.timescale)===Math.round((null!==(n=e.template.representationTimeOffset)&&void 0!==n?n:0)*e.template.timescale)+(s.end-o.start):(void 0===o||void 0===a||o.position<=a.position)&&e.template.durationBasedSegments===t.template.durationBasedSegments&&(!e.template.durationBasedSegments||void 0!==e.template.totalDuration&&void 0!==t.template.totalDuration&&e.template.representationTimeOffset===t.template.representationTimeOffset&&e.template.timescale===t.template.timescale&&this._compareTemplateSegmentTimes(e.template.segmentTimes,t.template.segmentTimes))&&e.template.uriTemplate===t.template.uriTemplate&&e.template.timescale===t.template.timescale}return void 0!==e.base&&void 0!==t.base&&e.base.uri===t.base.uri&&e.base.indexRange[0]===t.base.indexRange[0]&&e.base.indexRange[1]===t.base.indexRange[1]&&e.base.initializationRange[0]===t.base.initializationRange[0]&&e.base.initializationRange[1]===t.base.initializationRange[1]},t._compareTemplateSegmentTimes=function(e,t){return 0===e.length||0===t.length||e[0].end-e[0].start==t[0].end-t[0].start},t._compareStreamsDrm=function(e,t){return e.drm.length===t.drm.length&&e.drm.every(function(e,r){return e.keyId===t.drm[r].keyId})},t._isStreamsMatch=function(e,t){return!!(e.audio.length===t.audio.length&&e.video.length===t.video.length&&e.text.length===t.text.length&&e.image.length===t.image.length&&this._areStreamsMergeable(e.audio,t.audio,this._compareAudioStreams)&&this._areStreamsMergeable(e.video,t.video,this._compareVideoStreams)&&this._areStreamsMergeable(e.image,t.image,this._compareImageStreams)&&this._areStreamsMergeable(e.text,t.text,this._compareTextStreams))},t._extendStream=function(e,t){for(var r,n,o,s=[{to:e.audio,from:t.audio},{to:e.video,from:t.video},{to:e.text,from:t.text},{to:e.image,from:t.image}],u=0;u<s.length;u++){var d=s[u],l=d.to,h=d.from;if(l.length>0&&h.length>0&&void 0!==l[0].template&&void 0!==h[0].template)for(var p=0;p<l.length;p++){var f=l[p].template,_=h[p].template;if(void 0!==f&&void 0!==_&&f.segmentTimes.length>0&&_.segmentTimes.length>0){if(f.durationBasedSegments){if(void 0===f.totalDuration||void 0===_.totalDuration)throw new a.ManifestProcessingError("Failed to flatten periods, missing duration on duration based segments");var v=null!==(r=f.segmentTimes[0])&&void 0!==r?r:_.segmentTimes[0];if(void 0===v)break;var m=v.end-v.start,g=v.start/f.timescale,y=g+f.totalDuration+_.totalDuration;l[p].template=i.__assign(i.__assign({},f),{totalDuration:y-g,segmentTimes:c.DashManifestPeriodParser.getTemplateSegmentTimes(f.timescale,y-g,v.position,m,null!==(n=f.decodeShift)&&void 0!==n?n:0,null!==(o=f.representationTimeOffset)&&void 0!==o?o:0)})}else l[p].template=i.__assign(i.__assign({},f),{segmentTimes:f.segmentTimes.concat(_.segmentTimes)})}}}void 0!==e.periodDuration&&void 0!==t.periodDuration&&(e.periodDuration+=t.periodDuration)},t._areStreamsMergeable=function(e,t,r){for(var i=new m.HashMap,n=0;n<t.length;n++){var o=t[n];if(void 0===o.representationId)return!1;i.set(o.representationId,o)}for(var a=0;a<e.length;a++){var s=e[a];if(void 0===s.representationId)return!1;var o=i.tryGet(s.representationId);if(void 0===o||!r(s,o))return!1}return!0},t._tryToMergeStreams=function(e,r){for(var i=1;i<r.length;i++)t._isStreamsMatch(r[i-1],r[i])&&(e.logInfo("Merging period ".concat(r[i-1].periodId," and ").concat(r[i].periodId)),t._extendStream(r[i-1],r[i]),r.splice(i,1),i--)},t._compareTextStreams=function(e,r){return t._compareStreamsSource(e,r,"text")&&t._compareStreamsDrm(e,r)&&e.language===r.language&&e.textRole===r.textRole},t._compareImageStreams=function(e,r){return t._compareStreamsSource(e,r,"image")&&t._compareStreamsDrm(e,r)&&e.mime===r.mime&&e.codecs===r.codecs&&e.width===r.width&&e.height===r.height},t._compareVideoStreams=function(e,r){return t._compareStreamsSource(e,r,"video")&&t._compareStreamsDrm(e,r)&&e.codecs===r.codecs&&e.width===r.width&&e.height===r.height&&e.frameRate===r.frameRate&&e.attributes===r.attributes},t._compareAudioStreams=function(e,r){return t._compareStreamsSource(e,r,"audio")&&t._compareStreamsDrm(e,r)&&e.codecs===r.codecs&&e.language===r.language&&e.attributes===r.attributes},t}(p.BaseManifestMaker);t.F=g},80445:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DashManifestSegmentParser=void 0;var i=r(22970),n=r(17395),o=r(7253),a=r(94306),s=r(27468),u=r(69334),c=r(95645),d=r(70387),l=r(90155),h=r(16854),p=r(59791),f=r(85857),_=r(35509),v=function(){function e(e){this._segmentPromiseCache=new a.HashMap,this._parser=new s.Mp4Parser,this._parser.setParsers(new a.HashMap([["sidx",u.SegmentIndexBoxParser.getParser()]])),this._options=e}return e.prototype.getSegments=function(e,t,r,o,a){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(i){if(void 0!==e.base){if(t)throw new _.InvalidDynamicManifestError("Dynamic manifests using SegmentBase are invalid.",new n.ManifestProcessingError("Failed to process a dynamic manifest with SegmentBase."));return[2,this._getSegmentsFromBase(e.base,e,r)]}if(void 0!==e.template)return[2,new p.DashSegmentTemplateCollection(e,e.template,o)];if(void 0!==e.singleFile){if(t)throw new c.UnsupportedError("Unexpected SingleFile segments with dynamic information");return[2,new h.DashSegmentSingleFileCollection(e,e.singleFile,a)]}if(void 0!==e.list)return[2,new l.DashSegmentListCollection(e,e.list)];throw new n.ManifestProcessingError("Unexpected: segment information missing")})})},e.prototype._getSegmentIndexSegments=function(e,t,r){var i=this;return this._makeNetworkRequestForSegments(e,t,r,!0).catch(function(n){if(e.initializationRange[1]===e.indexRange[0]-1)return i._makeNetworkRequestForSegments(e,t,r,!1);throw n})},e.prototype._makeNetworkRequestForSegments=function(e,t,r,a){return i.__awaiter(this,void 0,void 0,function(){var s,u,c,l,h,p,f,_,v,m,g,y,S,E,b,w,P,T,C;return i.__generator(this,function(i){switch(i.label){case 0:return s=!1,u=e.indexRange[0],a&&e.initializationRange[1]===u-1&&(s=!0,u=e.initializationRange[0]),c="bytes=".concat(u,"-").concat(e.indexRange[1]),[4,r.makeNetworkClient({resource:e.uri,method:"GET",headers:{Range:c},type:"manifest",timeoutMS:this._options.timeoutMS,progressTimeoutMS:this._options.progressTimeoutMS,manifestContext:{format:"DASH",objectType:s?"init":"sidx"},cmcd:this._options.cmcd}).payloadBuffer()];case 1:if(l=i.sent(),!d.NetworkHelpers.isSuccessfulResponseCode(l.status))throw new n.ManifestProcessingError("did not get index response ".concat(l.status));if(p=l.data,s&&(f=e.initializationRange[1]-e.initializationRange[0],h=l.data.slice(0,f+1),p=l.data.slice(f+1)),_=this._parser.parse(new Uint8Array(p)),void 0===(v=new o.Mp4Walker(_).jumpTo("sidx")))throw new n.ManifestProcessingError("did not find sidx in data for ".concat(e.uri," at ").concat(c));for(void 0!==h&&void 0!==t.initSegment&&(t.initSegment.data=h),m=0,g=Number(e.indexRange[1])+1,y=0,S=0,b=Array(E=v.entries.length),w=0;w<E;w++)P=v.entries[w],m=g+P.referencedSize-1,y=S+P.subSegmentDuration,T=S/v.timescale,C=y/v.timescale,b[w]={start:T,end:C,startByte:g,endByte:m},g=m+1,S=y;return[2,b]}})})},e.prototype._getSegmentsFromBase=function(e,t,r){return i.__awaiter(this,void 0,void 0,function(){var n,o;return i.__generator(this,function(i){switch(i.label){case 0:return n="".concat(e.uri,"-").concat(e.indexRange[0],"-").concat(e.indexRange[1]),this._segmentPromiseCache.contains(n)||this._segmentPromiseCache.set(n,this._getSegmentIndexSegments(e,t,r)),[4,this._segmentPromiseCache.get(n)];case 1:return o=i.sent(),[2,new f.DashSegmentBaseCollection(t,e.uri,o)]}})})},e}();t.DashManifestSegmentParser=v},22555:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DashManifestVariantParser=void 0;var i=r(22970),n=r(27574),o=r(80445),a=r(64215),s=r(26958),u=function(){function e(e){this._playerUtil=new n.PlayerUtil,this._dashManifestSegmentParser=new o.DashManifestSegmentParser(e)}return e.prototype.parseVariants=function(e,t,r,n,o,u,c){var d;return i.__awaiter(this,void 0,void 0,function(){var l,h,p,f,_,v,m,g,y,S,E,b,w,P,T,C,M,k=this;return i.__generator(this,function(i){switch(i.label){case 0:for(_=0,l=[],h=null===(d=t.audio[0])||void 0===d?void 0:d.language,p=function(i){var a={id:u.getNext(),attributes:i.attributes,bandwidth:i.bandwidth,codecs:i.codecs,language:i.language,default:i.language===h,label:i.label,mimeType:"audio/mp4",type:"audio"},d=new s.StreamMetadata(a,function(){return k._getDetailsForStream(a,i,r,n,o,c,t.periodDuration)});l.push(f._addDrmToMetadata(i,d,n)),e.audio.push(d)},f=this,v=t.audio;_<v.length;_++)p(v[_]);for(y=0,m=function(i){var a={id:u.getNext(),attributes:i.attributes,bandwidth:i.bandwidth,codecs:i.codecs,language:"en-US",label:i.label,mimeType:"video/mp4",height:i.height,width:i.width,frameRate:i.frameRate,type:"video",embeddedCaptions:i.embeddedCaptions},d=new s.StreamMetadata(a,function(){return k._getDetailsForStream(a,i,r,n,o,c,t.periodDuration)});l.push(g._addDrmToMetadata(i,d,n)),e.video.push(d)},g=this,S=t.video;y<S.length;y++)m(S[y]);for(b=0,E=function(i){var d={id:u.getNext(),attributes:i.attributes,bandwidth:0,codecs:i.codecs,language:i.language,label:i.label,mimeType:a.ContainerConstants.DEFAULT_TEXT_MIME_TYPE,type:"text"},l=new s.StreamMetadata(d,function(){return k._getDetailsForStream(d,i,r,n,o,c,t.periodDuration)});e.text.push(l)},w=t.text;b<w.length;b++)E(w[b]);for(T=0,P=function(i){var a={id:u.getNext(),attributes:0,bandwidth:i.bandwidth,codecs:i.codecs,language:"",label:i.label,mimeType:i.mime,type:"image",height:i.height,width:i.width},d=new s.StreamMetadata(a,function(){return k._getDetailsForStream(a,i,r,n,o,c,t.periodDuration)});e.image.push(d)},C=t.image;T<C.length;T++)P(C[T]);return(M=e.events).push.apply(M,t.schemeEvents),[4,Promise.all(l)];case 1:return i.sent(),[2]}})})},e.prototype._addDrmToMetadata=function(e,t,r){return i.__awaiter(this,void 0,void 0,function(){var n;return i.__generator(this,function(i){switch(i.label){case 0:return[4,this.getDrmInfo(e,r)];case 1:return n=i.sent(),t.drmInfo=n,[2]}})})},e.prototype._getDetailsForStream=function(e,t,r,n,o,a,s){var u,c;return i.__awaiter(this,void 0,void 0,function(){var d,l,h,p,f,_,v;return i.__generator(this,function(m){switch(m.label){case 0:return[4,Promise.all([this.getDrmInfo(t,n),this._dashManifestSegmentParser.getSegments(t,r,o,a,s)])];case 1:if(l=(d=m.sent())[1],h=i.__assign(i.__assign({},e),{drmInfo:d[0],segments:l}),p=null!==(c=null===(u=t.base)||void 0===u?void 0:u.representationTimeOffset)&&void 0!==c?c:0,"text"===e.type&&1===l.length)return h.segments=l,[2,h];return f=void 0===s||r?l.getTiming(l.length-1).end:p+s,void 0!==(_=this._convertRangeToSegmentBoundary(l,{start:p,end:f}))&&(v=this._playerUtil.getSegmentIndicesInRange(l,_),l.setSubView(v.startIndex,v.endIndexExclusive)),[2,h]}})})},e.prototype.getDrmInfo=function(e,t){return 0===e.drm.length?[]:Promise.all(e.drm.map(function(e){return t.resolve(e)}))},e.prototype._getRangeOfSegments=function(e){var t=e.getTiming(0),r=e.getTiming(e.length-1);return{start:t.start,end:r.end}},e.prototype._convertRangeToSegmentBoundary=function(e,t){var r=this._getRangeOfSegments(e);if(r.start!==r.end){var i=this._findClosestSegmentBoundary(e,t.start),n=this._findClosestSegmentBoundary(e,t.end);return{start:-1===i?r.start:i,end:-1===n?r.end:n}}},e.prototype._findClosestSegmentBoundary=function(e,t){if(0===e.length)throw Error("Could not find closest segment on empty segment list");var r=e.getTiming(e.length-1),i=-1;t=Math.min(r.end,t);var n=this._playerUtil.binarySearchForSegmentIndex(e,t);if(n<0&&(0==(n=-n-1)||n===e.length))return i;for(var o=0,a=[n-1,n,n+1];o<a.length;o++){var s=a[o],u=e.tryGetTiming(s);if(void 0!==u){var c=Math.abs(i-t),d=Math.abs(u.start-t),l=Math.abs(u.end-t);(-1===i||d<c||l<c)&&(i=l<d?u.end:u.start)}}return i},e}();t.DashManifestVariantParser=u},81055:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DashUtil=void 0;var i=r(22970),n=r(81907),o=r(88269),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._languageUtil=new o.LanguageUtil,t._periodTimescaleMap={y:31536e3,m:2592e3,d:86400},t._timeTimescaleMap={s:1,m:60,h:3600},t}return i.__extends(t,e),t.prototype.getUriFromTemplate=function(e,t,r,i){var n=this,o=e;return void 0!==t&&(o=this._stringUtil.replaceAll(o,"$Number$","",function(){return t.toString()}),o=this._stringUtil.replaceAll(o,"$Number%0","d$",function(e){return n._stringUtil.padStart(t.toString(),parseInt(e),"0")})),void 0!==r&&(o=this._stringUtil.replaceAll(o,"$Time$","",function(){return r.toString()})),void 0!==i&&(o=this._stringUtil.replaceAll(o,"$RepresentationID$","",function(){return i})),o},t.prototype.parseSecondsFromISO8601=function(e){var t=0,r="",i=!1;e=e.toLowerCase();for(var o=0;o<e.length;o++){var a=e[o];if("p"!==a){if("t"===a){i=!0;continue}var s=i?this._timeTimescaleMap:this._periodTimescaleMap;if(void 0!==s[a]){var u=parseFloat(r)*s[a];if(!isFinite(u))throw new n.ManifestParserError("Invalid time value found ".concat(e," at index ").concat(o));if(u>0&&!i)throw new n.ManifestParserError("Found non-zero period time ".concat(e," at index ").concat(o));t+=u,r=""}else r+=a}}return t},t.prototype.parsePresentationTimeOffset=function(e){for(var t,r,i=0,n=e.attributes;i<n.length;i++){var o=n[i];if(this.startsWith(o,"presentationTimeOffset")){var a=parseFloat(this.getAttributeValue(o));isFinite(a)&&(t=a)}else if(this.startsWith(o,"timescale")){var s=parseFloat(this.getAttributeValue(o));isFinite(s)&&(r=s)}}if(void 0!==r&&void 0!==t)return t/r},t.prototype.parseRange=function(e){var t=e.split("-",2),r=parseInt(t[0]),i=parseInt(t[1]);if(!isFinite(r)||!isFinite(i))throw Error("Failed to parse range with input '".concat(e,"'"));return[r,i]},t.prototype.parseAudioDescription=function(e){for(var t=!1,r=!1,i=0,n=e.attributes;i<n.length;i++){var o=n[i];'schemeIdUri="urn:tva:metadata:cs:AudioPurposeCS:2007"'===o?t=!0:this.startsWith(o,"value=")&&(r="1"===this.getAttributeValue(o))}return t&&r},t.prototype.parseVideoRangePQ=function(e){for(var t=!1,r=!1,i=0,n=e.attributes;i<n.length;i++){var o=n[i];'schemeIdUri="urn:mpeg:mpegB:cicp:TransferCharacteristics"'===o?r=!0:'value="16"'===o&&(t=!0)}return t&&r},t.prototype.parseEmbeddedCaptions=function(e){for(var t=!1,r=[],i=0,n=e.attributes;i<n.length;i++){var o=n[i];if('schemeIdUri="urn:scte:dash:cc:cea-608:2015"'===o)t=!0;else if(this.startsWith(o,"value="))for(var a=0,s=this.getAttributeValue(o).split(";");a<s.length;a++){var u=s[a],c=u.indexOf("=");if(-1!==c){var d=u.substring(0,c),l=this._languageUtil.normalize(u.substring(c+1));("CC1"===d||"CC2"===d||"CC3"===d||"CC4"===d)&&r.push({service:d,language:l})}}}return t&&r.length>0?r:void 0},t.prototype.parseDolbyAtmos=function(e){for(var t=!1,r=!1,i=0,n=e.attributes;i<n.length;i++){var o=n[i];'schemeIdUri="tag:dolby.com,2018:dash:EC3_ExtensionType:2018"'===o?t=!0:this.startsWith(o,"value=")&&(r="JOC"===this.getAttributeValue(o))}return t&&r},t.prototype.containsRole=function(e,t){for(var r=!1,i=!1,n=0,o=e.attributes;n<o.length;n++){var a=o[n];if('schemeIdUri="urn:mpeg:dash:role:2011"'===a)r=!0;else if(this.startsWith(a,"value=")){var s=this.getAttributeValue(a);(i=s===t)||"forced-subtitle"!==t||(i="forced_subtitle"===s)}}return r&&i},t}(r(9345).NodeUtil);t.DashUtil=a},85857:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DashSegmentBaseCollection=void 0;var i=r(22970),n=function(e){function t(t,r,i){var n=e.call(this,{getLength:function(){return n._getLengthFromBase()},tryGetSegment:function(e){return n._tryGetSegmentFromBase(e)},tryGetTiming:function(e){return n._tryGetTimingFromBase(e)}})||this;return n.stream=t,n.uri=r,n.base=i,n}return i.__extends(t,e),t.prototype.refresh=function(t){e.prototype.refresh.call(this,t),this.base=t.base.slice(),this.uri=t.uri},t.prototype._getLengthFromBase=function(){return this.base.length},t.prototype._tryGetSegmentFromBase=function(e){var t=this.base[e],r=this._tryGetTimingFromBase(e);if(void 0!==t&&void 0!==r){var n=this.stream.drm.length>0?this.stream.drm[0].keyId:void 0,o=this.stream.initSegment;return i.__assign({id:"".concat(this.stream.id,"-").concat(e),position:e,createUri:this.uri,keyId:n,initSegment:o,startByte:t.startByte,endByte:t.endByte},r)}},t.prototype._tryGetTimingFromBase=function(e){var t=this.base[e];if(void 0!==t)return{start:t.start,end:t.end,originalStart:t.start,originalEnd:t.end,presentationTimeOffset:0}},t}(r(8533).SegmentCollection);t.DashSegmentBaseCollection=n},90155:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DashSegmentListCollection=void 0;var i=r(22970),n=function(e){function t(t,r){var i=e.call(this,{getLength:function(){return i._getLengthFromList()},tryGetSegment:function(e){return i._tryGetSegmentFromList(e)},tryGetTiming:function(e){return i._tryGetTimingFromList(e)}})||this;return i.stream=t,i.list=r,i}return i.__extends(t,e),t.prototype.refresh=function(t){e.prototype.refresh.call(this,t),this.list.duration=t.list.duration,this.list.initializationUri=t.list.initializationUri,this.list.items=t.list.items.slice(),this.list.timescale=t.list.timescale},t.prototype._getLengthFromList=function(){return this.list.items.length},t.prototype._tryGetSegmentFromList=function(e){var t=this.list.items[e],r=this._tryGetTimingFromList(e);if(void 0!==t&&void 0!==r)return i.__assign({id:"".concat(this.stream.id,"-").concat(e),position:e,keyId:void 0,createUri:t.mediaUri,initSegment:this.stream.initSegment},r)},t.prototype._tryGetTimingFromList=function(e){if(void 0!==this.list.items[e]){var t=this.list.duration/this.list.timescale,r=t*e,i=r+t;return{start:r,end:i,presentationTimeOffset:0,originalStart:r,originalEnd:i}}},t}(r(8533).SegmentCollection);t.DashSegmentListCollection=n},16854:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DashSegmentSingleFileCollection=void 0;var i=r(22970),n=function(e){function t(t,r,i){var n=e.call(this,{getLength:function(){return 1},tryGetSegment:function(e){return n._tryGetSegmentFromSingleFile(e)},tryGetTiming:function(e){return n._tryGetTimingFromSingleFile(e)}})||this;return n.stream=t,n.singleFile=r,n._maxDuration=i,n}return i.__extends(t,e),t.prototype.refresh=function(t){e.prototype.refresh.call(this,t),this.singleFile.uri=t.singleFile.uri,this._maxDuration=t._maxDuration},t.prototype._tryGetSegmentFromSingleFile=function(e){if(0===e){var t=this._tryGetTimingFromSingleFile(e);if(void 0!==t)return i.__assign({id:"".concat(this.stream.id,"-single-file"),position:0,keyId:void 0,createUri:this.singleFile.uri,initSegment:void 0},t)}},t.prototype._tryGetTimingFromSingleFile=function(e){if(0===e){var t,r=null!==(t=this._maxDuration)&&void 0!==t?t:36e4;return{start:0,end:r,originalStart:0,originalEnd:r,presentationTimeOffset:0}}},t}(r(8533).SegmentCollection);t.DashSegmentSingleFileCollection=n},59791:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DashSegmentTemplateCollection=void 0;var i=r(22970),n=r(8533),o=r(81055),a=function(e){function t(t,r,i){void 0===i&&(i=0);var n=e.call(this,{getLength:function(){return n._getLengthFromTemplate()},tryGetSegment:function(e){return n._tryGetSegmentFromTemplate(e)},tryGetTiming:function(e){return n._tryGetTimingFromTemplate(e)}})||this;return n.stream=t,n.template=r,n.timeOffset=i,n._dashUtil=new o.DashUtil,n}return i.__extends(t,e),t.prototype.refresh=function(t){e.prototype.refresh.call(this,t),this.template.decodeShift=t.template.decodeShift,this.template.durationBasedSegments=t.template.durationBasedSegments,this.template.finalizationData=t.template.finalizationData,this.template.initializationUri=t.template.initializationUri,this.template.representationTimeOffset=t.template.representationTimeOffset,this.template.segmentTimes=t.template.segmentTimes.slice(),this.template.timescale=t.template.timescale,this.template.totalDuration=t.template.totalDuration,this.template.uriTemplate=t.template.uriTemplate},t.prototype._getLengthFromTemplate=function(){return this.template.segmentTimes.length},t.prototype._tryGetSegmentFromTemplate=function(e){var t=this.template.segmentTimes[e],r=this._tryGetTimingFromTemplate(e);if(void 0!==t&&void 0!==r){var n=this.stream.drm.length>0?this.stream.drm[0].keyId:void 0,o=this._dashUtil.getUriFromTemplate(this.template.uriTemplate,t.position,t.start,this.stream.representationId);return i.__assign({id:"".concat(this.stream.id,"-").concat(t.position),position:t.position,keyId:n,createUri:o,initSegment:this.stream.initSegment},r)}},t.prototype._tryGetTimingFromTemplate=function(e){var t,r=this.template.segmentTimes[e];if(void 0!==r){var i=null!==(t=this.template.representationTimeOffset)&&void 0!==t?t:0,n=this.template.timescale,o=this.timeOffset-i,a=o+r.start/n,s=o+r.end/n;return{start:a,end:s,presentationTimeOffset:o,originalStart:a,originalEnd:s}}},t}(n.SegmentCollection);t.DashSegmentTemplateCollection=a},81087:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OptimalBitrateForecaster=void 0;var i=r(61029),n=r(68446),o=r(64600),a=r(82270),s=function(){function e(t){var r,a,s;this._bufferStabilityAnalyzer=new n.BufferStabilityAnalyzer,this._ratioAnalyzer=new o.DownloadRatioAnalyzer,this._bufferPrimed=!1,this._bufferCapacitySec=0,this._isLive=!1,this._initialBitrateForecastPolicy=null!==(r=null==t?void 0:t.bandwidthForecastPolicy)&&void 0!==r?r:0,this._initialBandwidth=null!==(a=null==t?void 0:t.initialBandwidth)&&void 0!==a?a:0,this._maxBandwidth=null==t?void 0:t.maxBandwidth,this._abrProtocol=null!==(s=null==t?void 0:t.protocol)&&void 0!==s?s:e.DEFAULT_ABR_PROTOCOL,this._bandwidthAnalyzer=new i.BandwidthQualityAnalyzer}return Object.defineProperty(e.prototype,"currentBitrate",{get:function(){return void 0===this._currentBitrate?0:this._currentBitrate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{set:function(e){this._abrProtocol=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"override",{set:function(e){this._abrOverride=e},enumerable:!1,configurable:!0}),e.prototype.forecast=function(e){if(0!==e.length){if(void 0!==this._maxBandwidth){var t,r=this._maxBandwidth,i=e.filter(function(e){return e.bandwidth<=r});if(0===i.length)return e.getFirst();e=i}if(this._bufferStabilityAnalyzer.adjustPlaybackUtility(e),this._bufferStabilityAnalyzer.adjustAncillaryValues(e.getLast().bandwidth),void 0!==this._abrOverride){var n=this._closestItem(e,this._abrOverride);if(void 0!==n)return n}switch(this._abrProtocol){case 0:t=this._bandwidthAbrForecast(e);break;case 1:t=this._bufferAbrForecast(e);break;case 2:t=this._hybridAbrForecast(e);break;case 3:t=this._randomAbrForecast(e)}if(void 0!==(t=null!=t?t:this._defaultVariant(e)))return this._currentBitrate=t.bandwidth,t}},e.prototype.getTopBitrateVariant=function(e){var t;return void 0===this._maxBandwidth?e.tryGetLast():null!==(t=this._closestItem(e,this._maxBandwidth))&&void 0!==t?t:e.tryGetFirst()},e.prototype.getCurrentBandwidthEstimate=function(){return this._projectBandwidth()},e.prototype.handlePlaybackStateChange=function(e){"SEEKING"===e&&(this._bufferPrimed=!1)},e.prototype.handleSegmentRetry=function(){this._bandwidthAnalyzer.handleSegmentRetry(),this._ratioAnalyzer.handleSegmentRetry()},e.prototype.onSegmentDownloaded=function(e,t,r,i){this._bandwidthAnalyzer.processValue(e,t,r),void 0!==i&&this._ratioAnalyzer.processValue(t,r,1e3*(i.end-i.start))},e.prototype.setBufferCapacitySec=function(e){this._bufferCapacitySec=e,this._bufferStabilityAnalyzer.setBufferCapacitySec(e)},e.prototype.setBufferLevelSec=function(e){this._bufferStabilityAnalyzer.setBufferLevelSec(e)},e.prototype.setSegmentDurationSec=function(e){this._bufferStabilityAnalyzer.setSegmentDurationSec(e)},e.prototype.setIsLive=function(e){this._isLive=e},e.prototype._defaultVariant=function(e){if(0!==e.length){if(0!==this._initialBandwidth){var t=this._closestItem(e,this._initialBandwidth);if(void 0!==t)return t}var r=0;switch(this._initialBitrateForecastPolicy){case 3:r=Math.floor((e.length-1)/4);break;case 1:r=Math.floor(e.length/2),e.length%2==0&&(r-=1);break;case 2:r=e.length-1}return e.getAt(r)}},e.prototype._hybridAbrForecast=function(e){if(this._isLive)return this._bandwidthAbrForecast(e);var t=this._bufferAbrForecast(e);if(this._bufferPrimed)return t;var r=this._bandwidthAbrForecast(e);return void 0===t||void 0===r?r:this._bufferCapacitySec>=a.PlayerConstants.DEFAULT_RELATIVE_BUFFER_END&&(t.bandwidth>r.bandwidth||t===e.tryGetLast())?(this._bufferPrimed=!0,t):r},e.prototype._projectBandwidth=function(){return this._bandwidthAnalyzer.projectBandwidth()},e.prototype._bandwidthAbrForecast=function(e){var t,r=this._projectBandwidth();if(0!==r)return void 0!==this._currentBitrate&&r<this._currentBitrate&&!this._ratioAnalyzer.shouldConsiderDownshift()&&(r=this._currentBitrate),null!==(t=this._closestItem(e,r))&&void 0!==t?t:e.getFirst()},e.prototype._bufferAbrForecast=function(e){return this._bufferStabilityAnalyzer.forecast(e)},e.prototype._randomAbrForecast=function(e){return e.getAt(Math.floor(Math.random()*e.length))},e.prototype._closestItemIndex=function(e,t){var r=e.find({bandwidth:t});if(r<0){var i=Math.abs(r)-2;return i<0?-1:i}return r},e.prototype._closestItem=function(e,t){var r=this._closestItemIndex(e,t);if(-1!==r)return e.getAt(r)},e.DEFAULT_ABR_PROTOCOL=0,e}();t.OptimalBitrateForecaster=s},61029:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BandwidthQualityAnalyzer=void 0;var r=function(){function e(){this._bytesSampled=0,this._metrics={bandwidthStatistics:{mean:0,montgomery:[],variance:0,hasCachedValues:!1},latencyStatistics:{mean:0,montgomery:[],variance:0,hasCachedValues:!1},cacheThreshold:e.CACHE_THRESHOLD}}return e.prototype.unregister=function(){this._reset()},e.prototype.getBandwidthMontgomeryHistory=function(){return this._metrics.bandwidthStatistics.montgomery},e.prototype.getBandwidthHasCachedValues=function(){return this._metrics.bandwidthStatistics.hasCachedValues},e.prototype.handleSegmentRetry=function(){this._reset()},e.prototype.processValue=function(t,r,i){if(!(t<e.MIN_SAMPLE_BYTE_SIZE)){var n=this._computeThroughput(r+i,t);this._bytesSampled<e.MINIMUM_BYTE_SAMPLE_SIZE&&(this._bytesSampled+=t),r<this._metrics.cacheThreshold?this._handleInvalidFragment(this._metrics.bandwidthStatistics):this._handleValidFragment(this._metrics.bandwidthStatistics),this._normalizeValueUsingStandardScore(n,this._metrics.bandwidthStatistics),i>0&&this._normalizeValueUsingStandardScore(i,this._metrics.latencyStatistics)}},e.prototype.projectBandwidth=function(){var t=0;return this._bytesSampled<e.MINIMUM_BYTE_SAMPLE_SIZE?t:t=Math.floor(this._getAverage(this._metrics.bandwidthStatistics.montgomery))},e.prototype._computeThroughput=function(e,t){return Math.round(8*t/e*1e3)},e.prototype._handleValidFragment=function(e){e.montgomery.length>0&&e.hasCachedValues&&this._resetBandwidthStatistics(e)},e.prototype._handleInvalidFragment=function(e){0!==e.montgomery.length&&e.hasCachedValues||(e.hasCachedValues=!0)},e.prototype._resetBandwidthStatistics=function(e){e.mean=0,e.montgomery=[],e.hasCachedValues=!1,e.variance=0},e.prototype._reset=function(){this._bytesSampled=0,this._resetBandwidthStatistics(this._metrics.bandwidthStatistics),this._resetBandwidthStatistics(this._metrics.latencyStatistics)},e.prototype._enforceAccumulatorCapacity=function(t){t.splice(0,Math.max(0,t.length-e.HISTORY_RETENTION_CAP))},e.prototype._normalizeValueUsingStandardScore=function(t,r){var i,n=this._delta(t,r),o=this._lambda(r),a=this._ema(o,n,r.mean),s=this._emaVariance(o,n,r.variance),u=Math.sqrt(s),c=this._standardScore(t,a,u);c<0&&Math.abs(c)>=e.DECREASING_Z_SCORE?i="decreased":c>0&&Math.abs(c)>=e.INCREASING_Z_SCORE&&(i="increased"),void 0!==i?(this._resetBandwidthStatistics(r),this._normalizeValueUsingStandardScore(t,r)):(r.variance=s,r.mean=a,r.montgomery.push(a),this._enforceAccumulatorCapacity(r.montgomery))},e.prototype._standardScore=function(e,t,r){return 0===r?0:(e-t)/r},e.prototype._emaVariance=function(e,t,r){return(1-e)*(r+e*Math.pow(t,2))},e.prototype._ema=function(e,t,r){return e*t+r},e.prototype._lambda=function(e){return 1-Math.pow(.5,2/Math.max(e.montgomery.length,1))},e.prototype._delta=function(e,t){return e-t.mean},e.prototype._getAverage=function(e){return 0===e.length?0:e.reduce(function(e,t){return e+t},0)/e.length},e.HISTORY_RETENTION_CAP=25,e.CACHE_THRESHOLD=50,e.MIN_SAMPLE_BYTE_SIZE=16e3,e.INCREASING_Z_SCORE=1.645,e.DECREASING_Z_SCORE=.706,e.MINIMUM_BYTE_SAMPLE_SIZE=128e3,e}();t.BandwidthQualityAnalyzer=r},64600:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DownloadRatioAnalyzer=void 0;var r=function(){function e(){this._downloadRatios=[]}return e.prototype.unregister=function(){this._reset()},e.prototype.handleSegmentRetry=function(){this._reset()},e.prototype.processValue=function(e,t,r){r<=0||(this._downloadRatios.push({ratio:(e+t)/r,durationMS:r}),this._enforceRetention())},e.prototype.shouldConsiderDownshift=function(){var e=this._getThreshold();return 0===this._downloadRatios.length||this._downloadRatios.some(function(t){return t.ratio>e})},e.prototype._totalDurationMS=function(){return this._downloadRatios.reduce(function(e,t){return e+t.durationMS},0)},e.prototype._enforceRetention=function(){for(var t,r;this._totalDurationMS()>=e.HISTORY_RETENTION_MS+(null!==(r=null===(t=this._downloadRatios[0])||void 0===t?void 0:t.durationMS)&&void 0!==r?r:0);)this._downloadRatios.shift()},e.prototype._getThreshold=function(){return e.MIN_THRESHOLD+(e.MAX_THRESHOLD-e.MIN_THRESHOLD)*Math.min(this._totalDurationMS(),e.HISTORY_RETENTION_MS)/e.HISTORY_RETENTION_MS},e.prototype._reset=function(){this._downloadRatios=[]},e.HISTORY_RETENTION_MS=2e4,e.MIN_THRESHOLD=.5,e.MAX_THRESHOLD=.75,e}();t.DownloadRatioAnalyzer=r},77620:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BufferOptimization=void 0;var r=function(){function e(){}return e.prototype.lyapunov=function(t,r,i,n,o){return(t*o+o*e.GAMMA-i/n)/r},e.prototype.calculateControlParameter=function(t,r,i){if(0!==r&&void 0!==t&&0!==i)return Math.round((i/r-1)/(t+e.GAMMA))},e.GAMMA=5,e}();t.BufferOptimization=r},68446:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BufferStabilityAnalyzer=void 0;var i=r(54965),n=r(77620),o=function(){function e(){this._bufferOptimizer=new n.BufferOptimization,this._segmentDurationSec=0,this._bufferCapacitySec=0,this._bufferLevelSec=0}return e.prototype.adjustAncillaryValues=function(e){void 0!==e&&void 0===this._controlCoefficient&&void 0!==this._utilityMap&&(this._controlCoefficient=this._bufferOptimizer.calculateControlParameter(this._utilityMap.tryGet(e),this._segmentDurationSec,this._bufferCapacitySec))},e.prototype.adjustPlaybackUtility=function(e){var t=this._utilityMap=new i.Map,r=e.getFirst().bandwidth;0!==r&&e.forEach(function(e){t.contains(e.bandwidth)||t.set(e.bandwidth,Math.log(e.bandwidth/r))})},e.prototype.forecast=function(e){for(var t,r=0,i=0;i<e.length;++i){var n=e.getAt(i),o=this._getScore(n.bandwidth);(void 0===t||o>r)&&(t=n,r=o)}return t},e.prototype.setBufferCapacitySec=function(e){this._bufferCapacitySec=e},e.prototype.setBufferLevelSec=function(e){this._bufferLevelSec=e},e.prototype.setSegmentDurationSec=function(e){this._segmentDurationSec=e},e.prototype._getScore=function(t){if(void 0===this._utilityMap)return 0;var r,i=this._utilityMap.tryGet(t);if(void 0===i||0===this._segmentDurationSec)return 0;var n=this._segmentDurationSec*t,o=null!==(r=this._controlCoefficient)&&void 0!==r?r:e.CONTROL_DEFAULT;return this._bufferOptimizer.lyapunov(i,n,this._bufferLevelSec,this._segmentDurationSec,o)},e.CONTROL_DEFAULT=.93,e}();t.BufferStabilityAnalyzer=o},61757:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncWorker=void 0;var i=r(5966),n=r(47632),o=r(54965),a=r(88309),s=r(57665),u=r(34855),c=function(){function e(t,r){var u=this;this.onWorkCompleted=new n.Emitter,this.onWorkStalled=new n.Emitter,this.onError=new n.Emitter,this.perTickDelay=e.DEFAULT_DELAY_SECONDS,this.postAsyncDelay=e.POSTASYNC_DELAY_SECONDS,this.concurrentLimit=e.CONCURRENT_LIMIT,this._workerRunning=!1,this._workerStalled=!1,this._runningWork=new a.Set,this._runningWorkPromises=new o.Map,this._haltedWork=new a.Set,this._handleWorkerTick=function(){var e;try{var t=u._workerStalled;u._workerStalled=!0,u._workerRunning&&u._runningWork.size<=u.concurrentLimit&&(e=u._workerFeeder.getNextWorkItem(),void 0!==e&&(u._startWorkItem(e),u._ensureTick(u.perTickDelay),u._workerStalled=!1)),!t&&u._workerStalled&&u.onWorkStalled.emit()}catch(t){var r=s.WrappedError.wrap(t,"AsyncWorkError");u.onError.emit({item:e,error:r})}},this._workerFeeder=r,this._workerTick=new i.DelayedTick(t,this._handleWorkerTick)}return e.prototype.destroy=function(){this.stop(),this.onWorkCompleted.off(),this.onWorkStalled.off(),this.onError.off(),this._runningWork.clear(),this._runningWorkPromises.clear(),this._haltedWork.clear()},e.prototype.flush=function(){(!this._workerRunning||this._workerStalled)&&this._ensureTick(0),this._workerStalled=!1,this._workerRunning=!0},e.prototype.stop=function(){this._workerRunning=!1,this._workerStalled=!1,this._workerTick.stop()},e.prototype.isHalted=function(e){return this._haltedWork.has(e)},e.prototype.isRunning=function(){return this._runningWork.size>0},e.prototype.halt=function(e){this._runningWork.has(e)&&this._haltedWork.add(e)},e.prototype._ensureTick=function(e){var t=this;u.PromiseUtil.catchRejection(function(){return t._workerTick.tickAfter(e)},function(e){t.onError.emit({error:s.WrappedError.wrap(e)})})},e.prototype._startWorkItem=function(e){var t=this;void 0!==this._workerFeeder.prepareWorkItem&&this._workerFeeder.prepareWorkItem(e),this._runningWork.add(e);var r=this._workerFeeder.handleWorkItem(e);this._runningWorkPromises.set(e,r.catch(function(r){var i=s.WrappedError.wrap(r,"AsyncWorkError");t.onError.emit({item:e,error:i})}).then(function(){void 0!==t._workerFeeder.completeWorkItem&&t._workerFeeder.completeWorkItem(e),t._runningWork.delete(e),t._runningWorkPromises.delete(e),t._haltedWork.delete(e),t.onWorkCompleted.emit(e),t._ensureTick(t.postAsyncDelay)}))},e.DEFAULT_DELAY_SECONDS=0,e.POSTASYNC_DELAY_SECONDS=0,e.CONCURRENT_LIMIT=Number.POSITIVE_INFINITY,e}();t.AsyncWorker=c},5966:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DelayedTick=void 0;var i=r(22970),n=function(){function e(e,t){this._system=e,this._onTick=t,this._cancel=void 0}return e.prototype.tickAfter=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,n;return i.__generator(this,function(i){switch(i.label){case 0:this.stop(),t=!0,r=this._system.postTimeout(e),this._cancel=function(){t=!1,r.cancel()},i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,r.timeout];case 2:return i.sent(),[3,5];case 3:if(n=i.sent(),t)throw n;return[3,5];case 4:return this._cancel=void 0,[7];case 5:return t&&void 0!==this._onTick&&this._onTick(),[2]}})})},e.prototype.stop=function(){void 0!==this._cancel&&(this._cancel(),this._cancel=void 0)},e}();t.DelayedTick=n},24533:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SequentialTaskRunner=void 0;var i=r(22970),n=r(47632),o=r(28521),a=r(61757),s="SequentialTaskRunner",u=function(){function e(e){var t=this;this._system=e,this.onError=new n.Emitter,this.onWarning=new n.Emitter,this._tasks=[],this._worker=new a.AsyncWorker(this._system,{getNextWorkItem:function(){return t._tasks[0]},handleWorkItem:function(e){return t._worker.onError.on(t,function(r){var i;r.item!==e&&t._system.logWarn("".concat(s,": Error for item not currently being handled with type '").concat(null===(i=r.item)||void 0===i?void 0:i.request.type,"'")),void 0!==r.item?r.item.reject(r.error):t.onError.emit(r.error)}),e.performAction()},completeWorkItem:function(e){t._worker.onError.off(t),t._tasks[0]!==e?t.onWarning.emit(new o.WarningError("Missing completed SequentialTask")):t._tasks.shift()}}),this._worker.concurrentLimit=0}return Object.defineProperty(e.prototype,"tasks",{get:function(){return this._tasks},enumerable:!1,configurable:!0}),e.prototype._run=function(e,t,r){var n=this,o=new Promise(function(o,a){var s={request:e,returnType:t,performAction:function(){return i.__awaiter(n,void 0,void 0,function(){var e;return i.__generator(this,function(t){switch(t.label){case 0:return e=o,[4,r(s.request)];case 1:return e.apply(void 0,[t.sent()]),[2]}})})},reject:a,promise:Promise.resolve()};n._tasks.push(s)});return this._tasks[this._tasks.length-1].promise=o,this._worker.flush(),o},e.prototype.runWithReturn=function(e,t){return this._run(e,"value",t)},e.prototype.runWithoutReturn=function(e,t){return this._run(e,"void",t)},e.prototype.runReplace=function(e,t,r){if(this._tasks.length>0){var i=this._tasks[this._tasks.length-1];if("void"===i.returnType&&i.request.type===e.type){if(!(1===this._tasks.length&&this._worker.isRunning()))return this._system.logInfo("".concat(s,": replacing old ").concat(e.type," request with new one")),i.request=e,i.promise;if(t(i.request,e))return this._system.logInfo("".concat(s,": ignoring duplicate ").concat(e.type," request")),i.promise}}return this.runWithoutReturn(e,r)},e.prototype.destroy=function(){this._worker.stop(),this._worker.destroy()},e}();t.SequentialTaskRunner=u},53282:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=void 0;var i=r(5966),n=r(47632),o=r(57665),a=r(34855),s=function(){function e(e,t){this.onError=new n.Emitter,this._system=e,this._onTick=t,this._ticker=void 0}return e.prototype.tickNow=function(){return this.stop(),this._onTick()},e.prototype.tickAfter=function(e){var t=this;this.stop(),this._ticker=new i.DelayedTick(this._system,function(){a.PromiseUtil.catchRejection(function(){return t._onTick()},function(e){t.onError.emit(o.WrappedError.wrap(e))})}),this._tick(e)},e.prototype.tickEvery=function(e){var t=this;this.stop(),this._ticker=new i.DelayedTick(this._system,function(){a.PromiseUtil.catchRejection(function(){return t._onTick()},function(e){t.onError.emit(o.WrappedError.wrap(e))},function(){t._tick(e)})}),this._tick(e)},e.prototype.stop=function(){void 0!==this._ticker&&(this._ticker.stop(),this._ticker=void 0)},e.prototype._tick=function(e){var t=this;a.PromiseUtil.catchRejection(function(){var r;return null===(r=t._ticker)||void 0===r?void 0:r.tickAfter(e)},function(e){t.onError.emit(o.WrappedError.wrap(e))})},e}();t.Timer=s},91475:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NUM_COLUMNS=t.NUM_ROWS=void 0,t.NUM_ROWS=15,t.NUM_COLUMNS=32},1460:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cta608Decoder=void 0;var i,n,o,a,s,u,c,d,l=r(22970),h=r(54965),p=r(36899),f=r(4679),_=r(91475);(i=s||(s={}))[i.FIELD_1=0]="FIELD_1",i[i.FIELD_2=1]="FIELD_2",(n=u||(u={}))[n.CHANNEL_1=0]="CHANNEL_1",n[n.CHANNEL_2=1]="CHANNEL_2",n[n.XDS=2]="XDS",(o=c||(c={}))[o.CAPTION=0]="CAPTION",o[o.TEXT=1]="TEXT",o[o.XDS=2]="XDS",(a=d||(d={}))[a.POP_ON=0]="POP_ON",a[a.PAINT_ON=1]="PAINT_ON",a[a.ROLL_UP=2]="ROLL_UP";var v=function(){function e(){var e;this._fieldDecoders=((e={})[s.FIELD_1]=new m,e[s.FIELD_2]=new m,e)}return e.prototype.decode=function(e,t){var r=[127&e.ccData[0],127&e.ccData[1]];switch((247&r[0])==21&&r[1]>=32&&r[1]<48&&(r[0]&=254),e.ccType){case 0:return this._fieldDecoders[s.FIELD_1].decode(r,"CC1"===t?u.CHANNEL_1:"CC2"===t?u.CHANNEL_2:void 0);case 1:return this._fieldDecoders[s.FIELD_2].decode(r,"CC3"===t?u.CHANNEL_1:"CC4"===t?u.CHANNEL_2:void 0);default:return}},e.prototype.getDisplay=function(e){switch(e){case"CC1":return this._fieldDecoders[s.FIELD_1].getDisplay(u.CHANNEL_1);case"CC2":return this._fieldDecoders[s.FIELD_1].getDisplay(u.CHANNEL_2);case"CC3":return this._fieldDecoders[s.FIELD_2].getDisplay(u.CHANNEL_1);case"CC4":return this._fieldDecoders[s.FIELD_2].getDisplay(u.CHANNEL_2)}},e}();t.Cta608Decoder=v;var m=function(){function e(){var e;this._channelDecoders=((e={})[u.CHANNEL_1]=new C,e[u.CHANNEL_2]=new C,e)}return e.prototype.decode=function(t,r){var i;if(void 0!==this._expectedRedundantControlCode&&(0,f.pairEquals)(t,this._expectedRedundantControlCode)){this._expectedRedundantControlCode=void 0;return}switch(t[0]>=16&&t[0]<32?this._expectedRedundantControlCode=l.__spreadArray([],t,!0):this._expectedRedundantControlCode=void 0,this._currentDataChannel=null!==(i=e._classify(t))&&void 0!==i?i:this._currentDataChannel,(t=l.__spreadArray([],t,!0))[0]>=16&&t[0]<32&&(t[0]&=247),this._currentDataChannel){case u.CHANNEL_1:case u.CHANNEL_2:var n=this._channelDecoders[this._currentDataChannel].decode(t);return this._currentDataChannel===r?n:void 0;default:return}},e.prototype.getDisplay=function(e){return this._channelDecoders[e].getDisplay()},e._classify=function(e){return e[0]>0&&e[0]<16?u.XDS:e[0]>=16&&e[0]<32?(8&e[0])==0?u.CHANNEL_1:u.CHANNEL_2:void 0},e}(),g=[20,32],y=[20,37],S=[20,38],E=[20,39],b=[20,41],w=[20,42],P=[20,43],T=[20,47],C=function(){function e(){this._rollUpRowDepth=3,this._displayedMemory=new M,this._nonDisplayedMemory=new M,this._activeMemory=this._displayedMemory}return e.prototype.decode=function(t){var r=e._classify(t),i=r[0],n=r[1];if(this._currentDataType=null!=i?i:this._currentDataType,this._currentDataType===c.CAPTION){var o=!1;return this._currentCaptionStyle!==n&&(o=this._switchStyles(n)||o),(o=t[0]>=16&&t[0]<32?this._control(t)||o:this._character(t)||o)?this.getDisplay():void 0}},e.prototype.getDisplay=function(){return this._displayedMemory.getDisplay()},e._classify=function(e){return[g,T].some(function(t){return(0,f.pairEquals)(e,t)})?[c.CAPTION,d.POP_ON]:(0,f.pairEquals)(e,b)?[c.CAPTION,d.PAINT_ON]:[y,S,E].some(function(t){return(0,f.pairEquals)(e,t)})?[c.CAPTION,d.ROLL_UP]:[w,P].some(function(t){return(0,f.pairEquals)(e,t)})?[c.TEXT,void 0]:[void 0,void 0]},e.prototype._switchStyles=function(e){var t=!1;return void 0===e||e===this._currentCaptionStyle||(e===d.ROLL_UP&&(this._nonDisplayedMemory.erase(),t=this._displayedMemory.erase()||t),this._currentCaptionStyle=e),t},e.prototype._character=function(t){for(var r,i=!1,n=0;n<t.length;n++){var o=t[n];if(0!==o){var a=null!==(r=e._remappedAsciiCodes.tryGet(o))&&void 0!==r?r:String.fromCharCode(o);this._activeMemory.append(a)&&this._activeMemory===this._displayedMemory&&(i=!0)}}return i},e.prototype._control=function(e){return 17===e[0]&&e[1]>=32&&e[1]<48?this._midRowCode():17===e[0]&&e[1]>=48&&e[1]<64?this._specialCharacter(e):(18===e[0]||19===e[0])&&e[1]>=32&&e[1]<64?this._extendedCharacter(e):e[1]>=64&&(16!==e[0]||e[1]<96)?this._preambleAddressCode(e):23===e[0]&&e[1]>=33&&e[1]<=35?this._tabOffset(e):20===e[0]&&!!(e[1]>=32)&&!!(e[1]<48)&&this._misc(e)},e.prototype._midRowCode=function(){return this._activeMemory.append(" ")&&this._activeMemory===this._displayedMemory},e.prototype._specialCharacter=function(t){return this._activeMemory.append(e._specialCharacters.get(t[1]))&&this._activeMemory===this._displayedMemory},e.prototype._extendedCharacter=function(t){var r=18===t[0]?e._extendedCharacters1:e._extendedCharacters2,i=this._activeMemory.backspace();return(i=this._activeMemory.append(r.get(t[1]))||i)&&this._activeMemory===this._displayedMemory},e.prototype._preambleAddressCode=function(t){var r=e._pacRowTable.get(t[0]);t[1]>=96&&++r;var i=0;return(16&t[1])!=0&&(i=(t[1]>>1&7)*4),this._activeMemory.setCursorPosition(r,i,this._currentCaptionStyle===d.ROLL_UP)&&this._activeMemory===this._displayedMemory},e.prototype._tabOffset=function(e){return this._activeMemory.tabOffset(e[1]-33+1,this._currentCaptionStyle===d.ROLL_UP)&&this._activeMemory===this._displayedMemory},e.prototype._misc=function(e){var t,r=!1;switch(e[1]){case g[1]:this._activeMemory=this._nonDisplayedMemory;break;case 33:r=this._activeMemory.backspace()&&this._activeMemory===this._displayedMemory;break;case y[1]:case S[1]:case E[1]:this._activeMemory=this._displayedMemory,this._rollUpRowDepth=e[1]-y[1]+2;break;case b[1]:this._activeMemory=this._displayedMemory;break;case 44:r=this._displayedMemory.erase();break;case 45:this._currentCaptionStyle===d.ROLL_UP&&(r=this._activeMemory.scroll(this._rollUpRowDepth)&&this._activeMemory===this._displayedMemory);break;case 46:this._nonDisplayedMemory.erase();break;case T[1]:t=[this._nonDisplayedMemory,this._displayedMemory],this._displayedMemory=t[0],this._nonDisplayedMemory=t[1],this._activeMemory=this._nonDisplayedMemory,r=!this._displayedMemory.displayIsBlank()||!this._nonDisplayedMemory.displayIsBlank()}return r},e._remappedAsciiCodes=new h.Map([[39,""],[42,"\xe1"],[92,"\xe9"],[94,"\xed"],[95,"\xf3"],[96,"\xfa"],[123,"\xe7"],[124,"\xf7"],[125,"\xd1"],[126,"\xf1"],[127,""]]),e._specialCharacters=new h.Map([[48,"\xae"],[49,"\xb0"],[50,"\xbd"],[51,"\xbf"],[52,""],[53,"\xa2"],[54,"\xa3"],[55,""],[56,"\xe0"],[57," "],[58,"\xe8"],[59,"\xe2"],[60,"\xea"],[61,"\xee"],[62,"\xf4"],[63,"\xfb"]]),e._extendedCharacters1=new h.Map([[32,"\xc1"],[33,"\xc9"],[34,"\xd3"],[35,"\xda"],[36,"\xdc"],[37,"\xfc"],[38,""],[39,"\xa1"],[40,"*"],[41,"'"],[42,""],[43,"\xa9"],[44,""],[45,""],[46,""],[47,""],[48,"\xc0"],[49,"\xc2"],[50,"\xc7"],[51,"\xc8"],[52,"\xca"],[53,"\xcb"],[54,"\xeb"],[55,"\xce"],[56,"\xcf"],[57,"\xef"],[58,"\xd4"],[59,"\xd9"],[60,"\xf9"],[61,"\xdb"],[62,"\xab"],[63,"\xbb"]]),e._extendedCharacters2=new h.Map([[32,"\xc3"],[33,"\xe3"],[34,"\xcd"],[35,"\xcc"],[36,"\xec"],[37,"\xd2"],[38,"\xf2"],[39,"\xd5"],[40,"\xf5"],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,"\xc4"],[49,"\xe4"],[50,"\xd6"],[51,"\xf6"],[52,"\xdf"],[53,"\xa5"],[54,"\xa4"],[55,""],[56,"\xc5"],[57,"\xe5"],[58,"\xd8"],[59,"\xf8"],[60,""],[61,""],[62,""],[63,""]]),e._pacRowTable=new h.Map([[17,1],[18,3],[21,5],[22,7],[23,9],[16,11],[19,12],[20,14]]),e}(),M=function(){function e(){this._chunks=[],this._608Util=new p.Cta608Util}return e.prototype.setCursorPosition=function(e,t,r){var i=!1;if(r&&void 0!==this._cursorRow){var n=e-this._cursorRow;if(0!==n)for(var o=0,a=this._chunks;o<a.length;o++){var s=a[o];s.row=Math.min(Math.max(s.row+n,1),_.NUM_ROWS),""!==s.text&&(i=!0)}}return void 0!==this._activeChunk&&0===this._activeChunk.text.length?(this._activeChunk.row=e,this._activeChunk.indent=t):r||(this._activeChunk=void 0),this._cursorRow=e,this._cursorIndent=t,i},e.prototype.tabOffset=function(e,t){return void 0!==this._cursorRow&&void 0!==this._cursorIndent&&this.setCursorPosition(this._cursorRow,Math.min(this._cursorIndent+e,_.NUM_COLUMNS-1),t)},e.prototype.append=function(e){if(0===e.length)return!1;if(void 0===this._activeChunk){if(void 0===this._cursorRow||void 0===this._cursorIndent)return!1;var t={row:this._cursorRow,indent:this._cursorIndent,text:""};this._chunks.push(t),this._activeChunk=t}return this._activeChunk.text+=e,!0},e.prototype.scroll=function(e){var t=!1;if(void 0===this._cursorRow||void 0===this._cursorIndent)return t;for(var r=0,i=this._chunks;r<i.length;r++){var n=i[r];n.row=Math.max(n.row-1,1),""!==n.text&&(t=!0)}var o={row:this._cursorRow,indent:this._cursorIndent,text:""};return this._chunks.push(o),this._chunks.length>e&&this._chunks.splice(0,this._chunks.length-e),this._activeChunk=o,t},e.prototype.backspace=function(){var e=!1;return void 0!==this._activeChunk?this._activeChunk.text.length>0?(this._activeChunk.text=this._activeChunk.text.substring(0,this._activeChunk.text.length-1),e=!0):this._activeChunk.indent>0&&--this._activeChunk.indent:void 0!==this._cursorIndent&&this._cursorIndent>0&&--this._cursorIndent,e},e.prototype.erase=function(){var e=this.displayIsBlank();return this._chunks=[],this._activeChunk=void 0,this._cursorRow=void 0,this._cursorIndent=void 0,!e},e.prototype.displayIsBlank=function(){return this._608Util.isDisplayBlank({chunks:this._chunks})},e.prototype.getDisplay=function(){return{chunks:this._chunks}},e}()},36361:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmbeddedCaptionSourceBuffer=void 0;var i=r(47632),n=r(36899),o=r(1460),a=r(28521),s=r(2254),u=r(44639),c=function(){function e(){var e;this._embeddedCaptionDecoder=new o.Cta608Decoder,this._608Util=new n.Cta608Util,this._embeddedCaptionState=((e={}).CC1={prevDisplay:{chunks:[]},prevDisplayPts:0,decodedText:new s.SortedIntervalCollection,lastSetId:0},e.CC2={prevDisplay:{chunks:[]},prevDisplayPts:0,decodedText:new s.SortedIntervalCollection,lastSetId:0},e.CC3={prevDisplay:{chunks:[]},prevDisplayPts:0,decodedText:new s.SortedIntervalCollection,lastSetId:0},e.CC4={prevDisplay:{chunks:[]},prevDisplayPts:0,decodedText:new s.SortedIntervalCollection,lastSetId:0},e),this.onTextChange=new i.Emitter,this.onWarning=new i.Emitter}return e.prototype.append=function(e){if(void 0!==this._lastAppendedSegmentEndTime){var t=e.start-this._lastAppendedSegmentEndTime;Math.abs(t)>.05&&(this.onWarning.emit(new a.WarningError("Resetting embedded caption decoder due to discontinuity from ".concat(this._lastAppendedSegmentEndTime," to ").concat(e.start," (diff=").concat(t,")"))),this._resetEmbeddedCaptionDecoder())}this._lastAppendedSegmentEndTime=e.end;for(var r=0,i=e.captionFrames;r<i.length;r++)for(var n=i[r],o=0,s=n.bytePairs;o<s.length;o++){var u=s[o];this._embeddedCaptionDecoder.decode(u);for(var c=0,d=this._getAllCta608Services();c<d.length;c++){var l=d[c],h=this._embeddedCaptionState[l],p=this._embeddedCaptionDecoder.getDisplay(l);if(!this._608Util.isDisplayEqual(h.prevDisplay,p)){if(!this._608Util.isDisplayBlank(h.prevDisplay))for(var f=0,_=this._608Util.displayToCues(h.prevDisplay,h.prevDisplayPts,n.pts);f<_.length;f++){var v=_[f];h.decodedText.add(v,h.decodedText.length)}h.prevDisplay=this._608Util.cloneDisplay(p),h.prevDisplayPts=n.pts}}}for(var m=0,g=this._getAllCta608Services();m<g.length;m++){var l=g[m],h=this._embeddedCaptionState[l];this.onTextChange.emit({source:l,text:h.decodedText,id:h.lastSetId++})}},e.prototype._getAllCta608Services=function(){var e,t=((e={}).CC1=1,e.CC2=1,e.CC3=1,e.CC4=1,e);return(0,u.stringKeys)(t)},e.prototype.remove=function(e){for(var t=0,r=this._getAllCta608Services();t<r.length;t++){var i=r[t],n=this._embeddedCaptionState[i],o=n.decodedText.length;n.decodedText.removeIf(function(t){return t.end>e.start&&t.end<=e.end}),n.decodedText.length!==o&&this.onTextChange.emit({source:i,text:n.decodedText,id:n.lastSetId++})}},e.prototype._resetEmbeddedCaptionDecoder=function(){this._embeddedCaptionDecoder=new o.Cta608Decoder;for(var e=0,t=this._getAllCta608Services();e<t.length;e++){var r=t[e],i=this._embeddedCaptionState[r];i.prevDisplay={chunks:[]},i.prevDisplayPts=0}},e}();t.EmbeddedCaptionSourceBuffer=c},86508:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ItuTT35Parser=void 0;var i=r(23280),n=function(){function e(){}return e.prototype.extractCc=function(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),n=new i.DataViewReader(r,!1);if(n.readUInt8()===e.USA_COUNTRY_CODE&&n.readUInt16()===e.ATSC_PROVIDER_CODE&&n.readUInt32()===e.ATSC1_USER_IDENTIFIER&&n.readUInt8()===e.CC_USER_DATA_TYPE_CODE){var o=n.readUInt8();if((64&o)!=0){var a=31&o;n.skip(1);for(var s=[],u=0;u<a;++u){var c=n.readUInt8(),d=n.readUInt8(),l=n.readUInt8();(4&c)!=0&&s.push({ccType:3&c,ccData:[d,l]})}return s}}},e.PAYLOAD_TYPE=4,e.USA_COUNTRY_CODE=181,e.ATSC_PROVIDER_CODE=49,e.ATSC1_USER_IDENTIFIER=1195456820,e.CC_USER_DATA_TYPE_CODE=3,e}();t.ItuTT35Parser=n},11059:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NalUtils=void 0;var r=function(){function e(){}return e.prototype.stripEmulationPreventionBytes=function(e){for(var t=[],r=0;r<e.length;++r)r+2<e.length&&0===e[r]&&0===e[r+1]&&3===e[r+2]?(t.push(e[r]),t.push(e[r+1]),r+=2):t.push(e[r]);return new Uint8Array(t)},e}();t.NalUtils=r},90301:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SeiParser=void 0;var r=function(){function e(){}return e.prototype.parse=function(e,t){for(var r=[],i=0;i<e.length;){var n=this.parseVariableLengthField(e,i);if(void 0===n)break;var o=n.value;i=n.newIndex;var a=this.parseVariableLengthField(e,i);if(void 0===a)break;var s=a.value;if(i=a.newIndex,s<=0)break;o===t&&r.push(e.subarray(i,i+s)),i+=s}return r},e.prototype.parseVariableLengthField=function(e,t){for(var r=0;255===e[t];)r+=e[t++];if(!(t>=e.length))return{value:r+=e[t++],newIndex:t}},e.H264_NAL_UNIT_TYPE=6,e.H265_PREFIX_SEI_NUT=39,e.H265_SUFFIX_SEI_NUT=40,e.H265_PAYLOAD_TYPE_USER_DATA_UNREGISTERED=5,e.X265_USER_DATA_UNREGISTERED_UUID=[44,162,222,9,181,23,71,219,187,85,164,254,127,194,252,78],e}();t.SeiParser=r},61685:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClearkeyHandler=void 0;var i=r(22970),n=r(84672),o=r(28521),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype._processKeySession=function(e,t,r){var n,a;return i.__awaiter(this,void 0,void 0,function(){var s,u,c,d,l;return i.__generator(this,function(i){switch(i.label){case 0:return s=this._sessionHelper.waitForMessage(e),this._system.logVerbose("calling to generateRequest for clearkey"),[4,e.generateRequest(t.initDataType,r,t)];case 1:if(i.sent(),!this._sessionHelper.hasSession(e))return this.onWarning.emit(new o.WarningError("lost session while generating request")),[2];return this._system.logVerbose("waiting for license request from CDM"),[4,s];case 2:if(!1===(u=i.sent())||!this._sessionHelper.hasSession(e))return this.onWarning.emit(new o.WarningError("lost session preparing to wait for message")),[2];return c=u,this._system.logVerbose("making request for license"),null===(n=this._playerVitals)||void 0===n||n.add("LICENSE_REQUEST_STARTED"),[4,this._getUpdateData(e,c,t)];case 3:if(d=i.sent(),null===(a=this._playerVitals)||void 0===a||a.add("LICENSE_REQUEST_ENDED"),!this._sessionHelper.hasSession(e))return this.onWarning.emit(new o.WarningError("lost session while making license request")),[2];return l=this._sessionHelper.waitForKeyStatusChange(e),this._system.logVerbose("updating session with license"),[4,e.update(d,c.sessionId)];case 4:if(i.sent(),!this._sessionHelper.hasSession(e))return[2];return this._system.logVerbose("waiting for key status change"),[4,l];case 5:return i.sent(),[2]}})})},t}(n.CommonDrmHandler);t.ClearkeyHandler=a},84672:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommonDrmHandler=void 0;var i=r(22970),n=r(47632),o=r(77285),a=r(60064),s=r(57665),u=r(93342),c=r(28521),d=r(16754),l=r(94306),h=r(6246),p=r(70387),f=r(36760),_=r(34855),v=r(53282),m=function(){function e(e,t,r){this._sessionRefreshMap=new l.HashMap,this._sessionRefreshTimers=new l.HashMap,this._pendingSessions=new l.HashMap,this._appliedServerCerts=new h.HashSet,this.onDrmStatusChange=new n.Emitter,this.onError=new n.Emitter,this.onWarning=new n.Emitter,this._keySystem=t,this._keyFormat=r,this._network=new a.NetworkUtil(e),this._sessionHelper=new o.KeySessionHelper(e),this._system=e}return e.prototype.addKeyStatus=function(e,t){this._sessionHelper.addKeyStatus(e,t)},e.prototype.getStreamDrm=function(e){var t=this;return e.drmInfo.filter(function(e){return e.keySystem===t._keySystem&&e.keyFormat===t._keyFormat&&e.licenseServerUri})},e.prototype.configure=function(t,r){var i,n,o,a,s,u;if(this._options=t,this._mediaKeys=r,void 0!==t){var c=e.DEFAULT_TIMEOUT_MS;this._licenseRequestTimeoutMs=null!==(n=null===(i=t.licenseRequest)||void 0===i?void 0:i.timeoutMS)&&void 0!==n?n:c,this._licenseRequestRetryCount=null===(o=t.licenseRequest)||void 0===o?void 0:o.retryCount,this._certificateRequestTimeoutMs=null!==(s=null===(a=t.certificateRequest)||void 0===a?void 0:a.timeoutMS)&&void 0!==s?s:c,this._certificateRequestRetryCount=null===(u=t.certificateRequest)||void 0===u?void 0:u.retryCount}},e.prototype.register=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,n,o,a,s,u,c,d,l,p,f,_,v,m,g,y=this;return i.__generator(this,function(i){switch(i.label){case 0:if(void 0===this._mediaKeys)throw Error("DrmHandler not configured");if(0===e.segments.length||void 0===e.segments.getSegment(0).keyId)throw Error("Registering drm on a stream without encrypted segments");for(n=0,t=e.drmInfo.map(function(e){return e.serverCertificate}),r=[],o=t;n<o.length;n++)void 0===(a=o[n])||(s=a.toString(),this._appliedServerCerts.has(s)||(this._appliedServerCerts.add(s),r.push(this._applyServerCertificate(this._mediaKeys,a))));if(!(r.length>0))return[3,2];return[4,Promise.all(r)];case 1:i.sent(),i.label=2;case 2:for(this._sessionHelper.onError.off(this),this._sessionHelper.onError.on(this,function(e){return y.onError.emit(e)}),this._sessionHelper.onWarning.off(this),this._sessionHelper.onWarning.on(this,function(e){return y.onWarning.emit(e)}),this._sessionHelper.onDrmStatusChange.off(this),this._sessionHelper.onDrmStatusChange.on(this,function(){y.onDrmStatusChange.emit(y._sessionHelper.getDrmStatus())}),u=new h.HashSet,c=0,d=e.drmInfo;c<d.length;c++)l=d[c],u.add(l.keyId.toLowerCase());p=0,f=u.values(),i.label=3;case 3:if(!(p<f.length))return[3,6];if(void 0===(_=f[p])||this._pendingSessions.contains(_)||this._sessionHelper.hasKey(_))return[3,5];for(m=0,v=[],g=this.getStreamDrm(e);m<g.length;m++){if(!(l=g[m]).licenseServerUri)throw Error("DrmInfo incomplete, missing license server");v.push(this._registerNewKeySession(l))}return this._pendingSessions.set(_,Promise.all(v)),[4,this._pendingSessions.get(_)];case 4:i.sent(),this._pendingSessions.delete(_),i.label=5;case 5:return p++,[3,3];case 6:return[2]}})})},e.prototype.unregister=function(){return i.__awaiter(this,void 0,void 0,function(){var e=this;return i.__generator(this,function(t){switch(t.label){case 0:return this.onError.off(),this.onWarning.off(),this._sessionHelper.onError.off(this),this._sessionHelper.onWarning.off(this),this._sessionHelper.onDrmStatusChange.off(this),this._sessionRefreshTimers.forEach(function(t){e._stopTimer(t)}),this._sessionRefreshTimers.clear(),this._sessionRefreshMap.clear(),this._sessionHelper.forEachSession(function(t){t.onMessage.off(e)}),this._appliedServerCerts=new h.HashSet,[4,this._sessionHelper.close()];case 1:return t.sent(),[2]}})})},e.prototype.setPlayerVitals=function(e){this._playerVitals=e},e.prototype._registerNewKeySession=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,n;return i.__generator(this,function(i){switch(i.label){case 0:return[4,this._generateKeySession(e)];case 1:return t=i.sent(),[4,this._applyInitModifications(e.initData)];case 2:r=i.sent(),i.label=3;case 3:if(i.trys.push([3,8,,11]),!t.messagesFromAppending)return[3,5];return[4,this._listenForMessagesAppending(t,e,r)];case 4:return i.sent(),[3,7];case 5:return[4,this._processKeySession(t,e,r)];case 6:i.sent(),i.label=7;case 7:return this._tryStartExpiredKeyTimer(e,t),[3,11];case 8:if(n=i.sent(),!this._sessionHelper.hasSession(t))return[3,10];return[4,this._sessionHelper.closeSession(t)];case 9:throw i.sent(),n;case 10:return this.onWarning.emit(new c.WarningError("ignoring error for session ".concat(t.sessionId),s.WrappedError.wrap(n))),[3,11];case 11:return[2]}})})},e.prototype._listenForMessagesAppending=function(e,t,r){return i.__awaiter(this,void 0,void 0,function(){var n=this;return i.__generator(this,function(o){switch(o.label){case 0:return e.onMessage.on(this,function(r){_.PromiseUtil.catchRejection(function(){return i.__awaiter(n,void 0,void 0,function(){var n,o;return i.__generator(this,function(i){switch(i.label){case 0:return[4,this._getUpdateData(e,r,t)];case 1:n=i.sent(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,e.update(n,r.sessionId)];case 3:return i.sent(),[3,5];case 4:return o=i.sent(),this.onWarning.emit(new c.WarningError("error updating license",s.WrappedError.wrap(o))),[3,5];case 5:return[2]}})})},function(e){e instanceof s.WrappedError&&s.WrappedError.causedBy(e,u.NonFatalError.NAME)?n.onWarning.emit(new c.WarningError("Message empty while updating license",e)):n.onError.emit(s.WrappedError.wrap(e))})}),[4,e.generateRequest(t.initDataType,r,t)];case 1:return o.sent(),[2]}})})},e.prototype._generateKeySession=function(e){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(r){switch(r.label){case 0:if(void 0===this._mediaKeys)throw Error("DrmHandler not configured");return[4,this._mediaKeys.createSession(this._getSessionType(e))];case 1:return t=r.sent(),this._sessionHelper.addSession(t),[2,t]}})})},e.prototype._stopTimer=function(e){var t=this._sessionRefreshTimers.tryGet(e);void 0!==t&&(t.stop(),t.onError.off(this),this._sessionRefreshTimers.delete(e))},e.prototype._tryStartExpiredKeyTimer=function(t,r){var n,o,a=this;this._stopTimer(r.sessionId);var u=null!==(n=this._sessionRefreshMap.tryGet(r.sessionId))&&void 0!==n?n:0;if(this._sessionRefreshMap.set(r.sessionId,u+1),this._sessionHelper.hasSession(r)&&(null!==(o=this._sessionRefreshMap.tryGet(r.sessionId))&&void 0!==o?o:0)<e.MAX_REFRESH_COUNT){var c=r.expiration,d=Date.now();if(void 0!==c&&c>d&&c-d<=e.DRM_REFRESH_MAXIMUM){var l=d-e.DRM_REFRESH_OFFSET,h=new v.Timer(this._system,function(){return i.__awaiter(a,void 0,void 0,function(){var e;return i.__generator(this,function(i){switch(i.label){case 0:this._system.logInfo("Media Key Session has expired, attempting to regenerate key session with info: ",r),r.onMessage.off(this),i.label=1;case 1:return i.trys.push([1,4,5,6]),[4,this._sessionHelper.closeSession(r)];case 2:return i.sent(),[4,this._registerNewKeySession(t)];case 3:return i.sent(),[3,6];case 4:return e=i.sent(),this.onError.emit(s.WrappedError.wrap(e)),[3,6];case 5:return this._stopTimer(r.sessionId),[7];case 6:return[2]}})})});h.onError.on(this,function(e){return a.onError.emit(e)}),this._sessionRefreshTimers.set(r.sessionId,h),h.tickAfter(l>c?(c-l)/1e3:(c-d)/1e3)}}},e.prototype._getSessionType=function(e){return"required"===e.persistentState?"persistent-license":"temporary"},e.prototype._applyServerCertificate=function(e,t){var r,n;return i.__awaiter(this,void 0,void 0,function(){var o,a,s;return i.__generator(this,function(i){switch(i.label){case 0:if(!(t instanceof d.Uri))return[3,2];return a=this._network.makeNetworkClient({resource:t.toString(),method:"GET",type:"other",timeoutMS:this._certificateRequestTimeoutMs,retryCount:this._certificateRequestRetryCount}),null===(r=this._playerVitals)||void 0===r||r.add("CERTIFICATE_REQUEST_STARTED"),[4,a.payloadBuffer()];case 1:if(s=i.sent(),null===(n=this._playerVitals)||void 0===n||n.add("CERTIFICATE_REQUEST_ENDED"),!p.NetworkHelpers.isSuccessfulResponseCode(s.status))throw new f.LicenseRequestError("failed to download certificate ".concat(s.status));return o=new Uint8Array(s.data),[3,3];case 2:o=t,i.label=3;case 3:return[4,e.setServerCertificate(o)];case 4:return i.sent(),[2]}})})},e.prototype._applyInitModifications=function(e){var t;return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(r){switch(r.label){case 0:if(!((null===(t=this._options)||void 0===t?void 0:t.modifyInitData)!==void 0))return[3,2];return[4,this._options.modifyInitData(e,this)];case 1:e=r.sent(),r.label=2;case 2:return[2,e]}})})},e.prototype._getUpdateData=function(e,t,r){return i.__awaiter(this,void 0,void 0,function(){var n,o,a,s;return i.__generator(this,function(i){switch(i.label){case 0:if(void 0===r.licenseServerUri)throw Error("No license server found for drm info");return o=(n=this._network).makeNetworkClient,s={},[4,r.licenseServerUri()];case 1:return[4,o.apply(n,[(s.resource=i.sent(),s.method="POST",s.headers={},s.body=new Uint8Array(t.message),s.type="license",s.timeoutMS=this._licenseRequestTimeoutMs,s.retryCount=this._licenseRequestRetryCount,s)]).payloadBuffer()];case 2:if(a=i.sent(),p.NetworkHelpers.isSuccessfulResponseCode(a.status))return[3,4];return[4,e.close()];case 3:throw i.sent(),new f.LicenseRequestError("Did not get a valid response from license server '".concat(a.status,"'"));case 4:return[2,a.data]}})})},e.DRM_REFRESH_OFFSET=6e4,e.DRM_REFRESH_MAXIMUM=2147483647,e.MAX_REFRESH_COUNT=2,e.DEFAULT_TIMEOUT_MS=1e3*o.KeySessionHelper.TIMEOUT_SECONDS,e}();t.CommonDrmHandler=m},2913:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommonEncryptionUtil=void 0;var i=r(67280),n=r(27468),o=r(7253),a=r(69964),s=r(17590),u=r(94306),c=r(89773),d=r(37454),l=r(87437),h=r(42586),p=function(){function e(){this._arrayUtil=new a.ArrayUtil,this._stringUtil=new s.StringUtil}return e.prototype.isPlayReadySystemId=function(t){return this._arrayUtil.areEqual(e.PLAYREADY_SYSTEM_ID,t)},e.prototype.isWidevineSystemId=function(t){return this._arrayUtil.areEqual(e.WIDEVINE_SYSTEM_ID,t)},e.prototype._getPlayreadyPssh=function(t){var r=this.getSingleKeyPlayreadyPSSHData(t),i=32+r.length,n=new Uint8Array(new ArrayBuffer(i)),o=new DataView(n.buffer);return o.setUint32(0,i),n.set([112,115,115,104,0],4),n.set(e.PLAYREADY_SYSTEM_ID,12),o.setUint32(28,r.length),n.set(r,32),n},e.prototype._getWidevinePssh=function(t){var r=new Uint8Array(new ArrayBuffer(50)),i=new DataView(r.buffer);return i.setUint32(0,50),r.set([112,115,115,104,0],4),r.set(e.WIDEVINE_SYSTEM_ID,12),i.setUint32(28,18),r.set(e.WIDEVINE_V0_SEPARATOR,32),r.set(t,34),r},e.prototype.getKeyFormat=function(e){var t=e.subarray(12,28);return this.isPlayReadySystemId(t)?"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":this.isWidevineSystemId(t)?"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":void 0},e.prototype.getVersion=function(e){return e[8]},e.prototype.getKeysFromInitData=function(e){var t=1===this.getVersion(e),r=this.getKeyFormat(e);if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===r||t){if(!t)return this._parseWidevinePsshProtoBuf(e.subarray(32)).keys;for(var i=[],n=new DataView(e.buffer).getUint32(28),o=0;o<n;o++){var a=32+16*o;i.push(e.slice(a,a+16))}return i}if("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95"===r)return this.getKeysFromPlayreadyHeader(e);throw Error("unsupported key format "+r+" "+t)},e.prototype._parseWidevinePsshProtoBuf=function(e){var t=0,r={startByte:0,endByte:0};8===e[0]&&(r.endByte=2,t+=2);for(var i=[];t+2+16<=e.length&&18===e[t]&&16===e[t+1];)i.push(e.slice(t+2,t+2+16)),t+=18;var n={startByte:t,endByte:e.length};return{keys:i,prefix:e.subarray(r.startByte,r.endByte),suffix:e.subarray(n.startByte,n.endByte)}},e.prototype.fromEncodedPlayreadyKeyId=function(e){var t=new DataView(this._stringUtil.fromHexString(e).buffer),r=t.getUint32(0,!0),i=t.getUint16(4,!0),n=t.getUint16(6,!0);return t.setUint32(0,r,!1),t.setUint16(4,i,!1),t.setUint16(6,n,!1),this._stringUtil.toHex(new Uint8Array(t.buffer))},e.prototype.toEncodedPlayreadyKeyId=function(e){var t=new DataView(e.buffer),r=new ArrayBuffer(16),i=new DataView(r);i.setUint32(0,t.getUint32(0),!0),i.setUint16(4,t.getUint16(4),!0),i.setUint16(6,t.getUint16(6),!0),i.setUint32(8,t.getUint32(8),!1),i.setUint32(12,t.getUint32(12),!1);var n=this._stringUtil.fromCharCode(new Uint8Array(r));return this._stringUtil.toStandardBase64(n)},e.prototype.getPlayreadyPSSHData=function(e){switch(e.length){case 0:throw Error("Unsupported zero key PSSH");case 1:return this.getSingleKeyPlayreadyPSSHData(e[0]);default:return this.getMultiKeyPlayreadyPSSHData(e)}},e.prototype.getMultiKeyPlayreadyPSSHData=function(e){for(var t='<WRMHEADER xmlns="http://schemas.microsoft.com/DRM/2007/03/PlayReadyHeader" version="4.2.0.0"><DATA><PROTECTINFO><KIDS>',r=0;r<e.length;r++){var i=e[r];t+='<KID ALGID="AESCTR" VALUE="'.concat(this.toEncodedPlayreadyKeyId(i),'"></KID>')}return t+="</KIDS></PROTECTINFO></DATA></WRMHEADER>",this._getPlayreadyPSSHFromXml(t)},e.prototype.getSingleKeyPlayreadyPSSHData=function(e){var t='<WRMHEADER xmlns="http://schemas.microsoft.com/DRM/2007/03/PlayReadyHeader" version="4.0.0.0"><DATA><PROTECTINFO><ALGID>AESCTR</ALGID><KEYLEN>16</KEYLEN></PROTECTINFO>';return t+="<KID>".concat(this.toEncodedPlayreadyKeyId(e),"</KID>")+"<LA_URL>http://jSam</LA_URL></DATA></WRMHEADER>",this._getPlayreadyPSSHFromXml(t)},e.prototype.rewriteInitDataKeys=function(t,r,i){void 0===i&&(i=1===this.getVersion(t)),n=28;var n,o=this.getKeyFormat(t);i&&(n+=4+16*r.length),n+=4;var a=new Uint8Array(0),s=new Uint8Array(0);if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===o){var u=new DataView(t.buffer),c=28;if(i){var d=u.getUint32(c);c+=4+16*d}if(c<t.length){var l=u.getUint32(c),h=c+4,p=t.subarray(h,h+l),f=this._parseWidevinePsshProtoBuf(p),_=f.prefix,v=f.suffix;n+=_.length+v.length+18*r.length,a=_,s=v}}else if("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95"===o)n+=this.getPlayreadyPSSHData(r).length;else throw Error("unsupported key format "+o);var m=new Uint8Array(n),g=new DataView(m.buffer);g.setUint32(0,n),m.set(t.slice(4,31),4);var y=28;if(i){g.setUint32(y,r.length),y+=4;for(var S=0;S<r.length;S++){var E=r[S];m.set(E,y),y+=16}}if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===o){g.setUint32(y,a.length+s.length+18*r.length),y+=4,m.set(a,y),y+=a.length;for(var b=0;b<r.length;b++){var E=r[b];m.set(e.WIDEVINE_V0_SEPARATOR,y),y+=2,m.set(E,y),y+=E.length}m.set(s,y)}else if("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95"===o){var w=this.getPlayreadyPSSHData(r);g.setUint32(y,w.length),y+=4,m.set(w,y)}return m},e.prototype.getKeysFromPlayreadyHeader=function(e){var t=new DataView(e.buffer);if(1!==t.getUint16(36,!0))throw Error("unsupported playready object record type");if(1!==t.getUint16(38,!0))throw Error("unsupported playready object count");var r=this._stringUtil.fromUTF16(e.slice(42,42+t.getUint16(40,!0)).buffer,!0),i=r.indexOf("<KID>");if(-1===i)throw Error("unsupported playready header, missing KID");var n=r.indexOf("</KID>",i),o=r.substring(i+5,n),a=this._stringUtil.toCharCode(this._stringUtil.fromStandardBase64(o));return[this._stringUtil.fromHexString(this.fromEncodedPlayreadyKeyId(this._stringUtil.toHex(a)))]},e.prototype._getPlayreadyPSSHFromXml=function(e){var t=10+2*e.length,r=new Uint8Array(new ArrayBuffer(t)),i=new DataView(r.buffer);return i.setUint32(0,t,!0),i.setUint16(4,1,!0),i.setUint16(6,1,!0),i.setUint16(8,2*e.length,!0),r.set(new Uint8Array(this._stringUtil.toUTF16(e,!0)),10),r},e.prototype.injectKid=function(t,r){var a=new Uint8Array(t),s=new n.Mp4Parser;s.setParsers(e.getParsersForTenc());var u=s.parse(a),c=new o.Mp4Walker(u).jumpTo("tenc",!0);if(void 0===c||c.default_KID.some(function(e){return 0!==e}))return a;var d=this._stringUtil.fromHexString(r);if(d.length!==i.TrackEncryptionBoxParser.DEFAULT_KID_LENGTH)return a;for(var l=c.rangeContentBody.start+i.TrackEncryptionBoxParser.DEFAULT_KID_OFFSET,h=0;h<i.TrackEncryptionBoxParser.DEFAULT_KID_LENGTH;++h)a[h+l]=d[h];return a},e.prototype.addPssh=function(t){var r=e.getParsersForTenc();r.set("pssh",c.ContainerParser.getBasicBoxParser());var i=new n.Mp4Parser;i.setParsers(r);var a=i.parse(t),s=new o.Mp4Walker(a),u=s.jumpTo("moov"),d=s.jumpTo("tenc"),l=s.jumpTo("pssh");if(void 0===d||void 0===u||void 0!==l)return t;var h=this._getPlayreadyPssh(d.default_KID),p=this._getWidevinePssh(d.default_KID),f=new Uint8Array(new ArrayBuffer(t.length+p.length+h.length));f.set(t,0),f.set(h,t.length),f.set(p,t.length+h.length);var _=new DataView(f.buffer);return _.setUint32(u.rangeBox.start,_.getUint32(u.rangeBox.start)+p.length+h.length),f},e.getParsersForTenc=function(){return new u.HashMap([["moov",c.ContainerParser.getBasicBoxParser()],["trak",c.ContainerParser.getBasicBoxParser()],["mdia",c.ContainerParser.getBasicBoxParser()],["minf",c.ContainerParser.getBasicBoxParser()],["stbl",c.ContainerParser.getBasicBoxParser()],["stsd",c.ContainerParser.getFullEntriesBoxParser()],["enca",l.EncryptedAudioBoxParser.getParser()],["encv",h.EncryptedVideoBoxParser.getParser()],["sinf",d.SinfBoxParser.getParser()],["schi",c.ContainerParser.getBasicBoxParser()],["tenc",i.TrackEncryptionBoxParser.getParser()]])},e.WIDEVINE_V0_SEPARATOR=[18,16],e.WIDEVINE_SYSTEM_ID=[237,239,139,169,121,214,74,206,163,200,39,220,213,29,33,237],e.PLAYREADY_SYSTEM_ID=[154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149],e}();t.CommonEncryptionUtil=p},78082:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DigitalRightsManagement=void 0;var i=r(22970),n=r(82971),o=r(54965),a=r(88309),s=r(47632),u=r(67179),c=r(84639),d=r(54459),l=r(57665),h=r(28521),p=r(94306),f=r(6246),_=r(69964),v=r(24533),m=function(){function e(e){var t=this;this._destroyed=!1,this.onUpdated=new s.Emitter,this.onSingleKeyRestriction=new s.Emitter,this.onError=new s.Emitter,this.onWarning=new s.Emitter,this.options={},this.supportedMediaKeys=[],this._codecUtil=new u.CodecUtil,this._arrayUtil=new _.ArrayUtil,this._statusMap=new p.HashMap,this._pendingStreams=new a.Set,this._singleKeyRestrictions=new o.Map,this._requireSingleKey=!1,this._systemInterface=e,this._worker=new v.SequentialTaskRunner(this._systemInterface),this._worker.onError.on(this,function(e){return t.onError.emit(new c.DigitalRightsError(e))}),this._handlerFactory=new n.DrmHandlerFactory,this._keyTypesWithRestrictions=e.getKeyTypesWhichMayBeRestricted(),this._requireSingleKey=e.requireSingleKey()}return e.prototype.destroy=function(){var e;return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:if(this._destroyed=!0,this._worker.onError.off(this),this._worker.destroy(),this.onError.off(),this.onWarning.off(),this.onUpdated.off(),this.onSingleKeyRestriction.off(),!(void 0!==this._drmHandler))return[3,2];return this._drmHandler.onDrmStatusChange.off(this),this._drmHandler.onError.off(this),this._drmHandler.onWarning.off(this),[4,this._drmHandler.unregister()];case 1:t.sent(),t.label=2;case 2:return this._pendingStreams=new a.Set,[4,this._chosenMediaKeyPromise];case 3:return t.sent(),(null===(e=this._chosenMediaKeys)||void 0===e?void 0:e.mediaKeys)!==void 0&&(this._chosenMediaKeys.mediaKeys.onError.off(this),this._chosenMediaKeys.mediaKeys.onWarning.off(this)),this._chosenMediaKeys=void 0,this._chosenMediaKeyPromise=void 0,this._drmHandler=void 0,this._statusMap.clear(),this._singleKeyRestrictions.clear(),[2]}})})},e.prototype.setPlayerVitals=function(e){this._playerVitals=e},e.prototype.chooseMediaKeyOption=function(e){return i.__awaiter(this,void 0,void 0,function(){var t=this;return i.__generator(this,function(r){return void 0===this._chosenMediaKeyPromise&&(this._chosenMediaKeys=void 0,this._chosenMediaKeyPromise=this._chooseMediaKey(e).then(function(e){return t._chosenMediaKeys=e,t._chosenMediaKeys})),[2,this._chosenMediaKeyPromise]})})},e.prototype.getChosenMediaKeyOptions=function(){var e;return null===(e=this._chosenMediaKeys)||void 0===e?void 0:e.chosenOption},e.prototype.getMediaKeys=function(){var e;return null===(e=this._chosenMediaKeys)||void 0===e?void 0:e.mediaKeys},e.prototype.getStatusMap=function(){return this._statusMap},e.prototype._chooseMediaKey=function(e){var t,r,n,o,a,s;return i.__awaiter(this,void 0,void 0,function(){var u,c,d,l,p,f,_,v,m,g,y,S,E,b,w=this;return i.__generator(this,function(P){switch(P.label){case 0:for(d=0,l=e;d<l.length;d++)f=null!==(r=null===(t=(p=l[d]).videoDetails)||void 0===t?void 0:t.drmInfo)&&void 0!==r?r:[],_=null!==(o=null===(n=p.audioDetails)||void 0===n?void 0:n.drmInfo)&&void 0!==o?o:[],(null!==(s=null===(a=p.textDetails)||void 0===a?void 0:a.drmInfo)&&void 0!==s?s:[]).length>0&&this.onWarning.emit(new h.WarningError("DRM not supported on text streams")),v=_.length>0,m=f.length>0,void 0!==p.audioDetails&&void 0!==p.videoDetails&&(v||m)&&(g=v?this._codecUtil.getAudioGroup(this._getMimeCodec(p.audioDetails)):void 0,y=m?this._codecUtil.getVideoGroup(this._getMimeCodec(p.videoDetails)):void 0,void 0===(S=this._getMediaKeyOption(i.__spreadArray(i.__spreadArray([],_,!0),f,!0),g,y))?this.onWarning.emit(new h.WarningError("Could not find a media key option for drm protected variant")):void 0===c?(c=S,E=this._getMediaKeyOptionString(S),this._systemInterface.logInfo("Choosing media key options ".concat(E))):c!==S&&(b=this._getMediaKeyOptionString(c),E=this._getMediaKeyOptionString(S),this.onWarning.emit(new h.WarningError("Found more than one media key options with current ".concat(b," and alternate ").concat(E)))));if(!(void 0!==c))return[3,3];return this._systemInterface.logInfo("creating MediaKeys with ".concat(this._getMediaKeyOptionString(c))),[4,this._systemInterface.makeMediaKeySystemAccess(c)];case 1:return[4,P.sent().createMediaKeys()];case 2:(u=P.sent()).onError.on(this,function(e){return w.onError.emit(e)}),u.onWarning.on(this,function(e){return w.onWarning.emit(e)}),P.label=3;case 3:return[2,{mediaKeys:u,chosenOption:c}]}})})},e.prototype._getMediaKeyOption=function(e,t,r){for(var i=0,n=this.supportedMediaKeys;i<n.length;i++){var o=n[i];if((void 0===t||o.audio===t)&&(void 0===r||o.video===r))for(var a=0;a<e.length;a++){var s=e[a];if(s.scheme===o.encryptionScheme&&s.keySystem===o.keySystem&&void 0!==s.licenseServerUri&&this._hasAllowedPersistence(o,s))return o}}},e.prototype._hasMediaKeyOption=function(e,t){for(var r={reason:1,drm:[]},i=this._codecUtil.getCodecGroup(this._getMimeCodec(e)),n=0,o=this.supportedMediaKeys;n<o.length;n++){var a=o[n];if(this._hasMatchingOption(a,e.type,i))for(var s=0;s<t.length;s++){var u=t[s];if(u.scheme!==a.encryptionScheme)this._updateRejectedData(r,2,u);else if(u.keySystem!==a.keySystem)this._updateRejectedData(r,3,u);else if(void 0===u.licenseServerUri)this._updateRejectedData(r,4,u);else{if(this._hasAllowedPersistence(a,u))return!0;this._updateRejectedData(r,5,u)}}}return r},e.prototype._isTypeSupportedByDRM=function(e,t){if(0===this.supportedMediaKeys.length)return{reason:0,drm:[]};for(var r=this._codecUtil.getCodecGroup(t),i=0,n=this.supportedMediaKeys;i<n.length;i++){var o=n[i];if(this._hasMatchingOption(o,e,r))return!0}return{reason:1,drm:[]}},e.prototype._hasMatchingOption=function(e,t,r){var i="audio"===t&&e.audio===r,n="video"===t&&e.video===r;return i||n},e.prototype._getMimeCodec=function(e){return{mimeType:e.mimeType,codecs:e.codecs,attributes:0}},e.prototype._isCompatibleByDRM=function(e,t){return e.scheme===t.encryptionScheme&&e.keySystem===t.keySystem},e.prototype._isStreamAllowedByDRM=function(e,t){var r,i,n=this;if(this._isUnencrypted(t))return!0;var o=this._getMimeCodec(t),a=this._isTypeSupportedByDRM(t.type,o);if(!0!==a)return a;var s=t.getCachedDetails(),u=null!==(r=null==s?void 0:s.drmInfo)&&void 0!==r?r:t.drmInfo;if(void 0===u)return!0;if(this._requireSingleKey){var c=this._singleKeyRestrictions.tryGet(e),d=null==c?void 0:c.tryGet(t.type);if(void 0!==d){var l=this._arrayUtil.find(u,function(e){return e.keyId!==d});if(void 0!==l)return{reason:6,drm:[l]}}}if((null===(i=this._chosenMediaKeys)||void 0===i?void 0:i.chosenOption)===void 0)return 0===u.length||this._hasMediaKeyOption(t,u);var h=this._chosenMediaKeys.chosenOption,p=this._codecUtil.getCodecGroup(o);if(!(this._codecUtil.isCodecGroupCompatible(p,h.audio)||this._codecUtil.isCodecGroupCompatible(p,h.video)))return{reason:1,drm:[]};var f=u.filter(function(e){return n._isCompatibleByDRM(e,h)});return!this.isRestricted(f.map(function(e){return e.keyId}))||{reason:7,drm:f}},e.prototype._isUnencrypted=function(e){var t;return void 0!==e.drmInfo&&0===e.drmInfo.length||(null===(t=e.getCachedDetails())||void 0===t?void 0:t.drmInfo.length)===0},e.prototype.filterVariants=function(e,t){for(var r={accepted:{audio:[],video:[],text:t.text},rejected:new o.Map},i=0,n=[[t.audio,r.accepted.audio],[t.video,r.accepted.video]];i<n.length;i++)for(var a=n[i],s=a[0],u=a[1],c=0;c<s.length;c++){var d=s[c],l=this._isStreamAllowedByDRM(e,d);!0===l?u.push(d):r.rejected.set(d,l)}return r},e.prototype._mayBeRestricted=function(e){var t;if(void 0===this._systemInterface.keyTypeResolver||(null===(t=this._chosenMediaKeys)||void 0===t?void 0:t.chosenOption)!==void 0&&"com.widevine.alpha"!==this._chosenMediaKeys.chosenOption.keySystem)return!1;for(var r=0;r<e.length;r++){var i=e[r],n=this._systemInterface.keyTypeResolver(i);if(this._keyTypesWithRestrictions.has(n))return!0}return!1},e.prototype.isRestricted=function(e){var t=this;return 0!==e.length&&(void 0===this._drmHandler?this._mayBeRestricted(e):this._hasKeyWithoutMatchingStatus(e,function(e,r){return void 0===e||"status-pending"===e?!t._mayBeRestricted([r]):"usable"===e}))},e.prototype.isUsable=function(e){return 0===e.length||void 0!==this._drmHandler&&!this._hasKeyWithoutMatchingStatus(e,function(e){return"usable"===e})},e.prototype.prepare=function(e,t){if(this._requireSingleKey&&0!==t.drmInfo.length){for(var r,i=this._singleKeyRestrictions.tryGet(e),n=null==i?void 0:i.tryGet(t.type),o=0,a=t.drmInfo;o<a.length;o++){var s=a[o].keyId;if(void 0!==n&&n!==s)throw Error("Applying stream drmInfo with keyId='".concat(s,"' with existing single key lock keyId='").concat(n,"'"));void 0===n&&(n=s,this._singleKeyRestrictions.set(e,null!=i?i:new p.HashMap),this._singleKeyRestrictions.get(e).set(t.type,n),(r=null!=r?r:[]).push({period:e,key:s}))}void 0!==r&&this.onSingleKeyRestriction.emit(r)}},e.prototype.apply=function(e){if(!this._pendingStreams.has(e)&&this._shouldApply(e))return this._runApplyStream(e)},e.prototype._runApplyStream=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r=this;return i.__generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,3,4]),this._pendingStreams.add(e),[4,this._worker.runWithoutReturn({type:"ApplyStream"},function(){return r._applyStream(e)})];case 1:return i.sent(),[3,4];case 2:throw t=i.sent(),new c.DigitalRightsError(l.WrappedError.wrap(t));case 3:return this._pendingStreams.delete(e),[7];case 4:return[2]}})})},e.prototype._hasKeyWithoutMatchingStatus=function(e,t){for(var r,i=0;i<e.length;i++){var n=e[i];if(!t(null===(r=this._statusMap.tryGet(n.toLowerCase()))||void 0===r?void 0:r.status,n))return!0}return!1},e.prototype._shouldApply=function(e){if(this._destroyed)return!1;if(void 0===this._drmHandler)return!0;for(var t=this._drmHandler.getStreamDrm(e).map(function(e){return e.keyId}),r=0;r<t.length;r++){var i=t[r];if(!this._statusMap.contains(i))return!0}return!1},e.prototype._applyStream=function(e){var t;return i.__awaiter(this,void 0,void 0,function(){var r,n,o,a,s=this;return i.__generator(this,function(i){switch(i.label){case 0:if(0===e.drmInfo.length)return[2];if(n=(r=null!==(t=this._chosenMediaKeys)&&void 0!==t?t:{}).chosenOption,o=r.mediaKeys,void 0===n)throw Error("Unable to fulfill DRM requirements given system support");if(void 0===o)throw Error("Unexpected missing media keys");if(a=this._codecUtil.getCodecGroup(this._getMimeCodec(e)),"audio"===e.type&&!this._codecUtil.isCodecGroupCompatible(n.audio,a))throw new d.FormatChangedError(n.audio,a);if("video"===e.type&&!this._codecUtil.isCodecGroupCompatible(n.video,a))throw new d.FormatChangedError(n.video,a);if(void 0===this._drmHandler&&(this._drmHandler=this._handlerFactory.create(this._systemInterface,n.keySystem),this._drmHandler.onDrmStatusChange.on(this,function(e){return s._onDrmStatusChange(e)}),this._drmHandler.onError.on(this,function(e){return s.onError.emit(new c.DigitalRightsError(e))}),this._drmHandler.onWarning.on(this,function(e){return s.onWarning.emit(e)})),this._drmHandler.configure(this.options,o),!this._shouldApply(e))return[3,2];return[4,this._drmHandler.register(e)];case 1:i.sent(),i.label=2;case 2:return[2]}})})},e.prototype._hasAllowedPersistence=function(e,t){return"optional"===e.persistentState||"not-allowed"!==t.persistentState&&"required"!==t.persistentState||e.persistentState===t.persistentState},e.prototype._getMediaKeyOptionString=function(e){return"".concat(e.encryptionScheme,", ").concat(e.keySystem,", ").concat(e.audio,", and ").concat(e.video)},e.prototype._onDrmStatusChange=function(e){for(var t,r=0,i=e.values();r<i.length;r++){var n=i[r];this._systemInterface.logInfo("".concat(n.sessionId,":").concat(n.keyId," has status '").concat(n.status,"'"))}null===(t=this._playerVitals)||void 0===t||t.add({name:"DRM_KEY_STATUS_CHANGED",value:e}),this._statusMap=e,this.onUpdated.emit()},e.prototype._updateRejectedData=function(e,t,r){t>e.reason&&(e.reason=t,e.drm=[]),e.reason===t&&e.drm.push(r)},e.prototype.aggregateRejectedData=function(e){var t=this,r=new p.HashMap;e.forEach(function(e,i){var n;switch(i.reason){case 0:n="no key systems found on platform";break;case 1:n="codec not supported by platform: ".concat(t._codecUtil.getCodecGroup(t._getMimeCodec(e)));break;case 2:n="encryption scheme not supported by platform: ".concat(new f.HashSet(i.drm.map(function(e){return e.scheme})).values().sort().join(", "));break;case 3:n="key system not supported by platform: ".concat(new f.HashSet(i.drm.map(function(e){return e.keySystem})).values().sort().join(", "));break;case 4:n="supported key system not requested: ".concat(new f.HashSet(i.drm.map(function(e){return e.keySystem})).values().sort().join(", "));break;case 5:n="persistent state not allowed: ".concat(new f.HashSet(i.drm.map(function(e){return"".concat(e.persistentState)})).values().sort().join(", "));break;case 6:n="unique keys='[".concat(t._getUniqueKeysString(),"]', found key not allowed: ").concat(new f.HashSet(i.drm.map(function(e){return"".concat(e.keyId)})).values().sort().join(", "));break;case 7:n="all keys are restricted"}r.contains(n)||r.set(n,[]),r.get(n).push(e)});var i=[];return r.forEach(function(e,t){i.push("filtered streams ".concat(t.map(function(e){return e.id}).join(", "),": ").concat(e))}),i},e.prototype._getUniqueKeysString=function(){var e=new f.HashSet;return this._singleKeyRestrictions.forEach(function(t,r){r.forEach(function(t,r){e.add(r)})}),e.values().join(", ")},e}();t.DigitalRightsManagement=m},82971:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DrmHandlerFactory=void 0;var i=r(61685),n=r(44378),o=r(28928),a=r(39139),s=function(){function e(){}return e.prototype.create=function(e,t){switch(t){case"com.apple.fps.2_0":return new n.FairPlayHandler(e,t,"com.apple.streamingkeydelivery");case"com.widevine.alpha":return new a.WidevineHandler(e,t,"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed");case"org.w3.clearkey":return new i.ClearkeyHandler(e,t,"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b");case"com.microsoft.playready":case"com.microsoft.playready.recommendation":return new o.PlayReadyHandler(e,t,"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95");default:throw Error("Key system is not supported")}},e}();t.DrmHandlerFactory=s},44378:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FairPlayHandler=void 0;var i=r(22970),n=r(17590),o=r(84672),a=r(70387),s=r(36760),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._stringUtil=new n.StringUtil,t}return i.__extends(t,e),t.prototype.getStreamDrm=function(t){return e.prototype.getStreamDrm.call(this,t).filter(function(e){return void 0!==e.serverCertificate})},t.prototype._processKeySession=function(e,t,r){return i.__awaiter(this,void 0,void 0,function(){var n,o,a,s;return i.__generator(this,function(i){switch(i.label){case 0:return n=this._sessionHelper.waitForMessage(e),[4,e.generateRequest(t.initDataType,r,t)];case 1:if(i.sent(),!this._sessionHelper.hasSession(e))return[2];return[4,n];case 2:if(!1===(o=i.sent())||!this._sessionHelper.hasSession(e))return[2];return[4,this._getUpdateData(e,o,t)];case 3:if(a=i.sent(),!this._sessionHelper.hasSession(e))return[2];return s=this._sessionHelper.waitForKeyStatusChange(e),[4,e.update(a)];case 4:if(i.sent(),!this._sessionHelper.hasSession(e))return[2];return[4,s];case 5:return i.sent(),[2]}})})},t.prototype._getUpdateData=function(e,t,r){var n,o,u,c;return i.__awaiter(this,void 0,void 0,function(){var d,l,h,p,f,_,v,m;return i.__generator(this,function(i){switch(i.label){case 0:if(void 0===r.licenseServerUri)throw Error("Invalid drmInfo for FairPlay, missing license uri");return d=this._stringUtil.toStandardBase64(this._stringUtil.fromCharCode(new Uint8Array(t.message))),l={"Content-Type":"application/json"},f=(p=this._network).makeNetworkClient,m={},[4,r.licenseServerUri()];case 1:return h=f.apply(p,[(m.resource=i.sent(),m.method="POST",m.headers=l,m.body=this._stringUtil.toUTF8(JSON.stringify({assetId:r.keyId,spc:d})),m.type="license",m.timeoutMS=this._licenseRequestTimeoutMs,m.retryCount=null===(o=null===(n=this._options)||void 0===n?void 0:n.licenseRequest)||void 0===o?void 0:o.retryCount,m)]),null===(u=this._playerVitals)||void 0===u||u.add("LICENSE_REQUEST_STARTED"),[4,h.payloadString()];case 2:if(_=i.sent(),null===(c=this._playerVitals)||void 0===c||c.add("LICENSE_REQUEST_ENDED"),a.NetworkHelpers.isSuccessfulResponseCode(_.status))return[3,4];return[4,e.close()];case 3:throw i.sent(),new s.LicenseRequestError("Did not receive a valid license response from server '".concat(_.status,"'"));case 4:if(v=JSON.parse(_.data),!this._responseIsValid(v))throw new s.LicenseRequestError("License response is not expected format: ".concat(_.data));return[2,this._stringUtil.toCharCode(this._stringUtil.fromStandardBase64(v.ckc)).buffer]}})})},t.prototype._responseIsValid=function(e){return"object"==typeof e&&null!==e&&"ckc"in e&&"string"==typeof e.ckc},t}(o.CommonDrmHandler);t.FairPlayHandler=u},77285:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeySessionHelper=void 0;var i=r(53282),n=r(88309),o=r(47632),a=r(35619),s=r(94306),u=function(){function e(t){this._keySessions=new n.Set,this._keyStatusOverrides=new s.HashMap,this._drmStatus=new s.HashMap,this._timeoutSeconds=e.TIMEOUT_SECONDS,this.onDrmStatusChange=new o.Emitter,this.onError=new o.Emitter,this.onWarning=new o.Emitter,this._system=t}return e.prototype.hasKey=function(e){return this._drmStatus.contains(e.toLowerCase())},e.prototype.hasSession=function(e){return this._keySessions.has(e)},e.prototype.getDrmStatus=function(){return this._drmStatus},e.prototype.addKeyStatus=function(e,t){this._keyStatusOverrides.set(e,t)},e.prototype.forEachSession=function(e){this._keySessions.forEach(function(t){e(t)})},e.prototype.addSession=function(e){var t=this;this._keySessions.add(e),e.onError.on(this,function(e){return t.onError.emit(e)}),e.onWarning.on(this,function(e){return t.onWarning.emit(e)}),e.onKeyStatusesChange.on(this,function(){t._drmStatus=t._getDrmStatusMap(),t.onDrmStatusChange.emit()}),this._drmStatus=this._getDrmStatusMap()},e.prototype.closeSession=function(e){if(e.onMessage.off(this),e.onError.off(this),e.onWarning.off(this),this._keySessions.delete(e))return e.onKeyStatusesChange.off(this),this._drmStatus=this._getDrmStatusMap(),e.close()},e.prototype.close=function(){var e=this,t=[];return this.forEachSession(function(r){r.onKeyStatusesChange.off(e),t.push(e.closeSession(r))}),Promise.all(t)},e.prototype._waitFor=function(e,t,r,n){var o,s=this,u={};return Promise.race([e.then(function(){return null==o||o.stop(),t.off(u),!1}),new Promise(function(e,c){(o=new i.Timer(s._system,function(){t.off(u),c(new a.KeySessionError("Timed out waiting for "+n(),s.getDrmStatus(),r))})).tickAfter(s._timeoutSeconds),t.once(u,function(t){null==o||o.stop(),e(t)})})])},e.prototype.waitForMessage=function(e){return this._waitFor(e.closed,e.onMessage,e,function(){return"message"})},e.prototype.waitForKeyStatusChange=function(e){return this._waitFor(e.closed,e.onKeyStatusesChange,e,function(){return"key status change"})},e.prototype._getDrmStatusMap=function(){var e=new s.HashMap;return this.forEachSession(function(t){t.getMediaKeyStatusMap().forEach(function(r,i){r=r.toLowerCase(),e.set(r,{sessionId:t.sessionId,keyId:r,status:i})})}),this._keyStatusOverrides.forEach(function(t,r){t=t.toLowerCase(),e.set(t,{sessionId:"system-session",keyId:t,status:r})}),e},e.TIMEOUT_SECONDS=10,e}();t.KeySessionHelper=u},28928:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayReadyHandler=void 0;var i=r(22970),n=r(17590),o=r(84672),a=r(93342),s=r(70387),u=r(36760),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._stringUtil=new n.StringUtil,t}return i.__extends(t,e),t.prototype._processKeySession=function(e,t,r){return i.__awaiter(this,void 0,void 0,function(){var n,o,a,s;return i.__generator(this,function(i){switch(i.label){case 0:return n=this._sessionHelper.waitForMessage(e),[4,e.generateRequest(t.initDataType,r,t)];case 1:if(i.sent(),!this._sessionHelper.hasSession(e))return[2];return[4,n];case 2:if(!1===(o=i.sent())||!this._sessionHelper.hasSession(e))return[2];return[4,this._getUpdateData(e,o,t)];case 3:if(a=i.sent(),!this._sessionHelper.hasSession(e))return[2];return s=this._sessionHelper.waitForKeyStatusChange(e),[4,e.update(a)];case 4:if(i.sent(),!this._sessionHelper.hasSession(e))return[2];return[4,s];case 5:return i.sent(),[2]}})})},t.prototype._getUpdateData=function(e,t,r){var n,o;return i.__awaiter(this,void 0,void 0,function(){var c,d,l,h,p,f,_,v,m,g,y;return i.__generator(this,function(i){switch(i.label){case 0:if(void 0===r.licenseServerUri)throw Error("No license server found for drm info");if(d=new Uint8Array(t.message)[0],l=new Uint8Array(t.message)[1],0===t.message.byteLength)throw new a.NonFatalError;return 60===d&&63===l?c=new Uint8Array(t.message):(h=this._stringUtil.fromUTF16(t.message,!0),p=this._getChallengeFromXml(h),c=this._stringUtil.toUTF8(this._stringUtil.fromStandardBase64(p))),f={"Content-Type":"text/xml; charset=utf-8",SOAPAction:"http://schemas.microsoft.com/DRM/2007/03/protocols/AcquireLicense"},m=(v=this._network).makeNetworkClient,y={},[4,r.licenseServerUri()];case 1:return _=m.apply(v,[(y.resource=i.sent(),y.method="POST",y.headers=f,y.body=c,y.type="license",y.timeoutMS=this._licenseRequestTimeoutMs,y.retryCount=this._licenseRequestRetryCount,y)]),null===(n=this._playerVitals)||void 0===n||n.add("LICENSE_REQUEST_STARTED"),[4,_.payloadBuffer()];case 2:if(g=i.sent(),null===(o=this._playerVitals)||void 0===o||o.add("LICENSE_REQUEST_ENDED"),s.NetworkHelpers.isSuccessfulResponseCode(g.status))return[3,4];return[4,e.close()];case 3:throw i.sent(),new u.LicenseRequestError("Did not get a valid response from license server '".concat(g.status,"'"));case 4:return[2,g.data]}})})},t.prototype._getChallengeFromXml=function(e){var t=e.indexOf("<Challenge"),r=e.indexOf(">",t);if(-1===r)throw Error("Could not find challenge in license XML");var i=e.indexOf("</Challenge>",r);if(-1===i)throw Error("Could not find challenge end in license XML");return e.substring(r+1,i)},t}(o.CommonDrmHandler);t.PlayReadyHandler=c},39139:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WidevineHandler=void 0;var i=r(22970),n=r(84672),o=r(28521),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype._processKeySession=function(e,t,r){var n,a,s,u;return i.__awaiter(this,void 0,void 0,function(){var c,d,l,h,p,f,_;return i.__generator(this,function(i){switch(i.label){case 0:return c=this._sessionHelper.waitForMessage(e),this._system.logVerbose("calling to generateRequest for widevine"),[4,e.generateRequest(t.initDataType,r,t)];case 1:if(i.sent(),!this._sessionHelper.hasSession(e))return this.onWarning.emit(new o.WarningError("lost session while generating request")),[2];return this._system.logVerbose("waiting for certificate or license request from CDM"),[4,c];case 2:if(!1===(d=i.sent())||!this._sessionHelper.hasSession(e))return this.onWarning.emit(new o.WarningError("lost session preparing to wait for message")),[2];if(2!==(l=d).message.byteLength)return[3,8];if(h=void 0,void 0!==t.individualizationRequest)return[3,4];return this._system.logVerbose("making request for certificate"),null===(n=this._playerVitals)||void 0===n||n.add("CERTIFICATE_REQUEST_STARTED"),[4,this._getUpdateData(e,d,t)];case 3:return h=i.sent(),null===(a=this._playerVitals)||void 0===a||a.add("CERTIFICATE_REQUEST_ENDED"),[3,5];case 4:this._system.logVerbose("retrieving cached individualization request"),h=t.individualizationRequest.buffer,i.label=5;case 5:if(!this._sessionHelper.hasSession(e))return this.onWarning.emit(new o.WarningError("lost session while getting certificate")),[2];return p=this._sessionHelper.waitForMessage(e),this._system.logVerbose("updating session with certificate"),[4,e.update(h,l.sessionId)];case 6:if(i.sent(),!this._sessionHelper.hasSession(e))return this.onWarning.emit(new o.WarningError("lost session while waiting for certificate-request")),[2];return this._system.logVerbose("waiting for license request from CDM"),[4,p];case 7:if(!1===(l=i.sent())||!this._sessionHelper.hasSession(e))return[2];i.label=8;case 8:if("license-request"!==l.type&&"licenserequest"!==l.type)throw Error("Unexpected message type '".concat(l.type,"' for license request"));return this._system.logVerbose("making request for license"),null===(s=this._playerVitals)||void 0===s||s.add("LICENSE_REQUEST_STARTED"),[4,this._getUpdateData(e,l,t)];case 9:if(f=i.sent(),null===(u=this._playerVitals)||void 0===u||u.add("LICENSE_REQUEST_ENDED"),!this._sessionHelper.hasSession(e))return this.onWarning.emit(new o.WarningError("lost session while making license request")),[2];return _=this._sessionHelper.waitForKeyStatusChange(e),this._system.logVerbose("updating session with license"),[4,e.update(f,l.sessionId)];case 10:if(i.sent(),!this._sessionHelper.hasSession(e))return[2];return this._system.logVerbose("waiting for key status change"),[4,_];case 11:return i.sent(),[2]}})})},t}(n.CommonDrmHandler);t.WidevineHandler=a},1319:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BufferError=void 0;var i=r(22970),n=r(57665),o=function(e){function t(r){var i=e.call(this,t.NAME,"Failure to process buffer items in pipeline",r.pipelineState.error)||this;return i.item=r,i}return i.__extends(t,e),t.prototype.toString=function(){return n.WrappedError.getStandardMessage(this)+t.getItemLocationMessage(this)+t.getItemUrlMessage(this)+n.WrappedError.getCauseMessage(this)},t.getItemLocationMessage=function(e){return"\nat segment time=(".concat(e.item.pipelineState.start," - ").concat(e.item.pipelineState.end,")")},t.getItemUrlMessage=function(e){var t,r,i="";return(void 0!==e.item.pipelineState.segment.startByte||void 0!==e.item.pipelineState.segment.endByte)&&(i="bytes=[".concat(null!==(t=e.item.pipelineState.segment.startByte)&&void 0!==t?t:"*","-").concat(null!==(r=e.item.pipelineState.segment.endByte)&&void 0!==r?r:"*","]")),"\nat segment ".concat(i," url=").concat(e.item.pipelineState.segment.createUri)},t.NAME="Buffer",t}(n.WrappedError);t.BufferError=o},30020:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BufferUpdateError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="BufferUpdate",t}(r(57665).WrappedError);t.BufferUpdateError=n},67503:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BufferVariantError=void 0;var i=r(22970),n=function(e){function t(r){var i=e.call(this,t.NAME,"Failed to find suitable variant")||this;return i.result=r,i}return i.__extends(t,e),t.prototype.toString=function(){var t=e.prototype.toString.call(this);return this.result.filterMap.forEach(function(e,r){t+="\n".concat(e," filtered to ").concat(r)}),t},t.NAME="BufferVariant",t}(r(57665).WrappedError);t.BufferVariantError=n},19734:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyProtectionError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,null!=r?r:"HDCP Error",i)||this}return i.__extends(t,e),t.NAME="CopyProtection",t}(r(57665).WrappedError);t.CopyProtectionError=n},84639:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DigitalRightsError=void 0;var i=r(22970),n=function(e){function t(r){return e.call(this,t.NAME,"Failure during digital rights acquisition",r)||this}return i.__extends(t,e),t.NAME="DigitalRights",t}(r(57665).WrappedError);t.DigitalRightsError=n},98669:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExpiredKeysError=void 0;var i=r(22970),n=function(e){function t(r){return e.call(this,t.NAME,"all keys have expired",r)||this}return i.__extends(t,e),t.NAME="ExpiredKeys",t}(r(57665).WrappedError);t.ExpiredKeysError=n},16471:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidSegmentDurationError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="InvalidSegmentDuration",t}(r(57665).WrappedError);t.InvalidSegmentDurationError=n},35619:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeySessionError=void 0;var i=r(22970),n=function(e){function t(r,i,n,o){var a=e.call(this,t.NAME,r,o)||this;return a._drmStatus=i,a._session=n,a}return i.__extends(t,e),t.prototype.toString=function(){for(var t="".concat(e.prototype.toString.call(this),"\nsessionId=").concat(this._session.sessionId," expires=").concat(this._session.expiration),r=0,i=this._drmStatus.values();r<i.length;r++){var n=i[r];t+="\n".concat(n.sessionId,":").concat(n.keyId,"->").concat(n.status)}return t},t.NAME="KeySession",t}(r(57665).WrappedError);t.KeySessionError=n},36760:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LicenseRequestError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="LicenseRequest",t}(r(57665).WrappedError);t.LicenseRequestError=n},82997:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaOperationStateError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="MediaOperationStateError",t}(r(57665).WrappedError);t.MediaOperationStateError=n},93342:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NonFatalError=void 0;var i=r(22970),n=function(e){function t(r){return e.call(this,t.NAME,"Non-fatal error",r)||this}return i.__extends(t,e),t.NAME="NonFatal",t}(r(57665).WrappedError);t.NonFatalError=n},11601:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutputRestrictedError=void 0;var i=r(22970),n=function(e){function t(r){return e.call(this,t.NAME,"Content previously appended is output restricted",r)||this}return i.__extends(t,e),t.NAME="OutputRestricted",t}(r(57665).WrappedError);t.OutputRestrictedError=n},49450:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="PlayerError",t}(r(57665).WrappedError);t.PlayerError=n},17997:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerLoadError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="PlayerLoad",t}(r(57665).WrappedError);t.PlayerLoadError=n},75855:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerNotLoadedError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="PlayerNotLoaded",t}(r(57665).WrappedError);t.PlayerNotLoadedError=n},43162:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentDownloadFailedError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="SegmentDownloadFailed",t}(r(57665).WrappedError);t.SegmentDownloadFailedError=n},61054:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentRetryFailedError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="SegmentRetryFailed",t}(r(57665).WrappedError);t.SegmentRetryFailedError=n},5375:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextEncodingError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="TextEncoding",t}(r(57665).WrappedError);t.TextEncodingError=n},2906:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VideoElementError=void 0;var i=r(22970),n=r(57665),o=r(7500),a=function(e){function t(r,i){var n=e.call(this,t.NAME,"Error on video element with code=(".concat(r.code,"): ").concat(r.message))||this;return n.error=r,n._data=i,n._mp4Util=new o.Mp4Util,n}return i.__extends(t,e),t.prototype.updateData=function(e){this._data=i.__assign(i.__assign({},this._data),e)},t.prototype.toString=function(){var t,r,i,n,o="".concat(e.prototype.toString.call(this));if(void 0===this._data)return o;o+="\nbufferForPlaybackSeconds=".concat(this._data.bufferForPlaybackSeconds);var a=this.getSourceBuffer("audio",this._data.sourceBuffers),s=this.getSourceBuffer("video",this._data.sourceBuffers),u=null==a?void 0:a.getInitSegment(),c=null==s?void 0:s.getInitSegment();if(void 0!==u){var d=this._mp4Util.determineCodec("audio",new Uint8Array(u));i="init segment had codec: ".concat(d)}else i="no init segment";if(void 0!==c){var l=this._mp4Util.determineCodec("video",new Uint8Array(c));n="init segment had codec: ".concat(l)}else n="no init segment";if((null===(t=this._data.variantData)||void 0===t?void 0:t.audio)!==void 0&&(o+="\ncodec of audio source buffer: ".concat(null==a?void 0:a.codecs,", attempting to append ").concat(void 0!==a&&a.lastAppendedSegmentWasInit?"init":"data"," segment with codec: ").concat(this._data.variantData.audio.codecs,", ").concat(i)),(null===(r=this._data.variantData)||void 0===r?void 0:r.video)!==void 0&&(o+="\ncodec of video source buffer: ".concat(null==s?void 0:s.codecs,", attempting to append ").concat(void 0!==s&&s.lastAppendedSegmentWasInit?"init":"data"," segment with codec: ").concat(this._data.variantData.video.codecs,", ").concat(n)),void 0!==this._data.videoState){var h=this._data.videoState;o+="\nVideoStateData:\n    currentTime=".concat(h.currentTime,"\n    playbackRate=").concat(h.playbackRate,"\n    readyState=").concat(h.readyState,"\n    size=").concat(JSON.stringify(h.size),"\n    buffered=").concat(JSON.stringify(h.buffered),"\n    droppedVideoFrames=").concat(h.droppedVideoFrames,"\n    totalVideoFrames=").concat(h.totalVideoFrames)}return o},t.prototype.getSourceBuffer=function(e,t){return null==t?void 0:t.tryGet(e)},t.NAME="VideoElement",t}(n.WrappedError);t.VideoElementError=a},39077:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VideoStalledError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="VideoStalled",t}(r(57665).WrappedError);t.VideoStalledError=n},14016:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaObjectQueue=void 0;var i=r(22970),n=r(47632),o=r(54965),a=r(34518),s=r(57665),u=r(61757),c=r(82997),d=r(94306),l=function(){function e(e,t,r){this._system=e,this.onError=new n.Emitter,this.onSourceBufferUpdateEnd=new n.Emitter,this._opSequence=0,this._sourceBufferObjects=new o.Map,this._mediaSourceVerify=t,this._sourceBufferVerify=r}return e.prototype.trackMediaSource=function(e){var t=this;this.untrackMediaSource();var r=new u.AsyncWorker(this._system,{getNextWorkItem:function(){return t._getNextMediaSourceWorkItem()},handleWorkItem:function(e){return t._handleMediaSourceWorkItem(e)}});r.onError.on(this,function(e){return t.onError.emit(e.error)}),r.onWorkCompleted.on(this,function(){return t.flush()}),r.concurrentLimit=0;var i=this._makeMediaObject(r,e);this._mediaSourceObject=i},e.prototype.trackSourceBuffer=function(e){var t=this;this.untrackSourceBuffer(e);var r=new u.AsyncWorker(this._system,{getNextWorkItem:function(){return t._getNextSourceBufferWorkItem(e)},handleWorkItem:function(r){return t._handleSourceBufferWorkItem(e,r)}});r.onError.on(this,function(e){return t.onError.emit(e.error)}),r.onWorkCompleted.on(this,function(){return t.flush()}),r.concurrentLimit=0;var i=this._makeMediaObject(r,e);this._sourceBufferObjects.set(e,i),e.onUpdateEnd.on(this,function(){t.flush(),t.onSourceBufferUpdateEnd.emit()})},e.prototype.untrackMediaSource=function(){var e;null===(e=this._mediaSourceObject)||void 0===e||e.destroy(),this._mediaSourceObject=void 0},e.prototype.untrackSourceBuffer=function(e){var t=this._sourceBufferObjects.tryGet(e);null==t||t.mediaObject.onUpdateEnd.off(this),null==t||t.destroy(),this._sourceBufferObjects.delete(e)},e.prototype.reset=function(){var e=this;this.untrackMediaSource(),this._sourceBufferObjects.forEach(function(t){return e.untrackSourceBuffer(t)})},e.prototype.flush=function(){var e;null===(e=this._mediaSourceObject)||void 0===e||e.worker.flush(),this._sourceBufferObjects.forEach(function(e,t){return t.worker.flush()})},e.prototype.queueMediaSource=function(e,t,r){var n=this;return new Promise(function(o,s){if(void 0===n._mediaSourceObject){s(new c.MediaOperationStateError("Attempting to queue ".concat(e," without a tracking media source")));return}n._opSequence++,n._mediaSourceObject.queue.push({name:e,sequence:n._opSequence,run:function(){return i.__awaiter(n,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return[4,t()];case 1:return o(e.sent()),[2]}})})},reject:function(t){if(!(t instanceof a.OperationCanceledError)||"addSourceBuffer"===e||"openSource"===e){s(t);return}n._system.logWarn("ignoring cancelation ".concat(e)),o(void 0)},canRun:null!=r?r:function(){return!0}}),n.flush()})},e.prototype.queueSourceBuffer=function(e,t,r,n){var o=this;return new Promise(function(a,s){var u=o._sourceBufferObjects.tryGet(e);if(void 0===u){s(new c.MediaOperationStateError("Attempting to queue ".concat(t," without a tracking source buffer")));return}o._opSequence++,u.queue.push({name:t,sequence:o._opSequence,run:function(){return i.__awaiter(o,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return[4,r()];case 1:return a(e.sent()),[2]}})})},reject:s,canRun:null!=n?n:function(){return!0}}),o.flush()})},e.prototype.hasRunningSourceBuffer=function(){var e=!1;return this._sourceBufferObjects.forEach(function(t,r){(t.updating||r.worker.isRunning())&&(e=!0)}),e},e.prototype.hasRunningMediaSource=function(){return void 0!==this._mediaSourceObject&&this._mediaSourceObject.worker.isRunning()},e.prototype.getSourceBuffers=function(){var e=new d.HashMap;return this._sourceBufferObjects.forEach(function(t){e.set(t.streamType,t)}),e},e.prototype._makeMediaObject=function(e,t){var r=this,i={worker:e,mediaObject:t,queue:[],destroy:function(){e.stop(),e.destroy(),r._cancelQueue(i.queue)}};return i},e.prototype._cancelQueue=function(e){for(var t=0;t<e.length;t++){var r=e[t];r.reject(new a.OperationCanceledError("".concat(r.name," is being canceled because the media object is being destroyed.")))}e.splice(0,e.length)},e.prototype._getNextMediaSourceWorkItem=function(){var e,t,r=null===(e=this._mediaSourceObject)||void 0===e?void 0:e.queue[0],i=this._getFirstSourceBufferSequence();if(void 0!==r&&(void 0===i||r.sequence<=i)&&!this.hasRunningMediaSource()&&!this.hasRunningSourceBuffer()&&r.canRun())return null===(t=this._mediaSourceObject)||void 0===t?void 0:t.queue.shift()},e.prototype._handleMediaSourceWorkItem=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,n;return i.__generator(this,function(i){switch(i.label){case 0:if(i.trys.push([0,2,,3]),void 0===this._mediaSourceObject)throw new c.MediaOperationStateError("Attempting to run ".concat(e.name," on untracked media source"));if(void 0!==(t=this._mediaSourceVerify(this._mediaSourceObject.mediaObject,e)))throw t;return[4,e.run()];case 1:return i.sent(),[3,3];case 2:return r=i.sent(),n=s.WrappedError.wrap(r),e.reject(n),[3,3];case 3:return[2]}})})},e.prototype._getNextSourceBufferWorkItem=function(e){var t=this._sourceBufferObjects.tryGet(e);if(void 0!==t){var r=t.queue[0],i=this._getFirstMediaSourceSequence(),n=this._getFirstSourceBufferItemsWithLowestSequence(e);if(void 0!==r&&(void 0===i||r.sequence<i)&&!e.updating&&!this.hasRunningMediaSource()&&!n.some(function(e){return e.sequence<=r.sequence})&&!this.hasRunningSourceBuffer()&&r.canRun())return t.queue.shift()}},e.prototype._handleSourceBufferWorkItem=function(e,t){return i.__awaiter(this,void 0,void 0,function(){var r,n,o,a,u;return i.__generator(this,function(i){switch(i.label){case 0:if(i.trys.push([0,2,,3]),r=this._sourceBufferObjects.tryGet(e),void 0===this._mediaSourceObject)throw new c.MediaOperationStateError("Attempting to run ".concat(t.name," on untracked media source"));if(void 0===r)throw new c.MediaOperationStateError("Attempting to run ".concat(t.name," on untracked source buffer"));if(n=this._mediaSourceVerify(this._mediaSourceObject.mediaObject,t),o=this._sourceBufferVerify(r.mediaObject,t),void 0!==n)throw n;if(void 0!==o)throw o;return[4,t.run()];case 1:return i.sent(),[3,3];case 2:return a=i.sent(),u=s.WrappedError.wrap(a),t.reject(u),[3,3];case 3:return[2]}})})},e.prototype._getFirstSourceBufferItemsWithLowestSequence=function(e){var t=[];return this._sourceBufferObjects.forEach(function(r,i){if(r!==e){var n=i.queue[0];void 0!==n&&(0===t.length||n.sequence===t[0].sequence?t.push(n):n.sequence<t[0].sequence&&t.splice(0,t.length,n))}}),t},e.prototype._getFirstSourceBufferSequence=function(){var e;return null===(e=this._getFirstSourceBufferItemsWithLowestSequence()[0])||void 0===e?void 0:e.sequence},e.prototype._getFirstMediaSourceSequence=function(){var e,t=null===(e=this._mediaSourceObject)||void 0===e?void 0:e.queue[0];if(void 0!==t)return t.sequence},e}();t.MediaObjectQueue=l},68216:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsGroup=void 0;var r=function(){function e(e,t){this._times=[],this._values=[],this._label=e,this._windowMs=t}return e.prototype.add=function(e){this._times.push(Date.now()),this._values.push(e),this._trimDataToWindow()},e.prototype.getAllValues=function(){return this._values},e.prototype.getCurrentValue=function(){if(0!==this._values.length)return this._values[this._values.length-1]},e.prototype.toJSON=function(){return{label:this._label,windowMs:this._windowMs,times:this._times.slice(),values:this._values.slice()}},e.prototype._trimDataToWindow=function(){for(var e=Date.now()-this._windowMs;this._times.length>0&&this._times[0]<e;)this._times.shift(),this._values.shift()},e}();t.AnalyticsGroup=r},86922:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsSession=void 0;var i=r(94306),n=r(68216),o=function(){function e(t){void 0===t&&(t={sessionWindowMs:e.DEFAULT_WINDOW_MS}),this._groups=new i.HashMap,this._options=t}return e.prototype.removeGroup=function(e){this._groups.delete(e)},e.prototype.addGroup=function(e){var t=this._options.sessionWindowMs;void 0!==this._options.groupOverrides&&void 0!==this._options.groupOverrides[e]&&(t=this._options.groupOverrides[e]);var r=new n.AnalyticsGroup(e,t);return this._groups.set(e,r),r},e.prototype.getGroup=function(e){return this._groups.tryGet(e)},e.prototype.toJSON=function(){var e={};return this._groups.forEach(function(t,r){e[t]=r.toJSON()}),e},e.DEFAULT_WINDOW_MS=6e4,e}();t.AnalyticsSession=o},15942:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetricBus=void 0;var i=r(47632);t.MetricBus=function(){this.bandwidthEstimation=new i.Emitter,this.bitrateChange=new i.Emitter,this.playerState=new i.Emitter,this.variantChange=new i.Emitter,this.bandwidthsChange=new i.Emitter}},74557:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EndOfStreamController=void 0;var i=r(53282),n=r(47632),o=r(95645),a=function(){function e(t,r){var a=this;this.onError=new n.Emitter,this.endOfStream=new n.Emitter,this._onTimerUpdate=function(){var t=a._inject.getState(),r=null==t?void 0:t.videoState;if(void 0!==t&&void 0!==r){var i=r.currentTime,n=a._inject.getCurrentPeriodRange();if(void 0!==n){var s=r.buffered;if(void 0!==s&&s.length>0&&i>=s[s.length-1].start&&i<=s[s.length-1].end&&r.playbackRate>0&&Math.abs(s[s.length-1].end-n.end)<=e.SMALL_PERIOD_DURATION_SECONDS&&a._haveAppendedToEnd()&&(!a._inject.isLive()||!a._isLastPeriod()))try{a.endOfStream.emit()}catch(e){a.onError.emit(new o.UnsupportedError("Error emitting endOfStream."))}}}},this._inject=r,this._timer=new i.Timer(t,this._onTimerUpdate)}return e.prototype.start=function(){this._timer.tickEvery(e.TIMER_UPDATE_SECONDS)},e.prototype.stop=function(){this._timer.stop()},e.prototype._isLastPeriod=function(){var e=this._inject.playbackSession();if(void 0===e)return!1;var t=e.getLoadedBuffer();return void 0!==t&&e.getAppendPeriod()===t.getPeriods()[t.getPeriods().length-1]},e.prototype._haveAppendedLastSegmentInPeriod=function(e,t,r){for(var i=0,n=r.active.getAllRanges();i<n.length;i++){var o=n[i],a=t.getBufferItem(o);if(void 0!==a&&a.period===e&&o.segment.id===a.stream.segments.getSegment(a.stream.segments.length-1).id)return"AppendCompleted"===o.phases.getLastPhaseName()}return!1},e.prototype._haveAppendedToEnd=function(){var e=this._inject.playbackSession();if(void 0===e)return!1;var t=e.getAppendPeriod(),r=e.getLoadedBuffer();if(void 0===r||void 0===t)return!1;var i=r.mediaSourceController,n=i.getPipeline("audio"),o=i.getPipeline("video");return!!(void 0!==o&&this._haveAppendedLastSegmentInPeriod(t,r,o))&&(void 0===n||this._haveAppendedLastSegmentInPeriod(t,r,n))},e.TIMER_UPDATE_SECONDS=.5,e.SMALL_PERIOD_DURATION_SECONDS=4,e.ALLOWED_TIMESTAMP_DISCREPANCY_SECONDS=.1,e}();t.EndOfStreamController=a},7822:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GapSkippingController=void 0;var i=r(47632),n=function(){function e(t){var r=this;this.skipMaxSeconds=e.GAP_SKIP_MAX_SECONDS,this.skipMinBufferSeconds=e.GAP_SKIP_MIN_BUFFER_SECONDS,this.onGapSeek=new i.Emitter,this._onPlayerStateChange=function(e){var t,i,n,o,a,s,u=null===(t=e.videoState)||void 0===t?void 0:t.buffered,c=null===(i=e.videoState)||void 0===i?void 0:i.currentTime,d=null===(n=e.videoState)||void 0===n?void 0:n.playbackRate,l="STALLED"===e.playbackState,h="SEEKING"===e.playbackState,p=(null===(o=e.videoState)||void 0===o?void 0:o.readyState)===1,f=r._inject.getCurrentPeriodRange();if((l||h||p&&"IDLE"===e.playbackState)&&void 0!==d&&0!==d&&void 0!==u&&void 0!==c&&void 0!==f){for(var _=f.end-f.start<r.skipMinBufferSeconds,v=0;v<u.length;v++){var m=u[v];if(!(m.start<=c)&&(_||m.end-m.start>r.skipMinBufferSeconds)){var g=Math.abs(m.start-c);(void 0===a||g<a)&&(a=g,s=m.start)}}void 0!==a&&a<=r.skipMaxSeconds&&a>0&&void 0!==s&&r.onGapSeek.emit({currentTime:c,nextBufferedTime:s})}},this._inject=t}return e.prototype.start=function(){this._inject.stateChange.on(this,this._onPlayerStateChange)},e.prototype.stop=function(){this._inject.stateChange.off(this)},e.GAP_SKIP_MAX_SECONDS=1,e.GAP_SKIP_MAX_SECONDS_LIVE=10,e.GAP_SKIP_MIN_BUFFER_SECONDS=4,e}();t.GapSkippingController=n},29251:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LiveWindowUpdateController=void 0;var i=r(47632),n=function(){function e(e,t,r){this.onLiveWindowUpdate=new i.Emitter,this._stateChange=e,this._system=t,this._inject=r}return e.prototype.start=function(){var e=this;this._stateChange.on(this,function(t){return e._checkInLiveWindow(t)})},e.prototype.stop=function(){this._stateChange.off(this)},e.prototype._isOutsideLiveWindow=function(e,t){return e+.001<t.start||e>=t.end+.001},e.prototype.correctLivePosition=function(e,t){if(this._isOutsideLiveWindow(e,t)){var r=this._isRollingWindow(t.start)||e>=t.end+.001?this._inject.getLiveEdge():this._inject.getLiveStart();if(void 0!==r)return r;this._system.logInfo("Failed to find live edge or live start.")}},e.prototype._isRollingWindow=function(e){var t=this._inject.getOriginalStartTime();return void 0!==t&&e>t},e.prototype._checkInLiveWindow=function(e){var t,r=null===(t=e.videoState)||void 0===t?void 0:t.currentTime,i=this._inject.getLiveContentRange();if(void 0!==e.videoState&&0!==e.videoState.playbackRate&&void 0!==i&&void 0!==r){var n=this.correctLivePosition(r,i);void 0!==n&&(this._system.logWarn("Outside live window. Current time: ".concat(r,". Live window: ").concat(i.start," - ").concat(i.end,". Attempting jump to ").concat(n,".")),this.onLiveWindowUpdate.emit(n))}},e}();t.LiveWindowUpdateController=n},27451:function(e,t){"use strict";var r,i;t.q=void 0,(i=r||(t.q=r={})).IDLE="IDLE",i.READY="READY",i.STALLED="STALLED",i.SEEKING="SEEKING",i.ENDED="ENDED"},82270:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerConstants=void 0;var r=function(){function e(){}return e.SIZE_UPDATE_SECONDS=10,e.BUFFER_UPDATE_SECONDS=1,e.PLAYER_UPDATE_SECONDS=.25,e.PLAYER_TIMEDEVENTS_DISPATCH_SECONDS=4,e.TEXT_UPDATE_SECONDS=.25,e.DEFAULT_RELATIVE_BUFFER_START=0,e.DEFAULT_RELATIVE_BUFFER_END=30,e.DEFAULT_RELATIVE_APPEND_START=0,e.DEFAULT_RELATIVE_APPEND_END=10,e.DEFAULT_BUFFER_FOR_PLAYBACK_SECONDS=0,e.STALL_SEEK_EPSILON=.01,e.DEFAULT_SEEK_PAST_END_RESTART_SECONDS=.5,e.DEFAULT_STALL_TIME_MITIGATION_THRESHOLD_SECONDS=5,e.DEFAULT_STALL_TIME_ERROR_THRESHOLD_SECONDS=360,e}();t.PlayerConstants=r},84770:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerLoadController=void 0;var i=r(22970),n=r(24533),o=r(69964),a=function(){function e(e,t){this._inject=t,this._arrayUtil=new o.ArrayUtil,this._worker=new n.SequentialTaskRunner(e),this.onError=this._worker.onError,this.onWarning=this._worker.onWarning}return e.prototype.isReloading=function(){var e;return(null===(e=this._worker.tasks[0])||void 0===e?void 0:e.request.type)==="reload"},e.prototype.attach=function(e){var t=this;return this._worker.runWithoutReturn(i.__assign({type:"attach"},e),function(e){return t._inject.attach(e)})},e.prototype.detach=function(){var e=this;return this._worker.runWithReturn({type:"detach"},function(){return e._inject.detach()})},e.prototype.reload=function(e){var t=this;return this._worker.runReplace(i.__assign({type:"reload"},e),function(e,r){return"reload"===e.type&&t._isReloadRequestEqual(e,r)},function(e){var r,i,n,o,a=t._inject.playbackSession();!0===e.useExistingDrm&&(n=null==a?void 0:a.removeDrm()),!0===e.reuseDownloadedSegments&&(o=null==a?void 0:a.drainDownloaded());var s=t._inject.playerState(),u=null!==(r=e.position)&&void 0!==r?r:null===(i=s.videoState)||void 0===i?void 0:i.currentTime;return t._inject.reload({drm:n,position:u,hydrateBuffer:o,audioCodecGroups:e.audioCodecGroups,videoCodecGroups:e.videoCodecGroups,sequence:e.sequence})})},e.prototype.seek=function(e){var t=this;return this._worker.runReplace(i.__assign({type:"seek"},e),function(e,t){return"seek"===e.type&&e.position===t.position},function(e){return t._inject.seek(e)})},e.prototype._isReloadRequestEqual=function(e,t){return e.sequence===t.sequence&&e.reuseDownloadedSegments===t.reuseDownloadedSegments&&e.useExistingDrm===t.useExistingDrm&&e.position===t.position&&(void 0===e.audioCodecGroups&&void 0===t.audioCodecGroups||void 0!==e.audioCodecGroups&&void 0!==t.audioCodecGroups&&this._arrayUtil.areEqual(e.audioCodecGroups,t.audioCodecGroups))&&(void 0===e.videoCodecGroups&&void 0===t.videoCodecGroups||void 0!==e.videoCodecGroups&&void 0!==t.videoCodecGroups&&this._arrayUtil.areEqual(e.videoCodecGroups,t.videoCodecGroups))},e}();t.PlayerLoadController=a},20432:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerStateTracker=void 0;var i=r(22970),n=r(47632),o=r(29368),a=r(27574),s=r(69964),u=r(74436),c=r(65533),d=function(){function e(){this.onStateChanged=new n.Emitter,this._rangeUtil=new o.TimeRangeUtil,this._pipelineUtil=new c.SegmentPipelineWorkerUtil,this._stallCounter=0,this._safeSeekInProgress=!1,this._playerState={stallReason:u.StallReason.NOT_STALLED,playbackState:"IDLE",bitrate:{},videoState:void 0},this._playerUtil=new a.PlayerUtil,this._delayedCallbacks=[],this._arrayUtil=new s.ArrayUtil}return e.prototype.getCurrent=function(){return this._playerState},e.prototype.reset=function(e){this._stallCounter=0,void 0!==this._session&&this._session.analytics.removeGroup("playerStateChanged"),this._playerStateAnalytics=void 0,this._session=e,void 0!==this._session&&(this._playerStateAnalytics=this._session.analytics.addGroup("playerStateChanged"),this._playerStateAnalytics.add("IDLE")),this._setPlayerState({stallReason:u.StallReason.NOT_STALLED,playbackState:"IDLE",bitrate:{},videoState:void 0}),this._emitOnStateChanged()},e.prototype.setVolume=function(e){void 0!==this._playerState.videoState&&this._playerState.videoState.volume!==e&&(this._setPlayerState(i.__assign(i.__assign({},this._playerState),{videoState:i.__assign(i.__assign({},this._playerState.videoState),{volume:e})})),this._emitOnStateChanged())},e.prototype.setPosition=function(e){void 0!==this._playerState.videoState&&this._playerState.videoState.currentTime!==e&&(this._setPlayerState(i.__assign(i.__assign({},this._playerState),{stallReason:u.StallReason.NOT_STALLED,playbackState:"SEEKING",videoState:i.__assign(i.__assign({},this._playerState.videoState),{currentTime:e})})),this._emitOnStateChanged())},e.prototype.startSafeSeek=function(){this._safeSeekInProgress=!0,this._setPlayerState(i.__assign(i.__assign({},this._playerState),{stallReason:u.StallReason.NOT_STALLED,playbackState:"SEEKING"})),this._emitOnStateChanged()},e.prototype.endSafeSeek=function(){this._safeSeekInProgress=!1},e.prototype.setRate=function(e){void 0!==this._playerState.videoState&&this._playerState.videoState.playbackRate!==e&&(this._setPlayerState(i.__assign(i.__assign({},this._playerState),{videoState:i.__assign(i.__assign({},this._playerState.videoState),{playbackRate:e})})),this._emitOnStateChanged())},e.prototype.setVideoState=function(e){var t=this._playerState.videoState;this._safeSeekInProgress&&void 0!==t&&(e=i.__assign(i.__assign({},e),{currentTime:t.currentTime})),this._setPlayerState(i.__assign(i.__assign({},this._playerState),{videoState:e})),void 0!==t&&t.currentTime===e.currentTime&&this._mayBeStalled(e)?this._stallCounter++:this._stallCounter=0;var r=this._getBufferItemsFromSession(e.currentTime),n=void 0===t;n=this._applyPlayerStateChanges(e)||n,n=this._applyCurrentBitrate(r)||n,n=this._applyCurrentStreams(r)||n,void 0!==t&&(n||(n=t.currentTime!==e.currentTime||t.volume!==e.volume||t.playbackRate!==e.playbackRate||t.readyState!==e.readyState||this._didBufferedTimeChange(t.buffered,e.buffered))),n&&this._emitOnStateChanged()},e.prototype._setPlayerState=function(e){var t,r=this._playerState;this._playerState=e,this._playerState.playbackState!==r.playbackState&&(void 0!==this._playerStateAnalytics&&this._playerStateAnalytics.add(this._playerState.playbackState),this._delayEmit(null===(t=this._session)||void 0===t?void 0:t.metricBus.playerState,e.playbackState))},e.prototype._applyPlayerStateChanges=function(e){var t,r=this._playerState.playbackState;return(null===(t=this._session)||void 0===t?void 0:t.isLive)===!1&&this._isStalledAtEnd(e)?this._setPlayerState(i.__assign(i.__assign({},this._playerState),{stallReason:u.StallReason.NOT_STALLED,playbackState:"ENDED"})):this._isStalled(e)?this._setPlayerState(i.__assign(i.__assign({},this._playerState),{stallReason:this._getReasonForStall(e),playbackState:"STALLED"})):"READY"!==r&&"ENDED"!==r&&e.readyState>=2&&this._setPlayerState(i.__assign(i.__assign({},this._playerState),{stallReason:u.StallReason.NOT_STALLED,playbackState:"READY"})),r!==this._playerState.playbackState},e.prototype._getReasonForStall=function(t){var r,i=this._getBufferItemsFromSession(t.currentTime);if(void 0!==i&&i.length>0&&t.currentTime>=i[0].pipelineState.end-e.STALLREASON_EPSILON&&(i=this._getBufferItemsFromSession(t.currentTime+e.STALLREASON_EPSILON)),void 0===i||0===i.length)return u.StallReason.NO_CONTENT_FOUND;for(var n=0,o=i;n<o.length;n++){var a=o[n];if(!this._pipelineUtil.hasPhase(a.pipelineState,"DownloadCompleted"))return u.StallReason.WAITING_NETWORK}for(var s=0,c=i;s<c.length;s++){var a=c[s];if(!this._pipelineUtil.hasPhase(a.pipelineState,"AppendCompleted"))return u.StallReason.WAITING_APPEND}for(var d=!1,l=!1,h=t.currentTime,p=t.currentTime+e.STALLREASON_EPSILON,f=0,_=null!==(r=t.buffered)&&void 0!==r?r:[];f<_.length;f++){var v=_[f];v.start<=h&&v.end>=h&&(d=!0),v.start<=p&&v.end>=p&&(l=!0)}return d&&l?u.StallReason.VIDEO_NOT_PROGRESSING:u.StallReason.NO_BUFFERED_FOUND},e.prototype._getBufferItemsFromSession=function(e){var t,r,i=null===(t=this._session)||void 0===t?void 0:t.getLoadedBuffer();return null!==(r=null==i?void 0:i.getBufferItems(e))&&void 0!==r?r:[]},e.prototype._applyCurrentBitrate=function(e){for(var t,r=!1,n=this._playerState.bitrate.audio,o=this._playerState.bitrate.video,a=this._playerState.bitrate.text,s=0;s<e.length;s++){var u=e[s],c=u.stream.bandwidth;"audio"===u.stream.type&&n!==c?(n=c,r=!0):"video"===u.stream.type&&o!==c?(o=c,r=!0):"text"===u.stream.type&&a!==c&&(a=c,r=!0)}return r&&(this._setPlayerState(i.__assign(i.__assign({},this._playerState),{bitrate:{audio:n,video:o,text:a}})),this._delayEmit(null===(t=this._session)||void 0===t?void 0:t.metricBus.bitrateChange,this._playerState.bitrate)),r},e.prototype._applyCurrentStreams=function(e){var t,r=this._playerState.variant,n=this._arrayUtil.find(e,function(e){return"video"===e.stream.type});return void 0!==n&&n.variant!==r&&(r=n.variant,this._setPlayerState(i.__assign(i.__assign({},this._playerState),{variant:r})),this._delayEmit(null===(t=this._session)||void 0===t?void 0:t.metricBus.variantChange,r),!0)},e.prototype._didBufferedTimeChange=function(e,t){if(void 0===e||void 0===t)return e!==t;if(e.length!==t.length)return!0;if(0===e.length)return!1;for(var r=this._rangeUtil.sort(e),i=this._rangeUtil.sort(t),n=0,o=r.length;n<o;n++)if(r[n].start!==i[n].start||r[n].end!==i[n].end)return!0;return!1},e.prototype._mayBeStalled=function(e){var t="READY"===this._playerState.playbackState||"STALLED"===this._playerState.playbackState,r=e.playbackRate>0;return(t||this._isNearOrAfterEnd(e.currentTime))&&r},e.prototype._isStalled=function(t){return this._stallCounter>=e.STALL_DETECTION_TICK_THRESHOLD&&this._mayBeStalled(t)},e.prototype._isStalledAtEnd=function(t){return this._stallCounter>=e.STALL_DETECTION_TICK_THRESHOLD&&t.playbackRate>0&&this._isNearOrAfterEnd(t.currentTime)},e.prototype._isNearOrAfterEnd=function(t){var r,i=null===(r=this._session)||void 0===r?void 0:r.getContentRange();return void 0!==i&&t>=i.end-e.ENDOFSTREAM_EPSILON},e.prototype._delayEmit=function(e,t){void 0!==e&&this._delayedCallbacks.push(function(){return e.emit(t)})},e.prototype._emitOnStateChanged=function(){this.onStateChanged.emit(this._playerState),this._delayedCallbacks.forEach(function(e){return e()}),this._delayedCallbacks=[]},e.ENDOFSTREAM_EPSILON=1,e.STALLREASON_EPSILON=.5,e.STALL_DETECTION_TICK_THRESHOLD=4,e}();t.PlayerStateTracker=d},59082:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegionController=void 0;var i=r(22970),n=r(47632),o=r(29368),a=r(27574),s=r(28521),u=r(75855),c="RegionController",d=function(){function e(t,r){this.periodEndMaxSeconds=e.PERIOD_END_MAX_SECONDS,this.onPeriodChange=new n.Emitter,this.onWarning=new n.Emitter,this._timeRangeUtil=new o.TimeRangeUtil,this._playerUtil=new a.PlayerUtil,this._stateChange=t,this._inject=r}return e.prototype.getPeriodForTime=function(e){var t;return null===(t=this._getResumePeriodForTime(e))||void 0===t?void 0:t.period},e.prototype.start=function(e){var t,r=this;this.stop();var i=null!==(t=this._inject.getPeriods())&&void 0!==t?t:[];if(-1===i.indexOf(e)){var n=i.map(function(e){return e.id}).join(", ");throw new u.PlayerNotLoadedError("Failed to start RegionController, starting period with id=".concat(e.id," not found in [").concat(n,"]"))}this._currentPeriod=e,this._currentPeriodRange=this._playerUtil.getRangeOfPeriod(this._currentPeriod),this._stateChange.on(this,function(e){("STALLED"===e.playbackState||"SEEKING"===e.playbackState)&&r.tryUpdatePeriod(e)}),this.tryUpdatePeriod(this._inject.getState())},e.prototype.stop=function(){this._currentTime=void 0,this._currentPeriodRange=void 0,this._buffer=void 0,this._append=void 0,this._stateChange.off(this)},e.prototype.getCurrentPeriodRange=function(){return this._currentPeriodRange},e.prototype.applyBufferRegions=function(t,r,n,o){var a;return i.__awaiter(this,void 0,void 0,function(){var u,d,l,h;return i.__generator(this,function(i){switch(i.label){case 0:if(void 0===this._currentPeriod)return this.onWarning.emit(new s.WarningError("".concat(c," period not defined"))),[2];if(void 0===this._currentPeriodRange)return this.onWarning.emit(new s.WarningError("".concat(c," range not defined"))),[2];if(!(r!==this._currentTime||!this._isEqual(n,this._buffer)||!this._isEqual(o,this._append)||(null===(a=t.getLoadedBuffer())||void 0===a?void 0:a.needsBufferUpdate(this._currentPeriod))===!0))return[3,2];if(u=this._playerUtil.getRangeOfPeriod(this._currentPeriod),this._inject.isLive()){if(void 0===u)return this.onWarning.emit(new s.WarningError("".concat(c," live range not defined"))),[2];this._timeRangeUtil.hasOverlap(this._currentPeriodRange,u)&&(this._currentPeriodRange=u)}return this._currentTime=r,this._buffer=n,this._append=o,d=e.DEFAULT_PADDING,l=void 0!==u?Math.max(u.start,r-d):r-d,h=r+d,t.setBufferRegions([{start:l+n.start,end:h+n.end}]),t.setAppendRegions([{start:l+o.start,end:h+o.end}]),[4,t.applyBufferRegions()];case 1:i.sent(),i.label=2;case 2:return[2]}})})},e.prototype.tryUpdatePeriod=function(e){var t,r=null===(t=e.videoState)||void 0===t?void 0:t.currentTime;if(void 0!==r){var i=this._getResumePeriodForTime(r,this.periodEndMaxSeconds);void 0!==i&&i.period!==this._currentPeriod&&this.onPeriodChange.emit({oldPeriodRange:this._currentPeriodRange,newPeriodRange:i.range,position:i.resumePosition})}},e.prototype._isEqual=function(e,t){return void 0!==t&&this._timeRangeUtil.isRangeEqual(e,t)},e.prototype._getResumePeriodForTime=function(t,r){void 0===r&&(r=0);var i,n=null!==(i=this._inject.getPeriods())&&void 0!==i?i:[],o=this._playerUtil.getPeriodForTime(n,t+r);if(void 0===o&&n.length>0){var a=this._playerUtil.getRangeOfPeriod(n[n.length-1]);void 0!==a&&t<=a.end&&(o=n[n.length-1])}if(void 0!==o){var s=this._playerUtil.getRangeOfPeriod(o);if(void 0!==s)return{period:o,range:s,resumePosition:Math.min(t-s.start<e.PERIOD_END_MAX_SECONDS?s.start+e.DEFAULT_PADDING:t,s.end-e.DEFAULT_PADDING)}}},e.PERIOD_END_MAX_SECONDS=1,e.DEFAULT_PADDING=.05,e}();t.RegionController=d},82541:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RetryController=void 0;var i=r(2906),n=r(57665),o=r(94306),a=r(46433),s=r(41746),u=function(){function e(){this.retryCounts=new o.HashMap}return e.prototype.canRetry=function(e){return this._clearStaleRetries(),this._canRetry(e)},e.prototype.getRetryRestrictions=function(e){if(this._clearStaleRetries(),this._canRetry(e))return this._getRetryRestrictions(e)},e.prototype.markRetry=function(t){this._clearStaleRetries();var r=this._getKeyForError(t);if(void 0!==r){var i=this.retryCounts.tryGet(r);void 0===i?i={lastTimestamp:Date.now(),retryCount:e.RETRY_COUNT-1,attemptedRetries:1}:i.retryCount>0&&(i.lastTimestamp=Date.now(),i.retryCount--,i.attemptedRetries++),this.retryCounts.set(r,i)}},e.prototype._clearStaleRetries=function(){var t=this,r=Date.now();this.retryCounts.forEach(function(i,n){r-n.lastTimestamp>e.RETRY_REPEAT_TIME_MS&&t.retryCounts.delete(i)})},e.prototype._canRetry=function(e){var t=this._getKeyForError(e);if(void 0===t)return!1;var r=this.retryCounts.tryGet(t);if(void 0!==r&&r.retryCount<=0)return!1;var o=n.WrappedError.findFirst(e,i.VideoElementError);return void 0===o||!(o.error.code<3)},e.prototype._getKeyForError=function(e){return n.WrappedError.causedBy(e,i.VideoElementError.NAME)?i.VideoElementError.NAME:n.WrappedError.causedBy(e,a.MediaKeySessionUpdateError.NAME)?a.MediaKeySessionUpdateError.NAME:n.WrappedError.causedBy(e,s.MediaKeySessionGenerateRequestError.NAME)?s.MediaKeySessionGenerateRequestError.NAME:void 0},e.prototype._getRetryRestrictions=function(e){switch(this._getKeyForError(e)){case i.VideoElementError.NAME:return{audio:["aac","heaac"],video:["avc"]};case a.MediaKeySessionUpdateError.NAME:return{video:["hevc","avc"]};case s.MediaKeySessionGenerateRequestError.NAME:return}},e.RETRY_REPEAT_TIME_MS=3e4,e.RETRY_COUNT=2,e}();t.RetryController=u},70847:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SafeSeeker=void 0;var i=r(22970),n=r(82270),o="SafeSeeker",a=function(){function e(e,t,r,i,n){this._system=e,this._buffer=t,this._videoElement=r,this._playerStateTracker=i,this._applyBufferRegions=n}return e.prototype.seek=function(e){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(r){switch(r.label){case 0:return this._system.logInfo("".concat(o,": initiating seek to ").concat(e)),[4,this._videoElement.getState()];case 1:t=r.sent().playbackRate,r.label=2;case 2:if(r.trys.push([2,,6,9]),this._playerStateTracker.startSafeSeek(),!(t>0))return[3,4];return this._system.logInfo("".concat(o,": pausing video before seek")),[4,this._videoElement.setRateWhenReady(0)];case 3:r.sent(),r.label=4;case 4:return[4,this._seek(e)];case 5:return r.sent(),[3,9];case 6:if(this._playerStateTracker.endSafeSeek(),!(t>0))return[3,8];return this._system.logInfo("".concat(o,": restoring playback rate to ").concat(t," after seek")),[4,this._videoElement.setRateWhenReady(t)];case 7:r.sent(),r.label=8;case 8:return[7];case 9:return this._system.logInfo("".concat(o,": seek to ").concat(e," completed")),[2]}})})},e.prototype._seek=function(e){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return[4,this._videoElement.setPositionWhenReady(e)];case 1:return t.sent(),[4,Promise.all([this._buffer.clearAsync("video"),this._buffer.clearAsync("audio")])];case 2:return t.sent(),this._playerStateTracker.setPosition(e),[4,this._applyBufferRegions()];case 3:return t.sent(),[4,this._videoElement.setPositionWhenReady(e+n.PlayerConstants.STALL_SEEK_EPSILON)];case 4:return t.sent(),[2]}})})},e}();t.SafeSeeker=a},24526:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SeekSnapper=void 0;var i=r(22970),n=r(29368),o=r(27574),a=function(){function e(e,t){this._seekSnapping=e,this._selectAllVariants=t,this._playerUtil=new o.PlayerUtil,this._timeRangeUtil=new n.TimeRangeUtil}return e.prototype.snapToSegmentBoundary=function(e){var t,r,n;return i.__awaiter(this,void 0,void 0,function(){var o,a,s,u,c,d,l,h,p;return i.__generator(this,function(f){switch(f.label){case 0:return[4,this._selectAllVariants()];case 1:for(s=0,o=f.sent(),a=[],u=o;s<u.length;s++)void 0!==(c=u[s]).videoDetails&&0!==c.videoDetails.segments.length&&void 0!==(d=this._playerUtil.getRangeOfStream(c.videoDetails))&&a.push(i.__assign(i.__assign({},d),{videoDetails:c.videoDetails}));if((l=this._playerUtil.binarySearchForIndex(a.length,function(e){return a[e]},e))<0)return[2,null===(t=a[-l-1])||void 0===t?void 0:t.videoDetails.segments.getTiming(0).start];if(p=(h=a[l]).videoDetails.segments.getTiming(h.videoDetails.segments.length-1),this._timeRangeUtil.contains([p],e)&&e-p.start>(p.end-p.start)/2)return[2,null===(r=a[l+1])||void 0===r?void 0:r.videoDetails.segments.getTiming(0).start];return[2,null===(n=this._playerUtil.getSegmentForSnapping(h.videoDetails.segments,e,this._seekSnapping))||void 0===n?void 0:n.start]}})})},e}();t.SeekSnapper=a},74436:function(e,t){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.StallReason=void 0,(i=r||(t.StallReason=r={})).NO_CONTENT_FOUND="NO_CONTENT_FOUND",i.WAITING_NETWORK="WAITING_NETWORK",i.WAITING_APPEND="WAITING_APPEND",i.NO_BUFFERED_FOUND="NO_BUFFERED_FOUND",i.VIDEO_NOT_PROGRESSING="VIDEO_NOT_PROGRESSING",i.NOT_STALLED="NOT_STALLED"},72413:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StallSkippingController=void 0;var i=r(47632),n=r(53282),o=r(28521),a=function(){function e(t,r){var a=this;this.onStallSkip=new i.Emitter,this.onWarning=new i.Emitter,this._onTimerUpdate=function(){var t=a._inject.getPlayerState(),r=null==t?void 0:t.videoState;if(void 0!==a._stallSkipTime&&(null==r?void 0:r.currentTime)!==void 0&&a._stallSkipTime!==r.currentTime&&(a._system.logInfo("no longer stalled at ".concat(a._stallSkipTime," (now at ").concat(r.currentTime,")")),a._stallSkipTime=void 0),void 0===t||void 0===r||0===r.playbackRate||1!==r.readyState||void 0===r.buffered||r.currentTime===a._stallSkipTime||!a._haveBufferedAhead(r.buffered,r.currentTime)){a._observedStalledTicks=0;return}if(a._observedStalledTicks>=e.STALLED_TICKS_TO_ATTEMPT_MITIGATION){var i=r.currentTime;a.onWarning.emit(new o.WarningError("stalled for ".concat(a._observedStalledTicks," ticks at ").concat(i))),a._stallSkipTime=i,a.onStallSkip.emit({currentTime:i}),a._observedStalledTicks=0}else a._stallSkipTime=void 0,a._observedStalledTicks++},this._system=t,this._observedStalledTicks=0,this._inject=r,this._timer=new n.Timer(t,this._onTimerUpdate)}return e.prototype.start=function(){this._observedStalledTicks=0,this._timer.tickEvery(e.TIMER_UPDATE_SECONDS)},e.prototype.stop=function(){this._timer.stop()},e.prototype._haveBufferedAhead=function(t,r){var i=this._inject.getCurrentPeriodRange(),n=Math.min(r+e.BUFFERED_AHEAD_THRESHOLD_SECONDS,void 0!==i?Math.max(i.end-.5,0):1/0);return t.some(function(e){return e.start<=r&&e.end>r&&e.start<=n&&e.end>n})},e.TIMER_UPDATE_SECONDS=.5,e.BUFFERED_AHEAD_THRESHOLD_SECONDS=7,e.STALLED_TICKS_TO_ATTEMPT_MITIGATION=5,e}();t.StallSkippingController=a},69052:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StallTrackingController=void 0;var i=r(47632),n=r(53282),o=r(74436),a=function(){function e(e,t,r,o){var a=this;this.onStallErrorTimeExceeded=new i.Emitter,this.onStallMitigationTimeExceeded=new i.Emitter,this._afterStallMitigationThreshold=function(){a._handleAfterStallTimerAction(a.onStallMitigationTimeExceeded,a._stallTimeMitigationThresholdSeconds)},this._afterStallErrorThreshold=function(){a._handleAfterStallTimerAction(a.onStallErrorTimeExceeded,a._stallTimeErrorThresholdSeconds)},this._system=e,this._inject=t,this._stallErrorTimer=new n.Timer(e,function(){return a._afterStallErrorThreshold()}),this._stallMitigationTimer=new n.Timer(e,function(){return a._afterStallMitigationThreshold()}),this._stallTimeErrorThresholdSeconds=r,this._stallTimeMitigationThresholdSeconds=o}return e.prototype.start=function(){var e=this;this._inject.onPlayerStateChange.on(this,function(t){var r;"STALLED"===t.playbackState&&"STALLED"!==e._lastKnownState?(e._startTimers(),e._timeFirstObserved=Date.now(),e._stalledAt=null===(r=t.videoState)||void 0===r?void 0:r.currentTime):"STALLED"!==t.playbackState&&"STALLED"===e._lastKnownState&&e._stopTimers(),e._lastKnownState=t.playbackState})},e.prototype.stop=function(){this._stopTimers(),this._inject.onPlayerStateChange.off(this)},e.prototype.restart=function(){var e,t=this._inject.getPlayerState();"STALLED"===t.playbackState&&(this._startTimers(),this._timeFirstObserved=Date.now(),this._stalledAt=null===(e=t.videoState)||void 0===e?void 0:e.currentTime)},e.prototype._startTimers=function(){this._stallTimeMitigationThresholdSeconds>0&&this._stallErrorTimer.tickAfter(this._stallTimeErrorThresholdSeconds),this._stallTimeErrorThresholdSeconds>0&&this._stallMitigationTimer.tickAfter(this._stallTimeMitigationThresholdSeconds)},e.prototype._stopTimers=function(){this._stalledAt=void 0,this._stallErrorTimer.stop(),this._stallMitigationTimer.stop()},e.prototype._handleAfterStallTimerAction=function(e,t){var r=this._inject.getPlayerState(),i=null==r?void 0:r.videoState;if((null==r?void 0:r.stallReason)===o.StallReason.NOT_STALLED&&(null==i?void 0:i.currentTime)!==void 0&&void 0!==this._stalledAt){this._system.logVerbose("No longer stalled at ".concat(this._stalledAt,". Now at ").concat(i.currentTime,"."));return}if(void 0!==r&&void 0!==i&&void 0!==i.buffered&&void 0!==i.currentTime){var n={timeFirstObserved:this._timeFirstObserved,currentTime:Date.now(),stallThreshold:t,videoCurrentTime:i.currentTime,stallReason:r.stallReason};e.emit(n)}},e}();t.StallTrackingController=a},19603:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BufferRetryHandler=void 0;var i=r(22970),n=r(27574),o=r(43495),a=r(57665),s=r(19808),u=r(67179),c=r(61054),d=r(54965),l=function(){function e(e,t){this._logger=e,this._playerUtil=new n.PlayerUtil,this._codecUtil=new u.CodecUtil,this._retryLogic={retryCount:6,timeoutMS:6e3,progressTimeoutMS:0,maxRequestTimeMS:16e3},this._retryDataMap=new d.Map,this._getBufferItem=t.getBufferItem,this._getVariants=t.getVariants}return Object.defineProperty(e.prototype,"timeoutMS",{get:function(){var e;return null!==(e=this._retryLogic.timeoutMS)&&void 0!==e?e:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"progressTimeoutMS",{get:function(){var e;return null!==(e=this._retryLogic.progressTimeoutMS)&&void 0!==e?e:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"retryData",{get:function(){return this._retryDataMap},set:function(e){this._retryDataMap=e},enumerable:!1,configurable:!0}),e.prototype.overrideDefaultRetryLogic=function(e){void 0!==e.retryCount&&e.retryCount<0&&this._logger.logWarn("An invalid retry count value of ".concat(e.retryCount," was configured.")),this._retryLogic=i.__assign(i.__assign({},this._retryLogic),e)},e.prototype.delete=function(e){this._retryDataMap.delete(e)},e.prototype.clear=function(){this._retryDataMap.clear()},e.prototype.onSegmentDownloadFailed=function(e){var t;return i.__awaiter(this,void 0,void 0,function(){var r,n,o,a,s;return i.__generator(this,function(i){switch(i.label){case 0:if(void 0!==this._retryLogic.maxRequestTimeMS&&e.downloadStartTimesMS.length>0&&this._retryLogic.maxRequestTimeMS>0&&(r=Date.now())-e.downloadStartTimesMS[0]>this._retryLogic.maxRequestTimeMS){if(n="Failed to retry segment, the configured maxRequestTimeMS (".concat(this._retryLogic.maxRequestTimeMS,") has been exceeded (").concat(e.downloadStartTimesMS.join(",")," t=").concat(r,"). "),void 0!==(o=this._generateSegmentRetryFailedError(e,n)))throw o;throw new c.SegmentRetryFailedError(n)}return this._retryDataMap.contains(e)||this._retryDataMap.set(e,null!==(t=this._retryLogic.retryCount)&&void 0!==t?t:0),[4,this._getFallbackSegment(e)];case 1:if(a=i.sent(),void 0===(s=this._getBufferItem(e)))return this._logger.logWarn("Buffer item is no longer in current buffer time range."),[2,!1];if(void 0===a&&(a=this._getRetrySegment(e)),void 0!==a)return e.phases.reset(),e.processing=!1,e.error=void 0,e.segment=a.segment,s.stream=a.details,s.variant=a.variant,[2,!0];if(void 0!==(o=this._generateSegmentRetryFailedError(e,"No retry or fallback segment found")))throw o;return[2,!1]}})})},e.prototype._getRetrySegment=function(e){var t=this._retryDataMap.tryGet(e),r=this._getBufferItem(e);if(void 0!==r&&void 0!==t&&t>0)return this._retryDataMap.set(e,t-1),{segment:r.pipelineState.segment,variant:r.variant,details:r.stream}},e.prototype._getFallbackSegment=function(e){var t;return i.__awaiter(this,void 0,void 0,function(){var r,n,s,u,d,l;return i.__generator(this,function(i){switch(i.label){case 0:if(r=this._retryDataMap.tryGet(e),n=this._getBufferItem(e),a.WrappedError.causedBy(e.error,o.NoProgressMadeError.NAME)&&this._logger.logWarn("FallbackDueToNoProgressError: ".concat(null===(t=e.error)||void 0===t?void 0:t.toString())),void 0!==n)return[3,1];throw new c.SegmentRetryFailedError("Failed to get fallback segment, because the buffer item is no longer valid.");case 1:if(!(void 0!==r&&r>0))return[3,3];if(void 0===(s=this._getFallbackVariant(n.variant,this._getVariants(n.period))))return[2];return[4,s.getDetails()];case 2:if(u=i.sent(),void 0===(d=this._playerUtil.getStream(u,n.stream.type)))return[2];if(void 0!==(l=this._playerUtil.getSegmentByTime(d.segments,e.segment.start))&&void 0!==this._getBufferItem(e))return n.blockedSegmentIds.add(n.pipelineState.segment.id),this._retryDataMap.set(e,r-1),[2,{details:d,variant:u,segment:l}];i.label=3;case 3:return[2]}})})},e.prototype._getFallbackVariant=function(e,t){var r=t.getFirst();return r.bandwidth<e.bandwidth?r:void 0},e.prototype._generateSegmentRetryFailedError=function(e,t){var r,i,n=this._getBufferItem(e);if(void 0!==n&&void 0!==e.error){var u="".concat(this._codecUtil.getCodecGroup(n.stream),"@").concat(n.stream.bandwidth),d="".concat(e.start,"-").concat(e.end),l=null!==(r=a.WrappedError.findFirst(e.error,o.NoProgressMadeError))&&void 0!==r?r:a.WrappedError.findFirst(e.error,s.OperationTimedOutError);if(void 0===l)i=new c.SegmentRetryFailedError("".concat(t," for stream ").concat(u," at time ").concat(d,"."),e.error);else{var h=l.readyState,p="with XHR readyState=".concat(h);void 0!==l.percentDownloaded&&(p+=" after downloading ".concat(l.percentDownloaded,"% of the segment")),i=new c.SegmentRetryFailedError("".concat(t," for stream ").concat(u," at time ").concat(d," ").concat(p,"."),e.error)}return i}},e}();t.BufferRetryHandler=l},31246:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultBufferLogic=void 0;var i=r(65533),n=r(29368),o=function(){function e(){this._timeRangeUtil=new n.TimeRangeUtil,this._pipelineUtil=new i.SegmentPipelineWorkerUtil}return e.prototype.applyToPipelines=function(e){this._applyAppendRegionToPipelines(e),this._applyOrderToPipelines(e),this._applyDownloadRegionToPipelines(e)},e.prototype._applyAppendRegionToPipelines=function(e){for(var t=e.getAppendRegions(),r=0,i=e.getActivePipelines();r<i.length;r++){for(var n=i[r].active.getAllRanges(),o=this._timeRangeUtil.getInsideOf(n,t),a=this._timeRangeUtil.getOutsideOf(n,o),s=0;s<a.length;s++)a[s].allowAppend=!1;this._applySequentialAppend(e,o)}},e.prototype._applyOrderToPipelines=function(e){for(var t=e.getAppendRegions(),r=0,i=e.getActivePipelines();r<i.length;r++){for(var n=i[r],o=0,a=n.active.getAllRanges(),s=this._timeRangeUtil.getInsideOf(a,t),u=this._timeRangeUtil.getOutsideOf(a,t),c=0;c<s.length;c++){var d=s[c];d.order=o++}for(var l=0;l<u.length;l++){var d=u[l];d.order=o++}}},e.prototype._applyDownloadRegionToPipelines=function(e){for(var t,r,i=e.getAppendRegions(),n=[],o=[],a=[],s=[],u=[],c=!0,d=0,l=e.getActivePipelines();d<l.length;d++){var h=l[d].active.getAllRanges().slice(),p=this._timeRangeUtil.getInsideOf(h,i),f=this._timeRangeUtil.getOutsideOf(h,i),_=null!==(t=this._getLastBufferedItem(p))&&void 0!==t?t:p[0],v=null!==(r=this._getLastBufferedItem(f))&&void 0!==r?r:f[0];n.push(h),o.push(p),a.push(f),s.push(_),u.push(v),c=c&&_===p[p.length-1]}for(var m=0;m<n.length;m++)for(var g=n[m],y=0;y<g.length;y++)g[y].allowDownload=!1;for(var S=0;S<o.length;S++){var p=o[S];this._applyThrottledSequentialBuffering(e,p,s)}if(c)for(var E=0;E<o.length;E++)this._applyThrottledSequentialBuffering(e,a[E],u)},e.prototype._getLastBufferedItem=function(e){for(var t=e.length-1;t>=0;t--)if(this._pipelineUtil.isDownloaded(e[t]))return e[t]},e.prototype._applySequentialAppend=function(e,t){for(var r=[],i=0;i<t.length;i++){var n=t[i];n.allowAppend=!1,e.isSegmentAppendable(n)&&r.push(n)}for(var o=0;o<r.length;o++){var a=r[o],s=r[o-1],u=!0;void 0!==s&&u&&(u=s.phases.has("AppendCompleted")),a.allowAppend=u}},e.prototype._applyThrottledSequentialBuffering=function(t,r,i){for(var n=e.DEFAULT_RUNAWAY_SECONDS,o=0;o<r.length;o++){var a=r[o],s=r[o-1],u=t.isSegmentUsable(a);if(u&&void 0!==s){u=this._pipelineUtil.isDownloaded(s);for(var c=0;c<i.length;c++){var d=i[c];void 0!==d&&s.start-d.end>n&&(u=!1)}}a.allowDownload=u}},e.DEFAULT_RUNAWAY_SECONDS=6,e}();t.DefaultBufferLogic=o},28161:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaSourceController=void 0;var i=r(22970),n=r(58269),o=r(94306),a=r(29368),s=r(65533),u=r(76008),c=r(77539),d=r(47632),l=r(6246),h=r(64215),p=function(){function e(e){this._pipelines=[],this._timeRangeUtil=new a.TimeRangeUtil,this._pipelineUtil=new s.SegmentPipelineWorkerUtil,this._textEnabled=!1,this.onTextChange=new d.Emitter,this.onWarning=new d.Emitter,this._system=e}return e.cleanDrained=function(e){e.forEach(function(e,t){n.SegmentPipeline.cleanDrained(t)})},e.prototype.destroy=function(){this._pipelines.forEach(function(e){return e.destroy()})},e.prototype.getMediaSource=function(){return this._mediaSource},e.prototype.getPipelines=function(){return this._pipelines},e.prototype.getPipeline=function(e){return this._pipelines.filter(function(t){return t.type===e})[0]},e.prototype.getPipelineItems=function(e){for(var t=[],r=this.getPipelines(),i=0;i<r.length;i++)for(var n=r[i].active.getAllRanges(),o=0;o<n.length;o++){var a=n[o];if(a.start<=e&&a.end>e){t.push(a);break}}return t},e.prototype.setTextEnabled=function(e){void 0===e&&(e=!0),this._textEnabled=e},e.prototype.drainDownloaded=function(){for(var e=new o.HashMap,t=this.getPipelines(),r=0;r<t.length;r++){var i=t[r];if(!e.contains(i.type)){var n=i.drainDownloaded();e.set(i.type,i.drainFromCache(n))}}return e},e.prototype.fillFromDrain=function(t){for(var r=this.getPipelines(),i=0;i<r.length;i++){var n=r[i],o=t.tryGet(n.type);t.delete(n.type),void 0!==o&&n.fillFromDrain(o)}0!==t.getCount()&&e.cleanDrained(t)},e.prototype.attach=function(e){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return this._mediaSource=e,[4,Promise.all(this._pipelines.map(function(e){return e.attach()}))];case 1:return t.sent(),[2]}})})},e.prototype.detach=function(){this._pipelines.map(function(e){return e.detach()}),this._mediaSource=void 0},e.prototype.getReadyRegions=function(e,t){void 0===t&&(t=new l.HashSet(["video","audio","text"])),!this._textEnabled&&t.has("text")&&t.delete("text");for(var r=this.getPipelines(),i=0;i<r.length;i++){var n=r[i];if(t.has(n.type)){for(var o=[],a=n.active.getAllRanges(),s=0;s<a.length;s++){var u=a[s];this._pipelineUtil.isAppended(u)&&o.push({start:u.start,end:u.end})}e=this._timeRangeUtil.getInsideOf(o,e)}}return this._timeRangeUtil.merge(e)},e.prototype.makePipeline=function(e,t,r,o){return i.__awaiter(this,void 0,void 0,function(){var a,s=this;return i.__generator(this,function(i){switch(i.label){case 0:if(void 0!==(a=this.getPipeline(e)))return[3,2];return a=new n.SegmentPipeline(this._system,e,{generateSource:function(t){return s._generateSourceBufferForPipeline(e,t,r)},removeSource:function(e){return s._removeSourceBufferForPipeline(e)}},o),this._pipelines.push(a),[4,a.attach()];case 1:i.sent(),i.label=2;case 2:return[4,a.setSourceType(t)];case 3:return i.sent(),[2,a]}})})},e.prototype._generateSourceBufferForPipeline=function(e,t,r){return i.__awaiter(this,void 0,void 0,function(){var n,o,a,s=this;return i.__generator(this,function(i){switch(i.label){case 0:if("text"!==e)return[3,1];return t.mimeType===h.ContainerConstants.DEFAULT_TEXT_MIME_TYPE&&(n=new c.TextSourceBuffer(this._system,t.codecs)),[3,3];case 1:if(!(void 0!==this._mediaSource))return[3,3];return[4,this._mediaSource.addSourceBuffer(e,t.mimeType,t.codecs,r)];case 2:o=i.sent(),a=new u.SegmentSourceBuffer(this._system,o),r&&a.attachEmbeddedCaptions(),n=a,i.label=3;case 3:return null==n||n.onTextChange.on(this,function(e){return s.onTextChange.emit(e)}),null==n||n.onWarning.on(this,function(e){return s.onWarning.emit(e)}),[2,n]}})})},e.prototype._removeSourceBufferForPipeline=function(e){e.onTextChange.off(this),e.onWarning.off(this),void 0!==this._mediaSource&&e instanceof u.SegmentSourceBuffer&&e.detachEmbeddedCaptions()},e}();t.MediaSourceController=p},50595:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DynamicManifestWorker=void 0;var i=r(22970),n=r(5966),o=r(47632),a=r(57665),s=r(95645),u=r(27574),c=r(28210),d=r(34855),l=r(15302),h=r(69964),p=r(17395),f=function(){function e(e,t,r){var i=this;this.onError=new o.Emitter,this.onSuccess=new o.Emitter,this._arrayUtil=new h.ArrayUtil,this._playerUtil=new u.PlayerUtil,this._manifestUtil=new c.ManifestUtil,this._mergePending=!1,this._disposed=!1,this._manifestLoad=t,this._current=t.getManifest(),this._controller=r,this._system=e,this._ticker=new n.DelayedTick(e,function(){d.PromiseUtil.catchRejection(function(){return i.update()},function(e){i.onError.emit(a.WrappedError.wrap(e))})})}return e.prototype.start=function(){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:if(this._disposed)throw new l.InvalidOperationError("Calling start on disposed DynamicManifestWorker");return[4,this._offsetPeriods(this._current.periods)];case 1:return e.sent(),this._startInternal(),[2]}})})},e.prototype.update=function(){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){if(this._disposed)throw new l.InvalidOperationError("Calling start on disposed DynamicManifestWorker");return this._mergePending=!0,void 0===this._mergePromise&&(this._mergePromise=this._updateInternal()),[2,this._mergePromise]})})},e.prototype.destroy=function(){this.onError.off(),this.onSuccess.off(),this._ticker.stop(),this._disposed=!0},e.prototype._updateInternal=function(){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,,2,3]),[4,this._mergeManifests()];case 1:return e.sent(),[3,3];case 2:return this._mergePromise=void 0,[7];case 3:return[2]}})})},e.prototype._startInternal=function(){var e=this;this._ticker.stop();var t=this._current.dynamicInfo;void 0===t||this._disposed||d.PromiseUtil.catchRejection(function(){return e._ticker.tickAfter(t.minUpdateSeconds)},function(t){e.onError.emit(a.WrappedError.wrap(t))})},e.prototype._mergeStream=function(e,t){return i.__awaiter(this,void 0,void 0,function(){var r,n,o;return i.__generator(this,function(i){switch(i.label){case 0:return[4,Promise.all([this._getStreamDetails(e),this._getStreamDetails(t)])];case 1:if(n=(r=i.sent())[0],o=r[1],void 0===n||void 0===o)return[2];return n.drmInfo=o.drmInfo,n.segments.refresh(o.segments),[2]}})})},e.prototype._mergePeriod=function(e,t){return i.__awaiter(this,void 0,void 0,function(){var r,n,o,a,u,c,d,l,h,p=this;return i.__generator(this,function(i){switch(i.label){case 0:if(r=e.audio,n=e.video,o=e.text,a=e.image,u=t.audio,c=t.video,d=t.text,l=t.image,r.length!==u.length||n.length!==c.length||o.length!==d.length||a.length!==l.length)throw new s.UnsupportedError("variant mismatch within periods in live content, had "+"".concat(r.length,"->").concat(u.length," audio, ")+"".concat(n.length,"->").concat(c.length," video")+"".concat(o.length,"->").concat(d.length," text")+"".concat(a.length,"->").concat(l.length," image"));return h=[],e.audio.forEach(function(e,r){var i=t.audio[r];h.push(p._mergeStream(e,i))}),e.video.forEach(function(e,r){var i=t.video[r];h.push(p._mergeStream(e,i))}),e.text.forEach(function(e,r){var i=t.text[r];h.push(p._mergeStream(e,i))}),e.image.forEach(function(e,r){var i=t.image[r];h.push(p._mergeStream(e,i))}),[4,Promise.all(h)];case 1:return i.sent(),[2]}})})},e.prototype._offsetPeriods=function(e,t){return i.__awaiter(this,void 0,void 0,function(){var r,n,o;return i.__generator(this,function(i){switch(i.label){case 0:r=0,n=e,i.label=1;case 1:if(!(r<n.length))return[3,4];return o=n[r],void 0!==t&&this._offsetPeriodToPosition(o,t),[4,this._ensurePeriodRange(o)];case 2:t=i.sent().end,i.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype._offsetPeriodToPosition=function(e,t){this._offsetPeriodPerStream(e,{audio:t,video:t,text:t,image:t})},e.prototype._offsetPeriodPerStream=function(e,t){if(void 0!==t.audio)for(var r=0,i=e.audio;r<i.length;r++){var n=i[r];this._manifestUtil.setStreamPosition(n,t.audio)}if(void 0!==t.video)for(var o=0,a=e.video;o<a.length;o++){var n=a[o];this._manifestUtil.setStreamPosition(n,t.video)}if(void 0!==t.text)for(var s=0,u=e.text;s<u.length;s++){var n=u[s];this._manifestUtil.setStreamPosition(n,t.text)}if(void 0!==t.image)for(var c=0,d=e.image;c<d.length;c++){var n=d[c];this._manifestUtil.setStreamPosition(n,t.image)}},e.prototype._findStreamStartingPoint=function(e,t){if(void 0!==e&&void 0!==t){var r=t.segments.tryGetTiming(0),i=e.segments.tryGetTiming(0);if(void 0===r||void 0===i)throw new p.ManifestProcessingError("Failed to get timing information for first segment in current and updated details");var n=i.presentationTimeOffset-r.presentationTimeOffset;return r.start+n}},e.prototype._findStartingPoint=function(e,t){return i.__awaiter(this,void 0,void 0,function(){var r,n,o;return i.__generator(this,function(i){switch(i.label){case 0:return[4,Promise.all([this._ensureAtLeastOneStreamDetailsForPeriod(e),this._ensureAtLeastOneStreamDetailsForPeriod(t)])];case 1:return n=(r=i.sent())[0],o=r[1],[2,{audio:this._findStreamStartingPoint(n.audio,o.audio),video:this._findStreamStartingPoint(n.video,o.video),text:this._findStreamStartingPoint(n.text,o.text),image:this._findStreamStartingPoint(n.image,o.image)}]}})})},e.prototype._getAllDetails=function(e){for(var t=[],r=0,i=e.audio;r<i.length;r++){var n=i[r];t.push(this._getStreamDetails(n))}for(var o=0,a=e.video;o<a.length;o++){var n=a[o];t.push(this._getStreamDetails(n))}for(var s=0,u=e.text;s<u.length;s++){var n=u[s];t.push(this._getStreamDetails(n))}for(var c=0,d=e.image;c<d.length;c++){var n=d[c];t.push(this._getStreamDetails(n))}return Promise.all(t)},e.prototype._updateExistingPeriod=function(e,t){return i.__awaiter(this,void 0,void 0,function(){var r;return i.__generator(this,function(i){switch(i.label){case 0:return[4,Promise.all([this._getAllDetails(e),this._getAllDetails(t)])];case 1:return i.sent(),[4,this._findStartingPoint(e,t)];case 2:return r=i.sent(),this._offsetPeriodPerStream(t,r),[4,this._mergePeriod(e,t)];case 3:return i.sent(),this._offsetPeriodPerStream(e,r),[2]}})})},e.prototype._addPeriods=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r;return i.__generator(this,function(i){switch(i.label){case 0:if(0===this._current.periods.length)throw new p.ManifestProcessingError("Attempting to add periods without having existing periods");return[4,this._ensurePeriodRange(this._current.periods[this._current.periods.length-1])];case 1:return t=i.sent(),[4,this._offsetPeriods(e,t.end)];case 2:return i.sent(),(r=this._current.periods).push.apply(r,e),[2]}})})},e.prototype._updatePeriods=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,n,o;return i.__generator(this,function(i){switch(i.label){case 0:return t=e.currentFirstPeriod,r=e.previousLastPeriod,n=[],void 0!==t&&((o=this._arrayUtil.findFirstIndex(this._current.periods,function(e){return e.id===t.id}))>0&&this._current.periods.splice(0,o),n.push(this._updateExistingPeriod(this._current.periods[0],t))),void 0!==r&&t!==r&&n.push(this._updateExistingPeriod(this._current.periods[this._current.periods.length-1],r)),[4,Promise.all(n)];case 1:if(i.sent(),!(e.currentAddedPeriods.length>0))return[3,3];return[4,this._addPeriods(e.currentAddedPeriods)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},e.prototype._ensureAtLeastOneStreamDetailsForPeriod=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r;return i.__generator(this,function(i){switch(i.label){case 0:return[4,Promise.all([this._ensureAtLeastOneStreamDetails(e.audio),this._ensureAtLeastOneStreamDetails(e.video),this._ensureAtLeastOneStreamDetails(e.text),this._ensureAtLeastOneStreamDetails(e.image)])];case 1:return r=(t=i.sent())[0],[2,{audio:r,video:t[1],text:t[2],image:t[3]}]}})})},e.prototype._ensureAtLeastOneStreamDetails=function(e){if(0!==e.length){for(var t=0;t<e.length;t++){var r=e[t].getCachedDetails();if(void 0!==r)return r}return this._getStreamDetails(e[0])}},e.prototype._getStreamDetails=function(e){if(void 0!==e){var t=e.getCachedDetails();return void 0===t?e.getDetails():t}},e.prototype._ensurePeriodRange=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r;return i.__generator(this,function(i){switch(i.label){case 0:if(void 0!==(t=this._playerUtil.getRangeOfPeriod(e)))return[2,t];return[4,this._ensureAtLeastOneStreamDetails(e.video)];case 1:if(r=i.sent(),void 0===(t=this._playerUtil.getRangeOfStream(r)))throw new s.UnsupportedError("Could not get period range for id=".concat(e.id," after getting audio/video details"));return[2,t]}})})},e.prototype._mergeManifests=function(){return i.__awaiter(this,void 0,void 0,function(){var e,t,r,n,o,s,u;return i.__generator(this,function(i){switch(i.label){case 0:if(!(this._mergePending&&!this._disposed))return[3,6];this._mergePending=!1,i.label=1;case 1:return i.trys.push([1,4,,5]),e=new Date().getTime(),[4,this._manifestLoad.refresh(this._current.periods)];case 2:return t=i.sent(),this._system.logVerbose("refreshed live manifest in "+(new Date().getTime()-e)),r=new Date().getTime(),[4,this._updatePeriods(t)];case 3:for(i.sent(),this._current.dynamicInfo=t.dynamicInfo,n=0,o=[t.currentFirstPeriod,t.previousLastPeriod];n<o.length;n++){if(void 0===(s=o[n]))return[2];this._playerUtil.iteratePeriodStreams(s,function(e){e.clearCachedDetails()}),s.audio.length=0,s.video.length=0,s.text.length=0,s.image.length=0}return this._controller.requireBufferUpdate(),this._system.logVerbose("merged with latest live manifest in "+(new Date().getTime()-r)),this.onSuccess.emit(),[3,5];case 4:return u=i.sent(),this.onError.emit(a.WrappedError.wrap(u)),[3,5];case 5:return[3,0];case 6:return this._startInternal(),[2]}})})},e}();t.DynamicManifestWorker=f},63775:function(e,t,r){"use strict";t.N=void 0;var i=r(22970),n=r(75855),o=r(15942),a=r(86922),s=r(57665),u=r(16590),c=r(47632),d=r(78082),l=r(50595),h=r(59587),p=r(63210),f=r(25014),_=r(69964),v=r(35509),m=function(){function e(t,r){var i,n;void 0===r&&(r={}),this._metricBus=new o.MetricBus,this._textEnabled=!1,this._appendRegions=[],this._bufferRegions=[],this._arrayUtil=new _.ArrayUtil,this._currentDynamicRefreshFailures=0,this._isFirstSegmentAppended=!1,this.allowedDynamicRefreshFailures=e.DEFAULT_LIVE_ALLOWED_REFRESH_FAILURES,this.onError=new c.Emitter,this.onWarning=new c.Emitter,this._options=r,this._systemInterface=t,this._analytics=new a.AnalyticsSession(this._options.analyticsOptions),this._trackPreferences=null!==(i=this._options.trackPreferences)&&void 0!==i?i:[],this.allowedDynamicRefreshFailures=null!==(n=this._options.allowedDynamicRefreshFailures)&&void 0!==n?n:this.allowedDynamicRefreshFailures,void 0!==this._options.variantSelector?this._variantSelector=this._options.variantSelector:this._variantSelector=new u.ForecastVariantSelector(this._options.abrOptions)}return e.prototype.isRestrictedToAAC=function(){var e,t;if((null===(t=null===(e=this._loadedData)||void 0===e?void 0:e.init)||void 0===t?void 0:t.audioGroupOrder)!==void 0&&this._loadedData.init.audioGroupOrder.length>0){for(var r=0,i=this._loadedData.init.audioGroupOrder;r<i.length;r++){var n=i[r];if("aac"!==n&&"heaac"!==n)return!1}return!0}return!1},Object.defineProperty(e.prototype,"analytics",{get:function(){return this._analytics},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metricBus",{get:function(){return this._metricBus},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"variantSelector",{get:function(){return this._variantSelector},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLive",{get:function(){var e;return(null===(e=this._loadedData)||void 0===e?void 0:e.manifest.getManifest().dynamicInfo)!==void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"capVariantsToSize",{get:function(){var e;return(null===(e=this._options.variantsToSizeOptions)||void 0===e?void 0:e.capToSize)===!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cmcd",{get:function(){return this._options.cmcd},enumerable:!1,configurable:!0}),e.prototype.getLoadedBuffer=function(){var e;return null===(e=this._loadedData)||void 0===e?void 0:e.buffer},e.prototype.getLoadedData=function(){return this._loadedData},e.prototype.getContentRange=function(){var e;return null===(e=this._loadedData)||void 0===e?void 0:e.buffer.getContentRange()},e.prototype.emitCurrentBandwidthEstimate=function(){this.metricBus.bandwidthEstimation.emit(this._variantSelector.getCurrentBandwidthEstimate())},e.prototype.getLiveEdge=function(){var t,r,i=null===(t=this._loadedData)||void 0===t?void 0:t.manifest.getManifest().dynamicInfo,n=this.getContentRange();if(void 0!==i&&void 0!==n)return n.end-(null!==(r=i.suggestedPresentationDelaySeconds)&&void 0!==r?r:e.DEFAULT_LIVE_DELAY_SECONDS)},e.prototype.getLiveStart=function(){var e,t=null===(e=this._loadedData)||void 0===e?void 0:e.manifest.getManifest().dynamicInfo,r=this.getContentRange();if(void 0!==t&&void 0!==r)return r.start},e.prototype.getLiveEnd=function(){var e,t,r=this.getContentRange(),i=null===(t=null===(e=this._loadedData)||void 0===e?void 0:e.manifest.getManifest().dynamicInfo)||void 0===t?void 0:t.publishedTime;if(void 0!==i&&void 0!==r)return r.end+(Date.now()/1e3-i)},e.prototype.isLiveEnd=function(e){var t,r=this.getLiveEdge(),i=null===(t=this._loadedData)||void 0===t?void 0:t.manifest.getManifest().dynamicInfo;return void 0!==r&&void 0!==i&&r-e<i.minUpdateSeconds},e.prototype.getLivePresentationStartTime=function(){var e,t;return null===(t=null===(e=this._loadedData)||void 0===e?void 0:e.manifest.getManifest().dynamicInfo)||void 0===t?void 0:t.presentationStartTime},e.prototype.setPlayerVitals=function(e){this._playerVitals=e},e.prototype.setAppendPeriod=function(e){var t;this._period=e,null===(t=this._loadedData)||void 0===t||t.buffer.setAppendPeriod(e)},e.prototype.getAppendPeriod=function(){return this._period},e.prototype.setTextEnabled=function(e){var t;void 0===e&&(e=!0),this._textEnabled=e,null===(t=this._loadedData)||void 0===t||t.buffer.setTextEnabled(e)},e.prototype.setAppendRegions=function(e){var t;this._appendRegions=e,null===(t=this._loadedData)||void 0===t||t.buffer.setAppendRegions(e)},e.prototype.setBufferRegions=function(e){var t;this._bufferRegions=e,null===(t=this._loadedData)||void 0===t||t.buffer.setBufferRegions(e)},e.prototype.getTrackPreferences=function(){return void 0!==this._loadedData?this._loadedData.buffer.getTrackPreferences():this._trackPreferences},e.prototype.setTrackPreferences=function(e){var t;return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(r){switch(r.label){case 0:return this._trackPreferences=e,[4,null===(t=this._loadedData)||void 0===t?void 0:t.buffer.setTrackPreferences(this._trackPreferences)];case 1:return r.sent(),[2]}})})},e.prototype.setVideoSize=function(e){var t,r;null===(t=this._videoSizeVariantFilter)||void 0===t||t.setVideoElementSize(e),null===(r=this._loadedData)||void 0===r||r.buffer.invalidateAllVariants(["VideoSizeVariantFilter"]),this._systemInterface.logVerbose("Invalidating filtered variants due to video size change ".concat(e.width,"x").concat(e.height))},e.prototype.removeDrm=function(){var e;return null===(e=this._loadedData)||void 0===e?void 0:e.buffer.removeDrm()},e.prototype.drainDownloaded=function(){var e,t,r=null===(e=this._loadedData)||void 0===e?void 0:e.buffer.drainDownloaded();if(void 0!==r)return i.__assign(i.__assign({},r),{init:null===(t=this._loadedData)||void 0===t?void 0:t.init})},e.prototype.load=function(e,t){var r;return i.__awaiter(this,void 0,void 0,function(){var o,a,u,c,d=this;return i.__generator(this,function(i){switch(i.label){case 0:if(void 0!==this._loadedData)return[3,9];i.label=1;case 1:return i.trys.push([1,7,,9]),this._registerMetricsAnalytics(),this._trackPreferences=null!==(r=null==t?void 0:t.trackPreferences)&&void 0!==r?r:this._trackPreferences,a=this,[4,this._createBuffer(e,t)];case 2:if(a._loadedData=i.sent(),this._loadedData.manifest.onWarning.off(this),this._loadedData.manifest.onWarning.on(this,function(e){return d.onWarning.emit(e)}),u=this._loadedData.manifest.getManifest().url,this._systemInterface.logInfo("Loading Playback Session with ManifestUrl: ".concat(u.toString())),!(void 0!==this._loadedData.manifest.getManifest().dynamicInfo))return[3,4];return this._currentDynamicRefreshFailures=0,this._variantSelector.setIsLive(!0),this._loadedData.dynamicManifestWorker=new l.DynamicManifestWorker(this._systemInterface,this._loadedData.manifest,this._loadedData.buffer),this._loadedData.dynamicManifestWorker.onError.on(this,function(e){d._currentDynamicRefreshFailures++,s.WrappedError.causedBy(e,v.InvalidDynamicManifestError.NAME)||d._currentDynamicRefreshFailures>d.allowedDynamicRefreshFailures?(d._currentDynamicRefreshFailures=0,d.onError.emit(e)):d.onWarning.emit(e)}),this._loadedData.dynamicManifestWorker.onSuccess.on(this,function(){d._currentDynamicRefreshFailures=0}),[4,this._loadedData.dynamicManifestWorker.start()];case 3:return i.sent(),[3,5];case 4:this._variantSelector.setIsLive(!1),i.label=5;case 5:return[4,this.applyBufferRegions()];case 6:return i.sent(),[3,9];case 7:return c=i.sent(),[4,this.unload()];case 8:throw i.sent(),c;case 9:if(void 0===this._loadedData)throw new n.PlayerNotLoadedError("Session failed to load",o);return[2,this._loadedData]}})})},e.prototype.unload=function(){var e,t,r,n,o;return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(i){switch(i.label){case 0:return void 0!==this._loadedData&&(this._trackPreferences=this._loadedData.buffer.getTrackPreferences(),this._loadedData.manifest.onWarning.off(this),this._loadedData.buffer.onError.off(this),this._loadedData.buffer.onWarning.off(this),this._loadedData.buffer.onBufferItemPhaseChange.off(this),this._loadedData.buffer.onSegmentDurationChanged.off(this),this._loadedData.buffer.onBufferCapacityChanged.off(this),this._loadedData.buffer.onBufferLevelChanged.off(this),this._loadedData.buffer.onSegmentRetry.off(this),null===(e=this._loadedData.dynamicManifestWorker)||void 0===e||e.destroy(),null===(t=this._loadedData.dynamicManifestWorker)||void 0===t||t.onError.off(this),null===(r=this._loadedData.dynamicManifestWorker)||void 0===r||r.onSuccess.off(this)),null===(n=this._videoSizeVariantFilter)||void 0===n||n.onWarning.off(this),[4,null===(o=this._loadedData)||void 0===o?void 0:o.buffer.destroy()];case 1:return i.sent(),this._removeMetricsAnalytics(),this._loadedData=void 0,[2]}})})},e.prototype.applyBufferRegions=function(){var e;return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return[4,null===(e=this._loadedData)||void 0===e?void 0:e.buffer.updateBufferRegions()];case 1:return t.sent(),[2]}})})},e.prototype._removeRegions=function(){return this.setAppendRegions([]),this.setBufferRegions([]),this.applyBufferRegions()},e.prototype._registerMetricsAnalytics=function(){var e=this,t=this._analytics.addGroup("bitrateChanged"),r=this._analytics.addGroup("availableBitrates"),i=this._analytics.addGroup("bandwidthEstimation"),n=this._analytics.addGroup("networkProgress");this._metricBus.bitrateChange.on(this,function(r){t.add(r),void 0!==e._playerVitals&&(e._playerVitals.onVideoOscillation(),e._playerVitals.add("FIRST_SEGMENT_APPENDED"))}),this._metricBus.bandwidthsChange.on(this,function(e){return r.add(e)}),this._metricBus.bandwidthEstimation.on(this,function(e){i.add(e)}),this._metricBus.playerState.on(this,function(t){e._variantSelector.handlePlaybackStateChange(t)}),this._systemInterface.networkProgressEvent.on(this,function(t){n.add(t),"video"===t.type&&e._variantSelector.onSegmentDownloaded(t.bytes,t.downloadTimeMS,t.latency,"media"===t.segmentContext.type?t.segmentContext:void 0)})},e.prototype._removeMetricsAnalytics=function(){this._metricBus.bitrateChange.off(this),this._metricBus.bandwidthsChange.off(this),this._metricBus.bandwidthEstimation.off(this),this._metricBus.playerState.off(this),this._systemInterface.networkProgressEvent.off(this)},e.prototype._createBuffer=function(e,t){var r,n,o,a,s;return i.__awaiter(this,void 0,void 0,function(){var u,c,l,_,v,m,g,y,S,E=this;return i.__generator(this,function(i){switch(i.label){case 0:return[4,Promise.all([this._systemInterface.getMediaKeySupport(),e,this._removeRegions()])];case 1:if(c=(u=i.sent())[0],l=u[1],_=null==t?void 0:t.audioGroupOrder,v=null==t?void 0:t.videoGroupOrder,(null==t?void 0:t.hydrateBuffer)===void 0||(this._arrayUtil.areEqual(null!=_?_:[],null!==(n=null===(r=t.hydrateBuffer.init)||void 0===r?void 0:r.audioGroupOrder)&&void 0!==n?n:[])||h.BufferController.clearDrainDataForStreamType(t.hydrateBuffer,"audio"),this._arrayUtil.areEqual(null!=v?v:[],null!==(a=null===(o=t.hydrateBuffer.init)||void 0===o?void 0:o.videoGroupOrder)&&void 0!==a?a:[])||h.BufferController.clearDrainDataForStreamType(t.hydrateBuffer,"video")),(m=new h.BufferController(this._systemInterface,l.getManifest().periods,this._metricBus,this._trackPreferences,this._variantSelector,this._options.bufferOptions,null==t?void 0:t.hydrateBuffer,this.cmcd)).setAppendPeriod(this._period),void 0!==this._options.variantsToSizeOptions&&(this._videoSizeVariantFilter=new f.VideoSizeVariantFilter(this._options.variantsToSizeOptions),this._videoSizeVariantFilter.onWarning.on(this,function(e){return E.onWarning.emit(e)}),m.addVariantFilter(this._videoSizeVariantFilter)),m.addVariantFilter(new p.CodecGroupVariantFilter(v,_)),m.setTextEnabled(this._textEnabled),m.setDrm(null!==(s=null==t?void 0:t.drm)&&void 0!==s?s:new d.DigitalRightsManagement(this._systemInterface)),void 0!==m.drm&&(m.drm.supportedMediaKeys=c),m.onBufferItemPhaseChange.on(this,function(e){void 0===E._playerVitals||E._isFirstSegmentAppended||"AppendCompleted"!==e.pipelineState.phases.getLastPhaseName()||(E._isFirstSegmentAppended=!0,E._playerVitals.add("FIRST_SEGMENT_APPENDED"))}),m.setAppendRegions(this._appendRegions),m.setBufferRegions(this._bufferRegions),void 0!==this._options.customVariantFilters)for(g=0,y=this._options.customVariantFilters;g<y.length;g++)S=y[g],m.addVariantFilter(S);return void 0!==this._options.bufferRetryLogic&&m.overrideDefaultRetryLogic(this._options.bufferRetryLogic),void 0!==this._options.drmOptions&&void 0!==m.drm&&(m.drm.options=this._options.drmOptions),void 0!==this._options.bufferLogic&&(m.bufferLogic=this._options.bufferLogic),m.onError.on(this,function(e){E.onError.emit(e)}),m.onWarning.on(this,function(e){return E.onWarning.emit(e)}),m.onSegmentDurationChanged.on(this,function(e){return E._variantSelector.setSegmentDurationSec(e)}),m.onBufferCapacityChanged.on(this,function(e){return E._variantSelector.setBufferCapacitySec(e)}),m.onBufferLevelChanged.on(this,function(e){return E._variantSelector.setBufferLevelSec(e)}),m.onSegmentRetry.on(this,function(){return E.variantSelector.handleSegmentRetry()}),[2,{manifest:l,init:t,buffer:m}]}})})},e.DEFAULT_LIVE_DELAY_SECONDS=10,e.DEFAULT_LIVE_ALLOWED_REFRESH_FAILURES=2,e}();t.N=m},63210:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CodecGroupVariantFilter=void 0;var i=r(94306),n=r(88309),o=r(67179),a=function(){function e(e,t){void 0===e&&(e=["dvh","hevc-hdr","hevc","avc"]),void 0===t&&(t=["ec-3-atmos","ec-3","ac-3","aac","heaac"]),this._videoGroupOrder=e,this._audioGroupOrder=t,this.id="Codec Group Variant Filter",this._codecUtil=new o.CodecUtil}return e.prototype.filterVariants=function(e){var t=new i.HashMap;this._addCodecGroupMap(e.audio,t),this._addCodecGroupMap(e.video,t);for(var r=0,n=this._audioGroupOrder;r<n.length;r++)for(var o=n[r],a=0,s=this._videoGroupOrder;a<s.length;a++){var u=s[a],c=this._getMatchingCodecGroups(o,t),d=this._getMatchingCodecGroups(u,t);if(c.length>0&&d.length>0)return{audio:c,video:d,text:e.text}}return e},e.prototype._getMatchingCodecGroups=function(e,t){var r=[],i=t.tryGet(e);return void 0!==i&&i.forEach(function(e){return r.push(e)}),r},e.prototype._addCodecGroupMap=function(e,t){for(var r=0;r<e.length;r++){var i=e[r],o=this._codecUtil.getCodecGroup(i);t.contains(o)||t.set(o,new n.Set),t.get(o).add(i)}},e}();t.CodecGroupVariantFilter=a},76018:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DigitalRightsVariantFilter=void 0;var i=r(19734),n=function(){function e(e){this.id="Digital Rights Variant Filter",this.buffer=e}return e.prototype.filterVariants=function(e){if(void 0===this.buffer.drm)return e;var t=this.buffer.drm.filterVariants(e.period,e),r=t.accepted,i=t.rejected;return this._lastRejectedStreams=i,r},e.prototype.getFilterError=function(e,t){var r=[];return(void 0!==this.buffer.drm&&void 0!==this._lastRejectedStreams&&this._lastRejectedStreams.getCount()>0&&this._lastRejectedStreams.forEach(function(e,t){7===t.reason&&r.push(e.id)}),r.length>0)?new i.CopyProtectionError("Restricted streams '".concat(r.join(","),"'"),t):t},e.prototype.getContextualInfo=function(e){if(void 0===this.buffer.drm)return"Digital Rights Management object not available.";var t="";void 0!==this._lastRejectedStreams&&this._lastRejectedStreams.getCount()>0&&(t+="Rejected Data:\n"+this.buffer.drm.aggregateRejectedData(this._lastRejectedStreams).map(function(e){return"    ".concat(e)}).join("\n")),t.length>0&&(t+="\n");var r=this.buffer.drm.getStatusMap();if(0===r.getCount())t+="No key status information available.";else{for(var i="Available Key Statuses:",n=0,o=r.values();n<o.length;n++){var a=o[n];i+="\n    ".concat(a.keyId,": ").concat(a.status)}t+=i}return void 0!==e.getContextualInfo&&(t+=e.getContextualInfo()),t},e}();t.DigitalRightsVariantFilter=n},16590:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ForecastVariantSelector=void 0;var i=r(81087),n=function(){function e(e){this._forecaster=new i.OptimalBitrateForecaster(e)}return e.prototype.getCurrentBandwidthEstimate=function(){return this._forecaster.getCurrentBandwidthEstimate()},e.prototype.getInitialBandwidth=function(){return this._forecaster.currentBitrate},e.prototype.getVariant=function(e){return this._forecaster.forecast(e)},e.prototype.getTopBitrateVariant=function(e){return this._forecaster.getTopBitrateVariant(e)},e.prototype.handlePlaybackStateChange=function(e){this._forecaster.handlePlaybackStateChange(e)},e.prototype.handleSegmentRetry=function(){this._forecaster.handleSegmentRetry()},e.prototype.onSegmentDownloaded=function(e,t,r,i){this._forecaster.onSegmentDownloaded(e,t,r,i)},e.prototype.setBufferCapacitySec=function(e){this._forecaster.setBufferCapacitySec(e)},e.prototype.setBufferLevelSec=function(e){this._forecaster.setBufferLevelSec(e)},e.prototype.setBitrateOverride=function(e){this._forecaster.override=e},e.prototype.setProtocol=function(e){this._forecaster.protocol=e},e.prototype.setSegmentDurationSec=function(e){this._forecaster.setSegmentDurationSec(e)},e.prototype.setIsLive=function(e){this._forecaster.setIsLive(e)},e}();t.ForecastVariantSelector=n},18233:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FramerateVariantFilter=void 0;var r=function(){function e(){this.id="Framerate Variant Filter"}return e.prototype.setVideoFramerate=function(e){this._videoFramerate=e},e.prototype.filterVariants=function(e){return this._filterVariantsToFramerate(e)},e.prototype._filterVariantsToFramerate=function(e){var t=this._videoFramerate,r=[];if(void 0===t)return e;for(var i=e.video.reduce(function(e,r){return void 0!==r.frameRate&&Math.abs(r.frameRate-t)<Math.abs(e-t)?r.frameRate:e},1/0),n=0,o=e.video;n<o.length;n++){var a=o[n];a.frameRate===i&&r.push(a)}return{video:0!==r.length?r:e.video,audio:e.audio,text:e.text}},e}();t.FramerateVariantFilter=r},16e3:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SupportedVariantFilter=void 0;var i=r(48360),n=r(67179),o=r(94306),a=function(){function e(e){this.id="Supported Variant Filter",this._mimeUtil=new i.MimeUtil,this._codecUtil=new n.CodecUtil,this._system=e}return e.prototype.filterVariants=function(e){var t=this,r=this._system.supportedHdrModes(),i=this._system.canPlayDolbyAtmos();return r instanceof Promise||i instanceof Promise?Promise.all([r,i]).then(function(r){var i=r[0],n=r[1];return t._filterVariants(e,i,n)}):this._filterVariants(e,r,i)},e.prototype._filterVariants=function(e,t,r){var i=this._getAudio(e.audio,r),n=this._getVideo(e.video,t);return i instanceof Promise||n instanceof Promise?Promise.all([i,n]).then(function(t){return{audio:t[0],video:t[1],text:e.text}}):{audio:i,video:n,text:e.text}},e.prototype._getAudio=function(e,t,r,i,n,a){var s=this;void 0===r&&(r=new o.HashMap),void 0===i&&(i=new o.HashMap),void 0===n&&(n=[]),void 0===a&&(a=0);for(var u=this;a<e.length;a++){var c=function(){var o=e[a],c=u.isAudioSupported(t,{stream:o,mimePromiseCache:r,mimeResultCache:i});if(c instanceof Promise)return{value:c.then(function(u){return u&&n.push(o),s._getAudio(e,t,r,i,n,a+1)})};c&&n.push(o)}();if("object"==typeof c)return c.value}return n},e.prototype._getVideo=function(e,t,r,i,n,a){var s=this;void 0===r&&(r=new o.HashMap),void 0===i&&(i=new o.HashMap),void 0===n&&(n=[]),void 0===a&&(a=0);for(var u=this;a<e.length;a++){var c=function(){var o=e[a],c=u.isVideoSupported(t,{stream:o,mimePromiseCache:r,mimeResultCache:i});if(c instanceof Promise)return{value:c.then(function(u){return u&&n.push(o),s._getVideo(e,t,r,i,n,a+1)})};c&&n.push(o)}();if("object"==typeof c)return c.value}return n},e.prototype.isAudioSupported=function(e,t){var r=t.stream;if(!e&&"ec-3-atmos"===this._codecUtil.getAudioGroup(r))return!1;var i=this._mimeUtil.getFullType(r.mimeType,r.codecs);return this._checkMimeSupport(i,t)},e.prototype.isVideoSupported=function(e,t){var r=t.stream,i=this._codecUtil.getVideoGroup(r);if(("dvh"===i||"hevc-hdr"===i)&&-1===e.indexOf(i))return!1;var n=this._mimeUtil.getFullType(r.mimeType,r.codecs);return this._checkMimeSupport(n,t)},e.prototype._checkMimeSupport=function(e,t){var r=t.mimeResultCache.tryGet(e);if(void 0!==r)return r;var i=t.mimePromiseCache.tryGet(e);if(void 0!==i)return i;var n=this._system.isTypeSupported(e);if(n instanceof Promise){var o=n.then(function(r){return t.mimeResultCache.set(e,r),r});return t.mimePromiseCache.set(e,o),o}return t.mimeResultCache.set(e,n),n},e}();t.SupportedVariantFilter=a},91689:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackPreferenceVariantFilter=void 0;var i=r(88269),n=r(47632),o=r(28521),a=function(){function e(){this.id="Track Preference Variant Filter",this._languageUtil=new i.LanguageUtil,this.onWarning=new n.Emitter,this._requiredAttributeMatches=29}return e.prototype.filterVariants=function(e){var t=this._getPreferenceMap(e.trackPreferences),r=this._getLanguageMap(e);return{audio:this._getFirstMatchingPreference("audio",e.audio,t.audios,r.audios),video:this._getFirstMatchingPreference("video",e.video,t.videos,r.videos),text:this._getFirstMatchingPreference("text",e.text,t.texts,r.texts)}},e.prototype._getFirstMatchingPreference=function(e,t,r,i){if(0===t.length)return t;for(var n=[],a=[],s=0;s<r.length;s++){var u=r[s],c=void 0;void 0===u.language&&void 0!==i&&(c=this._getDefaultLanguage(t));for(var d=0;d<t.length;d++){var l=t[d];this._isMatchingStream(u,l,i,c)&&(this._isMatchingStreamAttributes(u,l)?n.push(l):a.push(l))}if(n.length>0)return n;if(a.length>0)return a}return this.onWarning.emit(new o.WarningError("Unable to find matches for ".concat(e," preferences, falling back to all streams of this type!"))),t},e.prototype._isMatchingStream=function(e,t,r,i){var n,o=void 0!==t;if(void 0!==t){var a=null!==(n=e.language)&&void 0!==n?n:i;void 0!==a&&a.length>0&&void 0!==r&&o&&(o=this._languageUtil.fuzzyLanguageMatch(a,t.language,r)),void 0!==e.label&&e.label.length>0&&o&&(o=t.label===e.label)}return o},e.prototype._isMatchingStreamAttributes=function(e,t){var r,i=void 0!==t;if(void 0!==t){var n=(null!==(r=e.attributes)&&void 0!==r?r:0)&this._requiredAttributeMatches,o=t.attributes&this._requiredAttributeMatches;i&&(i=n===o)}return i},e.prototype._getPreferenceMap=function(e){for(var t=[],r=[],i=[],n=0;n<e.length;n++){var o=e[n];"audio"===o.streamType?t.push(o):"video"===o.streamType?r.push(o):"text"===o.streamType&&i.push(o)}return{audios:t,videos:r,texts:i}},e.prototype._getLanguageMap=function(e){for(var t=[],r=[],i=[],n=0,o=e.audio;n<o.length;n++){var a=o[n];t.push(this._languageUtil.normalize(a.language))}for(var s=0,u=e.video;s<u.length;s++){var c=u[s];r.push(this._languageUtil.normalize(c.language))}for(var d=0,l=e.text;d<l.length;d++){var h=l[d];i.push(this._languageUtil.normalize(h.language))}return{audios:t,videos:r,texts:i}},e.prototype._getDefaultLanguage=function(e){for(var t,r=0;r<e.length;r++){var i=e[r];if(!0===i.default)return i.language}return null===(t=e[0])||void 0===t?void 0:t.language},e}();t.TrackPreferenceVariantFilter=a},29080:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VariantMetadata=void 0;var i=r(22970),n=function(e){function t(t,r){var i=e.call(this,r)||this;return i.bandwidth=t.bandwidth,i.audio=t.audio,i.video=t.video,i.text=t.text,i}return i.__extends(t,e),t}(r(37992).BaseAsyncDetail);t.VariantMetadata=n},25014:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VideoSizeVariantFilter=void 0;var i=r(47632),n=function(){function e(e){this.id="VideoSizeVariantFilter",this.onWarning=new i.Emitter,this._maxSize=e.maxSize,this._minSize=e.minSize,this._videoElementSize=e.videoElementSize,this._fallbackToNearest=e.fallbackToNearest}return e.prototype.setMaxSize=function(e){this._maxSize=e},e.prototype.setVideoElementSize=function(e){this._videoElementSize=e},e.prototype.filterVariants=function(e){var t=this._filterVariantsByMinSize(e);return this._filterVariantsByMaxSize(t)},e.prototype.getContextualInfo=function(){var e=void 0!==this._minSize?"'".concat(this._minSize.width,"x").concat(this._minSize.height,"'"):"'not set'",t=void 0!==this._maxSize?"'".concat(this._maxSize.width,"x").concat(this._maxSize.height,"'"):"'not set'",r=void 0!==this._videoElementSize?"'".concat(this._videoElementSize.width,"x").concat(this._videoElementSize.height,"'"):"'not set'";return"Video size boundaries: min - ".concat(e,"; max - ").concat(t,"; video element - ").concat(r)},e.prototype._filterVariantsByMaxSize=function(e){if(void 0===this._maxSize&&(void 0===this._videoElementSize||0===this._videoElementSize.width&&0===this._videoElementSize.height))return e;for(var t,r,i,n,o,a,s=null!==(r=null===(t=this._maxSize)||void 0===t?void 0:t.width)&&void 0!==r?r:Number.MAX_VALUE,u=null!==(n=null===(i=this._maxSize)||void 0===i?void 0:i.height)&&void 0!==n?n:Number.MAX_VALUE,c={width:Math.min(s,void 0!==this._videoElementSize&&this._videoElementSize.width>0?this._videoElementSize.width:Number.MAX_VALUE),height:Math.min(u,void 0!==this._videoElementSize&&this._videoElementSize.height>0?this._videoElementSize.height:Number.MAX_VALUE)},d=[],l=[],h=0,p=e.video;h<p.length;h++){var f=p[h];void 0!==f.width&&void 0!==f.height&&(f.width<=c.width&&f.height<=c.height&&l.push(f),0===l.length&&!0===this._fallbackToNearest&&(void 0===o||void 0===a||f.width<o||f.height<a?(o=f.width,a=f.height,d=[f]):f.width===o&&f.height===a&&d.push(f)))}return{video:l.length>0?l:d,audio:e.audio,text:e.text}},e.prototype._filterVariantsByMinSize=function(e){if(void 0===this._minSize||0===this._minSize.width&&0===this._minSize.height)return e;for(var t,r,i=[],n=[],o=0,a=e.video;o<a.length;o++){var s=a[o];void 0!==s.width&&void 0!==s.height&&(s.width>=this._minSize.width&&s.height>=this._minSize.height&&n.push(s),0===n.length&&!0===this._fallbackToNearest&&(void 0===t||void 0===r||s.width>t||s.height>r?(t=s.width,r=s.height,i=[s]):s.width===t&&s.height===r&&i.push(s)))}return{video:n.length>0?n:i,audio:e.audio,text:e.text}},e}();t.VideoSizeVariantFilter=n},9734:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentPayloadCache=void 0;var i=r(22970),n=r(61757),o=r(60064),a=r(90149),s=r(43162),u=r(57665),c=r(34518),d=r(70387),l=r(34855),h=r(94306),p=function(){function e(t,r,i){var s=this;this._segmentWorkQueue=[],this._segments=new h.HashMap,this._segmentUtil=new a.SegmentUtil,this._system=t,this._network=new o.NetworkUtil(t),this._requestType=r,this._cmcd=i,this._asyncWorker=new n.AsyncWorker(this._system,{getNextWorkItem:function(){return s._getNextWorkItem()},handleWorkItem:function(e){return s._handleWorkItem(e)}}),this._asyncWorker.onError.on(this,function(e){void 0!==e.item&&(s._segments.delete(e.item.segment.id),e.item.responseRejecter(e.error))}),this._asyncWorker.concurrentLimit=e.CONCURRENT_DOWNLOAD_LIMIT}return e.prototype.destroy=function(){var e=this;this._segmentWorkQueue=[],this._asyncWorker.onError.off(this),this._segments.forEach(function(t,r){return e.delete(r.segment)}),this._asyncWorker.destroy()},e.prototype.removeCached=function(e){if(this._segments.contains(e.id)){var t=this._segments.get(e.id);if(void 0!==t.resolvedReference)return this._segments.delete(e.id),t}},e.prototype.fillCached=function(e){this._segments.set(e.segment.id,e)},e.prototype.delete=function(e){this._segments.contains(e.id)&&(this._segments.get(e.id).cancel(),this._segments.get(e.id).delete(),this._segments.delete(e.id)),this._segmentWorkQueue=this._segmentWorkQueue.filter(function(t){return t.segment.id!==e.id})},e.prototype.cancel=function(e){this._segments.contains(e.id)&&this._segments.get(e.id).cancel()},e.prototype.getCached=function(e){var t=this._segments.tryGet(e.id);return null==t?void 0:t.resolvedReference},e.prototype.setCached=function(e,t){this._segments.set(e.id,{segment:e,responsePromise:Promise.resolve(t),cancel:function(){},delete:function(){},responseRejecter:function(){},responseResolver:function(){}})},e.prototype.ensure=function(e,t,r,n){return i.__awaiter(this,void 0,void 0,function(){var o,a,s,u,c,d,l;return i.__generator(this,function(i){return this._segments.contains(e.id)||(void 0!==(o=e).data?this._setCachedInit(o,o.data):(a=function(){},s=function(){},u=function(){},c=function(){},d=new Promise(function(e,t){a=e,s=t}),l={segment:e,context:t,timeoutMS:null!=r?r:0,progressTimeoutMS:null!=n?n:0,cancel:u,delete:c,responseRejecter:s,responseResolver:a,responsePromise:d},this._segmentWorkQueue.push(l),this._segments.set(e.id,l),this._asyncWorker.flush())),[2,this._segments.get(e.id).responsePromise]})})},e.prototype._setCachedInit=function(e,t){var r=this,n="".concat(e.createUri,"-").concat(e.startByte,"-").concat(e.endByte),o=this._system.setPayloadReferenceData(n,t);this._segments.set(e.id,{segment:e,responsePromise:Promise.resolve(o),cancel:function(){},delete:function(){l.PromiseUtil.catchRejection(function(){return i.__awaiter(r,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return[4,o];case 1:return[4,e.sent().deleteFromMemory()];case 2:return e.sent(),[2]}})})},function(){r._system.logError("Failed to delete a cached init payload reference with id ".concat(n))})},responseRejecter:function(){},responseResolver:function(){}})},e.prototype._getNextWorkItem=function(){return this._segmentWorkQueue.shift()},e.prototype._handleWorkItem=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,n,o,a=this;return i.__generator(this,function(h){switch(h.label){case 0:(t=this._segmentUtil.getSegmentRequest(e.segment,this._requestType,e.context)).timeoutMS=e.timeoutMS,t.progressTimeoutMS=e.progressTimeoutMS,t.cmcd=this._cmcd,r=this._network.makeNetworkClient(t),e.cancel=function(){return r.cancel()},e.delete=function(){if((null==n?void 0:n.data)!==void 0){var e=n.data;l.PromiseUtil.catchRejection(function(){return i.__awaiter(a,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return[4,e.deleteFromMemory()];case 1:return t.sent(),[2]}})})},function(){a._system.logError("Failed to delete a payload reference with id ".concat(e.info.id))})}},h.label=1;case 1:return h.trys.push([1,3,,4]),[4,r.payloadReference()];case 2:if(n=h.sent(),!d.NetworkHelpers.isSuccessfulResponseCode(n.status))throw Error("failed to download segment with status ".concat(n.status));return[3,4];case 3:if(o=h.sent(),e.delete(),o instanceof u.WrappedError&&u.WrappedError.causedBy(o,c.OperationCanceledError.NAME))throw o;throw new s.SegmentDownloadFailedError("Failed to download segment",u.WrappedError.wrap(o));case 4:return e.resolvedReference=n.data,e.responseResolver(n.data),[2]}})})},e.CONCURRENT_DOWNLOAD_LIMIT=3,e}();t.SegmentPayloadCache=p},76008:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentSourceBuffer=void 0;var i=r(22970),n=r(36361),o=r(47632),a=function(){function e(e,t){this.onTextChange=new o.Emitter,this.onWarning=new o.Emitter,this._sourceBuffer=t}return e.prototype.getSourceBuffer=function(){return this._sourceBuffer},e.prototype.attachEmbeddedCaptions=function(){var e=this;this._embeddedCaptionSourceBuffer=new n.EmbeddedCaptionSourceBuffer,this._sourceBuffer.onEmbeddedCaptionsExtracted.on(this,function(t){var r;return null===(r=e._embeddedCaptionSourceBuffer)||void 0===r?void 0:r.append(t)}),this._embeddedCaptionSourceBuffer.onTextChange.on(this,function(t){return e.onTextChange.emit(t)}),this._embeddedCaptionSourceBuffer.onWarning.on(this,function(t){return e.onWarning.emit(t)})},e.prototype.detachEmbeddedCaptions=function(){var e,t;this._sourceBuffer.onEmbeddedCaptionsExtracted.off(this),null===(e=this._embeddedCaptionSourceBuffer)||void 0===e||e.onTextChange.off(this),null===(t=this._embeddedCaptionSourceBuffer)||void 0===t||t.onWarning.off(this)},e.prototype.append=function(e,t,r){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(i){switch(i.label){case 0:if(!(void 0!==r&&(void 0===this._lastInit||this._lastInit.initData!==r||this._lastInit.keyId!==e.keyId)))return[3,2];return this._lastInit={initData:r,keyId:e.keyId},[4,this._sourceBuffer.appendBuffer(r,e,!0)];case 1:i.sent(),i.label=2;case 2:if(!(void 0!==t))return[3,4];return[4,this._sourceBuffer.appendBuffer(t,e,!1)];case 3:i.sent(),i.label=4;case 4:return[2]}})})},e.prototype.remove=function(e){var t;return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(r){switch(r.label){case 0:return[4,this._sourceBuffer.remove(e.start,e.end)];case 1:return r.sent(),null===(t=this._embeddedCaptionSourceBuffer)||void 0===t||t.remove(e),[2]}})})},e.prototype.removeAll=function(){var e;return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return[4,this._sourceBuffer.removeAll()];case 1:return t.sent(),null===(e=this._embeddedCaptionSourceBuffer)||void 0===e||e.remove({start:0,end:1/0}),[2]}})})},e}();t.SegmentSourceBuffer=a},58269:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentPipeline=void 0;var i=r(22970),n=r(47632),o=r(29368),a=r(9734),s=r(51422),u=r(52130),c=r(65533),d=function(){function e(e,t,r,i){this.onPipelinePhaseChanged=new n.Emitter,this.onError=new n.Emitter,this.onWarning=new n.Emitter,this._workerUtil=new c.SegmentPipelineWorkerUtil,this.type=t,this._system=e,this._bufferSource=r,this._payloadCache=new a.SegmentPayloadCache(this._system,this._getNetworkTypeFromStreamType(t),i),this._worker=this._makeWorker()}return Object.defineProperty(e.prototype,"active",{get:function(){return this._worker.active},enumerable:!1,configurable:!0}),e.cleanDrained=function(e){e.forEach(function(e){e.segmentData.delete(),e.state.getSourceBuffer=function(){}})},e.prototype.destroy=function(){this._worker.destroy(),this._payloadCache.destroy(),this.onError.off(),this.onWarning.off(),this.onPipelinePhaseChanged.off()},e.prototype.attach=function(){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return[4,this._tryCreateSourceBuffer()];case 1:return e.sent(),[2]}})})},e.prototype.detach=function(){this._worker.detach(),void 0!==this._segmentSourceBuffer&&(this._bufferSource.removeSource(this._segmentSourceBuffer),this._segmentSourceBuffer=void 0)},e.prototype.getPayloadCache=function(){return this._payloadCache},e.prototype.setSourceType=function(e){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return this._sourceType=e,[4,this._tryCreateSourceBuffer()];case 1:return t.sent(),[2]}})})},e.prototype.getSourceType=function(){return this._sourceType},e.prototype.setStoragePath=function(e){this._worker.storagePath=e},e.prototype.flush=function(){this._worker.flush()},e.prototype.add=function(e,t,r){var i,n,a,u,c=this;void 0===t&&(t={}),void 0===r&&(r={});var d={kind:"segment",segment:e,processing:!1,allowAppend:null===(i=r.allowAppend)||void 0===i||i,allowDownload:null===(n=r.allowDownload)||void 0===n||n,order:void 0===r.order||0===r.order?0:r.order,phases:new s.SegmentPipelinePhases,initOnly:r.initOnly,start:e.start,end:e.end,downloadStartTimesMS:[],segmentTimeoutMS:null!==(a=r.timeoutMS)&&void 0!==a?a:0,segmentProgressTimeoutMS:null!==(u=r.progressTimeoutMS)&&void 0!==u?u:0,context:t,getSourceBuffer:function(){return c._segmentSourceBuffer}},l=o.TimeRangeUtil.DEFAULT_INTERSECT_PERCENT;return this.active.hasIntersect(d,l)||this.active.add(d),this._worker.flush(),d},e.prototype.removeAll=function(){return this._worker.clear()},e.prototype.remove=function(e){return this._worker.clear(e)},e.prototype.clearAsync=function(){var e=this;return this._worker.clearAll(function(){return e._segmentSourceBuffer})},e.prototype.drainDownloaded=function(){for(var e=[],t=this.active.getAllRanges(),r=0;r<t.length;r++){var i=t[r],n=this._workerUtil.isDownloaded(i),o=this._workerUtil.hasPhase(i,"AppendQueued");n&&!o&&(i.getSourceBuffer=function(){},this._worker.halt(i),i.processing=!1,e.push(i),this.active.remove(i))}return e},e.prototype.drainFromCache=function(e){for(var t=[],r=0;r<e.length;r++){var i=e[r],n=this._payloadCache.removeCached(i.segment),o=void 0;void 0!==i.segment.initSegment&&(o=this._payloadCache.removeCached(i.segment.initSegment)),void 0!==n&&t.push({state:i,segmentData:n,initData:o})}return t},e.prototype.fillFromDrain=function(e){for(var t=this,r=0;r<e.length;r++){var i=e[r];i.state.getSourceBuffer=function(){return t._segmentSourceBuffer},this.active.add(i.state),this._payloadCache.fillCached(i.segmentData),void 0!==i.initData&&void 0!==i.state.segment.initSegment&&this._payloadCache.fillCached(i.initData)}this._worker.flush()},e.prototype._getNetworkTypeFromStreamType=function(e){switch(e){case"audio":return"audio";case"video":return"video";case"text":return"text";default:return"other"}},e.prototype._makeWorker=function(){var e=this,t=new u.SegmentPipelineWorker(this._system,this._payloadCache);return t.onError.on(this,function(t){return e.onError.emit(t)}),t.onWarning.on(this,function(t){return e.onWarning.emit(t)}),t.onPipelinePhaseChanged.on(this,function(t){return e.onPipelinePhaseChanged.emit(t)}),t.storagePath=this._storagePath,t},e.prototype._tryCreateSourceBuffer=function(){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){switch(t.label){case 0:if(!(void 0!==this._sourceType&&void 0===this._segmentSourceBuffer))return[3,2];return e=this,[4,this._bufferSource.generateSource(this._sourceType)];case 1:e._segmentSourceBuffer=t.sent(),t.label=2;case 2:return this._worker.flush(),[2]}})})},e}();t.SegmentPipeline=d},51422:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentPipelinePhases=void 0;var i=r(94306),n=function(){function e(){this.phases=new i.HashMap}return e.prototype.add=function(e){this.phases.set(e.phaseName,e),this.lastPhaseName=e.phaseName},e.prototype.has=function(e){return this.phases.contains(e)},e.prototype.getAll=function(){return this.phases.values()},e.prototype.reset=function(){this.phases.clear(),this.lastPhaseName=void 0},e.prototype.getLastPhaseName=function(){return this.lastPhaseName},e}();t.SegmentPipelinePhases=n},52130:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentPipelineWorker=void 0;var i=r(22970),n=r(61757),o=r(47632),a=r(17590),s=r(99506),u=r(65533),c=r(29368),d=r(88309),l=r(28521),h=function(){function e(t,r){var i=this;this.onPipelinePhaseChanged=new o.Emitter,this.onError=new o.Emitter,this.onWarning=new o.Emitter,this.active=new s.TimeRangeList,this._removes=new d.Set,this._stringUtil=new a.StringUtil,this._pipelineUtil=new u.SegmentPipelineWorkerUtil,this._timerangeUtil=new c.TimeRangeUtil,this._system=t,this._payloadCache=r,this._asyncWorker=new n.AsyncWorker(this._system,{getNextWorkItem:function(){return i._getNextWorkItem()},prepareWorkItem:function(e){return i._prepareWorkItem(e)},handleWorkItem:function(e){return i._handleWorkItem(e)},completeWorkItem:function(e){return i._completeWorkItem(e)}}),this._asyncWorker.concurrentLimit=e.CONCURRENT_LIMIT,this._asyncWorker.onWorkCompleted.on(this,function(e){"segment"===e.kind?i._emitIfNotCleared(i.onPipelinePhaseChanged,e):(e.items.forEach(function(e){return i.onPipelinePhaseChanged.emit(e)}),e.resolver())}),this._asyncWorker.onError.on(this,function(e){var t,r;(null===(t=e.item)||void 0===t?void 0:t.kind)==="segment"?(e.item.error=e.error,i._emitIfNotCleared(i.onError,e.item)):null===(r=e.item)||void 0===r||r.rejecter(e.error)})}return e.prototype.clear=function(e){for(var t=void 0===e?this.active.clear():this.active.remove(e),r=0;r<t.length;r++){var i=t[r];this.halt(i),this._removes.add(i)}return t},e.prototype.clearAll=function(e){var t=this;if(void 0!==this._clearPipeline)return this._clearPipeline.promise;var r=new Promise(function(i,n){t._clearPipeline={kind:"clear",processing:!1,promise:r,resolver:i,rejecter:n,getSourceBuffer:e,items:new d.Set}});return this.flush(),r},e.prototype.detach=function(){this.clear(),this._resetClearPipeline()},e.prototype.destroy=function(){this._asyncWorker.destroy(),this._resetClearPipeline(),this.active.clear(),this.onPipelinePhaseChanged.off(),this.onError.off(),this.onWarning.off()},e.prototype.flush=function(){this._asyncWorker.flush()},e.prototype.halt=function(e){this._asyncWorker.halt(e),this._payloadCache.cancel(e.segment)},e.prototype._getNextWorkItem=function(){return this._findActionableActiveState()},e.prototype._resetClearPipeline=function(){void 0!==this._clearPipeline&&(this._clearPipeline.resolver(),this._clearPipeline=void 0)},e.prototype._prepareWorkItem=function(e){e.processing=!0},e.prototype._completeWorkItem=function(e){e.processing=!1,e===this._clearPipeline&&(this._clearPipeline=void 0)},e.prototype._findActionableActiveState=function(){if(void 0!==this._clearPipeline)return this._clearPipeline.processing?void 0:this._clearPipeline;for(var e=!0,t=0,r=this._removes.values();t<r.length;t++){var i=r[t];if(!i.processing)return i;this._pipelineUtil.hasPhase(i,"AppendQueued")&&!this._pipelineUtil.hasPhase(i,"RemoveQueued")&&(e=!1)}for(var n=this._pipelineUtil.sortState(this.active.getAllRanges()),o=0;o<n.length;o++){var a=n[o],s=this._pipelineUtil.isLastPhase(a,"AppendCompleted"),u=this._isItemAtMaxState(a,e),c=this._isTimeRangeBeingRemoved(a);if(!s&&!u&&!c&&!a.processing&&void 0===a.error)return a}},e.prototype._isItemAtMaxState=function(e,t){return this._pipelineUtil.isLastPhase(e,"Initial")&&!e.allowDownload||this._pipelineUtil.isLastPhase(e,"DownloadCompleted")&&(void 0===e.getSourceBuffer()||!e.allowAppend||!t)},e.prototype._isTimeRangeBeingRemoved=function(e){var t=this,r=!1;return this._removes.forEach(function(i){!r&&t._timerangeUtil.isRangeEqual(i,e)&&(r=!0)}),r},e.prototype._handleWorkItem=function(e){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(r){switch(r.label){case 0:if("clear"===e.kind)return[2,this._handleClear(e)];if(this._removes.has(e))return[2,this._handleRemovePhase(e)];switch(t=e.phases.getLastPhaseName()){case void 0:return[3,1];case"Initial":return[3,2];case"DownloadCompleted":return[3,4]}return[3,6];case 1:return this._handleInitialPhase(e),[3,7];case 2:return[4,this._handleDownloadPhase(e)];case 3:case 5:return r.sent(),[3,7];case 4:return[4,this._handleAppendPhase(e)];case 6:throw Error("Invalid phase name for stepping '".concat(t,"'"));case 7:return[2]}})})},e.prototype._handleInitialPhase=function(e){e.phases.add({phaseName:"Initial",start:Date.now(),end:Date.now()})},e.prototype._handleRemovePhase=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,n,o,a,s=this;return i.__generator(this,function(i){switch(i.label){case 0:if(this._pipelineUtil.hasPhase(e,"DownloadQueued")&&this._payloadCache.delete(e.segment),t=this._pipelineUtil.hasPhase(e,"AppendQueued"),!(void 0===(r=e.getSourceBuffer())||!t))return[3,1];return e.phases.add({phaseName:"RemoveCompleted",start:Date.now(),end:Date.now()}),[3,3];case 1:return n=this.active.getAllRanges().every(function(t){return t.start>e.start||!s._pipelineUtil.hasPhase(t,"AppendQueued")}),o=Date.now(),e.phases.add({phaseName:"RemoveQueued",start:o,end:o}),this._emitIfNotCleared(this.onPipelinePhaseChanged,e),[4,r.remove({start:n?0:e.segment.start,end:e.segment.end})];case 2:i.sent(),a=Date.now(),e.phases.add({phaseName:"RemoveCompleted",start:a,end:a}),i.label=3;case 3:return this._removes.delete(e)||this.onWarning.emit(new l.WarningError("Removing item that was not found in collection, time range ".concat(e.start,"-").concat(e.end))),e.getSourceBuffer=function(){},[2]}})})},e.prototype._handleClear=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,n,o,a,s,u=this;return i.__generator(this,function(i){switch(i.label){case 0:if(void 0===(t=e.getSourceBuffer()))return[2];return this.clear(),r=Date.now(),[4,t.removeAll()];case 1:for(i.sent(),n=0,o=this.active.clear().concat(this._removes.values());n<o.length;n++)a=o[n],e.items.add(a);return this._removes.clear(),s=Date.now(),e.items.forEach(function(e){u._payloadCache.delete(e.segment),e.phases.add({phaseName:"RemoveCompleted",start:r,end:s}),e.getSourceBuffer=function(){},e.pipelineClearedWhileProcessing=!0}),[2]}})})},e.prototype._handleDownloadPhase=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,n,o,a,s;return i.__generator(this,function(u){switch(u.label){case 0:return t=Date.now(),r=[],void 0!==e.segment.initSegment&&r.push(this._payloadCache.ensure(e.segment.initSegment,i.__assign(i.__assign({},e.context),{nextSegment:e.segment}))),r.push(this._payloadCache.ensure(e.segment,e.context,e.segmentTimeoutMS,e.segmentProgressTimeoutMS)),n=Date.now(),e.phases.add({phaseName:"DownloadQueued",start:t,end:n}),this._emitIfNotCleared(this.onPipelinePhaseChanged,e),t=n,[4,Promise.all(r)];case 1:if(o=u.sent(),this._asyncWorker.isHalted(e))return[2];return a=1===o.length?void 0:o[0],s=o[o.length-1],void 0!==a&&(e.initSizeBytes=a.info.byteLength),e.segmentSizeBytes=s.info.byteLength,e.phases.add({phaseName:"DownloadCompleted",start:t,end:Date.now()}),[2]}})})},e.prototype._handleAppendPhase=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,n,o,a,s;return i.__generator(this,function(i){switch(i.label){case 0:if(!(void 0!==(t=e.getSourceBuffer())))return[3,7];if(r=void 0,!(!0!==e.initOnly))return[3,2];return[4,this._payloadCache.ensure(e.segment,e.context)];case 1:r=i.sent(),i.label=2;case 2:if(void 0!==e.segment.initSegment)return[3,3];return o=void 0,[3,5];case 3:return[4,this._payloadCache.ensure(e.segment.initSegment,e.context)];case 4:o=i.sent(),i.label=5;case 5:if(n=o,this._asyncWorker.isHalted(e))return[2];return a=Date.now(),e.phases.add({phaseName:"AppendQueued",start:a,end:a}),this._emitIfNotCleared(this.onPipelinePhaseChanged,e),[4,t.append(e.segment,r,n)];case 6:i.sent(),this._payloadCache.delete(e.segment),s=Date.now(),e.phases.add({phaseName:"AppendCompleted",start:s,end:s}),i.label=7;case 7:return[2]}})})},e.prototype._emitIfNotCleared=function(e,t){!0!==t.pipelineClearedWhileProcessing&&e.emit(t)},e.CONCURRENT_LIMIT=12,e}();t.SegmentPipelineWorker=h},65533:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentPipelineWorkerUtil=void 0;var r=function(){function e(){this._sortStateFunction=function(e,t){return e.order===t.order?e.start-t.start:e.order-t.order}}return e.prototype.sortState=function(e){return e.slice().sort(this._sortStateFunction)},e.prototype.isLastPhase=function(e,t){return e.phases.getLastPhaseName()===t},e.prototype.hasPhase=function(e,t){return e.phases.has(t)},e.prototype.isAppended=function(e){return this.hasPhase(e,"AppendCompleted")},e.prototype.isDownloaded=function(e){return this.hasPhase(e,"DownloadCompleted")},e.prototype.isDownloading=function(e){return this.hasPhase(e,"DownloadQueued")&&!this.hasPhase(e,"DownloadCompleted")},e}();t.SegmentPipelineWorkerUtil=r},46079:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mp4TtmlParser=void 0;var i=r(27468),n=r(7253),o=r(47632),a=r(28521),s=r(71791),u=r(9345),c=r(17590),d=function(){function e(){this._stringUtil=new c.StringUtil,this._nodeUtil=new u.NodeUtil,this.onWarning=new o.Emitter}return e.prototype.parseMediaSegment=function(e){var t=new Uint8Array(e),r=new i.Mp4Parser().parse(t),o=new n.Mp4Walker(r).jumpTo("mdat",!0);if(void 0===o)return[];for(var a=this._stringUtil.fromUTF8(t.subarray(o.rangeContentBody.start,o.rangeContentBody.start+o.rangeContentBody.length)),u=[],c=new s.NodeParser(a),d=0,l=c.getRecursiveChildrenByType("p");d<l.length;d++){for(var h=l[d],p=void 0,f=void 0,_=0,v=h.attributes;_<v.length;_++){var m=v[_];this._nodeUtil.startsWith(m,"begin=")?p=this._parseTimestamp(this._nodeUtil.getAttributeValue(m)):this._nodeUtil.startsWith(m,"end=")&&(f=this._parseTimestamp(this._nodeUtil.getAttributeValue(m)))}if(void 0===p||void 0===f){this._emitWarning("skipping cue with unknown start or end time");continue}u.push({start:p,end:f,text:this._parseParagraphBody(h.rawBody),position:{textAlignment:"center",positionAlignment:"center"}})}return u},e.prototype.destroy=function(){this.onWarning.off()},e.prototype._parseTimestamp=function(e){var t=e.match(/^(\d+):(\d\d?):(\d\d?(\.\d\d?\d?)?)$/);if(null===t){this._emitWarning("unsupported timestamp string: '".concat(e,"'"));return}return 60*(60*parseInt(t[1])+parseInt(t[2]))+parseFloat(t[3])},e.prototype._parseParagraphBody=function(e){var t=this;return e.split(/<br\s*\/>/g).map(function(e){return t._nodeUtil.unescapeString(t._nodeUtil.stripTags(e)).split("\n").reduce(function(e,t){return(t=t.trim(),e.length>0&&t.length>0)?"".concat(e," ").concat(t):e.length>0?e:t},"")})},e.prototype._emitWarning=function(e){this.onWarning.emit(new a.WarningError("[Mp4TtmlParser] ".concat(e)))},e}();t.Mp4TtmlParser=d},94659:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mp4VttParser=void 0;var i=r(22970),n=r(89773),o=r(58373),a=r(40715),s=r(23280),u=r(47632),c=r(15302),d=r(94306),l=r(23422),h=r(27468),p=r(7253),f=r(96133),_=r(99818),v=r(35389),m=r(80334),g=r(28521),y=function(e){function t(t){var r=e.call(this)||this;r._defaultSampleDuration=0,r.onWarning=new u.Emitter;var i=new h.Mp4Parser;i.setParsers(new d.HashMap([["moov",n.ContainerParser.getBasicBoxParser()],["trak",n.ContainerParser.getBasicBoxParser()],["mdia",n.ContainerParser.getBasicBoxParser()],["mdhd",l.MediaHeaderBoxParser.getParser()],["minf",n.ContainerParser.getBasicBoxParser()],["stbl",n.ContainerParser.getBasicBoxParser()],["wvtt",n.ContainerParser.getBasicBoxParser()],["stsd",n.ContainerParser.getFullEntriesBoxParser()]]));var o=i.parse(new Uint8Array(t)),a=new p.Mp4Walker(o),s=a.jumpTo("mdhd",!0),f=a.jumpTo("wvtt",!0);if(void 0!==s)r._timescale=s.timescale;else throw new c.InvalidOperationError("Missing timescale for VTT content. It should be located in the MDHD");if(void 0===f)throw new c.InvalidOperationError("Init segment should have WVTT box, a valid vtt init segment with no actual subtitles");return r}return i.__extends(t,e),t.prototype.parseMediaSegment=function(e){var t,r,i,o=[],a=new h.Mp4Parser;a.setParsers(new d.HashMap([["moof",n.ContainerParser.getBasicBoxParser()],["traf",n.ContainerParser.getBasicBoxParser()],["tfdt",f.TrackFragmentDecodeTimeBoxParser.getParser()],["tfhd",_.TrackFragmentHeaderBoxParser.getParser()],["trun",v.TrackRunBoxParser.getParser()]]));var u=a.parse(new Uint8Array(e)),c=new p.Mp4Walker(u),l=c.jumpTo("tfdt",!0),m=c.jumpTo("tfhd",!0),g=c.jumpTo("trun",!0),y=c.jumpTo("mdat",!0),S=null!==(t=null==g?void 0:g.samples)&&void 0!==t?t:[],E=null!==(r=null==m?void 0:m.defaultSampleDuration)&&void 0!==r?r:this._defaultSampleDuration,b=null==l?void 0:l.baseDecodeTime;if(void 0===b||void 0===y)return[];for(var w=new DataView(e,y.rangeContentBody.start,y.rangeContentBody.length),P=new s.DataViewReader(w,!1),T=b,C=0;C<S.length;C++){var M=S[C],k=null!==(i=M.duration)&&void 0!==i?i:E,A=T;T=A+k;var x=0;do{var D=P.readUInt32();x+=D;var R=P.readString(4),O=void 0;if("vttc"===R?D>8&&(O=P.readBytes(D-8)):("vtte"===R||this.emitWarning_("Skipping unknown box ".concat(R)),P.skip(D-8)),void 0!==O){var I=this.parseVTTC_(O,A/this._timescale,T/this._timescale);I.length>0&&(o=o.concat(I))}}while(void 0!==M.size&&x<M.size)}return o},t.prototype.destroy=function(){this.onWarning.off()},t.prototype.parseVTTC_=function(e,t,r){var i=this,n=[],s=new h.Mp4Parser;s.setParsers(new d.HashMap([["payl",o.CuePayloadBoxParser.getParser()],["sttg",a.CueSettingsBoxParser.getParser()]]));var u=s.parse(e),c=new p.Mp4Walker(u),l=c.jumpTo("payl",!0),f=c.jumpTo("sttg",!0);if(void 0!==l){var _=l.payload,v=void 0!==f&&f.settings.length>0?this._tryParsePosition(f.settings):{textAlignment:"center",positionAlignment:"center"};n.push({start:t,end:r,text:_.split("\n").map(function(e){return i._sanitizeText(e)}),position:v})}return n},t.prototype.emitWarning_=function(e){this.onWarning.emit(new g.WarningError("[Mp4VttParser] ".concat(e)))},t}(m.VttParserBase);t.Mp4VttParser=y},77539:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextSourceBuffer=void 0;var i=r(22970),n=r(47632),o=r(94659),a=r(2254),s=r(17590),u=r(29368),c=r(92271),d=r(28521),l=r(93510),h=r(46079),p=function(){function e(e,t){this._stringUtil=new s.StringUtil,this._vttUtil=new c.VttUtil,this._timeRangeUtil=new u.TimeRangeUtil,this._lastSet=0,this._text=new a.SortedIntervalCollection,this.onTextChange=new n.Emitter,this.onWarning=new n.Emitter,this._system=e,this._codec=t}return e.prototype.append=function(e,t,r){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(i){switch(i.label){case 0:return[4,this._parseAndAppendTextData(e,t,r)];case 1:return i.sent(),[2]}})})},e.prototype.remove=function(e){this._removeTextData(e)},e.prototype.removeAll=function(){this._removeTextData({start:0,end:1/0})},e.prototype._removeTextData=function(e){var t=this,r=this._text.length;this._text.removeIf(function(r){return t._timeRangeUtil.hasOverlap(e,r)}),this._text.length!==r&&this.onTextChange.emit({source:"VTT",text:this._text,id:this._lastSet++})},e.prototype._parseAndAppendTextData=function(e,t,r){return i.__awaiter(this,void 0,void 0,function(){var n,o,a,s,u,c;return i.__generator(this,function(d){switch(d.label){case 0:if(!(void 0!==t))return[3,2];return[4,this._getTextCues(e,t,r)];case 1:if((n=d.sent()).length>0){for(a=0,o=0===this._text.length,s=n;a<s.length;a++)u=s[a],c=i.__assign(i.__assign({},u),{start:e.presentationTimeOffset+u.start,end:e.presentationTimeOffset+u.end}),this._addCue(c,o);this.onTextChange.emit({source:"VTT",text:this._text,id:this._lastSet++})}d.label=2;case 2:return[2]}})})},e.prototype._getTextCues=function(e,t,r){return i.__awaiter(this,void 0,void 0,function(){var n,a,s,u,c,p=this;return i.__generator(this,function(i){switch(i.label){case 0:return[4,this._system.getPayloadReferenceData(t.info.id)];case 1:if(n=i.sent(),"stpp"!==this._codec)return[3,2];return a=new h.Mp4TtmlParser,[3,4];case 2:if(!(void 0!==r))return[3,4];return[4,this._system.getPayloadReferenceData(r.info.id)];case 3:s=i.sent(),a=new o.Mp4VttParser(s),i.label=4;case 4:if(void 0!==a)return a.onWarning.on(this,function(e){return p.onWarning.emit(e)}),u=a.parseMediaSegment(n),a.destroy(),[2,u];if(c=this._stringUtil.fromUTF8(new Uint8Array(n)),this._stringUtil.startsWith("WEBVTT",c))return[2,new l.WebVttParser().parse(c)];return this.onWarning.emit(new d.WarningError("Invalid webvtt format found at t=".concat(e.start,"-").concat(e.end," with url ").concat(e.createUri))),[2,[]]}})})},e.prototype._addCue=function(e,t){var r;if(t)r=this._text.length;else{for(var i=this._text.lowerBound(e.start),n=this._text.upperBound(e.start),o=i;o<n;++o)if(this._vttUtil.isCueEqual(e,this._text.getAt(o)))return;r=n}this._text.add(e,r)},e}();t.TextSourceBuffer=p},80334:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VttParserBase=void 0;var r=function(){function e(){}return e.prototype._tryParsePosition=function(t){for(var r,i,n={textAlignment:"center",positionAlignment:"center"},o=0;o<t.length;o++){var a=t[o].split(":");switch(a[0].trim()){case e.VTT_LINE:n.linePercent=this._parsePercentValue(a[1]);break;case e.VTT_POS:n.positionPercent=this._parsePercentValue(a[1]),i=this._parsePositionAlignment(a[1]);break;case e.VTT_SIZE:n.sizePercent=this._parsePercentValue(a[1]);break;case e.VTT_ALIGN:r=this._parseAlignment(a[1])}}return this._setTextAlignment(n,r),this._setPositionAlignment(n,i),this._setPositionPercent(n,n.textAlignment),n},e.prototype._setTextAlignment=function(e,t){void 0!==t&&(e.textAlignment=t)},e.prototype._setPositionAlignment=function(e,t){if(void 0!==t)e.positionAlignment=t;else switch(e.textAlignment){case"left":case"start":e.positionAlignment="left";break;case"right":case"end":e.positionAlignment="right";break;default:e.positionAlignment="center"}},e.prototype._setPositionPercent=function(e,t){if(void 0===e.positionPercent)switch(t){case"left":e.positionPercent=0;break;case"right":e.positionPercent=1;break;default:e.positionPercent=.5}},e.prototype._parsePositionAlignment=function(t){var r=t.split(",");if(r.length>1)switch(r[1].trim()){case e.VTT_POS_ALIGN_LEFT:return"left";case e.VTT_POS_ALIGN_CENTER:return"center";case e.VTT_POS_ALIGN_RIGHT:return"right"}},e.prototype._parseAlignment=function(e){switch(e){case"left":return"left";case"center":default:return"center";case"right":return"right";case"start":return"start";case"end":return"end"}},e.prototype._parsePercentValue=function(e){var t,r=parseFloat(e);return isFinite(r)&&(t=Math.max(0,Math.min(1,r/100))),t},e.prototype._sanitizeText=function(e){for(var t=e.indexOf("<");t>=0;){var r=e.indexOf(">",t);if(-1===r)break;t=(e=e.substring(0,t)+e.substring(r+1)).indexOf("<")}return(e=e.replace(/&(lt|gt|nbsp|amp);/g,function(e,t){return"lt"===t?"<":"gt"===t?">":"nbsp"===t?" ":"&"})).trim()},e.VTT_LINE="line",e.VTT_POS="position",e.VTT_SIZE="size",e.VTT_ALIGN="align",e.VTT_POS_ALIGN_LEFT="line-left",e.VTT_POS_ALIGN_CENTER="center",e.VTT_POS_ALIGN_RIGHT="line-right",e}();t.VttParserBase=r},93510:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebVttParser=void 0;var i=r(22970),n=r(17590),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._stringUtil=new n.StringUtil,t}return i.__extends(t,e),t.prototype.parse=function(e){var t=this,r=[];if(this._stringUtil.startsWith("WEBVTT",e))for(var i=e.indexOf("\n\n"),n=-1;-1!==i&&i!==n;){n=i;var o=i+2;if(this._stringUtil.startsWith("NOTE",e,o)||this._stringUtil.startsWith("STYLE",e,o)){i=e.indexOf("\n\n",o);continue}var a=e.indexOf("\n",o);if(-1===a)break;var s=e.substring(o,a).split("-->");if(2!==s.length){i=a;continue}var u=s[0].trim(),c=s[1].trim().split(" "),d=c[0],l=this._tryParsePosition(c),h=a+1,p=e.indexOf("\n\n",a);-1===p&&(p=e.length),i=p,r.push({text:e.substring(h,p).split("\n").map(function(e){return t._sanitizeText(e)}),start:this._parseTimeToSeconds(u),end:this._parseTimeToSeconds(d),position:l})}return r},t.prototype._parseTimeToSeconds=function(e){var t,r,i,n=e.split(":"),o=0;return 3===n.length&&(o+=3600*parseInt(null!==(t=n.shift())&&void 0!==t?t:"0")),Math.round(1e3*(o+=60*parseInt(null!==(r=n.shift())&&void 0!==r?r:"0")+parseFloat(null!==(i=n.shift())&&void 0!==i?i:"0")))/1e3},t}(r(80334).VttParserBase);t.WebVttParser=o},99506:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimeRangeList=void 0;var i=r(29368),n=function(){function e(){this._normalizedRanges=[],this._timeRangeUtil=new i.TimeRangeUtil}return e.prototype.getAllRanges=function(){return this._normalizedRanges},e.prototype.count=function(){return this._normalizedRanges.length},e.prototype.first=function(){return this._normalizedRanges[0]},e.prototype.last=function(){return this._normalizedRanges[this._normalizedRanges.length-1]},e.prototype.clear=function(){var e=this._normalizedRanges.slice();return this._normalizedRanges=[],e},e.prototype.hasIntersect=function(e,t){for(var r=this.getInside([e]),i=0;i<r.length;i++){var n=r[i];if(this._timeRangeUtil.hasIntersect(e,n,t))return!0}return!1},e.prototype.contains=function(e){return this._timeRangeUtil.contains(this._normalizedRanges,e)},e.prototype.getInside=function(e){return this._timeRangeUtil.getInsideOf(this._normalizedRanges,e)},e.prototype.getOutside=function(e){return this._timeRangeUtil.getOutsideOf(this._normalizedRanges,e)},e.prototype.add=function(e){var t=this._normalizedRanges.slice();t.push(e);for(var r=this._timeRangeUtil.sort(t),n=0;n<r.length-1;n++){var o=r[n],a=r[n+1];if(this._timeRangeUtil.hasIntersect(o,a,i.TimeRangeUtil.DEFAULT_INTERSECT_PERCENT))throw Error("Time range overlap detected: [".concat(a.start,", ").concat(a.end,"] between [").concat(o.start,", ").concat(o.end,"]"))}this._normalizedRanges=r},e.prototype.remove=function(e){for(var t=[],r=[],i=0,n=this._normalizedRanges;i<n.length;i++){var o=n[i];this._timeRangeUtil.hasOverlap(o,e)?r.push(o):t.push(o)}return this._normalizedRanges=t,r},e}();t.TimeRangeList=n},29368:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimeRangeUtil=void 0;var r=function(){function e(){}return e.prototype.hasIntersect=function(e,t,r){if(e.start===e.end||t.start===t.end)return this.hasOverlap(e,t);var i=Math.max(e.end-e.start,t.end-t.start),n=Math.max(e.start,t.start);return(Math.min(e.end,t.end)-n)/i>r},e.prototype.getSortCompare=function(e,t){return this.isTimeClose(e.start,t.start)?this.isTimeClose(e.end,t.end)?0:e.end-t.end:e.start-t.start},e.prototype.hasOverlap=function(e,t){return!!this.isRangeEqual(e,t)||(e.start===e.end?this.contains([t],e.start):t.start===t.end?this.contains([e],t.start):0>=this.getSortCompare(e,t)?!this.isTimeClose(e.end,t.start)&&e.end>t.start:!this.isTimeClose(t.end,e.start)&&t.end>e.start)},e.prototype.isTimeClose=function(t,r){return Math.abs(t-r)<e.TIME_EPSILON_FRACTION},e.prototype.isRangeEqual=function(e,t){return e.start===t.start&&e.end===t.end},e.prototype.intersection=function(e,t){if(!(e.start>t.end)&&!(t.start>e.end))return{start:Math.max(e.start,t.start),end:Math.min(e.end,t.end)}},e.prototype.sort=function(e){var t=this,r=e.slice();return r.sort(function(r,i){var n=t.getSortCompare(r,i);return 0===n?e.indexOf(r)-e.indexOf(i):n}),r},e.prototype.contains=function(e,t){if("number"==typeof t){for(var r=0;r<e.length;r++){var i=e[r];if(t>=i.start&&t<i.end)return!0}return!1}return this.getInsideOf(e,t).length>0},e.prototype.getInsideOf=function(e,t){return this._getMatchingRanges(e,t,!0)},e.prototype.getOutsideOf=function(e,t){return this._getMatchingRanges(e,t,!1)},e.prototype.merge=function(e){for(var t=this.sort(e),r=[],i=0;i<t.length;i++){var n=t[i],o=r[r.length-1],a=void 0!==o&&this.isTimeClose(o.end,n.start),s=void 0!==o&&n.start>o.end&&!a;void 0===o||s?r.push({start:n.start,end:n.end}):o.end=Math.max(n.end,o.end)}return r},e.prototype.sum=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,i=0;i<e.length;i++)for(var n=e[i],o=0;o<n.length;o++){var a=n[o];r+=a.end-a.start}return r},e.prototype.getSumOfIntersection=function(e,t){for(var r=[],i=0;i<t.length;i++){var n=t[i],o=Math.min(n.end,e.end),a=Math.min(o,Math.max(n.start,e.start));a!==o&&r.push({start:a,end:o})}return this.sum(this.merge(r))},e.prototype._getMatchingRanges=function(e,t,r){for(var i=[],n=0;n<e.length;n++){for(var o=e[n],a=!1,s=0;s<t.length;s++){var u=t[s];if(this.hasOverlap(o,u)){a=!0;break}}a===r&&i.push(o)}return i},e.DEFAULT_INTERSECT_PERCENT=.95,e.TIME_EPSILON_FRACTION=1/60,e}();t.TimeRangeUtil=r},69964:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayUtil=void 0;var r=function(){function e(){}return e.prototype.areEqual=function(e,t){if(e.length!==t.length)return!1;for(var r=e.length-1;r>=0;r--)if(e[r]!==t[r])return!1;return!0},e.prototype.find=function(e,t){var r=e.find;if(void 0!==r)return r.call(e,t);for(var i=0,n=e.length;i<n;i++){var o=e[i];if(t(o,i,e))return o}},e.prototype.findFirstIndex=function(e,t){var r=e.findIndex;if(void 0!==r)return r.call(e,t);for(var i=0;i<e.length;i++)if(t(e[i],i,e))return i;return -1},e.prototype.binarySearchArray=function(e,t,r,i,n,o){return void 0===i&&(i="none"),void 0===n&&(n=0),void 0===o&&(o=e.length),this.binarySearch(e.length,function(t){return e[t]},t,r,i,n,o)},e.prototype.binarySearch=function(e,t,r,i,n,o,a){if(void 0===n&&(n="none"),void 0===o&&(o=0),void 0===a&&(a=e),o<0||a>e||o>a)throw Error("invalid bounds passed to binarySearch");for(;o<a;){var s=o+a>>>1,u=i(r,t(s));if(u<0)a=s;else if(u>0)o=s+1;else switch(n){case"none":return s;case"lower_bound":var c=this.binarySearch(e,t,r,i,n,o,s);return c<0?s:c;case"upper_bound":var c=this.binarySearch(e,t,r,i,n,s+1,a);return c<0?s+1:c}}return-(o+1)},e}();t.ArrayUtil=r},43392:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BitStreamReader=void 0;var i=r(15302),n=function(){function e(){this._bits=[]}return e.prototype.addBytes=function(e){for(var t=0;t<e.length;t++){var r=e[t];this._bits.push(!!(128&r),!!(64&r),!!(32&r),!!(16&r),!!(8&r),!!(4&r),!!(2&r),!!(1&r))}},e.prototype.readBits=function(e){if(this._bits.length<e)throw new i.InvalidOperationError("Failed to read '".concat(e,"' bytes from '").concat(this._bits.length,"' bits"));for(var t=0,r=0;r<e;r++)!0===this._bits.shift()&&(t+=1<<e-1-r);return t},e.prototype.clear=function(){this._bits=[]},e}();t.BitStreamReader=n},67179:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CodecUtil=void 0;var r=function(){function e(){}return e.prototype.getAudioGroup=function(e){switch(e.codecs.substring(0,4)){case"ac-3":return"ac-3";case"mp4a":return"5"===e.codecs[8]?"heaac":"aac";case"ec-3":if((2&e.attributes)!=0)return"ec-3-atmos";return"ec-3"}return"unknown-audio"},e.prototype.getVideoGroup=function(t){switch(t.codecs.substring(0,4)){case"dvh1":return"dvh";case"hev1":case"hvc1":if(e.SIGNAL_HEVC_HDR_WITH_VIDEO_RANGE_PQ){if((32&t.attributes)!=0)return"hevc-hdr"}else if("2"===t.codecs[5])return"hevc-hdr";return"hevc";case"avc1":return"avc"}return"unknown-video"},e.prototype.getCodecGroup=function(e){return"audio"===e.mimeType.substring(0,5)?this.getAudioGroup(e):this.getVideoGroup(e)},e.prototype.isCodecGroupCompatible=function(e,t){return e===t||"ec-3"===e&&"ec-3-atmos"===t||"ec-3-atmos"===e&&"ec-3"===t},e.prototype.trimCodecsFromMimeString=function(e){var t,r;return null!==(r=null===(t=e.match(/codecs="([^"]*)"/))||void 0===t?void 0:t[1])&&void 0!==r?r:""},e.SIGNAL_HEVC_HDR_WITH_VIDEO_RANGE_PQ=!0,e}();t.CodecUtil=r},36899:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cta608Util=void 0;var i=r(22970),n=r(91475),o=function(){function e(){}return e.prototype.isDisplayBlank=function(e){return e.chunks.every(function(e){return 0===e.text.length})},e.prototype.isDisplayEqual=function(e,t){if(this.isDisplayBlank(e)&&this.isDisplayBlank(t))return!0;if(e.chunks.length!==t.chunks.length)return!1;for(var r=0;r<e.chunks.length;++r){var i=e.chunks[r],n=t.chunks[r];if(i.row!==n.row||i.indent!==n.indent||i.text!==n.text)return!1}return!0},e.prototype.cloneDisplay=function(e){return{chunks:e.chunks.map(function(e){return i.__assign({},e)})}},e.prototype.displayToCues=function(e,t,r){for(var n=[],o=0,a=this._groupChunks(e);o<a.length;o++){for(var s=a[o],u=this._toCueGroup(s,t,r),c=[],d=0;d<s.length;d++){var l=s[d],h=this._toCueGroup([l],t,r).position;c.push({text:l.text,position:i.__assign(i.__assign({},h),{textAlignment:"start",sizePercent:1})})}n.push(i.__assign(i.__assign({},u),{individualCues:c}))}return n},e.prototype._abuts=function(e,t){if(1!==Math.abs(e.row-t.row))return!1;var r=e.indent,i=r+e.text.length,n=t.indent,o=n+t.text.length;return i>n&&o>r},e.prototype._groupChunks=function(e){if(0===e.chunks.length)return[];var t=[];t.push([e.chunks[0]]);for(var r=1;r<e.chunks.length;++r){var i=e.chunks[r],n=t[t.length-1],o=n[n.length-1];this._abuts(o,i)?n.push(i):t.push([i])}return t},e.prototype._inferAlignment=function(e){if(0===e.length)return"left";var t=e[0].indent,r=t+e[0].text.length;return e.every(function(e){return e.indent===t})?"left":e.every(function(e){return e.indent+e.text.length===r})?"right":"center"},e.prototype._toCueGroup=function(e,t,r){if(0===e.length)return{text:[],position:{positionAlignment:"left",textAlignment:"left"},start:t,end:r};var i,o=(e[0].row-1)/n.NUM_ROWS,a=this._inferAlignment(e);switch(a){case"left":i=e[0].indent/n.NUM_COLUMNS;break;case"right":i=(e[0].indent+e[0].text.length)/n.NUM_COLUMNS;break;case"center":i=(Math.min.apply(Math,e.map(function(e){return e.indent}))+Math.max.apply(Math,e.map(function(e){return e.indent+e.text.length})))/2/n.NUM_COLUMNS}return{text:e.map(function(e){return e.text}),position:{positionAlignment:a,textAlignment:a,linePercent:.8*o+.1,positionPercent:.8*i+.1},start:t,end:r}},e}();t.Cta608Util=o},23280:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataViewReader=void 0;var i=r(15302),n=r(17590),o=function(){function e(e,t){void 0===t&&(t=!1),this._position=0,this._stringUtil=new n.StringUtil,this._dataView=e,this._littleEndian=t}return e.prototype.getByteOffset=function(){return this._dataView.byteOffset},e.prototype.hasMoreData=function(){return this._position<this._dataView.byteLength},e.prototype.getPosition=function(){return this._position},e.prototype.getLength=function(){return this._dataView.byteLength},e.prototype.readUInt8=function(){try{var e=this._dataView.getUint8(this._position);return this._position+=1,e}catch(e){throw new i.InvalidOperationError("Failed to parse Uint8 at position '".concat(this._position,"'"))}},e.prototype.readUInt16=function(){try{var e=this._dataView.getUint16(this._position,this._littleEndian);return this._position+=2,e}catch(e){throw new i.InvalidOperationError("Failed to parse Uint16 at position '".concat(this._position,"'"))}},e.prototype.readUInt24=function(){try{var e=[this.readUInt8(),this.readUInt8(),this.readUInt8()];return this._littleEndian&&(e=e.reverse()),65536*e[0]+256*e[1]+e[2]}catch(e){throw new i.InvalidOperationError("Failed to parse Uint16 at position '".concat(this._position,"'"))}},e.prototype.readUInt32=function(){try{var e=this._dataView.getUint32(this._position,this._littleEndian);return this._position+=4,e}catch(e){throw new i.InvalidOperationError("Failed to parse Uint32 at position '".concat(this._position,"'"))}},e.prototype.readInt32=function(){try{var e=this._dataView.getInt32(this._position,this._littleEndian);return this._position+=4,e}catch(e){throw new i.InvalidOperationError("Failed to parse Int32 at position '".concat(this._position,"'"))}},e.prototype.readUInt64=function(){var e,t;try{this._littleEndian?(e=this._dataView.getUint32(this._position,!0),t=this._dataView.getUint32(this._position+4,!0)):(t=this._dataView.getUint32(this._position,!1),e=this._dataView.getUint32(this._position+4,!1))}catch(e){throw new i.InvalidOperationError("Failed to parse Uint64 at position '".concat(this._position,"'"))}if(t>2097151)throw new i.InvalidOperationError("Integer overflow reading Uint64 with low '".concat(e,"' and high '").concat(t,"'"));return this._position+=8,4294967296*t+e},e.prototype.readInt64=function(){var e,t;try{this._littleEndian?(e=this._dataView.getUint32(this._position,!0),t=this._dataView.getInt32(this._position+4,!0)):(t=this._dataView.getInt32(this._position,!1),e=this._dataView.getUint32(this._position+4,!1))}catch(e){throw new i.InvalidOperationError("Failed to parse Uint64 at position '".concat(this._position,"'"))}if(t>2097151)throw new i.InvalidOperationError("Integer overflow reading Uint64 with low '".concat(e,"' and high '").concat(t,"'"));return this._position+=8,4294967296*t+e},e.prototype.readFixed8x8=function(){try{return this.readUInt16()/256}catch(e){throw new i.InvalidOperationError("Unable to read 8x8 fixed point value at '".concat(this._position,"'"))}},e.prototype.readFixed16x16=function(){try{return this.readUInt32()/65536}catch(e){throw new i.InvalidOperationError("Unable to read 16x16 fixed point value at '".concat(this._position,"'"))}},e.prototype.readFixed2x30=function(){try{return this.readUInt32()/1073741824}catch(e){throw new i.InvalidOperationError("Unable to read 2x30 fixed point value at '".concat(this._position,"'"))}},e.prototype.checkRemaining=function(e){if(this._position+e>this._dataView.byteLength)throw new i.InvalidOperationError("Cannot read at position '".concat(this._position+e,"' with length '").concat(this._dataView.byteLength,"'"))},e.prototype.readBytes=function(e){this.checkRemaining(e);var t=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._position,e);return this._position+=e,new Uint8Array(t)},e.prototype.skip=function(e){this.checkRemaining(e),this._position+=e},e.prototype.rewind=function(e){if(this._position<e)throw new i.InvalidOperationError("Cannot rewind '".concat(e,"' from position '").concat(this._position,"'"));this._position-=e},e.prototype.seek=function(e){if(e<0||e>this._dataView.byteLength)throw new i.InvalidOperationError("Index is out of bounds, position '".concat(e,"' with length '").concat(this._dataView.byteLength,"'"));this._position=e},e.prototype.readTerminatedString=function(){for(var e=this._position;this.hasMoreData()&&0!==this._dataView.getUint8(this._position);)this._position+=1;var t=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+e,this._position-e);return this._position+=1,this._stringUtil.fromUTF8(t)},e.prototype.readString=function(e){this.checkRemaining(e);for(var t="",r=e;r>0;r--)t+=String.fromCharCode(this._dataView.getUint8(this._position++));return t},e}();t.DataViewReader=o},1679:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DateUtil=void 0;var r=function(){function e(){}return e.parseDate=function(e){/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z");var t=Date.parse(e);return isNaN(t)?void 0:t/1e3},e}();t.DateUtil=r},88269:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageUtil=void 0;var r=function(){function e(){}return e.prototype.isLocaleCompatible=function(e,t){return(e=this.normalize(e))===(t=this.normalize(t))},e.prototype.isLanguageCompatible=function(e,t){var r=this.disassemble(e),i=this.disassemble(t);return r[0]===i[0]},e.prototype.isParentOf=function(e,t){var r=this.disassemble(e),i=this.disassemble(t);return r[0]===i[0]&&1===r.length&&2===i.length},e.prototype.isSiblingOf=function(e,t){var r=this.disassemble(e),i=this.disassemble(t);return 2===r.length&&2===i.length&&r[0]===i[0]},e.prototype.findClosestLocale=function(e,t){e=this.normalize(e);for(var r,i,n,o=[],a=0;a<t.length;a++){var s=t[a],u=this.normalize(s);if(u===e)return e;o.push(u)}for(var c=0;c<o.length;c++){var d=o[c];void 0===r&&this.isParentOf(d,e)&&(r=d),void 0===i&&this.isSiblingOf(d,e)&&(i=d),void 0===n&&this.isParentOf(e,d)&&(n=d)}return void 0!==r&&r.length>0?r:void 0!==i&&i.length>0?i:n},e.prototype.disassemble=function(e){return e=this.normalize(e),this._disassembleInternal(e)},e.prototype.normalize=function(t){var r,i,n=this._disassembleInternal(t),o=(null!==(r=n[0])&&void 0!==r?r:"").toLowerCase(),a=null!==(i=n[1])&&void 0!==i?i:"",s=e._languageMap[o];return(void 0!==s&&(o=s),""!==a)?o+"-"+a.toUpperCase():o},e.prototype.fuzzyLanguageMatch=function(e,t,r){return this.findClosestLocale(e,r)===this.normalize(t)},e.prototype._disassembleInternal=function(e){return e.split("-")},e._languageMap={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"},e}();t.LanguageUtil=r},28210:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ManifestUtil=void 0;var i=r(67179),n=function(){function e(){}return e.prototype.getHdrModes=function(e){for(var t=new i.CodecUtil,r=!1,n=!1,o=0;o<e.length;o++)for(var a=e[o],s=0,u=a.video;s<u.length;s++){var c=u[s],d=t.getVideoGroup(c);if("dvh"===d?r=!0:"hevc-hdr"===d&&(n=!0),r&&n)return["dvh","hevc-hdr"]}return r?["dvh"]:n?["hevc-hdr"]:[]},e.prototype.setStreamPosition=function(e,t,r){e.initialStartTime=t,e.initialOriginTime=r;var i=e.getCachedDetails();void 0!==i&&this.setStreamDetailsPosition(i,t,r)},e.prototype.setStreamDetailsPosition=function(e,t,r){e.segments.startTime=t,e.segments.origin=r},e}();t.ManifestUtil=n},48360:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MimeUtil=void 0;var i=r(17590),n=function(){function e(){this._stringUtil=new i.StringUtil}return e.prototype.getFullType=function(e,t){var r=e;return t.length>0&&(r+='; codecs="'.concat(t,'"')),r},e.prototype.getExtendedType=function(e){var t=Array(e.mimeType);return e.codecs.length>0&&t.push('codecs="'+e.codecs+'"'),"audio"===e.type?t.push('dolbyAtmos="'+!!(2&e.attributes)+'"'):"video"===e.type&&(32&e.attributes)!=0&&t.push('videoRange="PQ"'),void 0!==e.frameRate&&e.frameRate>0&&t.push('framerate="'+e.frameRate+'"'),void 0!==e.bandwidth&&e.bandwidth>0&&t.push('bitrate="'+e.bandwidth+'"'),void 0!==e.width&&e.width>0&&t.push('width="'+e.width+'"'),void 0!==e.height&&e.height>0&&t.push('height="'+e.height+'"'),void 0!==e.channelsCount&&e.channelsCount>0&&t.push('channels="'+e.channelsCount+'"'),t.join("; ")},e.prototype.getCodecBase=function(e){return this._getCodecParts(e)[0]},e.prototype.getStreamTypeFromMimeType=function(e){if(this._stringUtil.startsWith("audio",e))return"audio";if(this._stringUtil.startsWith("video",e))return"video";if(this._stringUtil.startsWith("text",e)||"application/mp4"===e)return"text";if(this._stringUtil.startsWith("image",e))return"image";throw Error("Invalid mimeType string. mimeType: "+e)},e.prototype._getCodecParts=function(e){var t=e.split("."),r=t[0];return t.pop(),[r,t.join(".")]},e}();t.MimeUtil=n},70387:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkHelpers=void 0;var r=function(){function e(){}return e.addLicenseAuthorization=function(e,t){this.setLicenseHeaderValue(e,"Authorization",t)},e.setLicenseHeaderValue=function(e,t,r){var i;void 0!==r&&"license"===e.type&&(e.headers=null!==(i=e.headers)&&void 0!==i?i:{},e.headers[t]=r)},e.parseRangeHeader=function(e){void 0===e&&(e={});var t,r,i=null!==(r=null===(t=e.Range)||void 0===t?void 0:t.match(/^bytes=([0-9]+)-([0-9]+)?$/))&&void 0!==r?r:[],n=i[1],o=i[2];if(void 0!==n){var a={startByte:parseInt(n)};return void 0!==o&&(a.endByte=parseInt(o)),a}},e.isSuccessfulResponseCode=function(e){return e>=200&&e<300},e}();t.NetworkHelpers=r},60064:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkUtil=void 0;var i=r(22970),n=r(6246),o=r(70387),a=r(14789),s=r(43495),u=r(88616),c=r(34518),d=r(19808),l=r(57665),h=function(){function e(e){this._system=e}return e.prototype._getContext=function(e,t){return{url:e.resource,responseText:"string"==typeof(null==t?void 0:t.data)?t.data:void 0,statusCode:null==t?void 0:t.status}},e.prototype._getPayload=function(t,r,n,h,p){var f;return i.__awaiter(this,void 0,void 0,function(){var _,v,m,g,y,S,E,b,w,P;return i.__generator(this,function(i){switch(i.label){case 0:return v=r.count,m=[],g=[],[4,null==p?void 0:p(null!==(f=t.offlineWaitTimeoutMS)&&void 0!==f?f:e.DEFAULT_OFFLINE_WAIT_TIMEOUT_MS)];case 1:i.sent(),i.label=2;case 2:y=Date.now(),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,n()];case 4:if(_=i.sent(),o.NetworkHelpers.isSuccessfulResponseCode(_.status))return[2,_];return m.push(new a.NetworkRequestError("unsuccessful status from server: ".concat(_.status),this._getContext(t,_))),[3,6];case 5:if((S=i.sent())instanceof l.WrappedError&&(E=l.WrappedError.causedBy(S,c.OperationCanceledError.NAME),b=l.WrappedError.causedBy(S,d.OperationTimedOutError.NAME)||l.WrappedError.causedBy(S,s.NoProgressMadeError.NAME),w="audio"===t.type||"video"===t.type||"text"===t.type,E||w&&b))throw S;return m.push(l.WrappedError.wrap(S)),[3,6];case 6:if(!(void 0!==_&&void 0!==h))return[3,8];return[4,h(_)];case 7:i.sent(),i.label=8;case 8:if(g.push({start:y,end:Date.now()}),r.count--,!(r.count>=0))return[3,10];return[4,this._system.postTimeout(r.delay/1e3).timeout];case 9:i.sent(),r.delay*=2,i.label=10;case 10:if(r.count>=0)return[3,2];i.label=11;case 11:if(void 0===_){if(P=new a.NetworkRequestError("Failed to get response after ".concat(v," retries: ").concat(this._makeResourceIdentifier(t)),this._getContext(t,_),m,g),!this._system.onLine)throw new u.OfflineError("No internet connection detected by the browser",P);throw P}return[2,_]}})})},e.prototype.makeNetworkClient=function(t){var r,n,o,a=this;(void 0===t.timeoutMS||0===t.timeoutMS)&&(t=i.__assign(i.__assign({},t),{timeoutMS:e.DEFAULT_TIMEOUT_MS})),null===(r=t.cmcd)||void 0===r||r.modifyNetworkRequest(t);var s=this._system.makeNetworkClient(t),u={count:null!==(n=t.retryCount)&&void 0!==n?n:this._getRetryValues(t.type),delay:null!==(o=t.retryDelay)&&void 0!==o?o:e.DEFAULT_RETRY_DELAY};return{cancel:function(){s.cancel()},payloadReference:function(){return a._getPayload(t,u,function(){return s.payloadReference()},function(e){return e.data.deleteFromMemory()},function(e){return s.waitIfOffline(e)})},payloadBuffer:function(){return a._getPayload(t,u,function(){return s.payloadBuffer()},void 0,function(e){return s.waitIfOffline(e)})},payloadString:function(){return a._getPayload(t,u,function(){return s.payloadString()},void 0,function(e){return s.waitIfOffline(e)})},waitIfOffline:function(e){return s.waitIfOffline(e)}}},e.prototype._makeResourceIdentifier=function(t){var r="";if(void 0!==t.headers){for(var i=[],n=0,o=Object.keys(t.headers);n<o.length;n++){var a=o[n];e.PRINT_HEADER_BLOCKLIST.has(a)||i.push("".concat(a,": ").concat(t.headers[a]))}r=" | ".concat(i.join(","))}return"".concat(t.method,": ").concat(t.resource).concat(r)},e.prototype._getRetryValues=function(t){var r;switch(t){case"manifest":r=e.MANIFEST_RETRY_COUNT;break;case"license":r=e.LICENSE_RETRY_COUNT;break;default:r=e.DEFAULT_RETRY_COUNT}return r},e.DEFAULT_OFFLINE_WAIT_TIMEOUT_MS=3e4,e.DEFAULT_TIMEOUT_MS=3e5,e.DEFAULT_RETRY_DELAY=1e3,e.DEFAULT_RETRY_COUNT=1,e.MANIFEST_RETRY_COUNT=2,e.LICENSE_RETRY_COUNT=1,e.PRINT_HEADER_BLOCKLIST=new n.HashSet(["Authorization"]),e}();t.NetworkUtil=h},4679:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pairEquals=void 0,t.pairEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]}},27574:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerUtil=void 0;var i=r(22970),n=r(69964),o=r(29368),a=r(94306),s=r(6246),u=r(67179),c=function(){function e(){this._arrayUtil=new n.ArrayUtil,this._timeUtil=new o.TimeRangeUtil,this._codecUtil=new u.CodecUtil}return e.prototype.isPeriodEncrypted=function(e){for(var t=0===e.video.length,r=0===e.audio.length,i=0,n=e.video;i<n.length;i++){var o=n[i],a=this.isStreamEncrypted(o);if(!0===a)return!0;!1===a&&(t=!0)}for(var s=0,u=e.audio;s<u.length;s++){var c=u[s],a=this.isStreamEncrypted(c);if(!0===a)return!0;!1===a&&(r=!0)}if(r&&t)return!1},e.prototype.isStreamEncrypted=function(e){var t=e.getCachedDetails();if(void 0!==t)return t.segments.length>0&&void 0!==t.segments.getSegment(0).keyId},e.prototype.getPeriodForTime=function(e,t){for(var r=0;r<e.length;r++){var i=e[r],n=this.getRangeOfPeriod(i);if(void 0!==n&&this._timeUtil.contains([n],t))return i}},e.prototype.getClosestSizeStream=function(e,t,r){for(var i,n,o=0;o<e.length;o++){var a=e[o];if(void 0!==a.width&&void 0!==a.height){var s=Math.abs(t-a.width),u=Math.abs(r-a.height),c=s*s+u*u;(void 0===i||c<i)&&(i=c,n=a)}}return n},e.prototype.getStream=function(e,t){var r;if("audio"===t)r=e.audioDetails;else if("video"===t)r=e.videoDetails;else if("text"===t)r=e.textDetails;else throw Error("Invalid stream type ".concat(t));return r},e.prototype.getStreams=function(e,t){return"text"===t?e.text:"audio"===t?e.audio:"video"===t?e.video:e.image},e.prototype.iteratePeriodStreams=function(e,t){for(var r=0,n=i.__spreadArray(i.__spreadArray(i.__spreadArray(i.__spreadArray([],e.audio,!0),e.video,!0),e.text,!0),e.image,!0);r<n.length;r++)t(n[r])},e.prototype.replacePeriodStreams=function(e,t){for(var r=0;r<e.audio.length;r++)e.audio[r]=t(e.audio[r]);for(var r=0;r<e.video.length;r++)e.video[r]=t(e.video[r]);for(var r=0;r<e.text.length;r++)e.text[r]=t(e.text[r]);for(var r=0;r<e.image.length;r++)e.image[r]=t(e.image[r])},e.prototype.getRangeOfPeriods=function(e){for(var t,r=0;r<e.length;r++){var i=e[r],n=this.getRangeOfPeriod(i);void 0!==n&&(null!=t||(t=n),t.start=Math.min(t.start,n.start),t.end=Math.max(t.end,n.end))}return t},e.prototype.getRangeOfPeriod=function(e){for(var t,r=0,n=i.__spreadArray(i.__spreadArray([],e.audio,!0),e.video,!0);r<n.length;r++){var o=n[r];t=this._mergeStreamRange(t,o)}return t},e.prototype.getRangeOfVariant=function(e){for(var t,r=0,i=[e.audio,e.video];r<i.length;r++){var n=i[r];void 0!==n&&(t=this._mergeStreamRange(t,n))}return t},e.prototype.getRangeOfStream=function(e){if(void 0!==e){var t=e.segments.getTiming(0),r=e.segments.getTiming(e.segments.length-1);return{start:t.start,end:r.end}}},e.prototype.getSegmentByTime=function(e,t){var r=this.binarySearchForSegmentIndex(e,t);if(r>=0)return e.getSegment(r)},e.prototype.getSegmentIndicesInRange=function(e,t){if(0===e.length)throw Error("Could not get segments on empty segment list");var r=this.binarySearchForSegmentIndex(e,t.start);r<0&&(r=-r-1);var i=this.binarySearchForSegmentIndex(e,t.end);if(i<0)i=-i-1;else{var n=e.getTiming(i);(t.start===t.end||t.end!==n.start)&&i++}return{startIndex:r,endIndexExclusive:i}},e.prototype.getSegmentForSnapping=function(e,t,r){var i,n,o=this.binarySearchForSegmentIndex(e,t);if(o<0){var a=-o-1;a<e.length&&(n=e.tryGetTiming(a)),a>0&&(i=e.tryGetTiming(a-1))}else{if(e.getTiming(o).start===t)return e.getTiming(o);i=e.getTiming(o),o+1<e.length&&(n=e.tryGetTiming(o+1))}if(void 0!==i&&(!(o<0)||void 0!==n))switch(r){case"CLOSEST_VIDEO_SEGMENT_START":return t-i.start<(void 0!==n?n.start-t:1/0)?i:n;case"PREVIOUS_VIDEO_SEGMENT_START":return i;case"NEXT_VIDEO_SEGMENT_START":return null!=n?n:i}},e.prototype._mergeStreamRange=function(e,t){var r=this.getRangeOfStream(t.getCachedDetails());return void 0!==r&&(null!=e||(e=r),e.start=Math.max(e.start,r.start),e.end=Math.min(e.end,r.end)),e},e.prototype.binarySearchForSegmentIndex=function(e,t){return this.binarySearchForIndex(e.length,function(t){return e.getTiming(t)},t)},e.prototype.binarySearchForIndex=function(e,t,r){return this._arrayUtil.binarySearch(e,t,r,function(e,t){return e<t.start?-1:e>=t.end?1:0})},e.prototype.isTrackPreferencesEqual=function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var i=e[r],n=t[r];if(i.attributes!==n.attributes||i.label!==n.label||i.language!==n.language)return!1}return!0},e.prototype.groupKeyTypesByCodec=function(e,t){for(var r,i=new a.HashMap,n=0;n<e.length;n++)for(var o=e[n],u=this._codecUtil.getVideoGroup(o),c=0,d=null!==(r=o.drmInfo)&&void 0!==r?r:[];c<d.length;c++){var l=t(d[c].keyId);i.contains(u)||i.set(u,new s.HashSet),i.get(u).add(l)}return i},e.prototype.isEmptyStream=function(e){if(1===e.segments.length){var t=e.segments.getTiming(0);return t.end-t.start==0}return!1},e}();t.PlayerUtil=c},90149:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentUtil=void 0;var i=r(22970),n=function(){function e(){}return e.prototype.getSegmentRequest=function(e,t,r){var n;return n="start"in e?i.__assign(i.__assign({},r),{type:"media",start:e.start,end:e.end}):i.__assign(i.__assign({},r),{type:"init"}),{resource:e.createUri,method:"GET",headers:this._getRangeHeaders(e),type:t,segmentContext:n}},e.prototype._getRangeHeaders=function(e){var t,r,i;return void 0!==e.startByte&&((t={}).Range="bytes=".concat(e.startByte,"-").concat(null!==(r=e.endByte)&&void 0!==r?r:""),i=t),i},e}();t.SegmentUtil=n},12474:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SortedCollection=void 0;var i=r(15302),n=r(69964),o=function(){function e(e,t){void 0===t&&(t=[]),this._compareFn=e,this._items=[],this._arrayUtil=new n.ArrayUtil;for(var r=0,i=t;r<i.length;r++){var o=i[r];this.add(o,this.length)}}return Object.defineProperty(e.prototype,"length",{get:function(){return this._items.length},enumerable:!1,configurable:!0}),e.prototype.toArray=function(){return this._items},e.prototype.getAt=function(e){if(e<0||e>=this.length)throw new i.InvalidOperationError("SortedCollection.at: invalid index ".concat(e," (length=").concat(this.length,")"));return this._items[e]},e.prototype.tryGetAt=function(e){return this._items[e]},e.prototype.getFirst=function(){return this.getAt(0)},e.prototype.tryGetFirst=function(){return this.tryGetAt(0)},e.prototype.getLast=function(){return this.getAt(this.length-1)},e.prototype.tryGetLast=function(){return this.tryGetAt(this.length-1)},e.prototype.forEach=function(e){this._items.forEach(e)},e.prototype.add=function(e,t){var r;return r=void 0!==t&&t>=0&&t<=this.length&&(0===t||this._compareFn(e,this._items[t-1])>=0)&&(t===this.length||this._compareFn(this._items[t],e)>=0)?t:this.upperBound(e),this._items.splice(r,0,e),r},e.prototype.removeAt=function(e,t){if(void 0===t&&(t=1),e<0||t<0||e+t>this.length)throw new i.InvalidOperationError("SortedCollection.removeAt: invalid index or count");this._items.splice(e,t)},e.prototype.removeIf=function(e){this._items=this._items.filter(function(t){return!e(t)})},e.prototype.filter=function(t){var r=new e(this._compareFn);return r._items=this._items.filter(t),r},e.prototype.find=function(e){return this._arrayUtil.binarySearchArray(this._items,e,this._compareFn,"lower_bound")},e.prototype.lowerBound=function(e){var t=this._arrayUtil.binarySearchArray(this._items,e,this._compareFn,"lower_bound");return t<0?-t-1:t},e.prototype.upperBound=function(e){var t=this._arrayUtil.binarySearchArray(this._items,e,this._compareFn,"upper_bound");return t<0?-t-1:t},e}();t.SortedCollection=o},2254:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SortedIntervalCollection=void 0;var i=r(12474),n=function(){function e(e){void 0===e&&(e=[]),this._items=new i.SortedCollection(function(e,t){return e.start-t.start},e),this._maxEnd=Array(e.length),this._updateMaxEnd()}return Object.defineProperty(e.prototype,"length",{get:function(){return this._items.length},enumerable:!1,configurable:!0}),e.prototype.toArray=function(){return this._items.toArray()},e.prototype.getAt=function(e){return this._items.getAt(e)},e.prototype.tryGetAt=function(e){return this._items.tryGetAt(e)},e.prototype.add=function(e,t){var r=this._items.add(e,t);return this._maxEnd.splice(r,0,-1/0),this._updateMaxEnd(r,r),r},e.prototype.removeAt=function(e,t){void 0===t&&(t=1),this._items.removeAt(e,t),this._maxEnd.splice(e,t),this._updateMaxEnd(e,e)},e.prototype.removeIf=function(e){this._items.removeIf(e),this._items.length!==this._maxEnd.length&&(this._maxEnd.splice(this._items.length),this._updateMaxEnd())},e.prototype.find=function(e){for(var t=[],r=this.upperBound(e)-1;r>=0&&e<this._maxEnd[r];--r){var i=this._items.getAt(r);e<i.end&&t.unshift(i)}return t},e.prototype.lowerBound=function(e){return this._items.lowerBound({start:e})},e.prototype.upperBound=function(e){return this._items.upperBound({start:e})},e.prototype._updateMaxEnd=function(e,t){var r;void 0===e&&(e=0),void 0===t&&(t=this.length);for(var i=e;i<this.length;++i){var n=Math.max(this._items.getAt(i).end,null!==(r=this._maxEnd[i-1])&&void 0!==r?r:-1/0);if(i>=t&&this._maxEnd[i]===n)break;this._maxEnd[i]=n}},e}();t.SortedIntervalCollection=n},17590:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StringUtil=void 0;var i=r(5375),n=r(95645),o=r(57665),a=function(){function e(){}return e.prototype.reverse=function(e){return e.split("").reverse().join("")},e.prototype.padStart=function(e,t,r){for(;e.length<t;)e="".concat(r).concat(e);return e},e.prototype.removeNewlines=function(e){return e.replace(/\n|\r/gm,"")},e.prototype.fromUTF8=function(e){this.hasByteOrderMark(e)&&(e=e.subarray(3));var t=escape(this.fromCharCode(e));try{return decodeURIComponent(t)}catch(e){throw new i.TextEncodingError("Could not decode ArrayBuffer",o.WrappedError.wrap(e,"TextEncodingError"))}},e.prototype.fromUTF16=function(e,t,r){if(void 0===r&&(r=!1),!r&&e.byteLength%2!=0)throw new i.TextEncodingError("Incorrect length for UTF16");if(e instanceof ArrayBuffer)n=e;else{var n,o=new Uint8Array(e.byteLength);o.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),n=o.buffer}for(var a=Math.floor(e.byteLength/2),s=new Uint16Array(a),u=new DataView(n),c=0;c<a;c++)s[c]=u.getUint16(2*c,t);return this.fromCharCode(new Uint8Array(s))},e.prototype.toUTF8=function(e){for(var t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length),i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r},e.prototype.toUTF16=function(e,t){for(var r=new Uint8Array(2*e.length),i=new DataView(r.buffer),n=0;n<e.length;n++){var o=e.charCodeAt(n);i.setUint16(2*n,o,t)}return r.buffer},e.prototype.toCharCode=function(e){for(var t=new Uint8Array(e.length),r=0,i=e.length;r<i;r++)t[r]=e.charCodeAt(r);return t},e.prototype.fromCharCode=function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e.prototype.hasByteOrderMark=function(e){return 239===e[0]&&187===e[1]&&191===e[2]},e.prototype.toHex=function(e){for(var t="",r=0,i=e.length;r<i;r++){var n=e[r].toString(16);n.length<2&&(n="0"+n),t+=n}return t},e.prototype.fromHexString=function(e){if(e.length%2!=0)throw new n.UnsupportedError("Invalid hex string input, expected even number of characters");for(var t=new Uint8Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=parseInt(e[r]+e[r+1],16);return t},e.prototype.toStandardBase64=function(t){if(/[^\0-\xFF]/.test(t))throw Error("The string to be encoded contains characters outside of the Latin1 range.");for(var r,i,n,o=t.length%3,a="",s=-1,u=t.length-o;++s<u;)n=(r=t.charCodeAt(s)<<16)+(t.charCodeAt(++s)<<8)+t.charCodeAt(++s),a+=e.TABLE[n>>18&63]+e.TABLE[n>>12&63]+e.TABLE[n>>6&63]+e.TABLE[63&n];return 2===o?(n=(r=t.charCodeAt(s)<<8)+t.charCodeAt(++s),a+=e.TABLE[n>>10]+e.TABLE[n>>4&63]+e.TABLE[n<<2&63]+"="):void 0!==n&&1===o&&(n=t.charCodeAt(s),a+=e.TABLE[n>>2]+e.TABLE[n<<4&63]+"=="),a},e.prototype.fromStandardBase64=function(t){var r,i=(t=t.replace(/[\t\n\f\r ]/g,"")).length;if(i%4==0&&(i=(t=t.replace(/==?$/,"")).length),i%4==1||/[^+a-zA-Z0-9/]/.test(t))throw Error("Invalid character: the string to be decoded is not correctly encoded.");for(var n=0,o=0,a="",s=-1;++s<i;)r=e.TABLE.indexOf(String(t[s])),o=n%4!=0?64*o+r:r,n++%4!=0&&(a+=String.fromCharCode(255&o>>(-2*n&6)));return a},e.prototype.replaceAll=function(e,t,r,i){if(0===t.length)return e;for(var n=e.indexOf(t);-1!==n;){var o=n+t.length,a=e.indexOf(r,o);if(-1===a)break;var s=i(e.substring(o,a));n=(e=[e.substring(0,n),s,e.substring(a+r.length)].join("")).indexOf(t,n+s.length)}return e},e.prototype.startsWith=function(e,t,r){if(void 0===r&&(r=0),e.length>t.length-r)return!1;for(var i=0;i<e.length;++i)if(e[i]!==t[i+r])return!1;return!0},e.TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e}();t.StringUtil=a},57457:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextParser=void 0;var r=function(){function e(e){this._position=0,this._data=e}return e.prototype.isAtEnd=function(){return this._position===this._data.length},e.prototype.readLine=function(){return this._readRegexReturnCapture(/(.*?)(\n|$)/gm,1)},e.prototype.readWord=function(){return this._readRegexReturnCapture(/[^ \t\n]*/gm,0)},e.prototype.skipWhitespace=function(){this.readRegex(/[ \t]+/gm)},e.prototype.readRegex=function(e){var t=[],r=this._indexOf(e);return this.isAtEnd()||void 0===r||r.position!==this._position||(this._position+=r.length,t=r.results),t},e.prototype._readRegexReturnCapture=function(e,t){var r;return this.isAtEnd()||(r=this.readRegex(e)[t]),r},e.prototype._indexOf=function(e){e.lastIndex=this._position;var t,r=e.exec(this._data);return null!==r&&(t={position:r.index,length:r[0].length,results:r}),t},e}();t.TextParser=r},44639:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numberKeys=t.stringKeys=void 0,t.stringKeys=function(e){return Object.keys(e)},t.numberKeys=function(e){return Object.keys(e).map(Number)}},36630:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VariantUtil=void 0;var i=r(22970),n=r(29080),o=r(12474),a=function(){function e(){}return e.prototype.createSortedVariantListFromStreamCollection=function(e){for(var t,r,i,a=this,s=e.audio.length>0?e.audio:[void 0],u=e.video.length>0?e.video:[void 0],c=e.text.length>0?e.text:[void 0],d=Array(s.length*u.length*c.length),l=0,h=0;h<s.length;h++)for(var p=s[h],f=0;f<u.length;f++)for(var _=u[f],v=0;v<c.length;v++)!function(e){var o={bandwidth:(null!==(t=null==_?void 0:_.bandwidth)&&void 0!==t?t:0)+(null!==(r=null==p?void 0:p.bandwidth)&&void 0!==r?r:0)+(null!==(i=null==e?void 0:e.bandwidth)&&void 0!==i?i:0),audio:p,video:_,text:e},s=new n.VariantMetadata(o,function(){return a._getDetailsForVariant(o)});d[l++]=s}(c[v]);var m=function(e,t){return e.bandwidth-t.bandwidth};return d.sort(m),new o.SortedCollection(m,d)},e.prototype._getDetailsForVariant=function(e){var t,r,n;return i.__awaiter(this,void 0,void 0,function(){var o,a,s,u;return i.__generator(this,function(c){switch(c.label){case 0:return[4,Promise.all([null===(t=e.audio)||void 0===t?void 0:t.getDetails(),null===(r=e.video)||void 0===r?void 0:r.getDetails(),null===(n=e.text)||void 0===n?void 0:n.getDetails()])];case 1:return a=(o=c.sent())[0],s=o[1],void 0!==(u=o[2])&&void 0!==a&&u.segments.length>0&&a.segments.length>0&&(u.segments.startTime=a.segments.getTiming(0).start,u.segments.durationFill=a.segments.getTiming(a.segments.length-1).end),[2,i.__assign(i.__assign({},e),{audioDetails:a,videoDetails:s,textDetails:u})]}})})},e}();t.VariantUtil=a},92271:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VttUtil=void 0;var i=r(69964),n=function(){function e(){this._arrayUtil=new i.ArrayUtil}return e.prototype.isCueEqual=function(e,t){return e.start===t.start&&e.end===t.end&&this._arrayUtil.areEqual(e.text,t.text)},e}();t.VttUtil=n},8069:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SeekOnTrackChangeWorkaround=void 0;var i=r(47632),n=r(57665),o=r(34855),a="SeekOnTrackChangeWorkaround",s=function(){function e(e,t,r){this.onError=new i.Emitter,this._bufferItemPhaseChange=t,this._inject=r,this._system=e}return e.prototype.getKey=function(e){return e.language+":"+e.attributes},e.prototype.onAppendCompleted=function(t){var r=this;if(void 0!==this._lastRemovedTime){var i=this._inject.getCurrentTime();void 0!==i&&(i>=t.pipelineState.start&&i<=t.pipelineState.end&&i>=this._lastRemovedTime&&i-this._lastRemovedTime<=e.TIME_THRESHOLD_SECONDS&&this.getKey(t.stream)!==this._lastRemovedLanguage?(this._system.logInfo("".concat(a,": seeking to current time to reset buffer from ").concat(t.stream.language," ").concat(this._lastRemovedLanguage)),o.PromiseUtil.catchRejection(function(){return r._inject.setPositionWhenReady(i>=e.SEEK_EPSILON?i-e.SEEK_EPSILON:i+e.SEEK_EPSILON)},function(e){r.onError.emit(n.WrappedError.wrap(e))}),this._lastRemovedLanguage=void 0,this._lastRemovedTime=void 0):Math.abs(i-this._lastRemovedTime)>e.TIME_THRESHOLD_SECONDS&&(this._system.logInfo("".concat(a,": resetting checks")),this._lastRemovedLanguage=void 0,this._lastRemovedTime=void 0))}},e.prototype.onRemoveCompleted=function(e){var t=this._inject.getCurrentTime();if(void 0!==t&&t>=e.pipelineState.start&&t<=e.pipelineState.end){if(void 0!==this._lastRemovedTime)return;this._system.logInfo("".concat(a,": removed the segment being played")),this._lastRemovedLanguage=this.getKey(e.stream),this._lastRemovedTime=t}},e.prototype.start=function(){var e=this;this._bufferItemPhaseChange.off(this),this._lastRemovedLanguage=void 0,this._lastRemovedTime=void 0,this._bufferItemPhaseChange.on(this,function(t){if("audio"===t.stream.type){var r=t.pipelineState.phases.getLastPhaseName();"RemoveCompleted"===r?e.onRemoveCompleted(t):"AppendCompleted"===r&&e.onAppendCompleted(t)}})},e.prototype.stop=function(){this._bufferItemPhaseChange.off(this)},e.TIME_THRESHOLD_SECONDS=10,e.SEEK_EPSILON=.01,e}();t.SeekOnTrackChangeWorkaround=s},27468:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mp4Parser=void 0;var i=r(22970),n=r(94306),o=r(15302),a=r(23280),s=function(){function e(){this._parsers=new n.HashMap,this._done=!1}return e.prototype.setParsers=function(e){this._parsers=e},e.prototype.isDone=function(){return this._done},e.prototype.stop=function(){this._done=!0},e.prototype.processBasicBoxHeader=function(e){return i.__assign({},e.box)},e.prototype.processFullBoxHeader=function(e){var t=e.contentReader.readUInt32();return e.box.version=t>>>24,e.box.flags=16777215&t,i.__assign({},e.box)},e.prototype.parse=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r=new a.DataViewReader(t,!1);this._done=!1;for(var i=[],n=r.getPosition();r.hasMoreData()&&!this._done;){i.push(this.parseNext(r,0));var s=r.getPosition();if(n>=s)throw new o.InvalidOperationError("Expected reader position to progress from '".concat(s,"'"))}return i},e.prototype.parseNext=function(e,t){var r=e.getPosition(),i=e.readUInt32(),n=e.readString(4);switch(i){case 0:i=e.getLength()-r;break;case 1:i=e.readUInt64()}var s=e.getPosition(),u=i-(s-r),c=this._parsers.tryGet(n),d={name:n,rangeBox:{start:r+t,length:i},rangeContentHead:{start:s+t,length:0},rangeContentBody:{start:s+t,length:u}};if(void 0!==c){var l=r+i;if(l>e.getLength())throw new o.InvalidOperationError("Invalid reader length, trying to read to '".concat(l,"' with length '").concat(e.getLength(),"'"));var h=l-e.getPosition(),p=h>0?e.readBytes(h):new Uint8Array(0),f=new DataView(p.buffer,p.byteOffset,p.byteLength),_=new a.DataViewReader(f,!1),v={parser:this,contentReader:_,box:d};if(v.box=c.processContentHead(v),_.getPosition()>v.box.rangeContentHead.length){var m=_.getPosition();v.box.rangeContentHead.length+=m,v.box.rangeContentBody.start+=m,v.box.rangeContentBody.length-=m,f=new DataView(p.buffer,p.byteOffset+m),v.contentReader=new a.DataViewReader(f,!1)}v.box=c.processContentBody(v),d=v.box}else{var g=Math.min(r+i-e.getPosition(),e.getLength()-e.getPosition());e.skip(g)}return d},e}();t.Mp4Parser=s},7500:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mp4Util=void 0;var i=r(22970),n=r(7253),o=r(27468),a=r(89773),s=r(72453),u=r(94306),c=r(54965),d=r(45553),l=r(90301),h=r(69964),p=r(42586),f=r(87437),_=r(11943),v=r(62983),m=r(21598),g=r(21228),y=r(22848),S=r(88634),E=r(69383),b=r(96133),w=r(15302),P=function(){function e(){this._seiParser=new l.SeiParser,this._arrayUtil=new h.ArrayUtil}return e.prototype.stripX265UserData=function(e){var t=this,r=new u.HashMap([["moov",a.ContainerParser.getBasicBoxParser()],["trak",a.ContainerParser.getBasicBoxParser()],["mdia",a.ContainerParser.getBasicBoxParser()],["minf",a.ContainerParser.getBasicBoxParser()],["stbl",a.ContainerParser.getBasicBoxParser()],["stsd",a.ContainerParser.getFullEntriesBoxParser()],["hvc1",d.VisualSampleBoxParser.getParser()],["encv",p.EncryptedVideoBoxParser.getParser()],["hvcC",s.HevcConfigurationBoxParser.getParser()]]),c=new o.Mp4Parser;c.setParsers(r);var h=c.parse(e),f=new n.Mp4Walker(h),_=f.jumpTo("hvcC",!0);if(void 0===_)return e;for(var v=[],m=!1,g=0,y=_.arrayRecords;g<y.length;g++){var S=y[g];if(S.nalType!==l.SeiParser.H265_PREFIX_SEI_NUT){v.push(S);continue}var E=i.__assign(i.__assign({},S),{nalUnits:S.nalUnits.filter(function(e){var r=t._seiParser.parseVariableLengthField(e,2);if((null==r?void 0:r.value)!==l.SeiParser.H265_PAYLOAD_TYPE_USER_DATA_UNREGISTERED)return!0;var i=t._seiParser.parseVariableLengthField(e,r.newIndex);return void 0===i||i.value<l.SeiParser.X265_USER_DATA_UNREGISTERED_UUID.length||!t._arrayUtil.areEqual(e.subarray(i.newIndex,i.newIndex+l.SeiParser.X265_USER_DATA_UNREGISTERED_UUID.length),l.SeiParser.X265_USER_DATA_UNREGISTERED_UUID)||(m=!0,!1)})});E.nalUnits.length>0&&v.push(E)}if(!m)return e;var b=s.HevcConfigurationBoxParser.serializeArrayRecords(v),w=e.subarray(0,_.rangeContentBody.start+s.HevcConfigurationBoxParser.ARRAY_RECORDS_OFFSET),P=e.subarray(_.rangeContentBody.start+_.rangeContentBody.length,e.length),T=new Uint8Array(w.length+b.length+P.length);T.set(w),T.set(b,w.length),T.set(P,w.length+b.length);var C=_.rangeContentBody.length-s.HevcConfigurationBoxParser.ARRAY_RECORDS_OFFSET-b.length,M=new DataView(T.buffer);return r.forEach(function(e){var t=f.jumpTo(e,!0);if(void 0!==t){var r=t.rangeBox.length-C;M.setUint32(t.rangeBox.start,r,!1)}}),T},e.prototype.stripDolbyVisionBox=function(e){var t,r,i,s=new u.HashMap([["moov",a.ContainerParser.getBasicBoxParser()],["trak",a.ContainerParser.getBasicBoxParser()],["mdia",a.ContainerParser.getBasicBoxParser()],["minf",a.ContainerParser.getBasicBoxParser()],["stbl",a.ContainerParser.getBasicBoxParser()],["stsd",a.ContainerParser.getFullEntriesBoxParser()],["encv",p.EncryptedVideoBoxParser.getParser()],["hvc1",d.VisualSampleBoxParser.getParser()]]),c=new o.Mp4Parser;c.setParsers(s);var l=c.parse(e),h=new n.Mp4Walker(l),f=null!==(t=h.jumpTo("encv",!0))&&void 0!==t?t:h.jumpTo("hvc1",!0);if(void 0===f||(null===(r=f.children)||void 0===r||r.forEach(function(e){("dvcC"===e.name||"dvvC"===e.name)&&(i=e.rangeBox)}),void 0===i))return e;var _=e.subarray(0,i.start),v=e.subarray(i.start+i.length,e.length),m=new Uint8Array(_.length+v.length);m.set(_),m.set(v,_.length);var g=new DataView(m.buffer);return s.forEach(function(e){var t=h.jumpTo(e,!0);if(void 0!==t&&void 0!==i){var r=t.rangeBox.length-i.length;g.setUint32(t.rangeBox.start,r,!1)}}),m},e.prototype._determineVideoCodec=function(e,t){if("avcC"===t.name||"avc1"===t.name)return"avc";if("dvh1"===t.name)return"dvh";if("hvcC"===t.name||"hvc1"===t.name){var r=e.children;if(void 0===r)return;for(var i=0;i<r.length;i++){var n=r[i];if("dvcC"===n.name||"dvvC"===n.name)return"dvh"}return"hevc"}return"unknown-video"},e.prototype._determineAudioCodec=function(e,t){if("dec3"===e.name||"ec-3"===e.name){var r=t.jumpTo("dec3",!0);return(null==r?void 0:r.complexityIndexTypeA)!==void 0&&r.complexityIndexTypeA>0?"ec-3-atmos":"ec-3"}if("dac3"===e.name)return"ac-3";if("mp4a"===e.name||"esds"===e.name){var i=t.jumpTo("esds",!0);if(void 0!==i)for(var n=i.descriptor.descriptors,o=0;o<n.length;o++){var a=n[o];if(4===a.tag){var s=a.objectType;if(103===s)return"aac";if(64===s)return"heaac"}}}return"unknown-audio"},e.prototype.determineCodec=function(e,t){var r,i,s=new c.Map([[5,m.AudioSpecificConfigParser.getParser()],[4,g.DecoderConfigParser.getParser()],[3,v.ESDescriptorParser.getParser()]]),d=new u.HashMap([["moov",a.ContainerParser.getBasicBoxParser()],["trak",a.ContainerParser.getBasicBoxParser()],["mdia",a.ContainerParser.getBasicBoxParser()],["minf",a.ContainerParser.getBasicBoxParser()],["stbl",a.ContainerParser.getBasicBoxParser()],["stsd",a.ContainerParser.getFullEntriesBoxParser()],["encv",p.EncryptedVideoBoxParser.getParser()],["enca",f.EncryptedAudioBoxParser.getParser()],["dec3",_.EC3SpecificBoxParser.getParser()],["mp4a",S.Mp4aBoxParser.getParser()],["esds",y.ObjectDescriptorBoxParser.getParser(s)]]),l=new o.Mp4Parser;l.setParsers(d);var h=l.parse(t),E=new n.Mp4Walker(h);if(void 0!==E.jumpTo("stsd")){if("video"===e){var b=null!==(r=E.jumpTo("encv",!0))&&void 0!==r?r:E.jumpTo("stsd",!0);if(void 0===b)return;var w=E.step();if(void 0===w)return;return this._determineVideoCodec(b,w)}var b=null!==(i=E.jumpTo("enca",!0))&&void 0!==i?i:E.jumpTo("stsd",!0);if(void 0!==b){var w=E.step();if(void 0!==w)return this._determineAudioCodec(w,E)}}},e.prototype.getTimescale=function(e){var t=new u.HashMap([["moov",a.ContainerParser.getBasicBoxParser()],["mvhd",E.MovieHeaderBoxParser.getParser()]]),r=new o.Mp4Parser;r.setParsers(t);var i=r.parse(e),s=new n.Mp4Walker(i).jumpTo("mvhd",!0);return null==s?void 0:s.timescale},e.prototype.adjustBaseDecodeTime=function(e,t,r){var i=this.getTimescale(t);if(void 0!==i){var s=new u.HashMap([["moof",a.ContainerParser.getBasicBoxParser()],["traf",a.ContainerParser.getBasicBoxParser()],["tfdt",b.TrackFragmentDecodeTimeBoxParser.getParser()]]),c=new o.Mp4Parser;c.setParsers(s);var d=c.parse(e),l=new n.Mp4Walker(d).jumpTo("tfdt",!0);if(void 0!==l){var h=Math.round(r*i),p=l.baseDecodeTime+h,f=new DataView(e.buffer,e.byteOffset,e.byteLength);if(0===l.version){if(p>4294967295)throw new w.InvalidOperationError("Failed to set v0 tfdt baseDecodeTime to value ".concat(p,", value too large"));f.setUint32(l.rangeContentBody.start,p)}else this._setUint64(f,l.rangeContentBody.start,p);return p}}},e.prototype._setUint64=function(e,t,r){e.setUint32(t,Math.floor(r/4294967296)),e.setUint32(t+4,r%4294967296)},e}();t.Mp4Util=P},7253:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mp4Walker=void 0;var i=r(15302),n=function(){function e(t){this._flatIndex=0,this._allBoxes=t,this._flatBoxes=[];for(var r=e.BOX_MAX_COUNT,n=this._allBoxes.slice();n.length>0;){if(this._flatBoxes.length>r)throw new i.InvalidOperationError("Box count larger than max allowed size of '".concat(r,"'"));var o=n.shift();if(void 0!==o&&(this._flatBoxes.push(o),void 0!==o.children))for(var a=o.children.length-1;a>=0;a--)n.unshift(o.children[a])}}return e.prototype.getCurrent=function(){if(void 0===this._lastBox)throw new i.InvalidOperationError("No boxes have been walked.");return this._lastBox},e.prototype.canStep=function(){return this._flatIndex<this._flatBoxes.length},e.prototype.jumpTo=function(e,t){for(void 0===t&&(t=!1),t&&(this._flatIndex=0,this._lastBox=void 0);this.canStep();){var r=this.step();if(r.name===e)return r}},e.prototype.step=function(){if(!this.canStep())throw new i.InvalidOperationError("Cannot step on completed walk");return this._lastBox=this._flatBoxes[this._flatIndex++],this._lastBox},e.BOX_MAX_COUNT=1e4,e}();t.Mp4Walker=n},89773:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContainerParser=void 0;var i=r(22970),n=r(15302),o=function(){function e(){}return e.getBasicBoxParser=function(){var e=this;return{processContentHead:function(e){return e.parser.processBasicBoxHeader(e)},processContentBody:function(t){return e.parse(t)}}},e.getFullBoxParser=function(){var e=this;return{processContentHead:function(e){return e.parser.processFullBoxHeader(e)},processContentBody:function(t){return e.parse(t)}}},e.getFullEntriesBoxParser=function(){var e=this;return{processContentHead:function(e){return e.parser.processFullBoxHeader(e)},processContentBody:function(t){return t.contentReader.skip(4),e.parse(t)}}},e.parse=function(e){for(var t=i.__assign(i.__assign({},e.box),{children:[]}),r=e.contentReader.getPosition();void 0!==t.children&&e.contentReader.hasMoreData()&&!e.parser.isDone();){t.children.push(e.parser.parseNext(e.contentReader,e.box.rangeContentBody.start));var o=e.contentReader.getPosition();if(r>=o)throw new n.InvalidOperationError("Expected child content reader to progress from '".concat(o,"'"))}return t},e}();t.ContainerParser=o},45553:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VisualSampleBoxParser=void 0;var i=r(22970),n=r(89773),o=r(17590),a=function(){function e(){}return e.getParser=function(){var e=this;return{processContentHead:function(e){return e.parser.processBasicBoxHeader(e)},processContentBody:function(t){var r=t.contentReader;r.skip(6);var o=r.readUInt16();r.skip(16);var a=r.readUInt16(),s=r.readUInt16(),u=r.readFixed16x16(),c=r.readFixed16x16();r.skip(4);var d=r.readUInt16(),l=r.readUInt8(),h=e._stringUtil.fromUTF8(r.readBytes(l)).trim();l<31&&r.skip(31-l);var p=r.readUInt16();r.skip(2);var f=n.ContainerParser.parse(t);return i.__assign(i.__assign({},t.box),{dataIndex:o,width:a,height:s,horizontalResolution:u,verticalResolution:c,frameCount:d,compressorName:h,depth:p,children:f.children})}}},e._stringUtil=new o.StringUtil,e}();t.VisualSampleBoxParser=a},11943:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EC3SpecificBoxParser=void 0;var i=r(22970),n=r(89773),o=function(){function e(){}return e.getParser=function(){return{processContentHead:function(e){return e.parser.processBasicBoxHeader(e)},processContentBody:function(e){for(var t,r,o,a=e.contentReader,s=a.readUInt16(),u=7&s,c=[],d=0;d<u+1;d++){var l=a.readUInt8(),h=l>>6,p=l>>1&31,f=1&l,_=(l=a.readUInt8())>>7,v=l>>4&7,m=l>>1&7,g=1&l,y=(l=a.readUInt8())>>5,S=l>>1&15,E=1&l,b=void 0,w=void 0;S>0?b=E<<8|(l=a.readUInt8()):w=E;var P={fscod:h,bsid:p,reserved1:f,asvc:_,bsmod:v,acmod:m,lfeon:g,reserved2:y,numDepSub:S,chanLoc:b,reserved3:w};c.push(P)}if(a.hasMoreData()){var l=a.readUInt8();t=l>>1,1==(r=1&l)&&(o=l=a.readUInt8())}for(var T=[];a.hasMoreData();)T.push(a.readUInt8());var C=n.ContainerParser.parse(e);return i.__assign(i.__assign({},C),{dataRate:s>>3,numIndSub:u,indSubs:c,reserved4:t,flagEc3ExtensionTypeA:r,complexityIndexTypeA:o,reservedEnd:T})}}},e}();t.EC3SpecificBoxParser=o},87437:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EncryptedAudioBoxParser=void 0;var i=r(89773),n=function(){function e(){}return e.getParser=function(){return{processContentHead:function(e){return e.parser.processBasicBoxHeader(e)},processContentBody:function(e){return e.contentReader.skip(28),i.ContainerParser.parse(e)}}},e}();t.EncryptedAudioBoxParser=n},42586:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EncryptedVideoBoxParser=void 0;var i=r(89773),n=function(){function e(){}return e.getParser=function(){return{processContentHead:function(e){return e.parser.processBasicBoxHeader(e)},processContentBody:function(e){return e.contentReader.skip(78),i.ContainerParser.parse(e)}}},e}();t.EncryptedVideoBoxParser=n},61910:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FrmaBoxParser=void 0;var i=r(22970),n=r(17590),o=function(){function e(){}return e.getParser=function(){return{processContentHead:function(e){return e.parser.processBasicBoxHeader(e)},processContentBody:function(e){var t=new n.StringUtil,r=e.contentReader.readBytes(4),o=t.fromCharCode(r);return i.__assign(i.__assign({},e.box),{fourCC:o})}}},e}();t.FrmaBoxParser=o},72453:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HevcConfigurationBoxParser=void 0;var i=r(22970),n=function(){function e(){}return e.getParser=function(){return{processContentHead:function(e){return e.parser.processBasicBoxHeader(e)},processContentBody:function(e){var t=e.contentReader,r=t.readUInt8(),n=t.readUInt8(),o=(240&n)>>6,a=(32&n)>0,s=31&n,u=t.readUInt32(),c=[];c.push(t.readUInt8()),c.push(t.readUInt8()),c.push(t.readUInt8()),c.push(t.readUInt8()),c.push(t.readUInt8()),c.push(t.readUInt8());for(var d=(8&c[0])>0,l=(4&c[0])>0,h=(2&c[0])>0,p=(1&c[0])>0,f=t.readUInt8(),_=(61440&(n=t.readUInt16()))>>12,v=4095&n,m=(252&(n=t.readUInt8()))>>2,g=3&n,y=(252&(n=t.readUInt8()))>>2,S=3&n,E=(248&(n=t.readUInt8()))>>3,b=7&n,w=(248&(n=t.readUInt8()))>>3,P=7&n,T=t.readUInt16(),C=(192&(n=t.readUInt8()))>>6,M=(56&n)>>3,k=(4&n)>0,A=3&n,x=[],D=t.readUInt8(),R=0;R<D;R++){for(var O=(128&(n=t.readUInt8()))>0,I=(64&n)>0,U=63&n,B=[],L=t.readUInt16(),N=0;N<L;N++){var F=t.readUInt16();B.push(t.readBytes(F))}x.push({completeness:O,reserved:I,nalType:U,nalUnits:B})}return i.__assign(i.__assign({},e.box),{configurationVersion:r,profileSpace:o,profileCompatability:u,constraints:c,profileIdc:s,levelIdc:f,avgFrameRate:T,constantFrameRate:C,temporalLayerCount:M,temporalIdNested:k,lengthSizeMinusOne:A,tierFlag:a,frameOnlyFlag:d,nonPackedFlag:l,interlacedFlag:h,progressiveFlag:p,reserved1:_,minSpatialSegmentationIdc:v,reserved2:m,parallelismType:g,reserved3:y,chromaFormat:S,reserved4:E,bitDepthLumaMinus8:b,reserved5:w,bitDepthChromaMinus8:P,arrayRecords:x})}}},e.serializeArrayRecords=function(e){var t=new Uint8Array(1+e.map(function(e){return 3+e.nalUnits.map(function(e){return 2+e.length}).reduce(function(e,t){return e+t},0)}).reduce(function(e,t){return e+t},0)),r=new DataView(t.buffer),i=0;r.setUint8(i++,e.length);for(var n=0;n<e.length;n++){var o=e[n],a=o.nalType;o.completeness&&(a|=128),o.reserved&&(a|=64),r.setUint8(i++,a),r.setUint16(i,o.nalUnits.length,!1),i+=2;for(var s=0,u=o.nalUnits;s<u.length;s++){var c=u[s];r.setUint16(i,c.length,!1),i+=2,t.set(c,i),i+=c.length}}return t},e.ARRAY_RECORDS_OFFSET=22,e}();t.HevcConfigurationBoxParser=n},23422:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaHeaderBoxParser=void 0;var i=r(22970),n=r(88269),o=r(17590),a=function(){function e(){}return e.getParser=function(){var e=this;return{processContentHead:function(e){return e.parser.processFullBoxHeader(e)},processContentBody:function(t){var r,n,o,a,s=t.contentReader;1===t.box.version?(r=s.readUInt64(),n=s.readUInt64(),o=s.readUInt32(),a=s.readInt64()):(r=s.readUInt32(),n=s.readUInt32(),o=s.readUInt32(),a=s.readInt32());var u=e._languageUtil.normalize(e._getLanguageCodeFromBytes(s));return i.__assign(i.__assign({},t.box),{creationTime:r,modificationTime:n,timescale:o,duration:a,language:u})}}},e._getLanguageCodeFromBytes=function(e){for(var t=e.readUInt16(),r=new Uint8Array(3),i=0;i<3;i++){var n=t>>(2-i)*5&31;r[i]=n+96}return this._stringUtil.fromCharCode(r)},e._stringUtil=new o.StringUtil,e._languageUtil=new n.LanguageUtil,e}();t.MediaHeaderBoxParser=a},88634:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mp4aBoxParser=void 0;var i=r(22970),n=r(89773),o=function(){function e(){}return e.getParser=function(){return{processContentHead:function(e){return e.parser.processBasicBoxHeader(e)},processContentBody:function(e){var t=e.contentReader;t.skip(6);var r=t.readUInt16(),o=t.readUInt16();t.skip(6);var a=t.readUInt16(),s=t.readUInt16(),u=t.readUInt16(),c=t.readUInt16(),d=t.readFixed16x16();1===o?t.skip(16):2===o&&t.skip(36);var l=n.ContainerParser.parse(e);return i.__assign(i.__assign({},l),{dataIndex:r,soundVersion:o,channelCount:a,sampleSize:s,sampleRate:d,compressionId:u,packetSize:c})}}},e}();t.Mp4aBoxParser=o},69383:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MovieHeaderBoxParser=void 0;var i=r(22970),n=r(43274),o=function(){function e(){}return e.getParser=function(){return{processContentHead:function(e){return e.parser.processFullBoxHeader(e)},processContentBody:function(e){var t,r,o,a,s=e.contentReader;1===e.box.version?(t=s.readUInt64(),r=s.readUInt64(),o=s.readUInt32(),a=s.readInt64()):(t=s.readUInt32(),r=s.readUInt32(),o=s.readUInt32(),a=s.readInt32());var u=s.readFixed16x16(),c=s.readFixed8x8();s.skip(10);var d=n.Matrix.read(s),l=s.readInt32(),h=s.readInt32(),p=s.readInt32(),f=s.readInt32(),_=s.readInt32(),v=s.readInt32(),m=s.readInt32();return i.__assign(i.__assign({},e.box),{creationTime:t,modificationTime:r,timescale:o,duration:a,rate:u,volume:c,matrix:d,nextTrackId:m,previewTime:l,previewDuration:h,posterTime:p,selectionTime:f,selectionDuration:_,currentTime:v})}}},e}();t.MovieHeaderBoxParser=o},69334:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentIndexBoxParser=void 0;var i=r(22970),n=r(60508),o=function(){function e(){}return e.getParser=function(){return{processContentHead:function(e){return e.parser.processFullBoxHeader(e)},processContentBody:function(e){var t,r,o=e.contentReader,a=o.readUInt32(),s=o.readUInt32();0===e.box.version?(t=o.readUInt32(),r=o.readUInt32()):(t=o.readUInt64(),r=o.readUInt64()),o.skip(2);for(var u=[],c=o.readUInt16(),d=0;d<c;d++)u.push(n.SegmentIndexEntry.read(o));return i.__assign(i.__assign({},e.box),{referenceId:a,timescale:s,earliestPresentationTime:t,firstOffset:r,entries:u})}}},e}();t.SegmentIndexBoxParser=o},60508:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentIndexEntry=void 0;var r=function(){function e(){}return e.read=function(e){var t=e.readUInt32();return{isMoofReference:(2147483648&t)==0,referencedSize:2147483647&t,subSegmentDuration:e.readUInt32(),startsWithStreamAccessPoint:!!(2147483648&(t=e.readUInt32())),typeOfStreamAccessPoint:(1879048192&t)>>28,deltaTimeOfStreamAccessPoint:268435455&t}},e}();t.SegmentIndexEntry=r},37454:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SinfBoxParser=void 0;var i=r(22970),n=r(89773),o=function(){function e(){}return e.getParser=function(){return{processContentHead:function(e){return e.parser.processBasicBoxHeader(e)},processContentBody:function(e){var t=n.ContainerParser.getBasicBoxParser().processContentBody(e);e.contentReader.rewind(e.contentReader.getPosition());var r=e.contentReader.readBytes(e.contentReader.getLength());return i.__assign(i.__assign({},t),{data:r})}}},e}();t.SinfBoxParser=o},67280:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackEncryptionBoxParser=void 0;var i=r(22970),n=function(){function e(){}return e.getParser=function(){var e=this;return{processContentHead:function(e){return e.parser.processFullBoxHeader(e)},processContentBody:function(t){var r=t.contentReader;r.skip(2);var n=1===r.readUInt8(),o=r.readUInt8(),a=r.readBytes(e.DEFAULT_KID_LENGTH);return i.__assign(i.__assign({},t.box),{default_isEncrypted:n,default_IV_size:o,default_KID:a})}}},e.DEFAULT_KID_OFFSET=4,e.DEFAULT_KID_LENGTH=16,e}();t.TrackEncryptionBoxParser=n},96133:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackFragmentDecodeTimeBoxParser=void 0;var i=r(22970),n=function(){function e(){}return e.getParser=function(){return{processContentHead:function(e){return e.parser.processFullBoxHeader(e)},processContentBody:function(e){var t,r=e.contentReader;return t=1===e.box.version?r.readUInt64():r.readUInt32(),i.__assign(i.__assign({},e.box),{baseDecodeTime:t})}}},e}();t.TrackFragmentDecodeTimeBoxParser=n},99818:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackFragmentHeaderBoxParser=void 0;var i=r(22970),n=function(){function e(){}return e.getParser=function(){return{processContentHead:function(e){return e.parser.processFullBoxHeader(e)},processContentBody:function(e){var t,r=e.contentReader,n=r.readUInt32(),o=null!==(t=e.box.flags)&&void 0!==t?t:0,a=i.__assign(i.__assign({},e.box),{trackId:n});return(1&o)==1&&(a.baseDataOffset=r.readUInt64()),(2&o)==2&&(a.sampleDescriptionIndex=r.readUInt32()),(8&o)==8&&(a.defaultSampleDuration=r.readUInt32()),(16&o)==16&&(a.defaultSampleSize=r.readUInt32()),(32&o)==32&&(a.defaultSampleFlags=r.readUInt32()),(65536&o)==65536&&(a.durationIsEmpty=!0),(131072&o)==131072&&(a.defaultBaseIsMoof=!0),a}}},e}();t.TrackFragmentHeaderBoxParser=n},73686:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackExtendsBoxParser=void 0;var i=r(22970),n=function(){function e(){}return e.getParser=function(){return{processContentHead:function(e){return e.parser.processFullBoxHeader(e)},processContentBody:function(e){var t=e.contentReader,r=t.readUInt32(),n=t.readUInt32(),o=t.readUInt32(),a=t.readUInt32(),s=t.readUInt32();return i.__assign(i.__assign({},e.box),{trackId:r,defaultSampleDescriptionIndex:n,defaultSampleDuration:o,defaultSampleSize:a,defaultSampleFlags:s})}}},e}();t.TrackExtendsBoxParser=n},35389:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackRunBoxParser=void 0;var i=r(22970),n=r(63637),o=function(){function e(){}return e.getParser=function(){return{processContentHead:function(e){return e.parser.processFullBoxHeader(e)},processContentBody:function(e){var t,r=e.contentReader,o=null!==(t=e.box.flags)&&void 0!==t?t:0,a=r.readUInt32(),s=i.__assign(i.__assign({},e.box),{dataOffset:void 0,firstSampleFlags:void 0,samples:[]});(1&o)==1&&(s.dataOffset=r.readUInt32()),(4&o)==4&&(s.firstSampleFlags=r.readUInt32());for(var u=0;u<a;u++)s.samples.push(n.TrackRunSample.read(o,r));return s}}},e}();t.TrackRunBoxParser=o},63637:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackRunSample=void 0;var r=function(){function e(){}return e.read=function(e,t){var r={};return(256&e)==256&&(r.duration=t.readUInt32()),(512&e)==512&&(r.size=t.readUInt32()),(1024&e)==1024&&(r.flags=t.readUInt32()),(2048&e)==2048&&(r.compositionTimeOffset=t.readInt32()),r},e}();t.TrackRunSample=r},58373:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CuePayloadBoxParser=void 0;var i=r(22970),n=function(){function e(){}return e.getParser=function(){return{processContentHead:function(e){return e.parser.processBasicBoxHeader(e)},processContentBody:function(e){var t=e.contentReader;return i.__assign(i.__assign({},e.box),{payload:t.readTerminatedString()})}}},e}();t.CuePayloadBoxParser=n},40715:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CueSettingsBoxParser=void 0;var i=r(22970),n=r(57457),o=function(){function e(){}return e.getParser=function(){return{processContentHead:function(e){return e.parser.processBasicBoxHeader(e)},processContentBody:function(e){var t=e.contentReader.readTerminatedString(),r=[],o=i.__assign(i.__assign({},e.box),{settings:r});if(t.length>0)for(var a=new n.TextParser(t),s=a.readWord();void 0!==s;)r.push(s),a.skipWhitespace(),s=a.readWord();return o}}},e}();t.CueSettingsBoxParser=o},22848:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectDescriptorBoxParser=void 0;var i=r(22970),n=r(45374),o=function(){function e(){}return e.getParser=function(e){return{processContentHead:function(e){return e.parser.processFullBoxHeader(e)},processContentBody:function(t){var r=t.contentReader,o=new n.ObjectDescriptorParser(e).parse(r);return i.__assign(i.__assign({},t.box),{descriptor:o})}}},e}();t.ObjectDescriptorBoxParser=o},45374:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectDescriptorParser=void 0;var i=r(23280),n=function(){function e(e){this._parserMap=e}return e.prototype.parse=function(e){for(var t=e.readUInt8(),r=e.readUInt8(),n=127&r;r>>7==1;)n=n<<7|127&(r=e.readUInt8());var o=e.readBytes(n),a=this._parserMap.tryGet(t),s={tag:t,descriptorSize:n,descriptors:[]};if(void 0!==a){var u=new DataView(o.buffer,0,n),c=new i.DataViewReader(u,!1);s=a.processDescriptorBody({parser:this,contentReader:c,descriptor:s})}return s},e}();t.ObjectDescriptorParser=n},21598:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudioSpecificConfigParser=void 0;var i=r(22970),n=r(43392),o=function(){function e(){}return e.getParser=function(){return{processDescriptorBody:function(e){var t=e.contentReader,r=new n.BitStreamReader;r.addBytes(t.readBytes(2));var o=r.readBits(5);return 31===o&&(o=32+r.readBits(6)),i.__assign(i.__assign({},e.descriptor),{audioObjectType:o})}}},e}();t.AudioSpecificConfigParser=o},21228:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DecoderConfigParser=void 0;var i=r(22970),n=function(){function e(){}return e.getParser=function(){return{processDescriptorBody:function(e){for(var t=e.contentReader,r=t.readUInt8(),n=t.readUInt8(),o=t.readUInt24(),a=t.readInt32(),s=t.readInt32(),u=[];t.hasMoreData();)u.push(e.parser.parse(t));return i.__assign(i.__assign({},e.descriptor),{objectType:r,streamType:n>>2,upstream:(n>>1&1)==1,bufferSizeDB:o,maxBitrate:a,avgBitrate:s,descriptors:u})}}},e}();t.DecoderConfigParser=n},62983:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ESDescriptorParser=void 0;var i=r(22970),n=r(17590),o=function(){function e(){}return e.getParser=function(){return{processDescriptorBody:function(e){var t,r,o,a=new n.StringUtil,s=e.contentReader,u=s.readUInt16(),c=s.readUInt8();if(0!=(c>>7&1)&&(t=s.readUInt16()),0!=(c>>6&1)){var d=s.readUInt8();o=a.fromUTF8(s.readBytes(d))}0!=(c>>5&1)&&(r=s.readUInt16());for(var l=[];s.hasMoreData();)l.push(e.parser.parse(s));return i.__assign(i.__assign({},e.descriptor),{esId:u,priority:31&c,dependsOnId:t,url:o,ocrId:r,descriptors:l})}}},e}();t.ESDescriptorParser=o},43274:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Matrix=void 0;var r=function(){function e(){}return e.read=function(e){var t=e.readFixed16x16(),r=e.readFixed16x16(),i=e.readFixed2x30(),n=e.readFixed16x16(),o=e.readFixed16x16(),a=e.readFixed2x30(),s=e.readFixed16x16(),u=e.readFixed16x16();return{a:t,b:r,c:n,d:o,u:i,v:a,w:e.readFixed2x30(),tx:s,ty:u}},e}();t.Matrix=r},1954:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmbeddedCaptionParser=void 0;var i=r(86508),n=r(11059),o=r(90301),a=r(23280),s=r(94306),u=r(89773),c=r(23422),d=r(96133),l=r(99818),h=r(73686),p=r(35389),f=r(27468),_=r(7253),v=function(){function e(e,t){this._codecGroup=t,this._defaultSampleDuration=0,this._defaultSampleSize=0,this._timescale=9e4,this._nalUtils=new n.NalUtils,this._seiParser=new o.SeiParser,this._ituTT35Parser=new i.ItuTT35Parser;var r=new f.Mp4Parser;r.setParsers(new s.HashMap([["moov",u.ContainerParser.getBasicBoxParser()],["mvex",u.ContainerParser.getBasicBoxParser()],["trak",u.ContainerParser.getBasicBoxParser()],["mdia",u.ContainerParser.getBasicBoxParser()],["trex",h.TrackExtendsBoxParser.getParser()],["mdhd",c.MediaHeaderBoxParser.getParser()]]));var a=r.parse(new Uint8Array(e)),d=new _.Mp4Walker(a),l=d.jumpTo("trex",!0),p=d.jumpTo("mdhd",!0);void 0!==l&&(this._defaultSampleDuration=l.defaultSampleDuration,this._defaultSampleSize=l.defaultSampleSize),void 0!==p&&(this._timescale=p.timescale)}return e.prototype.parseMediaSegment=function(e){var t,r,n,c,h,v,m,g,y,S,E,b=new f.Mp4Parser;b.setParsers(new s.HashMap([["moof",u.ContainerParser.getBasicBoxParser()],["traf",u.ContainerParser.getBasicBoxParser()],["trun",p.TrackRunBoxParser.getParser()],["tfhd",l.TrackFragmentHeaderBoxParser.getParser()],["tfdt",d.TrackFragmentDecodeTimeBoxParser.getParser()]]));var w=b.parse(new Uint8Array(e)),P=new _.Mp4Walker(w),T=P.jumpTo("trun",!0),C=P.jumpTo("tfhd",!0),M=P.jumpTo("tfdt",!0),k=P.jumpTo("mdat",!0),A=null!==(t=null==T?void 0:T.samples)&&void 0!==t?t:[],x=null!==(r=null==C?void 0:C.defaultSampleDuration)&&void 0!==r?r:this._defaultSampleDuration,D=null!==(n=null==C?void 0:C.defaultSampleSize)&&void 0!==n?n:this._defaultSampleSize,R=null==M?void 0:M.baseDecodeTime;if(void 0===R||void 0===k)return[];for(var O=new DataView(e,k.rangeContentBody.start,k.rangeContentBody.length),I=new a.DataViewReader(O,!1),U=0,B=null!==(h=null===(c=A[0])||void 0===c?void 0:c.size)&&void 0!==h?h:D,L=R,N=[];I.hasMoreData();){var F=I.readUInt32(),W=void 0,V=void 0;switch(this._codecGroup){case"avc":W=1;var H=31&I.readUInt8();V=H===o.SeiParser.H264_NAL_UNIT_TYPE;break;case"hevc":case"hevc-hdr":case"dvh":W=2;var H=I.readUInt16()>>9&63;V=H===o.SeiParser.H265_PREFIX_SEI_NUT||H===o.SeiParser.H265_SUFFIX_SEI_NUT}if(V)for(var j=(L+(null!==(m=null===(v=A[U])||void 0===v?void 0:v.compositionTimeOffset)&&void 0!==m?m:0))/this._timescale,K=this._nalUtils.stripEmulationPreventionBytes(I.readBytes(F-W)),q=0,z=this._seiParser.parse(K,i.ItuTT35Parser.PAYLOAD_TYPE);q<z.length;q++){var G=z[q],$=this._ituTT35Parser.extractCc(G);void 0!==$&&N.push({bytePairs:$,pts:j})}else I.skip(F-W);0==(B-=F+4)&&(L+=null!==(y=null===(g=A[U])||void 0===g?void 0:g.duration)&&void 0!==y?y:x,B=null!==(E=null===(S=A[++U])||void 0===S?void 0:S.size)&&void 0!==E?E:D)}return N.sort(function(e,t){return e.pts-t.pts}),N},e}();t.EmbeddedCaptionParser=v},50297:function(e,t,r){"use strict";t.Y=void 0;var i=r(22970),n=r(2913),o=r(30607),a=r(17590),s=function(){function e(e,t){var r,i,s,u=this;void 0===e&&(e=function(){return"unknown"}),this._cencUtil=new n.CommonEncryptionUtil,this._platform=new o.Platform,this._stringUtil=new a.StringUtil,this._keyTypeResolver=e,this.customVariantFilters=null!==(r=null==t?void 0:t.customVariantFilters)&&void 0!==r?r:[],this.trackPreferences=null!==(i=null==t?void 0:t.trackPreferences)&&void 0!==i?i:[],this.drmOptions=null!==(s=null==t?void 0:t.drmOptions)&&void 0!==s?s:{modifyInitData:function(e,t){return u.modifyInitData(e,t)}},void 0!==t&&(this.variantSelector=t.variantSelector,this.bufferLogic=t.bufferLogic,this.bufferRetryLogic=t.bufferRetryLogic,this.abrOptions=t.abrOptions,this.analyticsOptions=t.analyticsOptions,this.bufferOptions=t.bufferOptions,this.variantsToSizeOptions=t.variantsToSizeOptions,this.cmcd=t.cmcd)}return e.prototype.hasSL3000=function(){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(r){switch(r.label){case 0:if(void 0!==e._isSL3000)return[3,3];if(this._platform.isWindows())return[3,1];return e._isSL3000=!0,[3,3];case 1:return t=e,[4,window.navigator.requestMediaKeySystemAccess("com.microsoft.playready.recommendation",[{initDataTypes:["cenc"],videoCapabilities:[{contentType:'video/mp4;codecs="hvc1"',robustness:"3000"}]}]).then(function(){return!0}).catch(function(){return!1})];case 2:t._isSL3000=r.sent(),r.label=3;case 3:return[2,e._isSL3000]}})})},e.prototype.hasVerifiedMediaPath=function(){return this._platform.isTizen()||!this._platform.isLinux()||this._platform.isComcastSetTopBox()||this._platform.isWebOS()||this._platform.isVizio()||this._platform.isSagemcom()||this._platform.isClaro()||this._platform.isSkyQ()},e.prototype.modifyInitData=function(e,t){return i.__awaiter(this,void 0,void 0,function(){var r,n,o,a,s,u,c=this;return i.__generator(this,function(i){switch(i.label){case 0:if(n="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===(r=this._cencUtil.getKeyFormat(e))&&!this.hasVerifiedMediaPath())return[3,3];if(!(o="urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95"===r&&1===this._cencUtil.getVersion(e)))return[3,2];return[4,this.hasSL3000()];case 1:o=!i.sent(),i.label=2;case 2:n=o,i.label=3;case 3:if(n&&(s=(a=this._cencUtil.getKeysFromInitData(e)).map(function(e){return c._keyTypeResolver(c._stringUtil.toHex(e))}),u=a.filter(function(e,i){var n=s[i];return("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"!==r||"video-hd"!==n)&&"video-fhd"!==n&&"video-uhd1"!==n&&"video-uhd2"!==n||(t.addKeyStatus(c._stringUtil.toHex(e),"internal-error"),!1)}),a.length!==u.length))return[2,this._cencUtil.rewriteInitDataKeys(e,u)];return[2,e]}})})},e._isSL3000=void 0,e}();t.Y=s},96801:function(e,t,r){"use strict";t.o=void 0;var i=r(22970),n=r(47632),o=r(94306),a=r(91324),s=r(76843),u=r(76300),c=r(84936),d=r(47042),l=r(90194),h=r(45997),p=r(91561),f=r(30607),_=r(1629),v=function(){function e(e){var t,r;this.networkProgressEvent=new n.Emitter,this._platformCapabilities=new h.PlatformCapabilities(this),this._networkReferenceStore=new o.HashMap,this._platform=new f.Platform,this._isTypeSupported=function(e){return MediaSource.isTypeSupported(e)},this._options=e,this._logLevel=void 0!==e.logLevel?e.logLevel:5,this._isPrefixed=null!==(t=e.usePrefixedEme)&&void 0!==t?t:void 0===navigator.requestMediaKeySystemAccess||this._platformCapabilities.isExternalRMKSA(),this._useSonyEnhancedSecurityVideoMode=null!==(r=e.useSonyEnhancedSecurityVideoMode)&&void 0!==r?r:this._platformCapabilities.supportsSonyEnhancedSecurityVideoMode(),this._workaround=new p.PlatformWorkaroundWrapper,this._timeout=new _.Timeout(function(e,t){return window.setTimeout(e,t)},function(e){return window.clearTimeout(e)}),void 0!==e.keyTypeResolver&&(this.keyTypeResolver=e.keyTypeResolver),"function"==typeof e.isTypeSupported&&(this._isTypeSupported=e.isTypeSupported),this._encryptedMedia=this._isPrefixed?new c.PrefixedKeySystemWrapper(e.prefixedMediaKeySupport):new s.KeySystemWrapper(this._isTypeSupported,e.supportedKeySystems,this._useSonyEnhancedSecurityVideoMode,this)}return Object.defineProperty(e.prototype,"onLine",{get:function(){return navigator.onLine},enumerable:!1,configurable:!0}),e.prototype.getContextualInfo=function(){return void 0!==this._encryptedMedia.getContextualInfo?this._encryptedMedia.getContextualInfo():""},e.prototype.assert=function(e,t){1<=this._logLevel&&console.assert(e,t)},e.prototype.logError=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];1<=this._logLevel&&console.error.apply(console,e)},e.prototype.logWarn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];2<=this._logLevel&&console.warn.apply(console,e)},e.prototype.logInfo=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];3<=this._logLevel&&console.info.apply(console,e)},e.prototype.logConsole=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];3<=this._logLevel&&console.log.apply(console,e)},e.prototype.logDebug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];5<=this._logLevel&&console.debug.apply(console,e)},e.prototype.logVerbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];4<=this._logLevel&&console.debug.apply(console,e)},e.prototype.postTimeout=function(e){return 0===e?{timeout:Promise.resolve(),cancel:function(){}}:this._timeout.postTimeout(e)},e.prototype.makeNetworkClient=function(e){return void 0!==this._options.modifyNetworkRequest&&this._options.modifyNetworkRequest(e),new l.NetworkResponseWrapper(this,e)},e.prototype.makePayloadReference=function(e){var t=this;return{info:e,deleteFromMemory:function(){t._networkReferenceStore.delete(e.id)}}},e.prototype.getPayloadReferenceData=function(e){return this._networkReferenceStore.get(e)},e.prototype.setPayloadReferenceData=function(e,t){return this._networkReferenceStore.set(e,t),this.makePayloadReference({id:e,byteLength:t.byteLength})},e.prototype.isTypeSupported=function(e){return this._platform.isXbox()&&-1!==e.indexOf("dvh1.05")&&(e='video/mp4; codecs="hvc1,mp4a"; features="ext-profile=dvhe.05,hdr=1"'),this._isTypeSupported(e)},e.prototype.makeMediaSource=function(){return new u.MediaSourceWrapper(this,this._options,new MediaSource,this._networkReferenceStore,this._useSonyEnhancedSecurityVideoMode)},e.prototype.getMediaKeySupport=function(){return this._encryptedMedia.getMediaKeySupport()},e.prototype.makeMediaKeySystemAccess=function(e){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){return[2,this._encryptedMedia.makeMediaKeySystemAccess(e)]})})},e.prototype.setMediaKeys=function(e,t){return this._encryptedMedia.setMediaKeys(e,t)},e.prototype.clearMediaKeys=function(e){return this._encryptedMedia.clearMediaKeys(e)},e.prototype.makeVideoElement=function(){return this.wrapBrowserElement(document.createElement("video"))},e.prototype.supportedHdrModes=function(){if(void 0!==this._options.supportedHdrModes)return this._options.supportedHdrModes();var e=this._platformCapabilities.getSupportedHdrModes();return void 0===e?(this.logWarn("Unable to successfully check hdr modes supported by the platform"),[]):e instanceof Promise?e.then(function(e){return void 0===e?[]:e}):e},e.prototype.canPlayDolbyAtmos=function(){var e,t,r;return null!==(r=null===(t=(e=this._options).canPlayDolbyAtmos)||void 0===t?void 0:t.call(e))&&void 0!==r?r:this._platformCapabilities.canPlayDolbyAtmos()},e.prototype.requireSingleKey=function(){return void 0!==this._options.requireSingleKey?this._options.requireSingleKey:this._platformCapabilities.requireSingleKey()},e.prototype.requireSingleFramerate=function(){return void 0!==this._options.requireSingleFramerate?this._options.requireSingleFramerate:this._platformCapabilities.requireSingleFramerate()},e.prototype.getKeyTypesWhichMayBeRestricted=function(){var e,t,r;return null!==(r=null===(t=(e=this._options).getKeyTypesWhichMayBeRestricted)||void 0===t?void 0:t.call(e))&&void 0!==r?r:this._platformCapabilities.getKeyTypesWhichMayBeRestricted()},e.prototype.supportsExactSeeks=function(){var e,t,r;return null!==(r=null===(t=(e=this._options).supportsExactSeeks)||void 0===t?void 0:t.call(e))&&void 0!==r?r:this._platformCapabilities.supportsExactSeeks()},e.prototype.supportsMediaKeySystemAccessGetConfiguration=function(){var e,t,r;return null!==(r=null===(t=(e=this._options).supportsMediaKeySystemAccessGetConfiguration)||void 0===t?void 0:t.call(e))&&void 0!==r?r:this._platformCapabilities.supportsMediaKeySystemAccessGetConfiguration()},e.prototype.requiredMultiPeriodWorkaround=function(){var e,t;return null!==(t=null===(e=this._options.workaroundOptions)||void 0===e?void 0:e.multiPeriod)&&void 0!==t?t:this._workaround.requiredMultiPeriodWorkaround()},e.prototype.requiresStallSkippingWorkaround=function(){var e,t;return null!==(t=null===(e=this._options.workaroundOptions)||void 0===e?void 0:e.stallSkipping)&&void 0!==t?t:this._workaround.requiresStallSkippingWorkaround()},e.prototype.requiresSeekOnTrackChangeWorkaround=function(){var e,t;return null!==(t=null===(e=this._options.workaroundOptions)||void 0===e?void 0:e.seekOnTrackChange)&&void 0!==t?t:this._workaround.requiresSeekOnTrackChangeWorkaround()},e.prototype.requiresDontSeekToZeroWorkaround=function(){var e,t;return null!==(t=null===(e=this._options.workaroundOptions)||void 0===e?void 0:e.dontSeekToZero)&&void 0!==t?t:this._workaround.requiresDontSeekToZeroWorkaround()},e.prototype.requiresSafeSeek=function(){var e,t;return null!==(t=null===(e=this._options.workaroundOptions)||void 0===e?void 0:e.safeSeek)&&void 0!==t?t:this._workaround.requiresSafeSeek()},e.prototype.requiresMediaKeysAttachedForUnencrypted=function(){var e,t;return null!==(t=null===(e=this._options.workaroundOptions)||void 0===e?void 0:e.mediaKeysAttachedForUnencrypted)&&void 0!==t?t:this._workaround.requiresMediaKeysAttachedForUnencrypted()},e.prototype.requiresReattachOnKeyStatusesChange=function(){var e,t;return null!==(t=null===(e=this._options.workaroundOptions)||void 0===e?void 0:e.reattachOnKeyStatusesChange)&&void 0!==t?t:this._workaround.requiresReattachOnKeyStatusesChange()},e.prototype.wrapBrowserElement=function(e){return this._isPrefixed?new d.PrefixedVideoElement(this,e):new a.BrowserVideoElement(this,e)},e.prototype.setLogLevel=function(e){this._logLevel=e},e}();t.o=v},54744:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseMediaKeySessionWrapper=void 0;var i=r(47632),n=r(17590),o=function(){function e(e,t){var r=this;this.onKeyStatusesChange=new i.Emitter,this.onMessage=new i.Emitter,this.onError=new i.Emitter,this.onWarning=new i.Emitter,this._stringUtil=new n.StringUtil,this.messagesFromAppending=e,this._options=t,this.closed=new Promise(function(e){r._closedResolver=e})}return Object.defineProperty(e.prototype,"isClosed",{get:function(){return void 0===this._closedResolver},enumerable:!1,configurable:!0}),e.prototype._close=function(){void 0!==this._closedResolver&&(this._closedResolver(),this._closedResolver=void 0)},e}();t.BaseMediaKeySessionWrapper=o},91324:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserVideoElement=void 0;var i=r(22970),n=r(53282),o=r(29368),a=r(47632),s=r(2906),u=r(57665),c=r(17590),d=r(27468),l=r(94306),h=r(61910),p=r(30607),f=r(14802),_=r(82270),v=r(34518),m=r(34855),g=function(){function e(e,t){var r=this;this._platform=new p.Platform,this._videoRate=0,this._droppedVideoFrames=0,this._totalVideoFrames=0,this._bufferForPlaybackSeconds=0,this._mediaSourceHasEverEnded=!1,this._timeRangeUtil=new o.TimeRangeUtil,this._expectingPauseEvent=!1,this._stringUtil=new c.StringUtil,this._inPictureInPicture=!1,this.onEnded=new a.Emitter,this.onError=new a.Emitter,this.onLoadedData=new a.Emitter,this.onWarning=new a.Emitter,this.onLeavePictureInPicture=new a.Emitter,this._appendedKeyFormats={},this._onVideoErrorEvent=function(){if(r._system.logInfo("Native `error` event was emitted"),null!==r._htmlVideoElement.error){var e,t=null===(e=r._mediaSource)||void 0===e?void 0:e.getSourceBufferInfoMap();r.onError.emit(new s.VideoElementError(r._htmlVideoElement.error,{sourceBuffers:t}))}},this._onVideoLoadedDataEvent=function(){r._system.logInfo("Native `loadeddata` event was emitted"),r._pokeTheDom(),r.onLoadedData.emit()},this._onVideoWaitingEvent=function(){r._system.logInfo("Native `waiting` event was emitted"),r._pauseForBufferPlaybackSeconds()},this._onVideoPlayEvent=function(){r._system.logInfo("Native `play` event was emitted"),r._videoRate=1},this._onVideoEndedEvent=function(){r._system.logInfo("Native `ended` event was emitted"),r._videoRate=1,r.onEnded.emit(r.getState())},this._onVideoPauseEvent=function(){r._system.logInfo("Native `pause` event was emitted (source=".concat(r._expectingPauseEvent?"internal":"external",")")),r._expectingPauseEvent||(r._videoRate=0),r._expectingPauseEvent=!1},this._onSafariLoadedData=function(){var e=Object.keys(r._appendedKeyFormats).length;void 0!==r._mediaSource&&e>0&&e!==r._mediaSource.getNativeResource().sourceBuffers.length&&r.onWarning.emit(new f.SafariKeyWarningError("Have only seen one webkitneedkey"))},this._onSafariWebkitNeedKey=function(e){if(void 0!==e&&e.initData instanceof Uint8Array){var t=new d.Mp4Parser;t.setParsers(new l.HashMap([["frma",h.FrmaBoxParser.getParser()]]));var i=r._stringUtil.fromCharCode(e.initData);if("{"===i[0]){var n=JSON.parse(i);if(r._fairPlayInitIsValid(n)&&0!==n.sinf.length){var o=t.parse(r._stringUtil.toCharCode(r._stringUtil.fromStandardBase64(n.sinf[0])));0!==o.length&&(r._appendedKeyFormats[o[0].fourCC]=1)}}}},this._onEnterPictureInPicture=function(){r._system.logInfo("Native `enterpictureinpicture` event was emitted"),r._inPictureInPicture=!0},this._onLeavePictureInPicture=function(){r._system.logInfo("Native `leavepictureinpicture` event was emitted"),r._inPictureInPicture=!1,r.onLeavePictureInPicture.emit()},this._syncVideo=function(){m.PromiseUtil.catchRejection(function(){return i.__awaiter(r,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return this._syncVideoPosition(),[4,this._syncVideoPlayState()];case 1:return e.sent(),[2]}})})},function(e){return r.onError.emit(u.WrappedError.wrap(e))})},this._system=e,this._htmlVideoElement=t,this._htmlVideoElement.autoplay=!1,this._htmlVideoElement.addEventListener("canplay",this._syncVideo),this._htmlVideoElement.addEventListener("loadedmetadata",this._syncVideo),this._htmlVideoElement.addEventListener("durationchange",this._syncVideo),this._platform.isSafari()&&(this._htmlVideoElement.addEventListener("loadeddata",this._onSafariLoadedData),this._htmlVideoElement.addEventListener("webkitneedkey",this._onSafariWebkitNeedKey)),this._htmlVideoElement.addEventListener("pause",this._onVideoPauseEvent),this._htmlVideoElement.addEventListener("ended",this._onVideoEndedEvent),this._htmlVideoElement.addEventListener("play",this._onVideoPlayEvent),this._htmlVideoElement.addEventListener("waiting",this._onVideoWaitingEvent),this._htmlVideoElement.addEventListener("loadeddata",this._onVideoLoadedDataEvent),this._htmlVideoElement.addEventListener("error",this._onVideoErrorEvent),this._htmlVideoElement.addEventListener("enterpictureinpicture",this._onEnterPictureInPicture),this._htmlVideoElement.addEventListener("leavepictureinpicture",this._onLeavePictureInPicture),void 0!==this._htmlVideoElement.getVideoPlaybackQuality&&(this._qualityTimer=new n.Timer(e,function(){return r._cacheQuality()}))}return e.prototype.destroy=function(){this.clearMediaSource(),this._htmlVideoElement.removeEventListener("canplay",this._syncVideo),this._htmlVideoElement.removeEventListener("loadedmetadata",this._syncVideo),this._htmlVideoElement.removeEventListener("durationchange",this._syncVideo),this._htmlVideoElement.removeEventListener("loadeddata",this._onSafariLoadedData),this._htmlVideoElement.removeEventListener("webkitneedkey",this._onSafariWebkitNeedKey),this._htmlVideoElement.removeEventListener("pause",this._onVideoPauseEvent),this._htmlVideoElement.removeEventListener("ended",this._onVideoEndedEvent),this._htmlVideoElement.removeEventListener("play",this._onVideoPlayEvent),this._htmlVideoElement.removeEventListener("waiting",this._onVideoWaitingEvent),this._htmlVideoElement.removeEventListener("loadeddata",this._onVideoLoadedDataEvent),this._htmlVideoElement.removeEventListener("error",this._onVideoErrorEvent),this._htmlVideoElement.removeEventListener("enterpictureinpicture",this._onEnterPictureInPicture),this._htmlVideoElement.removeEventListener("leavepictureinpicture",this._onLeavePictureInPicture),this._qualityTimer=void 0},e.prototype._fairPlayInitIsValid=function(e){return!!("object"==typeof e&&null!==e&&"sinf"in e&&Array.isArray(e.sinf))&&e.sinf.every(function(e){return"string"==typeof e})},e.prototype.getNativeResource=function(){return this._htmlVideoElement},e.prototype.getSize=function(){var e=this._htmlVideoElement.clientHeight,t=this._htmlVideoElement.clientWidth;return void 0!==window.devicePixelRatio&&window.devicePixelRatio>1&&(e*=window.devicePixelRatio,t*=window.devicePixelRatio),{height:e,width:t}},e.prototype.setRateWhenReady=function(e){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return this._videoRate=e,[4,this._syncVideoPlayState()];case 1:return t.sent(),[2]}})})},e.prototype.supportsPictureInPicture=function(){return"function"==typeof this._htmlVideoElement.requestPictureInPicture},e.prototype.requestPictureInPicture=function(){return i.__awaiter(this,void 0,void 0,function(){var e=this;return i.__generator(this,function(t){switch(t.label){case 0:if(!this.supportsPictureInPicture())return[3,2];return[4,this._htmlVideoElement.requestPictureInPicture().catch(function(t){e._system.logWarn("Request to Picture in Picture failed.",t)})];case 1:t.sent(),t.label=2;case 2:return[2]}})})},e.prototype.exitPictureInPicture=function(){var e=this;if("function"==typeof document.exitPictureInPicture)return document.exitPictureInPicture().catch(function(t){e._system.logWarn("Failed to exit Picture in Picture",t)})},e.prototype.inPictureInPicture=function(){return this._inPictureInPicture},e.prototype._pauseForBufferPlaybackSeconds=function(){this._bufferForPlaybackSeconds>0&&!this._htmlVideoElement.paused&&void 0===this._pendingPlayPromise&&1===this._videoRate&&this._pause()},e.prototype.setPositionWhenReady=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,n=this;return i.__generator(this,function(i){switch(i.label){case 0:if(this._lastSeekPosition=e,void 0!==this._seekPromise)return[2,this._seekPromise.promise];t=new Promise(function(e,r){n._seekPromise={promise:t,resolver:e,rejecter:r}}),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this._setPositionWhenReady()];case 2:return i.sent(),[3,4];case 3:return r=i.sent(),this._system.logError("Rejecting seek promise to ".concat(e),r),this._rejectSeekPromise(r),[3,4];case 4:return[2,t]}})})},e.prototype._setPositionWhenReady=function(){var e;return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,null===(e=this._mediaSource)||void 0===e?void 0:e.openSource()];case 1:return r.sent(),[3,3];case 2:if((t=r.sent())instanceof u.WrappedError&&u.WrappedError.causedBy(t,v.OperationCanceledError.NAME))return this._system.logVerbose("Resolving seek promise to ".concat(this._lastSeekPosition," because openSource was canceled")),this._resolveSeekPromise(),[2];throw t;case 3:return this._syncVideoPosition(),[2]}})})},e.prototype.setVolumeWhenReady=function(e){this._lastVolume=e,this._syncVideoVolume()},e.prototype._getBuffered=function(){for(var e,t,r,i,n,o,a=Array(this._htmlVideoElement.buffered.length),s=this._htmlVideoElement.buffered,u=0;u<s.length;u++)a[u]={start:null!==(r=null===(t=null===(e=this._mediaSource)||void 0===e?void 0:e.timelineOffset)||void 0===t?void 0:t.fromNativeValue(s.start(u)))&&void 0!==r?r:s.start(u),end:null!==(o=null===(n=null===(i=this._mediaSource)||void 0===i?void 0:i.timelineOffset)||void 0===n?void 0:n.fromNativeValue(s.end(u)))&&void 0!==o?o:s.end(u)};return a},e.prototype._getCurrentTime=function(){var e,t,r,i;return null!==(i=null!==(e=this._lastSeekPosition)&&void 0!==e?e:null===(r=null===(t=this._mediaSource)||void 0===t?void 0:t.timelineOffset)||void 0===r?void 0:r.fromNativeValue(this._htmlVideoElement.currentTime))&&void 0!==i?i:this._htmlVideoElement.currentTime},e.prototype.getState=function(){var e;return{currentTime:this._getCurrentTime(),volume:this._htmlVideoElement.volume,buffered:this._getBuffered(),playbackRate:this._videoRate,size:this.getSize(),totalVideoFrames:this._totalVideoFrames,droppedVideoFrames:this._droppedVideoFrames,readyState:this._getExternalReadyState(),timelineOffset:null===(e=this._mediaSource)||void 0===e?void 0:e.timelineOffset.getOffset()}},e.prototype._cacheQuality=function(){var e=this._htmlVideoElement.getVideoPlaybackQuality();this._droppedVideoFrames=e.droppedVideoFrames,this._totalVideoFrames=e.totalVideoFrames},e.prototype.setMediaSource=function(t){var r;return i.__awaiter(this,void 0,void 0,function(){var n=this;return i.__generator(this,function(o){switch(o.label){case 0:return this.clearMediaSource(),this._mediaSource=t,this._mediaSource.setVideoElement(this._htmlVideoElement),this._mediaSource.onSourceEnded.on(this,function(){n._mediaSourceHasEverEnded=!0}),this._mediaSource.mediaQueue.onSourceBufferUpdateEnd.on(this,function(){m.PromiseUtil.catchRejection(function(){return i.__awaiter(n,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:if(this._syncVideoPosition(),0===this._bufferForPlaybackSeconds)return[2];return[4,this._syncVideoPlayState()];case 1:return e.sent(),[2]}})})},function(e){return n.onError.emit(u.WrappedError.wrap(e))})}),this._mediaSource.mediaQueue.onError.on(this,function(e){return n.onError.emit(e)}),this._objectUrl=this._createObjectURL(this._mediaSource.getNativeResource()),this._htmlVideoElement.src=this._objectUrl,[4,this._mediaSource.openPromise];case 1:return o.sent(),this._syncVideoPosition(),null===(r=this._qualityTimer)||void 0===r||r.tickEvery(e.QUALITY_UPDATE_SECONDS),[2]}})})},e.prototype.setBufferForPlaybackSeconds=function(e){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:if(this._bufferForPlaybackSeconds===e)return[2];return this._bufferForPlaybackSeconds=e,[4,this._syncVideoPlayState()];case 1:return t.sent(),[2]}})})},e.prototype.clearMediaSource=function(){var e;this._appendedKeyFormats={},void 0!==this._objectUrl&&(this._revokeObjectURL(this._objectUrl),this._objectUrl=void 0,this._unload()),void 0!==this._mediaSource&&(this._mediaSource.setVideoElement(void 0),this._mediaSource.onSourceEnded.off(this),this._mediaSource.mediaQueue.onSourceBufferUpdateEnd.off(this),this._mediaSource.mediaQueue.onError.off(this),this._mediaSource=void 0),this._mediaSourceHasEverEnded=!1,this._droppedVideoFrames=0,this._totalVideoFrames=0,null===(e=this._qualityTimer)||void 0===e||e.stop(),void 0!==this._seekPromise&&(this._system.logWarn("Resolving seek promise because media source was cleared"),this._resolveSeekPromise()),this._expectingPauseEvent=!1,this._cancelAnimationFrame()},e.prototype._unload=function(){var e=this,t=this._pendingPlayPromise;this._htmlVideoElement.removeAttribute("src"),this._htmlVideoElement.load(),null==t||t.catch(function(){e._videoRate=1}),this._pendingPlayPromise=void 0},e.prototype._createObjectURL=function(e){return URL.createObjectURL(e)},e.prototype._revokeObjectURL=function(e){URL.revokeObjectURL(e)},e.prototype._haveEnoughBufferedToPlay=function(){if(this._htmlVideoElement.readyState<HTMLMediaElement.HAVE_CURRENT_DATA)return!1;if(0===this._bufferForPlaybackSeconds)return!0;var e=this._getCurrentTime(),t=this._getClosestBufferedRange(e);return void 0!==t&&Math.round(t.end-e)>=this._bufferForPlaybackSeconds},e.prototype._getClosestBufferedRange=function(e){for(var t,r=0,i=this._getBuffered();r<i.length;r++){var n=i[r];if(this._timeRangeUtil.contains([n],e))return n;var o=Math.abs(e-n.start);(void 0===t||o<Math.abs(e-t.start))&&(t=n)}return t},e.prototype._syncVideoPlayState=function(){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:if(!(this._htmlVideoElement.hasAttribute("src")&&""!==this._htmlVideoElement.src))return[3,6];if(!(0===this._videoRate&&!this._htmlVideoElement.paused))return[3,1];return this._pause(),[3,6];case 1:if(!(void 0===this._pendingPlayPromise&&this._videoRate>0&&this._htmlVideoElement.paused&&!this._htmlVideoElement.ended&&this._haveEnoughBufferedToPlay()))return[3,6];this._mediaSourceHasEverEnded&&this._platform.isPlayStation4()&&(this._system.logVerbose("NudgeWhenUnpausingAfterEndOfStream: nudging the playhead by ".concat(_.PlayerConstants.STALL_SEEK_EPSILON)),this._htmlVideoElement.currentTime+=_.PlayerConstants.STALL_SEEK_EPSILON),e.label=2;case 2:return e.trys.push([2,4,5,6]),this._pendingPlayPromise=this._htmlVideoElement.play(),[4,this._pendingPlayPromise];case 3:return e.sent(),[3,6];case 4:return e.sent(),this._system.logWarn("HTMLVideoElement.play() has failed - this may indicate an autoplay permission issue resulting in paused playback"),this._videoRate=0,[3,6];case 5:return this._pendingPlayPromise=void 0,[7];case 6:return[2]}})})},e.prototype._syncVideoPosition=function(){if(void 0!==this._lastSeekPosition){var e,t,r,i,n,o,a=void 0!==this._mediaSource&&this._htmlVideoElement.readyState>=HTMLMediaElement.HAVE_METADATA,s=null!==(t=null===(e=this._mediaSource)||void 0===e?void 0:e.mediaQueue.hasRunningSourceBuffer())&&void 0!==t&&t;if(!a){void 0!==this._seekPromise&&(this._system.logVerbose("Resolving seek promise to ".concat(this._lastSeekPosition," because HTMLVideoElement isn't ready")),this._resolveSeekPromise());return}if(!s){var u=null!==(n=null===(i=null===(r=this._mediaSource)||void 0===r?void 0:r.timelineOffset)||void 0===i?void 0:i.toNativeValue(this._lastSeekPosition))&&void 0!==n?n:this._lastSeekPosition;0===u&&this._system.requiresDontSeekToZeroWorkaround()&&(u=_.PlayerConstants.STALL_SEEK_EPSILON,this._system.logInfo("DontSeekToZeroWorkaround: seeking to ".concat(u," instead"))),this._htmlVideoElement.currentTime=u,this._system.logVerbose("Set HTMLVideoElement.currentTime to ".concat(this._lastSeekPosition," offset=").concat(null===(o=this._mediaSource)||void 0===o?void 0:o.timelineOffset.getOffset())),this._resolveSeekPromise(),(0===this._lastSeekPosition||0!==this._htmlVideoElement.currentTime)&&(this._lastSeekPosition=void 0)}}},e.prototype._syncVideoVolume=function(){void 0!==this._lastVolume&&(this._htmlVideoElement.volume=this._lastVolume,this._lastVolume=void 0)},e.prototype._resolveSeekPromise=function(){var e;null===(e=this._seekPromise)||void 0===e||e.resolver(),this._seekPromise=void 0},e.prototype._rejectSeekPromise=function(e){var t;null===(t=this._seekPromise)||void 0===t||t.rejecter(e),this._seekPromise=void 0},e.prototype._pause=function(){this._expectingPauseEvent=!this._htmlVideoElement.paused,this._htmlVideoElement.pause()},e.prototype._getExternalReadyState=function(){var e=this._remapNativeReadyState(this._htmlVideoElement.readyState);return e>=2&&this._htmlVideoElement.paused&&!this._haveEnoughBufferedToPlay()?1:e},e.prototype._remapNativeReadyState=function(e){switch(e){case HTMLMediaElement.HAVE_NOTHING:return 0;case HTMLMediaElement.HAVE_METADATA:return 1;case HTMLMediaElement.HAVE_CURRENT_DATA:return 2;case HTMLMediaElement.HAVE_FUTURE_DATA:return 3;case HTMLMediaElement.HAVE_ENOUGH_DATA:return 4}throw Error("Unexpected value for HTMLMediaElement.readyState: ".concat(e))},e.prototype._pokeTheDom=function(){var e=this;this._platform.isPlayStation4()&&this._requestAnimationFrame(function(){var t=e._htmlVideoElement.style.opacity,r=parseFloat(getComputedStyle(e._htmlVideoElement).opacity);e._htmlVideoElement.style.opacity="".concat(r>=.01?r-.01:r+.01),e._requestAnimationFrame(function(){e._htmlVideoElement.style.opacity=t})})},e.prototype._requestAnimationFrame=function(e){var t=this;if(void 0!==this._pendingAnimationFrame){this._system.logWarn("Ignoring stacked call to requestAnimationFrame");return}this._pendingAnimationFrame=requestAnimationFrame(function(r){t._pendingAnimationFrame=void 0,e(r)})},e.prototype._cancelAnimationFrame=function(){void 0!==this._pendingAnimationFrame&&(cancelAnimationFrame(this._pendingAnimationFrame),this._pendingAnimationFrame=void 0)},e.QUALITY_UPDATE_SECONDS=10,e}();t.BrowserVideoElement=g},76843:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeySystemWrapper=void 0;var i=r(22970),n=r(73093),o=r(95645),a=r(30607),s=r(34855),u=r(57665),c=r(69964),d=r(94306),l=r(67179),h=r(44639),p=function(){function e(e,t,r,i){var n,o;this._isTypeSupported=e,this._useSonyEnhancedSecurityVideoMode=r,this._system=i,this._platform=new a.Platform,this._codecUtil=new l.CodecUtil,this._arrayUtil=new c.ArrayUtil,this._supportedNativeConfigurationMap=new d.HashMap,this._audioMimeDefaults=((n={})["ec-3-atmos"]='audio/mp4; codecs="ec-3"',n["ec-3"]='audio/mp4; codecs="ec-3"',n["ac-3"]='audio/mp4; codecs="ac-3"',n.aac='audio/mp4; codecs="mp4a.40.2"',n.heaac='audio/mp4; codecs="mp4a.40.5"',n["unknown-audio"]="audio/mp4",n),this._videoMimeDefaults=((o={}).avc='video/mp4; codecs="avc1.4d400d"',o.hevc='video/mp4; codecs="hvc1.1.6.L60.90"',o["hevc-hdr"]='video/mp4; codecs="hvc1.2.4.L63.90"',o.dvh=this._getPlatformDolbyVisionDefault(),o["unknown-video"]="video/mp4",o),void 0!==t?this._supportedKeySystems=t:this._platform.isSafari()?this._supportedKeySystems=["com.apple.fps.2_0"]:this._supportedKeySystems=["com.microsoft.playready.recommendation","com.microsoft.playready","com.widevine.alpha"],this._supportedKeySystems=this._sanitizeSupportedKeySystems(this._supportedKeySystems)}return e.prototype.getContextualInfo=function(){var e=this,t="\n supportedNativeConfiguration: ";return this._supportedNativeConfigurationMap.forEach(function(r,i){var n=e._refineSupportMap(i);t+='{ "'.concat(r,'": {').concat(n,"} }; ")}),t},e.prototype.getMediaKeySupport=function(){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(r){switch(r.label){case 0:if(void 0!==e._supported)return[3,2];return t=e,[4,this._getSupport()];case 1:t._supported=r.sent(),r.label=2;case 2:return[2,e._supported]}})})},e.prototype.makeMediaKeySystemAccess=function(e){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this._makeSystemAccess(e)];case 1:return[2,r.sent()];case 2:throw t=r.sent(),new o.UnsupportedError("Unable to create system access with keySystem "+"'".concat(e.keySystem,"' and encryptionScheme '").concat(e.encryptionScheme,"'"),u.WrappedError.wrap(t));case 3:return[2]}})})},e.prototype.setMediaKeys=function(e,t){return s.PromiseUtil.ensurePromiseType(e.getNativeResource().setMediaKeys(t.getNativeResource()))},e.prototype.clearMediaKeys=function(e){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return[4,s.PromiseUtil.ensurePromiseType(e.getNativeResource().setMediaKeys(null))];case 1:return t.sent(),[2]}})})},e.prototype._getPlatformDolbyVisionDefault=function(){var e='video/mp4; codecs="';return this._platform.isXbox()?e+="hvc1.2.4.L63.90":e+="dvh1.05.01",e+'"'},e.prototype._sanitizeSupportedKeySystems=function(e){var t=this;return e.filter(function(e){return"com.microsoft.playready.recommendation"!==e||t._platform.isChromiumEdge()})},e.prototype._getAllSupportedAudio=function(){var e,t=this,r=["ec-3","ac-3","heaac","aac"].filter(function(e){return t._isTypeSupported(t._audioMimeDefaults[e])});if(this._platform.isSafari()){var i=((e={}).aac=1,e.heaac=1,e);this._platform.isSafari(14)&&(i["ac-3"]=1),r=r.filter(function(e){return void 0!==i[e]})}return r},e.prototype._assumeCbcForSafari=function(e,t,r){for(var n=function(t){for(var n=function(r){var n=o._arrayUtil.find(e,function(e){return"com.apple.fps.2_0"===e.keySystem&&e.video===t&&e.audio===r&&"ctr"===e.encryptionScheme&&"optional"===e.persistentState});void 0===n||e.some(function(e){return"com.apple.fps.2_0"===e.keySystem&&e.video===t&&e.audio===r&&"cbc"===e.encryptionScheme&&"optional"===e.persistentState})||e.push(i.__assign(i.__assign({},n),{encryptionScheme:"cbc"}))},a=0;a<r.length;a++)n(r[a])},o=this,a=0;a<t.length;a++)n(t[a])},e.prototype._getSupport=function(){return i.__awaiter(this,void 0,void 0,function(){var e,t,r,n,o,a,s,u,c,d,l,h,p,f,_,v,m,g,y,S,E,b,w,P,T,C,M,k,A,x,D,R,O,I,U=this;return i.__generator(this,function(B){switch(B.label){case 0:if(void 0===navigator.requestMediaKeySystemAccess)return[2,[]];if(e=["ctr","cbc"],t=this._supportedKeySystems,r=this._getAllSupportedAudio(),n=["dvh","hevc-hdr","hevc","avc"].filter(function(e){return U._isTypeSupported(U._videoMimeDefaults[e])}),o=[],this._system.supportsMediaKeySystemAccessGetConfiguration())return[3,3];for(s=0,a=Array(e.length*t.length),u=t;s<u.length;s++)for(l=0,c=u[s],d=this._getPersistentState(c),h=e;l<h.length;l++)p=h[l],a.push(this._tryMakeSystemAccess({keySystem:c,encryptionScheme:p,audio:"aac",video:"avc",persistentState:d}));return[4,Promise.all(a)];case 1:for(v=0,f=B.sent(),_=[],m=f;v<m.length;v++)if(void 0!==(g=m[v]))for(y=0,S=r;y<S.length;y++)for(b=0,E=S[y],w=n;b<w.length;b++)P=w[b],_.push(this._tryMakeSystemAccess(i.__assign(i.__assign({},g.options),{audio:E,video:P})));return[4,Promise.all(_)];case 2:for(T=0,C=B.sent();T<C.length;T++)void 0!==(M=C[T])&&o.push(M.options);return[3,7];case 3:for(k=0,a=[],A=t;k<A.length;k++)c=A[k],d=this._getPersistentState(c),a.push(this._checkOptionsForSupport(c,d,e,r,n));return x=0,[4,Promise.all(a)];case 4:D=B.sent(),B.label=5;case 5:if(!(x<D.length))return[3,7];for(R=0,O=D[x];R<O.length;R++)I=O[R],o.push(I);B.label=6;case 6:return x++,[3,5];case 7:return this._platform.isSafari()&&this._assumeCbcForSafari(o,n,r),[2,o.filter(function(e){return U._isOptionalAllowed(e)})]}})})},e.prototype._isOptionalAllowed=function(e){return!("com.microsoft.playready"===e.keySystem&&this._platform.isChromiumEdge())||"dvh"!==e.video&&"hevc-hdr"!==e.video},e.prototype._tryMakeSystemAccess=function(e){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this._makeSystemAccess(e)];case 1:return[2,t.sent()];case 2:return t.sent(),[2,void 0];case 3:return[2]}})})},e.prototype._makeSystemAccess=function(e){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(r){switch(r.label){case 0:return[4,navigator.requestMediaKeySystemAccess(this._getPlatformKeySystem(e.keySystem),[this._getSystemAccessConfiguration(e.keySystem,[e.encryptionScheme],[e.audio],[e.video])])];case 1:return t=r.sent(),[2,new n.MediaKeySystemAccessWrapper(t,e,this._system)]}})})},e.prototype._checkOptionsForSupport=function(e,t,r,n,o){var a,s;return i.__awaiter(this,void 0,void 0,function(){var u,c,d,l,p,f,_,v,m,g,y,S,E,b,w,P,T,C,M,k,A,x,D,R,O,I,U,B,L;return i.__generator(this,function(i){switch(i.label){case 0:u=this._getSystemAccessConfiguration(e,r,n,o),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,navigator.requestMediaKeySystemAccess(this._getPlatformKeySystem(e),[u])];case 2:return c=i.sent(),[3,4];case 3:return i.sent(),[2,[]];case 4:for(d=c.getConfiguration(),this._supportedNativeConfigurationMap.set(e,d),(B={}).aac=1,B.heaac=1,B["ac-3"]=1,B["ec-3"]=1,B["ec-3-atmos"]=1,B["unknown-audio"]=1,l=B,p=(0,h.stringKeys)(l),(L={}).dvh=1,L.avc=1,L.hevc=1,L["hevc-hdr"]=1,L["unknown-video"]=1,f=L,_=(0,h.stringKeys)(f),v=[],m=function(e){for(var t="cbcs"===e.encryptionScheme?"cbc":"ctr",r=function(r){if(g._audioMimeDefaults[r]===e.contentType)return v.some(function(e){var i=e[0],n=e[1];return i===r&&n===t})||v.push([r,t]),"break"},i=0;i<p.length&&"break"!==r(p[i]);i++);},g=this,y=0,S=null!==(a=d.audioCapabilities)&&void 0!==a?a:[];y<S.length;y++)m(S[y]);for(P=0,E=[],b=function(e){for(var t="cbcs"===e.encryptionScheme?"cbc":"ctr",r=function(r){if(w._videoMimeDefaults[r]===e.contentType)return E.some(function(e){var i=e[0],n=e[1];return i===r&&n===t})||E.push([r,t]),"break"},i=0;i<_.length&&"break"!==r(_[i]);i++);},w=this,T=null!==(s=d.videoCapabilities)&&void 0!==s?s:[];P<T.length;P++)b(T[P]);for(M=0,C=[],k=v;M<k.length;M++)for(x=(A=k[M])[0],D=A[1],R=0,O=E;R<O.length;R++)U=(I=O[R])[0],D===I[1]&&C.push({audio:x,video:U,encryptionScheme:D,keySystem:e,persistentState:t});return[2,C]}})})},e.prototype._getPlatformKeySystem=function(e){return this._useSonyEnhancedSecurityVideoMode?"".concat(e,".esvm"):e},e.prototype._getSystemAccessConfiguration=function(e,t,r,i){for(var n={initDataTypes:["cenc"],audioCapabilities:[],videoCapabilities:[]},o=0;o<t.length;o++){for(var a=t[o],s=0;s<r.length;s++){var u=r[s],c={contentType:this._audioMimeDefaults[u]};"ctr"!==a&&(c.encryptionScheme="cbcs"),n.audioCapabilities.push(c)}for(var d=0;d<i.length;d++){var l=i[d],c={contentType:this._videoMimeDefaults[l]};"ctr"!==a&&(c.encryptionScheme="cbcs"),"com.microsoft.playready.recommendation"!==e||this._useSonyEnhancedSecurityVideoMode||(c.robustness="3000"),n.videoCapabilities.push(c)}}return"com.apple.fps.2_0"===e&&(n.initDataTypes=["sinf"],n.sessionTypes=["temporary"]),n},e.prototype._getPersistentState=function(e){var t="optional";return"com.microsoft.playready.recommendation"===e&&this._platform.isChromiumEdge()&&(t="not-allowed"),t},e.prototype._refineSupportMap=function(e){var t="",r=new d.HashMap;return this._generateSupportMapFromCapabilities(r,e.audioCapabilities),this._generateSupportMapFromCapabilities(r,e.videoCapabilities),r.forEach(function(e,r){t.length>0&&(t+=", "),t+='"'.concat(e,'": [').concat(r.join(", "),"]")}),t},e.prototype._generateSupportMapFromCapabilities=function(e,t){var r=this;void 0===t&&(t=[]),t.forEach(function(t){var i=String(t.encryptionScheme);if(void 0!==t.contentType){var n=r._codecUtil.trimCodecsFromMimeString(t.contentType);e.contains(i)?e.get(i).push(n):e.set(i,[n])}})},e}();t.KeySystemWrapper=p},15790:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaKeySessionWrapper=void 0;var i=r(22970),n=r(2913),o=r(54744),a=r(34855),s=r(28521),u=r(57665),c=r(94306),d=r(6246),l=r(95645),h=r(46433),p=r(41746),f=r(77285),_=function(e){function t(t,r,i){var o=e.call(this,!1,r)||this;return o._hasEventHandlers=!1,o._commonEncryptionUtil=new n.CommonEncryptionUtil,o._onKeyStatusesChange=function(){o._keySessionStatusCache=void 0,o.onKeyStatusesChange.emit()},o._onMessage=function(e){o.onMessage.emit({message:e.message,type:e.messageType})},o._mediaKeySession=t,o._system=i,o}return i.__extends(t,e),Object.defineProperty(t.prototype,"sessionId",{get:function(){return this._mediaKeySession.sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"expiration",{get:function(){return this._mediaKeySession.expiration},enumerable:!1,configurable:!0}),t.prototype.getMediaKeyStatusMap=function(){var e=this;if(void 0===this._keySessionStatusCache){var t=new c.HashMap;this._keySessionStatusCache=t,this._mediaKeySession.keyStatuses.forEach(function(r,i){if("string"==typeof i){var n=i;i=r,r=n}var o=e._stringUtil.toHex(new Uint8Array(i));t.set(e._getKeyIdFromPlatformKeyId(o),e._getStatusFromPlatformStatus(r))})}return this._keySessionStatusCache},t.prototype.load=function(e){return this._addEventHandlersIfNeeded(),a.PromiseUtil.ensurePromiseType(this._mediaKeySession.load(e))},t.prototype.remove=function(){return a.PromiseUtil.ensurePromiseType(this._mediaKeySession.remove())},t.prototype.generateRequest=function(e,t){return i.__awaiter(this,void 0,void 0,function(){var r,n,o,s,c,l;return i.__generator(this,function(i){switch(i.label){case 0:if("com.microsoft.playready"===this._options.keySystem||"com.microsoft.playready.recommendation"===this._options.keySystem)for(void 0===this._requestedPlayReadyKeyIds&&(this._requestedPlayReadyKeyIds=new d.HashSet),r=this._commonEncryptionUtil.getKeysFromInitData(t),n=0,o=r;n<o.length;n++)s=o[n],this._requestedPlayReadyKeyIds.add(this._stringUtil.toHex(s));this._addEventHandlersIfNeeded(),i.label=1;case 1:return i.trys.push([1,3,,4]),c=new Promise(function(e,t){setTimeout(function(){t(Error("Timed out after ".concat(f.KeySessionHelper.TIMEOUT_SECONDS," seconds waiting for generateRequest promise.")))},1e3*f.KeySessionHelper.TIMEOUT_SECONDS)}),[4,Promise.race([a.PromiseUtil.ensurePromiseType(this._mediaKeySession.generateRequest(e,t)),c,this.closed])];case 2:return i.sent(),[3,4];case 3:throw l=i.sent(),new p.MediaKeySessionGenerateRequestError('call to MediaKeySession.generateRequest failed: initDataType="'.concat(e,'" initData="').concat(this._stringUtil.toStandardBase64(this._stringUtil.fromCharCode(t)),'" sessionId="').concat(this._mediaKeySession.sessionId,'" expiration=').concat(this._mediaKeySession.expiration," options=").concat(JSON.stringify(this._options)),u.WrappedError.wrap(l));case 4:return[2]}})})},t.prototype.update=function(e){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,a.PromiseUtil.ensurePromiseType(this._mediaKeySession.update(e))];case 1:return r.sent(),[3,3];case 2:throw t=r.sent(),new h.MediaKeySessionUpdateError("call to MediaKeySession.update failed",u.WrappedError.wrap(t));case 3:return[2]}})})},t.prototype.close=function(){return i.__awaiter(this,void 0,void 0,function(){var t,r,n;return i.__generator(this,function(i){switch(i.label){case 0:this._requestedPlayReadyKeyIds=void 0,this._keySessionStatusCache=void 0,this._removeEventHandlers(),t=this._system.postTimeout(1),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Promise.race([Promise.all([a.PromiseUtil.ensurePromiseType(this._mediaKeySession.close()),a.PromiseUtil.ensurePromiseType(this._mediaKeySession.closed)]),t.timeout.then(function(){return"TIMEOUT"})])];case 2:return r=i.sent(),t.cancel(),"TIMEOUT"===r&&this.onWarning.emit(new s.WarningError("Timeout waiting for MediaKeySession ".concat(this._mediaKeySession.sessionId," to close"))),[3,4];case 3:return n=i.sent(),this.onWarning.emit(new s.WarningError("error calling to close media key session ",u.WrappedError.wrap(n))),[3,4];case 4:return[2,e.prototype._close.call(this)]}})})},t.prototype._getKeyIdFromPlatformKeyId=function(e){if(void 0!==this._requestedPlayReadyKeyIds){if(this._requestedPlayReadyKeyIds.has(e))return e;if(32===e.length){var t=this._commonEncryptionUtil.fromEncodedPlayreadyKeyId(e);if(this._requestedPlayReadyKeyIds.has(t))return t}this.onError.emit(new l.UnsupportedError("platform returned unrecognized key id '".concat(e,"'")))}return e},t.prototype._getStatusFromPlatformStatus=function(e){return"com.microsoft.playready"===this._options.keySystem&&("status-pending"===e||"output-downscaled"===e)||"com.apple.fps.2_0"===this._options.keySystem&&"status-pending"===e?"usable":e},t.prototype._addEventHandlersIfNeeded=function(){this._hasEventHandlers||(this._hasEventHandlers=!0,this._mediaKeySession.addEventListener("message",this._onMessage,!1),this._mediaKeySession.addEventListener("keystatuseschange",this._onKeyStatusesChange))},t.prototype._removeEventHandlers=function(){this._hasEventHandlers=!1,this._mediaKeySession.removeEventListener("message",this._onMessage,!1),this._mediaKeySession.removeEventListener("keystatuseschange",this._onKeyStatusesChange)},t}(o.BaseMediaKeySessionWrapper);t.MediaKeySessionWrapper=_},73093:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaKeySystemAccessWrapper=void 0;var i=r(22970),n=r(15956),o=function(){function e(e,t,r){this.options=t,this._systemAccess=e,this._system=r}return e.prototype.createMediaKeys=function(){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){switch(t.label){case 0:return e=n.MediaKeysWrapper.bind,[4,this._systemAccess.createMediaKeys()];case 1:return[2,new(e.apply(n.MediaKeysWrapper,[void 0,t.sent(),this.options,this._system]))]}})})},e}();t.MediaKeySystemAccessWrapper=o},15956:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaKeysWrapper=void 0;var i=r(22970),n=r(15790),o=r(47632),a=r(57665),s=r(34855),u=r(98129),c=function(){function e(e,t,r){this.onError=new o.Emitter,this.onWarning=new o.Emitter,this._mediaKeys=e,this._options=t,this._system=r}return e.prototype.getNativeResource=function(){return this._mediaKeys},e.prototype.setServerCertificate=function(e){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,s.PromiseUtil.ensurePromiseType(this._mediaKeys.setServerCertificate(e))];case 1:return[2,r.sent()];case 2:throw t=r.sent(),new u.SetServerCertificateError("set server certificate failed",a.WrappedError.wrap(t));case 3:return[2]}})})},e.prototype.createSession=function(e){var t=this._mediaKeys.createSession(e);return new n.MediaKeySessionWrapper(t,this._options,this._system)},e}();t.MediaKeysWrapper=c},76300:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaSourceWrapper=void 0;var i=r(22970),n=r(48360),o=r(55087),a=r(30607),s=r(14016),u=r(82997),c=r(2906),d=r(47632),l=r(34855),h=r(57665),p=r(22994),f=function(){function e(t,r,o,h,f){var _,v=this;this._useSonyEnhancedSecurityVideoMode=f,this._mimeUtil=new n.MimeUtil,this._platform=new a.Platform,this.onSourceEnded=new d.Emitter,this._patchAddSourceBuffer=function(e){var t=v._mediaSource.addSourceBuffer;v._mediaSource.addSourceBuffer=function(r){return t.apply(this,[e(r)])}},this._onSourceOpen=function(){l.PromiseUtil.catchRejection(function(){return i.__awaiter(v,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:if(0!==this._mediaSource.sourceBuffers.length)return[3,2];return[4,this._setDuration(!1,0,e.DEFAULT_DURATION)];case 1:t.sent(),t.label=2;case 2:return[2]}})})},function(e){v._system.logError("MediaSource open duration setting failed",e)},function(){return v._resolveOpenPromise()})},this._onSourceClose=function(){v._resolveOpenPromise(),v._openPromise=new Promise(function(e){v._openResolve=e})},this._onSourceEnded=function(){v._system.logVerbose("mediaSource.readyState transitioned to 'ended'"),v._onSourceClose(),v.onSourceEnded.emit()},this._onLoadedMetadata=function(){v._mediaQueue.flush()},this._isMediaSourceValid=function(e,t){var r,i,n=null!==(i=null===(r=v._videoElement)||void 0===r?void 0:r.error)&&void 0!==i?i:void 0;if(void 0!==n){var o={sourceBuffers:v.getSourceBufferInfoMap()};return new u.MediaOperationStateError("Failed to run ".concat(t.name,": the video element is not in a valid state"),new c.VideoElementError(n,o))}if("closed"===e.getNativeResource().readyState)return new u.MediaOperationStateError("Failed to run ".concat(t.name,": the media source is closed"))},this._isSourceBufferValid=function(e,t){if(void 0===v._getExistingSourceBuffer(e))return new u.MediaOperationStateError("Failed to run ".concat(t.name,": the source buffer is no longer active"))},this._resolveOpenPromise=function(){void 0!==v._openResolve&&(v._openResolve(),v._openResolve=void 0)},this._system=t,this._options=r,this._mediaQueue=new s.MediaObjectQueue(t,this._isMediaSourceValid,this._isSourceBufferValid),this._mediaSource=o,this.timelineOffset=new p.TimelineOffset(null!==(_=r.workaroundOptions)&&void 0!==_?_:{}),"function"==typeof r.addSourceBufferTypeInterceptor&&this._patchAddSourceBuffer(r.addSourceBufferTypeInterceptor),this._referenceStore=h,this._openPromise=new Promise(function(e){v._openResolve=e}),this._mediaQueue.trackMediaSource(this)}return Object.defineProperty(e.prototype,"openPromise",{get:function(){return this._openPromise},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mediaQueue",{get:function(){return this._mediaQueue},enumerable:!1,configurable:!0}),e.prototype.getNativeResource=function(){return this._mediaSource},e.prototype.destroy=function(){this.setVideoElement(void 0)},e.prototype.setVideoElement=function(e){void 0!==this._videoElement&&this._videoElement.removeEventListener("loadedmetadata",this._onLoadedMetadata),this._mediaSource.removeEventListener("sourceopen",this._onSourceOpen),this._mediaSource.removeEventListener("sourceended",this._onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this._onSourceClose),this._videoElement=e,void 0!==this._videoElement?(this._videoElement.addEventListener("loadedmetadata",this._onLoadedMetadata),this._mediaSource.addEventListener("sourceopen",this._onSourceOpen),this._mediaSource.addEventListener("sourceended",this._onSourceEnded),this._mediaSource.addEventListener("sourceclose",this._onSourceClose)):this._mediaQueue.reset()},e.prototype.openSource=function(){return i.__awaiter(this,void 0,void 0,function(){var t=this;return i.__generator(this,function(r){switch(r.label){case 0:if(!(this._mediaSource.readyState===e.MEDIA_SOURCE_ENDED&&this._mediaSource.sourceBuffers.length>0))return[3,2];return[4,this._mediaQueue.queueMediaSource("openSource",function(){if(t._mediaSource.readyState===e.MEDIA_SOURCE_ENDED&&t._mediaSource.sourceBuffers.length>0)for(var r=0;r<t._mediaSource.sourceBuffers.length;++r)t._mediaSource.sourceBuffers[r].timestampOffset+=1e-4})];case 1:r.sent(),r.label=2;case 2:return[2]}})})},e.prototype._setDuration=function(t,r,i){var n=this;return this._mediaQueue.queueMediaSource("setContentRange",function(){t&&!n.timelineOffset.hasOffset()&&n.timelineOffset.setOffset(-r);for(var e=i,o=0;o<n._mediaSource.sourceBuffers.length;o++)for(var a=n._mediaSource.sourceBuffers[o],s=0;s<a.buffered.length;s++)i=Math.max(i,a.buffered.end(s));try{n._mediaSource.duration=i}catch(t){var c="Debug information:\n";throw c+="Current MediaSource duration: ".concat(n._mediaSource.duration,";\n")+"MediaSource readyState: ".concat(n._mediaSource.readyState,";\n")+"Duration to set: ".concat(i,";\n")+"Initial duration to set: ".concat(e,";\n"),new u.MediaOperationStateError("Can't set MediaSource duration.\n".concat(c),h.WrappedError.wrap(t))}},function(){return n._mediaSource.readyState===e.MEDIA_SOURCE_OPEN})},e.prototype.setContentRange=function(e,t){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(r){switch(r.label){case 0:return[4,this._openPromise];case 1:return r.sent(),[2,this._setDuration(!0,e,t)]}})})},e.prototype.addSourceBuffer=function(e,t,r,n){return i.__awaiter(this,void 0,void 0,function(){var a=this;return i.__generator(this,function(i){switch(i.label){case 0:return[4,this._openPromise];case 1:return i.sent(),[2,this._mediaQueue.queueMediaSource("addSourceBuffer",function(){var i=a._mediaSource.addSourceBuffer(a._getPlatformSourceBufferType(a._mimeUtil.getFullType(t,r)));return new o.SourceBufferWrapper(a._system,a._options,a._mediaQueue,i,a._referenceStore,e,r,n,a.timelineOffset)})]}})})},e.prototype.endOfStream=function(){return i.__awaiter(this,void 0,void 0,function(){var t=this;return i.__generator(this,function(r){switch(r.label){case 0:if(this._mediaSource.readyState===e.MEDIA_SOURCE_ENDED)return[2];return[4,this._openPromise];case 1:return r.sent(),[2,this._mediaQueue.queueMediaSource("endOfStream",function(){t._mediaSource.readyState===e.MEDIA_SOURCE_OPEN&&t._mediaSource.endOfStream()})]}})})},e.prototype.getSourceBufferInfoMap=function(){return this.mediaQueue.getSourceBuffers()},e.prototype._getExistingSourceBuffer=function(e){for(var t=e.getNativeResource(),r=0;r<this._mediaSource.sourceBuffers.length;r++)if(this._mediaSource.sourceBuffers[r]===t)return t},e.prototype._getPlatformSourceBufferType=function(e){return this._useSonyEnhancedSecurityVideoMode?"".concat(e,"; esvm=true"):this._platform.isXbox()&&-1!==e.indexOf("dvh1.05")?"video/mp4":e},e.MEDIA_SOURCE_OPEN="open",e.MEDIA_SOURCE_ENDED="ended",e.DEFAULT_DURATION=36e4,e}();t.MediaSourceWrapper=f},84936:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrefixedKeySystemWrapper=void 0;var i=r(30607),n=r(96484),o=function(){function e(e){this._supported=null==e?void 0:e.slice(),this._platform=new i.Platform}return e.prototype.getMediaKeySupport=function(){return void 0!==this._supported?this._supported:(void 0===e._cachedSupported&&(e._cachedSupported=this._getSupport()),e._cachedSupported)},e.prototype.makeMediaKeySystemAccess=function(e){return{options:e,createMediaKeys:function(){return new n.PrefixedMediaKeysWrapper(e)}}},e.prototype.setMediaKeys=function(e,t){t.setVideoElement(e)},e.prototype.clearMediaKeys=function(e){e.onPrefixedKeyError.off(),e.onPrefixedNeedKey.off()},e.prototype._getKeySystem=function(){return this._platform.isSagemcom()||this._platform.isClaro()?"com.widevine.alpha":"com.microsoft.playready"},e.prototype._getSupport=function(){var e=this;return["aac","heaac"].map(function(t){return{audio:t,video:"avc",encryptionScheme:"ctr",keySystem:e._getKeySystem(),persistentState:"optional"}})},e}();t.PrefixedKeySystemWrapper=o},73378:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrefixedMediaKeySessionWrapper=void 0;var i=r(22970),n=r(95645),o=r(2913),a=r(27468),s=r(34855),u=r(54744),c=r(57665),d=r(94306),l=r(6246),h=r(30607),p=r(41746),f=function(e){function t(t){var r=e.call(this,!0,t)||this;return r.sessionId="",r.expiration=0,r._keyMap=new d.HashMap,r._requestedWidevineKeyIds=new l.HashSet,r._cencUtil=new o.CommonEncryptionUtil,r._mp4Parser=new a.Mp4Parser,r._platform=new h.Platform,r}return i.__extends(t,e),t.prototype.setVideoElement=function(e){var t=this;this._reset(),this._videoElement=e,e.onPrefixedKeyError.on(this,function(){t.onError.emit(new n.UnsupportedError("unrecoverable webkit key error"))}),e.onPrefixedNeedKey.on(this,function(r){"com.widevine.alpha"===t._options.keySystem&&void 0!==t._widevineInitData&&(r=t._widevineInitData);for(var i,o,a=t._mp4Parser.parse(r),u=0;u<a.length;u++){var d=a[u],l=r.slice(d.rangeBox.start,d.rangeBox.start+d.rangeBox.length),h=t._cencUtil.getKeyFormat(l),p=t._cencUtil.getKeysFromInitData(l);if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===h){i=p;break}if("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95"===h){if(1!==p.length){t.onError.emit(new n.UnsupportedError("Only single key supported"));return}o=p[0]}}if(void 0===i){t.onError.emit(new n.UnsupportedError("Did not find widevine key ids"));return}if("com.widevine.alpha"===t._options.keySystem){for(var f=!1,_=0,v=i.map(function(e){return t._stringUtil.toHex(e)});_<v.length;_++){var m=v[_];t._requestedWidevineKeyIds.has(m)||(t._requestedWidevineKeyIds.add(m),f=!0)}if(!f)return}if("com.microsoft.playready"===t._options.keySystem){if(void 0===o){t.onError.emit(new n.UnsupportedError("Did not find playready key id"));return}if(t._stringUtil.toHex(o)!==t._playreadyKeyId)return}s.PromiseUtil.catchRejection(function(){return t._generateRequest(e,r)},function(e){t.onError.emit(c.WrappedError.wrap(e))})})},t.prototype.getMediaKeyStatusMap=function(){return this._keyMap},t.prototype.generateRequest=function(e,t){var r=this;if("cenc"!==e)return Promise.reject(new n.UnsupportedError("Expected 'cenc' type"));var i=this._cencUtil.getKeysFromInitData(t),o=this._cencUtil.getKeyFormat(t);if("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95"===o){if(1!==i.length)return Promise.reject(new n.UnsupportedError("Provided ".concat(i.length," key ids")));this._playreadyKeyId=this._stringUtil.toHex(i[0]),this._keyMap.set(this._playreadyKeyId,"usable")}else"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===o&&(this._widevineInitData=t,i.forEach(function(e){r._keyMap.set(r._stringUtil.toHex(e),"usable")}));return this.onKeyStatusesChange.emit(),Promise.resolve()},t.prototype.update=function(e,t){if(void 0===this._videoElement){this.onError.emit(new n.UnsupportedError("Need video element to add key"));return}if(void 0===t){this.onError.emit(new n.UnsupportedError("Session id missing when adding key"));return}this.sessionId=t,this._videoElement.addKey(this._options.keySystem,new Uint8Array(e),t)},t.prototype._reset=function(){var e,t;this.onError.off(),this.onMessage.off(),this.onKeyStatusesChange.off(),null===(e=this._videoElement)||void 0===e||e.onPrefixedKeyError.off(this),null===(t=this._videoElement)||void 0===t||t.onPrefixedNeedKey.off(this),this._requestedWidevineKeyIds.clear()},t.prototype.close=function(){this._reset(),e.prototype._close.call(this)},t.prototype._generateRequest=function(e,r){return i.__awaiter(this,void 0,void 0,function(){var o,a,s,u,d,l;return i.__generator(this,function(i){switch(i.label){case 0:o=this._platform.isTizen2016()?2:1,a=e.getState().currentTime,s=1,i.label=1;case 1:if(!(s<=o))return[3,9];i.label=2;case 2:return i.trys.push([2,4,,8]),[4,e.generateRequest(this._options.keySystem,r)];case 3:return u=i.sent(),this.onMessage.emit(u),[2];case 4:if(d=i.sent(),this.isClosed)return[2];if(!(s<o))return[3,6];return this.onWarning.emit(new n.UnsupportedError("Error generating message with retry ".concat(s),c.WrappedError.wrap(d))),[4,new Promise(function(e){return setTimeout(e,t.GENERATE_RETRY_DELAY_MS)})];case 5:return i.sent(),[3,7];case 6:l=e.getState().currentTime,this.onError.emit(new p.MediaKeySessionGenerateRequestError("Error generating message on final attempt (".concat(s,"), video positions ").concat(a,"-").concat(l),c.WrappedError.wrap(d))),i.label=7;case 7:return[3,8];case 8:return s++,[3,1];case 9:return[2]}})})},t.GENERATE_RETRY_DELAY_MS=500,t}(u.BaseMediaKeySessionWrapper);t.PrefixedMediaKeySessionWrapper=f},96484:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrefixedMediaKeysWrapper=void 0;var i=r(73378),n=r(47632),o=r(98129),a=function(){function e(e){this._sessions=[],this.onError=new n.Emitter,this.onWarning=new n.Emitter,this._options=e}return e.prototype.setServerCertificate=function(){return Promise.reject(new o.SetServerCertificateError("not supported"))},e.prototype.setVideoElement=function(e){this._videoElement=e;for(var t=0,r=this._sessions;t<r.length;t++)r[t].setVideoElement(e)},e.prototype.createSession=function(){var e=new i.PrefixedMediaKeySessionWrapper(this._options);return void 0!==this._videoElement&&e.setVideoElement(this._videoElement),this._sessions.push(e),e},e}();t.PrefixedMediaKeysWrapper=a},47042:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrefixedVideoElement=void 0;var i=r(22970),n=r(91324),o=r(47632),a=r(77285),s=r(53282),u=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i.onPrefixedKeyError=new o.Emitter,i.onPrefixedNeedKey=new o.Emitter,i._requests=[],i._keysToAdd=[],i._prefixedVideo=r,i._system=t,r.addEventListener("webkitneedkey",function(e){i._system.logConsole("webkitneedkey"),i.onPrefixedNeedKey.emit(e.initData)}),r.addEventListener("webkitkeyadded",function(){i._system.logConsole("webkitkeyadded"),i._system.assert(void 0!==i._currentKeyToAdd,"have a webkitkeyadded without a key added"),i._currentKeyToAdd=void 0,i._addNextKey()}),r.addEventListener("webkitkeyerror",function(){i._system.logConsole("webkitkeyerror"),i._system.assert(void 0!==i._currentKeyToAdd,"have a webkitkeyerror without a key added"),i.onPrefixedKeyError.emit(),i._currentKeyToAdd=void 0,i._addNextKey()}),r.addEventListener("webkitkeymessage",function(e){i._system.logConsole("webkitkeymessage");var t=i._currentRequest;void 0!==t?(i._currentRequest=void 0,t.resolve(e)):i._system.logWarn("have a webkitkeymessage without a request"),i._getNextMessage()}),i}return i.__extends(t,e),t.prototype._getNextMessage=function(){0!==this._requests.length&&void 0===this._currentRequest&&(this._currentRequest=this._requests[0],this._requests.shift(),this._system.logConsole("webkitGenerateKeyRequest"),this._prefixedVideo.webkitGenerateKeyRequest(this._currentRequest.keySystem,this._currentRequest.initData))},t.prototype._addNextKey=function(){0!==this._keysToAdd.length&&void 0===this._currentKeyToAdd&&(this._currentKeyToAdd=this._keysToAdd[0],this._keysToAdd.shift(),this._system.logConsole("webkitAddKey",this._currentKeyToAdd.sessionId),this._prefixedVideo.webkitAddKey(this._currentKeyToAdd.keySystem,this._currentKeyToAdd.license,null,this._currentKeyToAdd.sessionId))},t.prototype.generateRequest=function(e,t){return i.__awaiter(this,void 0,void 0,function(){var r=this;return i.__generator(this,function(i){return[2,new Promise(function(i,n){var o=new s.Timer(r._system,function(){n(Error("Timed out waiting for webkit key message"))});o.tickAfter(a.KeySessionHelper.TIMEOUT_SECONDS),r._requests.push({keySystem:e,initData:t,resolve:function(e){o.stop();var t=e.type;"webkitkeymessage"===t&&(t="license-request"),i({message:e.message,type:t,sessionId:e.sessionId})}}),r._getNextMessage()})]})})},t.prototype.addKey=function(e,t,r){this._keysToAdd.push({keySystem:e,license:t,sessionId:r}),this._addNextKey()},t.prototype.clearMediaSource=function(){e.prototype.clearMediaSource.call(this),this._requests.splice(0,this._requests.length),this._keysToAdd.splice(0,this._keysToAdd.length),this._currentRequest=void 0,this._currentKeyToAdd=void 0},t}(n.BrowserVideoElement);t.PrefixedVideoElement=u},14802:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SafariKeyWarningError=void 0;var i=r(22970),n=function(e){function t(r){return e.call(this,r,void 0,t.NAME)||this}return i.__extends(t,e),t.NAME="SafariKeyWarning",t}(r(28521).WarningError);t.SafariKeyWarningError=n},55087:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SourceBufferWrapper=void 0;var i=r(22970),n=r(44126),o=r(47632),a=r(57665),s=r(1954),u=r(2913),c=r(30607),d=r(66124),l=r(39697),h=r(7500),p=r(67179),f=r(29368),_=function(){function e(e,t,r,i,n,a,s,d,l){var _=this;this._cencUtil=new u.CommonEncryptionUtil,this._mp4Util=new h.Mp4Util,this._codecUtil=new p.CodecUtil,this._platform=new c.Platform,this._timeRangeUtil=new f.TimeRangeUtil,this._isComcast=this._platform.isComcastSetTopBox(),this._isPlayStation4=this._platform.isPlayStation4(),this._isSafari=this._platform.isSafari(),this._isTizen2016=this._platform.isTizen2016(),this._isClaro=this._platform.isClaro(),this._isSagemcom=this._platform.isSagemcom(),this._isLG=this._platform.isWebOS(),this._isXbox=this._platform.isXbox(),this._timestampOffset=0,this._queuedAppends=[],this.onUpdateEnd=new o.Emitter,this.onEmbeddedCaptionsExtracted=new o.Emitter,this.lastAppendedSegmentWasInit=!1,this._system=e,this._options=t,this._mediaQueue=r,this._sourceBuffer=i,this._referenceStore=n,this.streamType=a,this._codec=s,this._extractEmbeddedCaptions=d,this.timelineOffset=l,this._sourceBuffer.addEventListener("updatestart",function(){_._onUpdateStart()}),this._sourceBuffer.addEventListener("updateend",function(){_._onUpdateEnd(),_._checkBufferContinuity(),_.onUpdateEnd.emit()}),this._mediaQueue.trackSourceBuffer(this)}return Object.defineProperty(e.prototype,"codecs",{get:function(){return this._codec},enumerable:!1,configurable:!0}),e.prototype.getNativeResource=function(){return this._sourceBuffer},e.prototype.getInitSegment=function(){return this._lastAppendedInitSegment},Object.defineProperty(e.prototype,"updating",{get:function(){return this._sourceBuffer.updating},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this._mediaQueue.untrackSourceBuffer(this)},e.prototype._modifyInitSegment=function(e,t){var r;if(void 0!==t){if(this._isComcast||this._isTizen2016||this._isClaro||this._isSagemcom||(null===(r=this._options.workaroundOptions)||void 0===r?void 0:r.injectPsshIntoInitSegments)===!0)return this._cencUtil.addPssh(new Uint8Array(e)).buffer;if(this._isSafari)return this._cencUtil.injectKid(new Uint8Array(e),t).buffer}return this._isPlayStation4&&"video"===this.streamType?this._mp4Util.stripX265UserData(new Uint8Array(e)).buffer:(this._isLG||this._isXbox)&&"video"===this.streamType&&-1!==this._codec.indexOf("hvc1.2")?this._mp4Util.stripDolbyVisionBox(new Uint8Array(e)).buffer:e},e.prototype.appendBuffer=function(e,t,r){var i=this;return this._mediaQueue.queueSourceBuffer(this,"appendBuffer",function(){if(!i._referenceStore.contains(e.info.id))throw new n.AppendBufferError("Failed to find payload reference with id ".concat(e.info.id));var o=i._referenceStore.get(e.info.id);try{if(!r){var s=i.timelineOffset.toNativeValue(t.presentationTimeOffset);if(i.timelineOffset.needsDecodeTimeRewrite(s)){if(void 0===i._lastAppendedInitSegment)throw Error("Required init segment not found when appending data");i._mp4Util.adjustBaseDecodeTime(new Uint8Array(o),new Uint8Array(i._lastAppendedInitSegment),s),i._sourceBuffer.timestampOffset=0,i._timestampOffset=0}else if(i._timestampOffset!==s){var u=s<0?Math.ceil(1e6*s)/1e6:s;i._sourceBuffer.timestampOffset=u,i._timestampOffset=s}}}catch(e){throw new n.AppendBufferError("Unable to set 'timestampOffset' on source buffer",a.WrappedError.wrap(e,"AppendBufferError"))}try{r?(o=i._modifyInitSegment(o,t.keyId),i._lastAppendedInitSegment=o,i.lastAppendedSegmentWasInit=!0):(i.lastAppendedSegmentWasInit=!1,i._queuedAppends.push({segment:t,prevBuffered:i._getBuffered(),sawUpdateStart:!1})),i._sourceBuffer.appendBuffer(o),i._extractEmbeddedCaptions&&i._parseEmbeddedCaptions(t,o,r)}catch(e){if("object"==typeof e&&null!==e&&"name"in e&&"QuotaExceededError"===e.name){var c=r?"(init)":"";throw new d.QuotaExceededError("QuotaExceeded when attempting to append ".concat(c," @ ").concat(t.start,"-").concat(t.end),a.WrappedError.wrap(e))}throw new n.AppendBufferError("Unable to complete operation 'appendBuffer'",a.WrappedError.wrap(e,"AppendBufferError"))}})},e.prototype.remove=function(e,t){var r=this;return this._mediaQueue.queueSourceBuffer(this,"remove",function(){try{"video"===r.streamType&&(t-=.1),r._sourceBuffer.remove(Math.max(r.timelineOffset.toNativeValue(e),0),r.timelineOffset.toNativeValue(t))}catch(e){throw new l.RemoveBufferError("Unable to complete operation 'remove'",a.WrappedError.wrap(e,"RemoveBuffer"))}})},e.prototype.removeAll=function(){var e=this;return this._mediaQueue.queueSourceBuffer(this,"removeAll",function(){e._sourceBuffer.buffered.length>0&&e._sourceBuffer.remove(0,1/0)})},e.prototype._parseEmbeddedCaptions=function(e,t,r){var n=this;if(r){var o=this._codecUtil.getVideoGroup({codecs:this._codec,attributes:0});"unknown-video"!==o?this._embeddedCaptionParser=new s.EmbeddedCaptionParser(t,o):(this._system.logWarn("Ignoring embedded captions in stream with unknown codec group (codec=".concat(this._codec,")")),this._extractEmbeddedCaptions=!1)}else if(void 0!==this._embeddedCaptionParser){var a=this._embeddedCaptionParser.parseMediaSegment(t).map(function(e){return i.__assign(i.__assign({},e),{pts:n.timelineOffset.fromNativeValue(e.pts+n._timestampOffset)})});this.onEmbeddedCaptionsExtracted.emit({start:e.start,end:e.end,captionFrames:a})}},e.prototype._getBuffered=function(){try{for(var e=[],t=0;t<this._sourceBuffer.buffered.length;++t)e.push({start:this.timelineOffset.fromNativeValue(this._sourceBuffer.buffered.start(t)),end:this.timelineOffset.fromNativeValue(this._sourceBuffer.buffered.end(t))});return e}catch(e){return[]}},e.prototype._checkBufferContinuity=function(){var e=this._getBuffered();if(e.length>1){for(var t="",r=0;r<e.length;r++){var i=e[r];t.length>0&&(t+=", "),t+="[".concat(i.start,"-").concat(i.end,"]")}this._system.logWarn("Discontinuous source buffer (".concat(this.streamType,"): [").concat(t,"]"))}},e.prototype._onUpdateStart=function(){0!==this._queuedAppends.length&&(this._queuedAppends[0].sawUpdateStart=!0)},e.prototype._onUpdateEnd=function(){var e,t,r,i=this._queuedAppends[0];if(void 0!==i&&i.sawUpdateStart){this._queuedAppends.shift();var n=i.segment,o="".concat(n.createUri).concat(void 0!==n.startByte?" bytes=".concat(n.startByte,"-").concat(null!==(e=n.endByte)&&void 0!==e?e:""):""),a=this._getBuffered();if(a.length>0){var s=a[a.length-1],u={start:Math.max(null!==(r=null===(t=i.prevBuffered[i.prevBuffered.length-1])||void 0===t?void 0:t.end)&&void 0!==r?r:0,s.start),end:s.end};this._timeRangeUtil.isTimeClose(u.start,n.start)&&this._timeRangeUtil.isTimeClose(u.end,n.end)||this._system.logWarn("".concat(this.streamType," segment range computed from manifest ([").concat(n.start,"-").concat(n.end,"]) does not match buffered range after appending ([").concat(u.start,"-").concat(u.end,"]): ").concat(o))}else this._system.logWarn("Nothing in ".concat(this.streamType," source buffer after appending segment with range [").concat(n.start,"-").concat(n.end,"]: ").concat(o))}},e}();t.SourceBufferWrapper=_},22994:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimelineOffset=void 0;var i=r(30607),n=function(){function e(e){this._platform=new i.Platform,this._options=e}return e.prototype.hasOffset=function(){return void 0!==this._offset},e.prototype.setOffset=function(e){this._offset=e},e.prototype.getOffset=function(){var e;return this.needsTimelineOffset()?null!==(e=this._offset)&&void 0!==e?e:0:void 0},e.prototype.needsDecodeTimeRewrite=function(e){var t=this._options.decodeTimeRewriteLimit;return void 0===t&&this._platform.isClaro()&&(t=2147483.647),void 0!==t&&Math.abs(e)>t},e.prototype.needsTimelineOffset=function(){return!0===this._options.needsTimelineOffset||this._platform.isClaro()},e.prototype.fromNativeValue=function(e){var t;return e-(null!==(t=this.getOffset())&&void 0!==t?t:0)},e.prototype.toNativeValue=function(e){var t;return e+(null!==(t=this.getOffset())&&void 0!==t?t:0)},e}();t.TimelineOffset=n},41746:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaKeySessionGenerateRequestError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="MediaKeySessionGenerateRequest",t}(r(57665).WrappedError);t.MediaKeySessionGenerateRequestError=n},46433:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaKeySessionUpdateError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="MediaKeySessionUpdate",t}(r(57665).WrappedError);t.MediaKeySessionUpdateError=n},98129:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SetServerCertificateError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="SetServerCertificate",t}(r(57665).WrappedError);t.SetServerCertificateError=n},90194:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkResponseWrapper=void 0;var i=r(22970),n=r(34518),o=r(19808),a=r(15302),s=r(88309),u=r(43495),c=r(70387),d=r(79726),l=r(14789),h=function(){function e(e,t){this._canceled=!1,this._openXhr=new s.Set,this._openRejects=new s.Set,this._system=e,this._request=t,this._networkProgress=this._system.networkProgressEvent}return e.prototype._handleError=function(e){return!this._canceled||e instanceof n.OperationCanceledError?e:new n.OperationCanceledError("error after canceled")},e.prototype.cancel=function(){var e=this;this._canceled=!0,this._openRejects.forEach(function(t){t(new n.OperationCanceledError("xhr canceled to ".concat(e._request.resource,"\n    request header information: ").concat(e._getRequestHeaderString(e._request.headers))))}),this._openXhr.forEach(function(e){e.abort()})},e.prototype.payloadReference=function(){return i.__awaiter(this,void 0,void 0,function(){var t,r,n;return i.__generator(this,function(i){switch(i.label){case 0:return[4,this._payload("arraybuffer")];case 1:return t=i.sent(),r="reference-".concat(e.REFERENCE_ID++),[4,this._system.setPayloadReferenceData(r,t.data)];case 2:return n=i.sent(),[2,{status:t.status,data:n}]}})})},e.prototype.payloadBuffer=function(){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(r){switch(r.label){case 0:return[4,this._payload("arraybuffer")];case 1:return(t=r.sent()).data.byteLength>e.SERIALIZED_WARN_BYTES&&this._system.logWarn("Large payload serialized (".concat(t.data.byteLength," bytes): ").concat(this._request.resource)),[2,t]}})})},e.prototype.payloadString=function(){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return[4,this._payload("text")];case 1:return[2,e.sent()]}})})},e.prototype.waitIfOffline=function(e){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:if(this._isOnline())return[3,2];return[4,new Promise(function(t){window.addEventListener("online",i);var r=setTimeout(function(){window.removeEventListener("online",i),t(!0)},e);function i(){clearTimeout(r),window.removeEventListener("online",i),t(!0)}})];case 1:t.sent(),t.label=2;case 2:return[2]}})})},e.prototype._payload=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,n,o;return i.__generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,3,4]),[4,this._getResponse(e)];case 1:return t=(o=i.sent()).xhr,r=o.response,[2,{status:t.status,data:r}];case 2:throw n=i.sent(),this._handleError(n);case 3:return void 0!==t&&this._openXhr.delete(t),[7];case 4:return[2]}})})},e.prototype._getXMLHttpRequest=function(){return new XMLHttpRequest},e.prototype._emitNetworkProgress=function(e,t){this._networkProgress.emit(i.__assign(i.__assign({},this._request),{bytes:"string"==typeof t?t.length:t.byteLength,downloadTimeMS:new Date().getTime()-e,latency:0}))},e.prototype._getResponse=function(t){var r=this;if(this._canceled)throw new n.OperationCanceledError("response already canceled");return new Promise(function(i,n){var a,s,h,p=r._getXMLHttpRequest(),f=0,_=!1;r._openRejects.add(n);var v=function(){r._openRejects.delete(n),void 0!==h&&(clearInterval(h),h=void 0)};if(r._openXhr.add(p),p.onabort=v,p.open(r._request.method,r._request.resource,!0),p.timeout=void 0!==r._request.timeoutMS?r._request.timeoutMS:e.XHR_DEFAULT_TIMEOUT_MS,p.responseType=t,void 0!==r._request.headers){for(var m=0,g=Object.keys(r._request.headers);m<g.length;m++){var y=g[m];p.setRequestHeader(y,r._request.headers[y])}var S=c.NetworkHelpers.parseRangeHeader(r._request.headers);(null==S?void 0:S.startByte)!==void 0&&void 0!==S.endByte&&(s=S.endByte-S.startByte+1)}p.onprogress=function(t){if(_=!0,void 0!==s&&c.NetworkHelpers.isSuccessfulResponseCode(p.status)){var i=s*(1+e.RANGE_REQUEST_TOLERANCE_PERCENT);if(t.loaded>=i){var o=r._getRequestHeaderString(r._request.headers),a=r._getResponseHeaderString(p.getAllResponseHeaders());p.abort(),v(),n(new l.NetworkRequestError("Received more bytes during progress event than expected",r._getContext(p),[new d.ByteRangeMismatchError("received ".concat(t.loaded," bytes but requested only ").concat(s," bytes\n    request header information: ").concat(o,"\n    response header information: ").concat(a))]))}}if(void 0!==t.loaded){var u=null!=s?s:t.total;void 0!==u&&0!==u&&(f=Math.floor(t.loaded/u*100))}},p.onerror=function(e){v();var t=r._getRequestHeaderString(r._request.headers),i=r._getResponseHeaderString(p.getAllResponseHeaders());n(new l.NetworkRequestError("Network failure, isOnline=".concat(r._isOnline(),", lengthComputable=").concat(e.lengthComputable,", total=").concat(e.total,", loaded=").concat(e.loaded,", readyState=").concat(p.readyState,"\n    request header information: ").concat(t,"\n    response header information: ").concat(i),r._getContext(p)))},p.ontimeout=function(){v();var e=r._getRequestHeaderString(r._request.headers),t=r._getResponseHeaderString(p.getAllResponseHeaders());n(new l.NetworkRequestError("XHR ontimeout received",r._getContext(p),[new o.OperationTimedOutError("Network response timed out, isOnline=".concat(r._isOnline(),"\n    request header information: ").concat(e,"\n    response header information: ").concat(t),void 0,p.readyState,f)]))};var E=new Date().getTime();p.onload=function(){v();var e,o,a=r._getTypedResponse(p,t);if(null===a){n(new l.NetworkRequestError("did not receive response, isOnline=".concat(r._isOnline()),r._getContext(p)));return}var u=parseInt(null!==(e=p.getResponseHeader("Content-Length"))&&void 0!==e?e:""),h=null!==(o=p.getResponseHeader("Content-Type"))&&void 0!==o?o:"";if(void 0===s&&isFinite(u)&&-1!==h.indexOf("mp4")&&(s=u),void 0!==s&&a instanceof ArrayBuffer&&c.NetworkHelpers.isSuccessfulResponseCode(p.status)&&a.byteLength<s){var f=r._getRequestHeaderString(r._request.headers),_=r._getResponseHeaderString(p.getAllResponseHeaders());n(new l.NetworkRequestError("Partial response received",r._getContext(p),[new d.ByteRangeMismatchError("received only ".concat(a.byteLength," bytes but requested ").concat(s," bytes\n    request header information: ").concat(f,"\n    response header information: ").concat(_))]));return}r._emitNetworkProgress(E,a),i({xhr:p,response:a})},p.send(r._request.body);var b=null!==(a=r._request.progressTimeoutMS)&&void 0!==a?a:0;b>0&&(h=setInterval(function(){if(_)_=!1;else{var e=r._getRequestHeaderString(r._request.headers),t=r._getResponseHeaderString(p.getAllResponseHeaders());p.abort(),v(),n(new l.NetworkRequestError("Interval timeout expired",r._getContext(p),[new u.NoProgressMadeError("No network progress was made in ".concat(b," ms, isOnline=").concat(r._isOnline(),"\n    request header information: ").concat(e,"\n    response header information: ").concat(t),void 0,p.readyState,f)]))}},b))})},e.prototype._getContext=function(e){return{url:this._request.resource,statusCode:e.status,responseText:"text"===e.responseType?e.responseText:void 0}},e.prototype._isOnline=function(){return navigator.onLine},e.prototype._getRequestHeaderString=function(e){if(void 0===e||0===Object.keys(e).length)return"(no header information)";for(var t=[],r=0,i=Object.keys(e);r<i.length;r++){var n=i[r];t.push("".concat(n,": ").concat(e[n]))}return t.join(", ")},e.prototype._getResponseHeaderString=function(e){return null==e||""===e?"(no header information)":e.trim().split("\r\n").join(", ")},e.prototype._getTypedResponse=function(e,t){var r=e.response;if(null===r)return null;if(e.responseType!==t)throw new a.InvalidOperationError('mismatched responseType ("'.concat(e.responseType,'" !== "').concat(t,'")'));switch(t){case"text":if("string"==typeof r)return r;throw new l.NetworkRequestError("response is not string type (".concat(e.responseType,")"),this._getContext(e));case"arraybuffer":if(r instanceof ArrayBuffer)return r;throw new l.NetworkRequestError("response is not ArrayBuffer type (".concat(e.responseType,")"),this._getContext(e))}},e.XHR_DEFAULT_TIMEOUT_MS=0,e.SERIALIZED_WARN_BYTES=1048576,e.REFERENCE_ID=0,e.RANGE_REQUEST_TOLERANCE_PERCENT=.25,e}();t.NetworkResponseWrapper=h},30607:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Platform=void 0;var r=function(){function e(){}return e.prototype.isLinux=function(){var e=this._getPlatform();return void 0!==e&&-1!==e.indexOf("Linux")},e.prototype.isTizen=function(){var e=this._getUserAgent();return void 0!==e&&-1!==e.indexOf("Tizen")},e.prototype.isVizio=function(){var e=this._getUserAgent();return void 0!==e&&-1!==e.indexOf("VIZIO")},e.prototype.isSagemcom=function(){var e=this._getUserAgent();return void 0!==e&&-1!==e.indexOf("Sagemcom")},e.prototype.isClaro=function(){var e=this._getUserAgent();return void 0!==e&&-1!==e.indexOf("TeleIDEA")},e.prototype.isWebOS=function(){var e=this._getUserAgent();return void 0!==e&&-1!==e.indexOf("Web0S")},e.prototype.isXbox=function(){var e=this._getUserAgent();return void 0!==e&&-1!==e.indexOf("Xbox")},e.prototype.isEnseo=function(){var e=this._getUserAgent();return void 0!==e&&-1!==e.indexOf("Enseo")},e.prototype.isSkyQ=function(){var e=this._getUserAgent();return void 0!==e&&-1!==e.indexOf("Sky_")},e.prototype.isComcastSetTopBox=function(){return"undefined"!=typeof XREReceiver},e.parseTizenVersion=function(e){if(void 0!==e){var t=e.match(/Tizen (\d+(\.\d+)?)/);return null==t?void 0:t[1]}},e.prototype._getUserAgent=function(){return navigator.userAgent},e.prototype._getVendor=function(){return navigator.vendor},e.prototype._getPlatform=function(){return navigator.platform},e.prototype._getNavigatorUA=function(){return navigator},e.prototype._hasTizenOnGlobal=function(){return"undefined"!=typeof tizen},e.prototype._hasYouViewOnGlobal=function(){return"undefined"!=typeof youview},e.prototype._getTizenVersion=function(){if(void 0!==e._cachedTizenVersion)return e._cachedTizenVersion;if(this._hasTizenOnGlobal()){var t=e.parseTizenVersion(this._getUserAgent());if(void 0===t){var r=tizen.systeminfo;if(void 0===r)return;try{return e._cachedTizenVersion=parseFloat(r.getCapability("http://tizen.org/feature/platform.version"))}catch(e){console.warn("Failed to get Tizen device capability",e);return}}return e._cachedTizenVersion=parseFloat(t)}},e.prototype._isTizenVersion=function(e,t){var r=this._getTizenVersion();return void 0!==r&&r>=t&&r<e},e.prototype.isTizen2017=function(){return this._isTizenVersion(4,3)},e.prototype.isTizen2016=function(){return this._isTizenVersion(3,2)},e.prototype.isChromiumEdge=function(){var e,t=null===(e=this._getNavigatorUA().userAgentData)||void 0===e?void 0:e.brands;if(void 0!==t){for(var r=!1,i=!1,n=0;n<t.length;n++){var o=t[n];void 0!==o.brand&&-1!==o.brand.indexOf("Edge")&&(i=!0),"Chromium"===o.brand&&(r=!0)}return r&&i}var a=this._getUserAgent();return void 0!==a&&-1!==a.indexOf("Edg/")},e.prototype.isLegacyEdge=function(){var e=this._getUserAgent();return void 0!==e&&/edge/i.test(e)},e.prototype.isYouView=function(){return this._hasYouViewOnGlobal()},e.prototype.isWindows=function(){var e=this._getPlatform();return void 0!==e&&0===e.indexOf("Win")},e.prototype.isPlayStation=function(){var e=this._getPlatform();return void 0!==e&&0===e.indexOf("PlayStation")},e.prototype.isPlayStation4=function(){var e=this._getPlatform();return void 0!==e&&0===e.indexOf("PlayStation 4")},e.prototype.isPlayStation5=function(){var e=this._getPlatform();return void 0!==e&&0===e.indexOf("PlayStation 5")},e.prototype.isSafari=function(e){var t,r=this._getVendor(),i=void 0!==r&&-1!==r.indexOf("Apple")&&!this.isTizen()&&!this.isComcastSetTopBox()&&!this.isLinux()&&!this.isPlayStation();if(i&&void 0!==e){var n=/\bVersion\/([0-9]+)\.[0-9]+\b/.exec(null!==(t=this._getUserAgent())&&void 0!==t?t:"");return!!((null==n?void 0:n.length)===2&&parseInt(n[1])>=e)}return i},e}();t.Platform=r},45997:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformCapabilities=void 0;var i=r(22970),n=r(30607),o=r(6246),a={type:"media-source",video:{hdrMetadataType:"smpteSt2086",colorGamut:"rec2020",transferFunction:"pq",contentType:"video/mp4; codecs=hvc1.2.4.L120.90",width:3840,height:2160,bitrate:3e7,framerate:24}},s={type:"media-source",video:{hdrMetadataType:"smpteSt2094-10",colorGamut:"rec2020",transferFunction:"pq",contentType:"video/mp4; codecs=dvh1.05.06",width:3840,height:2160,bitrate:3e7,framerate:24}},u={type:"media-source",audio:{contentType:"audio/mp4; codecs=ec-3",spatialRendering:!0}},c=function(){function e(e){this._logger=e,this._platform=new n.Platform}return e.prototype.requireSingleKey=function(){return this._platform.isTizen2016()},e.prototype.requireSingleFramerate=function(){return this._platform.isTizen2016()},e.prototype.getKeyTypesWhichMayBeRestricted=function(){var e=new o.HashSet(["video-fhd"]);return this._platform.isTizen()||this._platform.isWebOS()||this._platform.isVizio()||e.add("video-hd"),e},e.prototype.getSupportedHdrModes=function(){return this._platform.isTizen()?this.getTizenHdrModes():this._platform.isXbox()?this.getXboxHdrModes():this._platform.isPlayStation()?this.getPlayStationHdrModes():this._platform.isWebOS()?this.getWebOsHdrModes():this._platform.isChromiumEdge()||this._platform.isSafari()?this.getBrowserHdrModes():[]},e.prototype._canPlayDolbyAtmos=function(){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,navigator.mediaCapabilities.decodingInfo(u)];case 1:return[2,(e=t.sent()).supported&&e.smooth];case 2:return console.warn(t.sent()),[2,!1];case 3:return[2]}})})},e.prototype.canPlayDolbyAtmos=function(){return this._platform.isChromiumEdge()||this._platform.isSafari()?this._canPlayDolbyAtmos():!!this._platform.isXbox()&&this._canXboxPlayDolbyAtmos()},e.prototype.supportsExactSeeks=function(){return!this._platform.isClaro()},e.prototype.supportsMediaKeySystemAccessGetConfiguration=function(){return!this._platform.isClaro()&&!this._platform.isComcastSetTopBox()&&!this._platform.isSagemcom()&&!this._platform.isWebOS()&&!this._platform.isXbox()},e.prototype.isTizenDisplay4kHdr=function(){return this.isTizenDisplay4k()&&void 0!==this.getTizenHdrModes()},e.prototype.isTizenDisplay4k=function(){if(!this._platform.isTizen())return!1;if(void 0===this._tizen4k){var e=window;try{void 0!==e.webapis&&e.webapis.productinfo.isUdPanelSupported()?this._tizen4k=!0:this._tizen4k=!1}catch(e){this._tizen4k=void 0}}return!0===this._tizen4k},e.prototype.getTizenHdrModes=function(){if(this._platform.isTizen()){if(void 0===this._tizenHdrModes){var e=window;try{void 0!==e.webapis&&e.webapis.avinfo.isHdrTvSupport()?this._tizenHdrModes=["hevc-hdr"]:this._tizenHdrModes=[]}catch(e){this._tizenHdrModes=void 0}}return this._tizenHdrModes}},e.prototype.getWebOsHdrModes=function(){var e,t=window;if(void 0!==t.webOS&&void 0!==t.webOS.service)return Promise.race([new Promise(function(t){e=setTimeout(function(){console.warn("timed out querying hdr modes"),t(void 0)},1e4)}),new Promise(function(r){t.webOS.service.request("luna://com.webos.service.config",{method:"getConfigs",parameters:{configNames:["tv.model.supportHDR","tv.config.supportDolbyHDRContents","tv.config.supportDolbyTVATMOS"]},onSuccess:function(t){var i=[];t.configs["tv.model.supportHDR"]&&i.push("hevc-hdr"),t.configs["tv.config.supportDolbyHDRContents"]&&i.push("dvh"),clearTimeout(e),r(i)},onFailure:function(t){console.error("failed to determine hdr modes",t),clearTimeout(e),r(void 0)}})})])},e.prototype.isXboxDisplay4k=function(){if(!this._platform.isXbox())return!1;var e=window;try{if(void 0!==e.Windows){var t=e.Windows.Graphics.Display.Core.HdmiDisplayInformation.getForCurrentView().getCurrentDisplayMode();if(3840===t.resolutionWidthInRawPixels&&2160===t.resolutionHeightInRawPixels)return!0}}catch(e){}return!1},e.prototype.getXboxHdrModes=function(){if(this._platform.isXbox()){if(this._platform.isChromiumEdge())return[];var e=window;try{if(void 0!==e.Windows){var t=e.Windows.Graphics.Display.Core.HdmiDisplayInformation.getForCurrentView().getCurrentDisplayMode(),r=[];return t.isSmpte2084Supported&&t.is2086MetadataSupported&&r.push("hevc-hdr"),t.isDolbyVisionLowLatencySupported&&r.push("dvh"),r}}catch(e){return}}},e.prototype.getXboxAvailableHdrModes=function(){if(this._platform.isXbox()){if(this._platform.isChromiumEdge())return[];var e=window;try{if(void 0!==e.Windows){for(var t=e.Windows.Graphics.Display.Core.HdmiDisplayInformation.getForCurrentView().getSupportedDisplayModes(),r=!1,i=!1,n=0;n<t.length;n++){var o=t[n];o.isSmpte2084Supported&&o.is2086MetadataSupported&&(r=!0),o.isDolbyVisionLowLatencySupported&&(i=!0)}var a=[];return r&&a.push("hevc-hdr"),i&&a.push("dvh"),a}}catch(e){return}}},e.prototype._canXboxPlayDolbyAtmos=function(){if(!this._platform.isXbox())return!1;var e,t,r=window;if(void 0===r.Windows)return null===(e=this._logger)||void 0===e||e.logWarn("Windows property undefined on window. Cannot check Atmos support."),!1;try{var i=r.Windows.Media.Devices.MediaDevice.getDefaultAudioRenderId(0),n=r.Windows.Media.Audio.SpatialAudioDeviceConfiguration.getForDeviceId(i);if(!n.isSpatialAudioSupported)return!1;var o=r.Windows.Media.Audio.SpatialAudioFormatSubtype,a=n.isSpatialAudioFormatSupported(o.dolbyAtmosForHeadphones)&&n.activeSpatialAudioFormat===o.dolbyAtmosForHeadphones,s=n.isSpatialAudioFormatSupported(o.dolbyAtmosForHomeTheater)&&n.activeSpatialAudioFormat===o.dolbyAtmosForHomeTheater,u=n.isSpatialAudioFormatSupported(o.dolbyAtmosForSpeakers)&&n.activeSpatialAudioFormat===o.dolbyAtmosForSpeakers;return a||s||u}catch(e){return null===(t=this._logger)||void 0===t||t.logWarn("Error checking Xbox Atmos support: ".concat(String(e))),!1}},e.prototype.requestXboxHdrMode=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,n,o,a,s,u,c,d,l,h,p,f,_;return i.__generator(this,function(i){if(!this._platform.isXbox()||this._platform.isChromiumEdge())return[2,!1];t=window;try{if(void 0!==t.Windows){if(r=t.Windows.Graphics.Display.Core.HdmiDisplayInformation.getForCurrentView(),n=t.Windows.Graphics.Display.Core.HdmiDisplayHdrOption.dolbyVisionLowLatency,o=t.Windows.Graphics.Display.Core.HdmiDisplayHdrOption.eotf2084,a=r.getCurrentDisplayMode(),s=this._getXboxDisplayModeType(a),u="dolbyVision"===s,c="hdr10"===s,"dvh"===e&&u||"hevc-hdr"===e&&c||void 0===e&&(u||c))return[2,!0];for(p=0,d=r.getSupportedDisplayModes(),l=void 0,h=void 0,f=d;p<f.length;p++)(_=f[p]).isSmpte2084Supported&&_.is2086MetadataSupported&&(l=_),_.isDolbyVisionLowLatencySupported&&(h=_);if(void 0!==e){if("dvh"===e&&void 0!==h)return[2,this._requestXboxDisplayMode(r,h,n)];if("hevc-hdr"===e&&void 0!==l)return[2,this._requestXboxDisplayMode(r,l,o)]}else if(void 0!==h)return[2,this._requestXboxDisplayMode(r,h,n)];else if(void 0!==l)return[2,this._requestXboxDisplayMode(r,l,o)]}}catch(e){}return[2,!1]})})},e.prototype.requestXboxSdrMode=function(){return i.__awaiter(this,void 0,void 0,function(){var e,t,r,n,o,a,s,u,c;return i.__generator(this,function(i){if(!this._platform.isXbox()||this._platform.isChromiumEdge())return[2,!1];e=window;try{if(void 0!==e.Windows){if(t=e.Windows.Graphics.Display.Core.HdmiDisplayInformation.getForCurrentView(),r=function(e){return!e.isSmpte2084Supported&&!e.is2086MetadataSupported&&!e.isDolbyVisionLowLatencySupported},n=t.getCurrentDisplayMode(),"sdr"===this._getXboxDisplayModeType(n))return[2,!0];for(s=0,o=t.getSupportedDisplayModes(),a=void 0,u=o;s<u.length;s++)if(c=u[s],r(c)){a=c;break}if(void 0!==a)return[2,this._requestXboxDisplayMode(t,a)]}}catch(e){}return[2,!1]})})},e.prototype.getXboxDisplayMode=function(){if(!(!this._platform.isXbox()||this._platform.isChromiumEdge())){var e=window;try{if(void 0!==e.Windows)return e.Windows.Graphics.Display.Core.HdmiDisplayInformation.getForCurrentView().getCurrentDisplayMode()}catch(e){return}}},e.prototype.requestXboxDisplayMode=function(e,t){return i.__awaiter(this,void 0,void 0,function(){var r,n;return i.__generator(this,function(i){if(!this._platform.isXbox()||this._platform.isChromiumEdge())return[2,!1];r=window;try{if(void 0!==r.Windows)return n=r.Windows.Graphics.Display.Core.HdmiDisplayInformation.getForCurrentView(),[2,this._requestXboxDisplayMode(n,e,t)]}catch(e){}return[2,!1]})})},e.prototype._requestXboxDisplayMode=function(e,t,r){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(i){return void 0!==r?[2,e.requestSetCurrentDisplayModeAsync(t,r)]:[2,e.requestSetCurrentDisplayModeAsync(t)]})})},e.prototype._getXboxDisplayModeType=function(e){var t=e.isDolbyVisionLowLatencySupported,r=e.isSmpte2084Supported&&e.is2086MetadataSupported;return t?"dolbyVision":r?"hdr10":"sdr"},e.prototype.getPlayStationHdrModes=function(){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){switch(t.label){case 0:if(e=window,!this._platform.isPlayStation()||void 0===e.msdk||void 0===e.msdk.device||void 0===e.msdk.device.getDisplayInfoImmediate)return[2];return[4,e.msdk.device.getDisplayInfoImmediate()];case 1:if("HDR"===t.sent().dynamicRange)return[2,["hevc-hdr"]];return[2,[]]}})})},e.prototype.canDisplayHdr=function(){return window.matchMedia("(dynamic-range: high)").matches&&(window.matchMedia("(color-gamut: p3)").matches||window.matchMedia("(color-gamut: rec2020)").matches)},e.prototype.canDecodeHdr=function(e){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(r){switch(r.label){case 0:if(void 0===navigator.mediaCapabilities)return[2,!1];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,navigator.mediaCapabilities.decodingInfo(e)];case 2:return[2,(t=r.sent()).supported&&t.smooth];case 3:return console.warn(r.sent()),[2,!1];case 4:return[2]}})})},e.prototype.getBrowserHdrModes=function(){if(void 0===this._browserHdrModes){if(void 0===window.matchMedia||void 0===window.screen)return;this.canDisplayHdr()?this._browserHdrModes=Promise.all([this.canDecodeHdr(a),this.canDecodeHdr(s)]).then(function(e){var t=e[0],r=e[1];return t&&r?["dvh","hevc-hdr"]:t?["hevc-hdr"]:[]}):this._browserHdrModes=[]}return this._browserHdrModes},e.prototype.isExternalRMKSA=function(){return this._platform.isClaro()},e.prototype.supportsSonyEnhancedSecurityVideoMode=function(){return this._platform.isPlayStation5()},e}();t.PlatformCapabilities=c},91561:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformWorkaroundWrapper=void 0;var i=r(30607),n=function(){function e(){this._platform=new i.Platform}return e.prototype.requiresStallSkippingWorkaround=function(){return!!(this._platform.isTizen()||this._platform.isTizen2016()||this._platform.isClaro())},e.prototype.requiredMultiPeriodWorkaround=function(){return this._platform.isTizen2016()||this._platform.isClaro()||this._platform.isPlayStation4()||this._platform.isEnseo()?"single_period_new_drm":"single_period_existing_drm"},e.prototype.requiresSeekOnTrackChangeWorkaround=function(){return this._platform.isWebOS()||this._platform.isVizio()||this._platform.isClaro()||this._platform.isPlayStation5()},e.prototype.requiresMediaKeysAttachedForUnencrypted=function(){return this._platform.isTizen2017()},e.prototype.requiresReattachOnKeyStatusesChange=function(){return this._platform.isPlayStation4()},e.prototype.requiresDontSeekToZeroWorkaround=function(){return this._platform.isClaro()},e.prototype.requiresSafeSeek=function(){return this._platform.isClaro()},e}();t.PlatformWorkaroundWrapper=n},47632:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Emitter=void 0;var i=r(22970),n=r(54965),o=function(){function e(){this._handlerMap=new n.Map,void 0!==e.global_on_created&&e.global_on_created(this)}return Object.defineProperty(e.prototype,"owners",{get:function(){var e=[];return this._handlerMap.forEach(function(t){e.push(t)}),e},enumerable:!1,configurable:!0}),e.prototype.on=function(e,t){this._handlerMap.contains(e)||this._handlerMap.set(e,[]),this._handlerMap.get(e).push(t)},e.prototype.off=function(e,t){var r=this,i=[];this._handlerMap.forEach(function(r,n){if(void 0===e||r===e){for(var o=n.length-1;o>=0;o--)(void 0===t||n[o]===t)&&n.splice(o,1);0===n.length&&i.push(r)}}),i.forEach(function(e){r._handlerMap.delete(e)})},e.prototype.once=function(e,t){var r=this,i=function(n){r.off(e,i),t(n)};this.on(e,i)},e.prototype.emit=function(e){this._handlerMap.forEach(function(t,r){i.__spreadArray([],r,!0).forEach(function(t){t(e)})})},e}();t.Emitter=o},94306:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HashMap=void 0;var i=r(15302),n=function(){function e(e){if(this._data={},void 0!==e)for(var t=0;t<e.length;t++){var r=e[t];this.set(r[0],r[1])}}return e.prototype.set=function(e,t){this._data[e]=t},e.prototype.get=function(e){var t=this.tryGet(e);if(void 0===t)throw new i.InvalidOperationError("Missing key '".concat(e,"' in HashMap"));return t},e.prototype.tryGet=function(e){return this._data[e]},e.prototype.coalesce=function(e){for(var t=0;t<e.length;t++){var r=e[t],i=this._data[r];if(void 0!==i)return i}},e.prototype.delete=function(e){return void 0!==this._data[e]&&(delete this._data[e],!0)},e.prototype.getCount=function(){return Object.keys(this._data).length},e.prototype.contains=function(e){return void 0!==this._data[e]},e.prototype.forEach=function(e){for(var t=0,r=Object.keys(this._data);t<r.length;t++){var i=r[t],n=this.tryGet(i);void 0!==n&&e(i,n)}},e.prototype.values=function(){var e=this;return Object.keys(this._data).map(function(t){return e._data[t]})},e.prototype.clear=function(){this._data={}},e}();t.HashMap=n},6246:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HashSet=void 0;var r=function(){function e(e){if(this._data={},this._size=0,void 0!==e)for(var t=0;t<e.length;t++){var r=e[t];this.add(r)}}return Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),e.prototype.forEach=function(e,t){void 0===t&&(t=void 0);for(var r=0,i=this.values();r<i.length;r++){var n=i[r];e.call(t,n,n,this)}},e.prototype.add=function(e){return!this.has(e)&&this._size++,this._data[e]=!0,this},e.prototype.clear=function(){this._data={},this._size=0},e.prototype.has=function(e){return e in this._data},e.prototype.delete=function(e){return e in this._data&&(delete this._data[e],this._size--,!0)},e.prototype.values=function(){return Object.keys(this._data)},e}();t.HashSet=r},54965:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Map=void 0;var i=r(15302),n=r(72635),o="undefined"==typeof Map?n.MapPolyfill:Map,a=function(){function e(e){void 0!==e?this._storage=new o(e):this._storage=new o}return e.prototype.forEach=function(e){var t=this;this._storage.forEach(function(r,i){return e(i,r,t)})},e.prototype.getCount=function(){return this._storage.size},e.prototype.get=function(e){var t=this._storage.get(e);if(void 0===t)throw new i.InvalidOperationError("Missing key '".concat(e,"' in Map"));return t},e.prototype.tryGet=function(e){return this._storage.get(e)},e.prototype.set=function(e,t){this._storage.set(e,t)},e.prototype.delete=function(e){return this._storage.delete(e)},e.prototype.coalesce=function(e){for(var t=0;t<e.length;t++){var r=e[t],i=this._storage.get(r);if(void 0!==i)return i}},e.prototype.contains=function(e){return this._storage.has(e)},e.prototype.clear=function(){this._storage.clear()},e}();t.Map=a},72635:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapPolyfill=void 0;var r=function(){function e(e){var t=this;this._keyArray=[],this._complexValueArray=[],void 0!==e&&e.forEach(function(e){t.set(e[0],e[1])})}return e.prototype.set=function(e,t){var r=this._keyArray.indexOf(e);return -1===r?(this._keyArray.push(e),this._complexValueArray[this._keyArray.length-1]=t):this._complexValueArray[r]=t,this},e.prototype.get=function(e){return this._complexValueArray[this._keyArray.indexOf(e)]},e.prototype.has=function(e){return -1!==this._keyArray.indexOf(e)},e.prototype.delete=function(e){var t=this._keyArray.indexOf(e);return t>=0&&(this._keyArray.splice(t,1),this._complexValueArray.splice(t,1),!0)},e.prototype.forEach=function(e){var t=this,r=this._keyArray.slice(),i=this._complexValueArray.slice();r.forEach(function(r,n){return e(i[n],r,t)})},Object.defineProperty(e.prototype,"size",{get:function(){return this._keyArray.length},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this._keyArray=[],this._complexValueArray=[]},e}();t.MapPolyfill=r},88309:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Set=t.SetPolyfill=void 0;var r=function(){function e(e){this._items=[];for(var t=0,r=null!=e?e:[];t<r.length;t++){var i=r[t];this.add(i)}}return Object.defineProperty(e.prototype,"size",{get:function(){return this._items.length},enumerable:!1,configurable:!0}),e.prototype.add=function(e){return -1===this._items.indexOf(e)&&this._items.push(e),this},e.prototype.clear=function(){this._items=[]},e.prototype.delete=function(e){var t=this._items.indexOf(e);return -1!==t&&(this._items.splice(t,1),!0)},e.prototype.forEach=function(e){for(var t=0,r=this._items.slice();t<r.length;t++){var i=r[t];e.call(this,i,i,this)}},e.prototype.has=function(e){return -1!==this._items.indexOf(e)},e}();t.SetPolyfill=r;var i="undefined"==typeof Set?r:Set,n=function(){function e(e){this._storage=new i(e)}return Object.defineProperty(e.prototype,"size",{get:function(){return this._storage.size},enumerable:!1,configurable:!0}),e.prototype.add=function(e){return this._storage.add(e),this},e.prototype.clear=function(){this._storage.clear()},e.prototype.delete=function(e){return this._storage.delete(e)},e.prototype.forEach=function(e,t){var r=this;void 0===t&&(t=void 0),this._storage.forEach(function(i,n){return e.call(t,i,n,r)})},e.prototype.has=function(e){return this._storage.has(e)},e.prototype.values=function(){var e=[];return this._storage.forEach(function(t){return e.push(t)}),e},e}();t.Set=n},78211:function(e,t){"use strict";var r,i;t.j=void 0,(i=r||(t.j=r={})).VIDEO="video",i.AUDIO="audio",i.TEXT="text",i.IMAGE="image"},16754:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Uri=void 0;var r=function(){function e(t){var r,i,n,o,a,s;if(this._scheme="",this._userInfo="",this._domain="",this._path="",this._fragment="",this._queryData="",this._port=0,t instanceof e)this.setScheme(t.getScheme()),this.setUserInfo(t.getUserInfo()),this.setDomain(t.getDomain()),this.setPort(t.getPort()),this.setPath(t.getPath()),this.setQueryData(t.getQueryData()),this.setFragment(t.getFragment());else if(void 0!==t&&t.length>0){var u=e.split(String(t));this.setScheme(null!==(r=u[e._componentIndexMap.scheme])&&void 0!==r?r:"",!0),this.setUserInfo(null!==(i=u[e._componentIndexMap.userInfo])&&void 0!==i?i:"",!0),this.setDomain(null!==(n=u[e._componentIndexMap.domain])&&void 0!==n?n:"",!0),this.setPort(Number(u[e._componentIndexMap.port])),this.setPath(null!==(o=u[e._componentIndexMap.path])&&void 0!==o?o:"",!0),this.setQueryData(null!==(a=u[e._componentIndexMap.queryData])&&void 0!==a?a:""),this.setFragment(null!==(s=u[e._componentIndexMap.fragment])&&void 0!==s?s:"",!0)}}return e.split=function(t){var r=[],i=t.match(e._regexMap.split);if(null!==i)for(var n=0;n<i.length;n++){var o=i[n];r.push(o)}return r},e._decodeOrEmpty=function(e,t){return""===e?"":!0===t?decodeURI(e):decodeURIComponent(e)},e._encodeSpecialChars=function(t,r,i){var n=encodeURI(t).replace(r,function(e){var t=e.charCodeAt(0);return"%"+(t>>4&15).toString(16)+(15&t).toString(16)});return!0===i&&(n=e._removeDoubleEncoding(n)),n},e._removeDoubleEncoding=function(t){return t.replace(e._regexMap.doubleEncode,"%$1")},e.prototype.hasScheme=function(){return!!this._scheme},e.prototype.getScheme=function(){return this._scheme},e.prototype.setScheme=function(t,r){this._scheme=!0===r?e._decodeOrEmpty(t,!0):t,this._scheme.length>0&&(this._scheme=this._scheme.replace(e._regexMap.colonAtEnd,""))},e.prototype.hasUserInfo=function(){return!!this._userInfo},e.prototype.getUserInfo=function(){return this._userInfo},e.prototype.setUserInfo=function(t,r){this._userInfo=!0===r?e._decodeOrEmpty(t):t},e.prototype.hasDomain=function(){return!!this._domain},e.prototype.getDomain=function(){return this._domain},e.prototype.setDomain=function(t,r){this._domain=!0===r?e._decodeOrEmpty(t,!0):t},e.prototype.hasPort=function(){return!!this._port},e.prototype.getPort=function(){return this._port},e.prototype.setPort=function(e){(isNaN(e=Number(e))||e<0)&&(e=0),this._port=e},e.prototype.hasPath=function(){return!!this._path},e.prototype.getPath=function(){return this._path},e.prototype.setPath=function(t,r){this._path=!0===r?e._decodeOrEmpty(t,!0):t},e.prototype.hasQueryData=function(){return""!==this._queryData},e.prototype.getQueryData=function(){return this._queryData},e.prototype.setQueryData=function(e){this._queryData=e},e.prototype.hasFragment=function(){return!!this._fragment},e.prototype.getFragment=function(){return this._fragment},e.prototype.setFragment=function(t,r){this._fragment=!0===r?e._decodeOrEmpty(t):t},e.prototype.toString=function(){var t=[],r=this.getScheme(),i=this.getDomain();if(""!==r&&t.push(e._encodeSpecialChars(r,e._regexMap.disallowedInSchemeOrUserInfo,!0),":"),""!==i){t.push("//");var n=this.getUserInfo();""!==n&&t.push(e._encodeSpecialChars(n,e._regexMap.disallowedInSchemeOrUserInfo,!0),"@"),t.push(e._removeDoubleEncoding(encodeURIComponent(i)));var o=this.getPort();0!==o&&t.push(":",String(o))}return t.push(this.toRelativeString()),t.join("")},e.prototype.toRelativeString=function(){var t=[],r=this.getPath(),i=this.getQueryData(),n=this.getFragment();if(""!==r){var o="/"===r[0];this.hasDomain()&&!o&&t.push("/"),t.push(e._encodeSpecialChars(r,o?e._regexMap.disallowedInAbsolutePath:e._regexMap.disallowedInRelativePath,!0))}return""!==i&&t.push("?",i),""!==n&&t.push("#",e._encodeSpecialChars(n,e._regexMap.disallowedInFragment)),t.join("")},e.prototype.resolve=function(t){var r=new e(this);if("data"===r.getScheme()&&(r=new e),t.hasScheme()&&r.setScheme(t.getScheme()),t.hasUserInfo()&&r.setUserInfo(t.getUserInfo()),t.hasDomain()&&r.setDomain(t.getDomain()),(t.hasPort()||t.hasDomain())&&r.setPort(t.getPort()),t.hasPath()){var i=t.getPath();if("/"!==i[0]){if(this.hasDomain()&&!this.hasPath())i="/"+i;else{var n=r.getPath().lastIndexOf("/");-1!==n&&(i=r.getPath().substring(0,n+1)+i)}}r.setPath(i)}return t.hasQueryData()?r.setQueryData(t.getQueryData()):r.setQueryData(""),t.hasFragment()?r.setFragment(t.getFragment()):r.setFragment(""),r},e.prototype.relativeUri=function(t){if(!this.hasScheme()||!t.hasScheme()||this.getScheme()!==t.getScheme()||this.getUserInfo()!==t.getUserInfo()||this.getDomain()!==t.getDomain()||this.getPort()!==t.getPort())return new e(this);for(var r=this.getPath().split("/"),i=t.getPath().split("/"),n=Math.min(r.length,i.length),o=0;o<n&&r[o]===i[o];)++o;var a=[];if(1===o&&r.length>1)a.push("");else if(o===r.length&&i.length===r.length+1)a.push(".");else for(var s=0;s<i.length-o-1;++s)a.push("..");for(var s=o;s<r.length;++s)0===a.length&&o===i.length&&s>0&&a.push(r[s-1]),a.push(r[s]);var u=new e;return u.setPath(a.join("/")),u.setQueryData(this.getQueryData()),u.setFragment(this.getFragment()),u},e._componentIndexMap={scheme:1,userInfo:2,domain:3,port:4,path:5,queryData:6,fragment:7},e._regexMap={colonAtEnd:/:$/,doubleEncode:/%25([0-9a-fA-F]{2})/g,disallowedInSchemeOrUserInfo:/[#/?@]/g,disallowedInRelativePath:/[#?:]/g,disallowedInAbsolutePath:/[#?]/g,disallowedInQuery:/[#?@]/g,disallowedInFragment:/#/g,split:RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$")},e}();t.Uri=r},46383:function(e,t){"use strict";var r,i;t.J=void 0,(i=r||(t.J=r={})).UNKNOWN="unknown",i.AUDIO="audio",i.VIDEO_SD="video-sd",i.VIDEO_HD="video-hd",i.VIDEO_FHD="video-fhd",i.VIDEO_UHD1="video-uhd1",i.VIDEO_UHD2="video-uhd2"},44126:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppendBufferError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="AppendBuffer",t}(r(57665).WrappedError);t.AppendBufferError=n},79726:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ByteRangeMismatchError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="ByteRangeMismatch",t}(r(57665).WrappedError);t.ByteRangeMismatchError=n},15302:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidOperationError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="InvalidOperation",t}(r(57665).WrappedError);t.InvalidOperationError=n},14789:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkRequestError=void 0;var i=r(22970),n=r(57665),o=function(e){function t(r,i,n,o){void 0===n&&(n=[]),void 0===o&&(o=[]);var a=e.call(this,t.NAME,r,n.length>0?n[n.length-1]:void 0)||this;return a.context=i,a.originalErrors=n,a.requestTimes=o,a}return i.__extends(t,e),t.prototype.toString=function(){var e=n.WrappedError.getStandardMessage(this);this.requestTimes.length>0&&(e+="\nRequest times: ".concat(JSON.stringify(this.requestTimes)));for(var t=0;t<this.originalErrors.length;++t)e+="\nAttempt ".concat(t+1," caused by:\n").concat(this.originalErrors[t].toString());return e},t.NAME="NetworkRequest",t}(n.WrappedError);t.NetworkRequestError=o},43495:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoProgressMadeError=void 0;var i=r(22970),n=function(e){function t(r,i,n,o){var a=e.call(this,t.NAME,r,i)||this;return a.readyState=n,a.percentDownloaded=o,a}return i.__extends(t,e),t.NAME="NoProgressMade",t}(r(57665).WrappedError);t.NoProgressMadeError=n},88616:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OfflineError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="OfflineError",t}(r(57665).WrappedError);t.OfflineError=n},34518:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OperationCanceledError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="OperationCanceled",t}(r(57665).WrappedError);t.OperationCanceledError=n},19808:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OperationTimedOutError=void 0;var i=r(22970),n=function(e){function t(r,i,n,o){var a=e.call(this,t.NAME,r,i)||this;return a.readyState=n,a.percentDownloaded=o,a}return i.__extends(t,e),t.NAME="OperationTimedOut",t}(r(57665).WrappedError);t.OperationTimedOutError=n},66124:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuotaExceededError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="QuotaExceeded",t}(r(57665).WrappedError);t.QuotaExceededError=n},39697:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoveBufferError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="RemoveBuffer",t}(r(57665).WrappedError);t.RemoveBufferError=n},95645:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnsupportedError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="Unsupported",t}(r(57665).WrappedError);t.UnsupportedError=n},28521:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WarningError=void 0;var i=r(22970),n=function(e){function t(r,i,n){return void 0===n&&(n=t.NAME),e.call(this,n,r,i)||this}return i.__extends(t,e),t.NAME="Warning",t}(r(57665).WrappedError);t.WarningError=n},57665:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WrappedError=void 0;var i=r(88309),n=function(){function e(t,r,i){this.name=t,this.message=r,void 0!==i&&(this.original=e.wrap(i))}return e.causedBy=function(e,t){return void 0!==this.findFirst(e,t)},e.findFirst=function(e,t){for(var r=e,n=new i.Set;void 0!==r&&!n.has(r);){if(n.add(r),"string"==typeof t){if(r.name===t)return r}else if(r instanceof t)return r;r=r.original}},e.wrap=function(t,r){return(void 0===r&&(r="Unknown"),t instanceof e)?t:new e(r,"Unknown error occurred: ".concat(String(t)))},e.prototype.toString=function(){return e.getStandardMessage(this)+e.getCauseMessage(this)},e.getStandardMessage=function(e){return"".concat(e.name,": ").concat(e.message)},e.getCauseMessage=function(e){var t="";return void 0!==e.original&&(t+="\nCaused by:\n".concat(e.original.toString())),t},e}();t.WrappedError=n},76622:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmlParserError=void 0;var i=r(22970),n=function(e){function t(r,i){return e.call(this,t.NAME,r,i)||this}return i.__extends(t,e),t.NAME="XmlParser",t}(r(57665).WrappedError);t.XmlParserError=n},7696:function(e,t){"use strict";var r,i;t.j=void 0,(i=r||(t.j=r={})).AAC="aac",i.HEAAC="heaac",i.AC3="ac-3",i.EC3="ec-3",i.EC3_ATMOS="ec-3-atmos",i.UNKNOWN="unknown-audio"},88818:function(e,t){"use strict";var r,i;t.v=void 0,(i=r||(t.v=r={})).FAIRPLAY_2_0="com.apple.fps.2_0",i.WIDEVINE="com.widevine.alpha",i.PLAYREADY="com.microsoft.playready",i.PLAYREADY_SL3000="com.microsoft.playready.recommendation",i.CLEARKEY="org.w3.clearkey"},42494:function(e,t){"use strict";var r,i;t._=void 0,(i=r||(t._=r={}))[i.NONE=0]="NONE",i[i.AUDIODESCRIPTION=1]="AUDIODESCRIPTION",i[i.AUDIOATMOS=2]="AUDIOATMOS",i[i.TEXTFORCEDSUBTITLE=4]="TEXTFORCEDSUBTITLE",i[i.TEXTCAPTION=8]="TEXTCAPTION",i[i.TEXTEMBEDDEDCAPTION=16]="TEXTEMBEDDEDCAPTION",i[i.VIDEORANGEPQ=32]="VIDEORANGEPQ"},1655:function(e,t){"use strict";var r,i;t.K=void 0,(i=r||(t.K=r={})).DVH="dvh",i.AVC="avc",i.HEVC="hevc",i.HEVC_HDR="hevc-hdr",i.UNKNOWN="unknown-video"},38375:function(e,t,r){"use strict";t.R=void 0;var i=r(22970),n=function(e){function t(r){return e.call(this,t.NAME,r)||this}return i.__extends(t,e),t.NAME="VitalFactoryError",t}(r(57665).WrappedError);t.R=n},56252:function(e,t){"use strict";var r,i;t.p=void 0,(i=r||(t.p=r={})).VIDEO="video",i.AUDIO="audio",i.TEXT="text",i.MANIFEST="manifest",i.LICENSE="license",i.OTHER="other"},34855:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseUtil=void 0;var r=function(){function e(){}return e.ensurePromiseType=function(e){return e instanceof Promise?e:Promise.resolve(e)},e.catchRejection=function(e,t,r){try{Promise.resolve(e()).catch(t).then(r).catch(t)}catch(e){t(e)}},e}();t.PromiseUtil=r},1629:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Timeout=void 0;var i=r(34518),n=function(){function e(e,t){this._set=e,this._clear=t}return e.prototype.postTimeout=function(e){var t,r,n=this,o=!0;return{timeout:new Promise(function(i,a){r=a,t=n._set(function(){o=!1,i()},1e3*e)}),cancel:function(){o&&(o=!1,n._clear(t)),r(new i.OperationCanceledError("Timeout with id: ".concat(String(t)," was canceled")))}}},e}();t.Timeout=n},71791:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeParser=void 0;var i=r(76622),n=function(){function e(e){this._body=e}return e.prototype.getFirstRecursiveChildByType=function(e){return this._readSingleNode(this._body,e)},e.prototype.getRecursiveChildrenByType=function(e){for(var t=[],r=this._readSingleNode(this._body,e);void 0!==r;)t.push(r),r=this._readSingleNode(this._body,e,r.leftover);return t},e.prototype.getDirectChildren=function(){for(var e=0,t=[],r=this._body.indexOf("<");-1!==r;r=this._body.indexOf("<",e)){var n=this._skipComment(this._body,r);if(void 0!==n){e=n;continue}var o=this._readTypeFromIndex(this._body,r),a=this._readSingleNode(this._body,o,e);if(void 0===a)throw new i.XmlParserError("Failed to read parsed type '".concat(o,"'"));t.push(a),e=a.leftover}return t},e.prototype._readTypeFromIndex=function(e,t){for(var r=t+1;""!==e[r].trim()&&"/"!==e[r]&&">"!==e[r];)r++;return e.substring(t+1,r)},e.prototype._readSingleNode=function(e,t,r){void 0===r&&(r=0);var i=this._indexOfTag(e,t,r);if(-1!==i){var n=i+t.length+1,o=e.indexOf("<",n),a=e.indexOf("/>",n),s=this._indexOfTag(e,"/".concat(t,">"),o),u=-1!==a&&(-1===o||o>a)&&(-1===s||a<s);if(-1!==s&&!u){var c=e.indexOf(">",n);return{type:t,attributes:e.substring(n,c).split(" "),rawBody:e.substring(c+1,s),leftover:s+t.length+3}}return{type:t,attributes:e.substring(n,a).split(" "),leftover:a+2,rawBody:""}}},e.prototype._indexOfTag=function(e,t,r){var i;void 0===r&&(r=0);for(var n=this._body.indexOf("<",r);-1!==n;n=this._body.indexOf("<",r)){if(e.substring(n,n+t.length+1)==="<".concat(t))return n;r=null!==(i=this._skipComment(e,n))&&void 0!==i?i:n+1}return -1},e.prototype._skipComment=function(e,t){if("<!--"===e.substring(t,t+4)){var r=e.indexOf("-->",t+4);if(-1===r)throw new i.XmlParserError("Failed to read comment");return r+3}},e}();t.NodeParser=n},9345:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeUtil=void 0;var i=r(17590),n=r(76622),o=function(){function e(){this._stringUtil=new i.StringUtil}return e.prototype.unescapeString=function(e){return e.replace(/&(quot|apos|lt|gt|amp|#([0-9]+|x[0-9a-fA-F]+));/g,function(e,t){return"quot"===t?'"':"apos"===t?"'":"lt"===t?"<":"gt"===t?">":"amp"===t?"&":String.fromCharCode("x"===t[1]?parseInt(t.substring(2),16):parseInt(t.substring(1),10))})},e.prototype.startsWith=function(e,t){return this._stringUtil.startsWith(t,e)},e.prototype.getAttributeValue=function(e){var t=e.indexOf("="),r=e[t+1];if(-1===t||"'"!==r&&'"'!==r)throw new n.XmlParserError("Failed to parse attribute with input '".concat(e,"'"));return this.unescapeString(e.slice(t+2,-1))},e.prototype.getBodyValue=function(e){return this.unescapeString(e.rawBody)},e.prototype.stripTags=function(e){return e.replace(/<[^<>]*>/g,"")},e}();t.NodeUtil=o},8840:function(e,t,r){"use strict";r.d(t,{c:function(){return ej}});var i,n,o=r(58468),a=r(24533),s=r(27451),u=r(81383),c=r(63775),d=r(67179),l=r(70387),h=r(50297),p=r(78211),f=r(88818),_=r(42494),v=r(1655),m=r(56252),g=r(92132),y=r(2176),S=r(37594),E=r(46383);let b={"0100":E.J.AUDIO,"0101":E.J.VIDEO_SD,"0102":E.J.VIDEO_HD,"0103":E.J.VIDEO_UHD1,"0104":E.J.VIDEO_UHD2,"0105":E.J.VIDEO_FHD},w=e=>{var t;return null!==(t=b[e.substring(0,4)])&&void 0!==t?t:E.J.UNKNOWN};(i=n||(n={}))[i.HDCP_LEVEL_UNKNOWN=0]="HDCP_LEVEL_UNKNOWN",i[i.HDCP_NONE=1]="HDCP_NONE",i[i.HDCP_V1=2]="HDCP_V1",i[i.HDCP_V2=3]="HDCP_V2",i[i.HDCP_V2_1=4]="HDCP_V2_1",i[i.HDCP_V2_2=5]="HDCP_V2_2",i[i.HDCP_V2_3=6]="HDCP_V2_3",i[i.HDCP_NO_DIGITAL_OUTPUT=7]="HDCP_NO_DIGITAL_OUTPUT";var P=r(96801),T=r(6246);class C extends P.o{constructor(e,t){super(e),this.hdcpLevel=t}getKeyTypesWhichMayBeRestricted(){if(void 0!==this.hdcpLevel)switch(this.hdcpLevel){case n.HDCP_V2_2:case n.HDCP_V2_3:return new T.HashSet;case n.HDCP_V2:case n.HDCP_V2_1:return new T.HashSet([E.J.VIDEO_UHD1,E.J.VIDEO_UHD2]);case n.HDCP_V1:return new T.HashSet([E.J.VIDEO_FHD,E.J.VIDEO_UHD1,E.J.VIDEO_UHD2]);case n.HDCP_NONE:return new T.HashSet([E.J.VIDEO_FHD,E.J.VIDEO_HD,E.J.VIDEO_UHD1,E.J.VIDEO_UHD2])}return super.getKeyTypesWhichMayBeRestricted()}}var M=r(45997),k=r(30607);let A=[{codec:'video/mp4; codecs="hev1.1.6.H156.B0"',profile:"main10",level:"5.2"},{codec:'video/mp4; codecs="hev1.1.6.H153.B0"',profile:"main10",level:"5.1"},{codec:'video/mp4; codecs="hev1.1.6.H150.B0"',profile:"main10",level:"5"},{codec:'video/mp4; codecs="hev1.1.6.H123.B0"',profile:"main10",level:"4.1"},{codec:'video/mp4; codecs="hev1.1.6.H120.B0"',profile:"main10",level:"4"},{codec:'video/mp4; codecs="hev1.1.6.L156.B0"',profile:"main",level:"5.2"},{codec:'video/mp4; codecs="hev1.1.6.L153.B0"',profile:"main",level:"5.1"},{codec:'video/mp4; codecs="hev1.1.6.L150.B0"',profile:"main",level:"5"},{codec:'video/mp4; codecs="hev1.1.6.L123.B0"',profile:"main",level:"4.1"},{codec:'video/mp4; codecs="hev1.1.6.L120.B0"',profile:"main",level:"4"},{codec:'video/mp4; codecs="hev1.1.6.L93.B0"',profile:"main",level:"3.1"},{codec:'video/mp4; codecs="hev1.1.6.L90.B0"',profile:"main",level:"3"},{codec:'video/mp4; codecs="hev1.1.6.L63.B0"',profile:"main",level:"2.1"},{codec:'video/mp4; codecs="hev1.1.6.L60.B0"',profile:"main",level:"2"},{codec:'video/mp4; codecs="hev1.1.6.L30.B0"',profile:"main",level:"1"}],x={codec:g.iL.H265,maxLevel:"5.2",profiles:["main10","main"]},D=[{codec:'video/mp4; codecs="avc1.640034"',profile:"high",level:"5.2"},{codec:'video/mp4; codecs="avc1.640033"',profile:"high",level:"5.1"},{codec:'video/mp4; codecs="avc1.640032"',profile:"high",level:"5"},{codec:'video/mp4; codecs="avc1.64002a"',profile:"high",level:"4.2"},{codec:'video/mp4; codecs="avc1.640029"',profile:"high",level:"4.1"},{codec:'video/mp4; codecs="avc1.640028"',profile:"high",level:"4"},{codec:'video/mp4; codecs="avc1.640020"',profile:"high",level:"3.2"},{codec:'video/mp4; codecs="avc1.64001f"',profile:"high",level:"3.1"},{codec:'video/mp4; codecs="avc1.64001e"',profile:"high",level:"3"},{codec:'video/mp4; codecs="avc1.640016"',profile:"high",level:"2.2"},{codec:'video/mp4; codecs="avc1.640015"',profile:"high",level:"2.1"},{codec:'video/mp4; codecs="avc1.640014"',profile:"high",level:"2"},{codec:'video/mp4; codecs="avc1.64000d"',profile:"high",level:"1.3"},{codec:'video/mp4; codecs="avc1.64000c"',profile:"high",level:"1.2"},{codec:'video/mp4; codecs="avc1.64000b"',profile:"high",level:"1.1"},{codec:'video/mp4; codecs="avc1.64000a"',profile:"high",level:"1"},{codec:'video/mp4; codecs="avc1.4d0034"',profile:"main",level:"5.2"},{codec:'video/mp4; codecs="avc1.4d0033"',profile:"main",level:"5.1"},{codec:'video/mp4; codecs="avc1.4d0032"',profile:"main",level:"5"},{codec:'video/mp4; codecs="avc1.4d002a"',profile:"main",level:"4.2"},{codec:'video/mp4; codecs="avc1.4d0029"',profile:"main",level:"4.1"},{codec:'video/mp4; codecs="avc1.4d0028"',profile:"main",level:"4"},{codec:'video/mp4; codecs="avc1.4d0020"',profile:"main",level:"3.2"},{codec:'video/mp4; codecs="avc1.4d001f"',profile:"main",level:"3.1"},{codec:'video/mp4; codecs="avc1.4d001e"',profile:"main",level:"3"},{codec:'video/mp4; codecs="avc1.4d0016"',profile:"main",level:"2.2"},{codec:'video/mp4; codecs="avc1.4d0015"',profile:"main",level:"2.1"},{codec:'video/mp4; codecs="avc1.4d0014"',profile:"main",level:"2"},{codec:'video/mp4; codecs="avc1.4d000d"',profile:"main",level:"1.3"},{codec:'video/mp4; codecs="avc1.4d000c"',profile:"main",level:"1.2"},{codec:'video/mp4; codecs="avc1.4d000b"',profile:"main",level:"1.1"},{codec:'video/mp4; codecs="avc1.4d000a"',profile:"main",level:"1"},{codec:'video/mp4; codecs="avc1.420034"',profile:"baseline",level:"5.2"},{codec:'video/mp4; codecs="avc1.420033"',profile:"baseline",level:"5.1"},{codec:'video/mp4; codecs="avc1.420032"',profile:"baseline",level:"5"},{codec:'video/mp4; codecs="avc1.42002a"',profile:"baseline",level:"4.2"},{codec:'video/mp4; codecs="avc1.420029"',profile:"baseline",level:"4.1"},{codec:'video/mp4; codecs="avc1.420028"',profile:"baseline",level:"4"},{codec:'video/mp4; codecs="avc1.420020"',profile:"baseline",level:"3.2"},{codec:'video/mp4; codecs="avc1.42001f"',profile:"baseline",level:"3.1"},{codec:'video/mp4; codecs="avc1.42001e"',profile:"baseline",level:"3"},{codec:'video/mp4; codecs="avc1.420016"',profile:"baseline",level:"2.2"},{codec:'video/mp4; codecs="avc1.420015"',profile:"baseline",level:"2.1"},{codec:'video/mp4; codecs="avc1.420014"',profile:"baseline",level:"2"},{codec:'video/mp4; codecs="avc1.42000d"',profile:"baseline",level:"1.3"},{codec:'video/mp4; codecs="avc1.42000c"',profile:"baseline",level:"1.2"},{codec:'video/mp4; codecs="avc1.42000b"',profile:"baseline",level:"1.1"},{codec:'video/mp4; codecs="avc1.42000a"',profile:"baseline",level:"1"}],R={codec:g.iL.H264,maxLevel:"5.2",profiles:["high","main","baseline"]},O=[{codec:'audio/mp4; codecs="mp4a.40.2"',profile:"lc"},{codec:'audio/mp4; codecs="mp4a.40.5"',profile:"hev"},{codec:'audio/mp4; codecs="mp4a.40.29"',profile:"hev2"}],I={codec:g.dg.AAC,profiles:["lc","hev","hev2"]},U=[{codec:'audio/mp4; codecs="ac-3";'}],B={codec:g.dg.AC3,profiles:[]},L="atmos",N=[{codec:'audio/mp4; codecs="ec-3"'}],F={codec:g.dg.EAC3,profiles:[]},W=[{robustness:"HW_SECURE_ALL",level:g.YH.L1},{robustness:"HW_SECURE_DECODE",level:g.YH.L1},{robustness:"HW_SECURE_CRYPTO",level:g.YH.L2},{robustness:"SW_SECURE_DECODE",level:g.YH.L3},{robustness:"SW_SECURE_CRYPTO",level:g.YH.L3}],V=[{robustness:"3000",level:g.xi.SL3000},{robustness:"2000",level:g.xi.SL2000},{robustness:"150",level:g.xi.SL150}],H=[{keySystem:"com.apple.fps.3_0",version:"3.0",initDataTypes:["cenc"]},{keySystem:"com.apple.fps.2_0",version:"2.0",initDataTypes:["sinf"]},{keySystem:"com.apple.fps.1_0",version:"1.0",initDataTypes:["cenc"]}],j=[{level:g.xi.SL3000,robustness:"3000",minHdcpVersion:"2.2"},{level:g.xi.SL2000,robustness:"2000",minHdcpVersion:"1.0"}];class K{constructor(e,t){this._platform=new k.Platform,this._containerElement=e,this._platformCapabilities=new M.PlatformCapabilities,this._config=t}async getCapabilities(){return{audioDecoders:void 0!==this._config.supportedAudioCodecs?this._getOverrideAudioDecodingCapabilities(this._config.supportedAudioCodecs):await this._getAudioDecodingCapabilities(),displayProperties:await this._getDisplayProperties(),drmInfo:await this._getDrmCapabilities(),manifests:this._getManifestsCapabilities(),segments:this._getSegmentsCapabilities(),videoDecoders:void 0!==this._config.supportedVideoCodecs?this._getOverrideVideoDecodingCapabilities(this._config.supportedVideoCodecs):this._getVideoDecodingCapabilities()}}async _getAudioDecodingCapabilities(){let e,t,r;let i=O.length;for(let t=0;t<i;t++){let r=O[t];this._isSupportedCodec(r.codec)&&(void 0===e?e={codec:g.dg.AAC,profiles:[r.profile]}:e.profiles.push(r.profile))}let n=U.length;for(let e=0;e<n;e++){let r=U[e];if(this._isSupportedCodec(r.codec)){t={codec:g.dg.AC3,profiles:[]};break}}let o=N.length;for(let e=0;e<o;e++){let t=N[e];if(this._isSupportedCodec(t.codec)){r={codec:g.dg.EAC3,profiles:[]};try{await this._platformCapabilities.canPlayDolbyAtmos()&&r.profiles.push(L)}catch(e){}break}}return{aac:e,ac3:t,eac3:r}}_getOverrideAudioDecodingCapabilities(e){let t,r,i;return e.aac&&(t=I),e.ac3&&(r=B),e.eac3&&(i=F,e.atmos&&i.profiles.push(L)),{aac:t,ac3:r,eac3:i}}async _getDisplayProperties(){var e,t;let r,i,n,o;return(null===(t=null===(e=this._config)||void 0===e?void 0:e.resolutionOverrides)||void 0===t?void 0:t.maxResolution)!==void 0?(r=this._config.resolutionOverrides.maxResolution.height,n=this._config.resolutionOverrides.maxResolution.height,i=this._config.resolutionOverrides.maxResolution.width,o=this._config.resolutionOverrides.maxResolution.width):(r=this._containerElement.offsetHeight,n=screen.height,i=this._containerElement.offsetWidth,o=screen.width),{hdrCapabilities:void 0!==this._config.supportedVideoCodecs?this._getOverrideHdrCapabilities(this._config.supportedVideoCodecs):await this._getHdrCapabilities(),playerViewHeight:r,playerViewWidth:i,screenHeight:n,screenWidth:o}}_getDrmCapabilitiesFromConfigOverride(){var e,t,r,i,n,o;let a={cdm:{clearKey:!1},hdcp:{negotiatedLevel:""}};return(null===(t=null===(e=this._config)||void 0===e?void 0:e.supportedCDMs)||void 0===t?void 0:t.widevine)&&(a.cdm.widevine=this._config.supportedCDMs.widevine),(null===(i=null===(r=this._config)||void 0===r?void 0:r.supportedCDMs)||void 0===i?void 0:i.playready)&&(a.cdm.playready=this._config.supportedCDMs.playready),(null===(o=null===(n=this._config)||void 0===n?void 0:n.supportedCDMs)||void 0===o?void 0:o.fairplay)&&(a.cdm.fairplay=this._config.supportedCDMs.fairplay),a}async _getDrmCapabilities(){var e;return(null===(e=this._config)||void 0===e?void 0:e.supportedCDMs)!==void 0?this._getDrmCapabilitiesFromConfigOverride():{cdm:{clearKey:!0,widevine:await this._getWidevineSupport(),playready:await this._getPlayReadySupport(),fairplay:await this._getFairplaySupport()},hdcp:{negotiatedLevel:""}}}async _getHdrCapabilities(){let e=[g.ho.SDR];try{let t=await this._platformCapabilities.getSupportedHdrModes();if(void 0!==t)for(let r=0;r<t.length;r++){let i=t[r];i===v.K.DVH?e.push(g.ho.DOLBY_VISION):i===v.K.HEVC_HDR&&e.push(g.ho.HDR10)}}catch(e){}return e}_getOverrideHdrCapabilities(e){let t=[g.ho.SDR];return e.hevcHdr&&t.push(g.ho.HDR10),e.dvh&&t.push(g.ho.DOLBY_VISION),t}_getManifestsCapabilities(){return{formats:{dash:{}}}}_getSegmentsCapabilities(){return{formats:{fmp4:{}}}}_getVideoDecodingCapabilities(){return{h264:this._getVideoCodecSupport(D,g.iL.H264),h265:this._getVideoCodecSupport(A,g.iL.H265)}}_getOverrideVideoDecodingCapabilities(e){return{h264:e.avc?R:void 0,h265:e.hevcSdr?x:void 0}}_getWidevineSupport(){return void 0===this._cachedWidevineCdmSupport&&(this._cachedWidevineCdmSupport=this._getWidevineCdmSupport()),this._cachedWidevineCdmSupport}async _getWidevineCdmSupport(){let e=W.length;for(let t=0;t<e;t++){let e=W[t];if(await this._getDrmSupport(e.robustness,"com.widevine.alpha"))return{level:e.level,version:""}}}async _getPlayReadySupport(){let e="com.microsoft.playready",t=!1;if(this._platform.isChromiumEdge()&&!this._platform.isXbox())for(let r of j){let i=await this._isHDCPSupported(r.robustness,e,r.minHdcpVersion);if(i)return{level:r.level,version:""};!1===i&&(t=!0)}if(!t)return void 0===this._cachedPlayReadyCdmSupport&&(this._cachedPlayReadyCdmSupport=this._getPlayReadyCdmSupport(e)),this._cachedPlayReadyCdmSupport}async _getPlayReadyCdmSupport(e){let t=V.length;for(let r=0;r<t;r++){let t=V[r];if(await this._getDrmSupport(t.robustness,e))return{level:t.level,version:""}}}_getFairplaySupport(){return void 0===this._cachedFairplayCdmSupport&&(this._cachedFairplayCdmSupport=this._getFairplayCdmSupport()),this._cachedFairplayCdmSupport}async _getFairplayCdmSupport(){let e=H.length;for(let t=0;t<e;t++){let e=H[t];if(await this._isSupportedKeySystem(e.keySystem,[{initDataTypes:e.initDataTypes,audioCapabilities:[],videoCapabilities:[{contentType:'video/mp4;codecs="avc1.42E01E"'}]}]))return{version:e.version}}}async _getDrmSupport(e,t){return await this._getKeySystemAccess(t,e)!==void 0}async _isHDCPSupported(e,t,r){if("MediaKeys"in window&&"function"!=typeof MediaKeys.prototype.getStatusForPolicy)return;let i=await this._getKeySystemAccess(t,e),n=await (null==i?void 0:i.createMediaKeys());return void 0!==n&&await n.getStatusForPolicy({minHdcpVersion:r})==="usable"}async _getKeySystemAccess(e,t){try{return await window.navigator.requestMediaKeySystemAccess(e,[{initDataTypes:["cenc"],audioCapabilities:[],videoCapabilities:[{robustness:t,contentType:'video/mp4;codecs="avc1.42E01E"'}]}])}catch(e){return}}async _isSupportedKeySystem(e,t){try{return await window.navigator.requestMediaKeySystemAccess(e,t),!0}catch(e){return!1}}_getVideoCodecSupport(e,t){let r;let i=e.length;for(let n=0;n<i;n++){let i=e[n];!(void 0!==r&&r.profiles.includes(i.profile))&&this._isSupportedCodec(i.codec)&&(void 0===r?r={codec:t,maxLevel:i.level,profiles:[i.profile]}:r.profiles.push(i.profile))}return r}_isSupportedCodec(e){try{return window.MediaSource.isTypeSupported(e)}catch{return!1}}}var q=r(57665),z=r(16471),G=r(44126),$=r(1319),Y=r(30020),X=r(67503),Q=r(79726),Z=r(19734),J=r(84639),ee=r(98669),et=r(54459),er=r(35509),ei=r(15302),en=r(35619),eo=r(36760),ea=r(81907),es=r(17395),eu=r(41746),ec=r(46433),ed=r(82997),el=r(14789),eh=r(43495),ep=r(93342),ef=r(88616),e_=r(34518),ev=r(19808),em=r(11601),eg=r(49450),ey=r(17997),eS=r(75855),eE=r(66124),eb=r(39697),ew=r(43162),eP=r(61054),eT=r(98129),eC=r(5375),eM=r(95645),ek=r(2906),eA=r(38375),ex=r(28521),eD=r(76622),eR=r(39077);let eO={[ek.VideoElementError.NAME]:"0028",[ed.MediaOperationStateError.NAME]:"0014",[eD.XmlParserError.NAME]:"0035",[eC.TextEncodingError.NAME]:"0011",[er.InvalidDynamicManifestError.NAME]:"0041",[ea.ManifestParserError.NAME]:"0017",[es.ManifestProcessingError.NAME]:"0018",[Z.CopyProtectionError.NAME]:"0006",[ee.ExpiredKeysError.NAME]:"0015",[en.KeySessionError.NAME]:"0019",[eo.LicenseRequestError.NAME]:"0033",[eu.MediaKeySessionGenerateRequestError.NAME]:"0036",[ec.MediaKeySessionUpdateError.NAME]:"0037",[eT.SetServerCertificateError.NAME]:"0038",[em.OutputRestrictedError.NAME]:"0005",[J.DigitalRightsError.NAME]:"0002",[eS.PlayerNotLoadedError.NAME]:"0008",[ey.PlayerLoadError.NAME]:"0009",[ew.SegmentDownloadFailedError.NAME]:"0013",[eP.SegmentRetryFailedError.NAME]:"0012",[ef.OfflineError.NAME]:"0042",[Q.ByteRangeMismatchError.NAME]:"0021",[el.NetworkRequestError.NAME]:"0034",[eh.NoProgressMadeError.NAME]:"0023",[e_.OperationCanceledError.NAME]:"0024",[ev.OperationTimedOutError.NAME]:"0025",[X.BufferVariantError.NAME]:"0003",[z.InvalidSegmentDurationError.NAME]:"0004",[et.FormatChangedError.NAME]:"0016",[Y.BufferUpdateError.NAME]:"1001",[G.AppendBufferError.NAME]:"0020",[eE.QuotaExceededError.NAME]:"0026",[eb.RemoveBufferError.NAME]:"0027",[$.BufferError.NAME]:"0001",[eR.VideoStalledError.NAME]:"0039",[eA.R.NAME]:"0030",[eg.PlayerError.NAME]:"0040",[ei.InvalidOperationError.NAME]:"0022",[eM.UnsupportedError.NAME]:"0029",[ep.NonFatalError.NAME]:"9999",[ex.WarningError.NAME]:"0031",Unknown:"0000",PlayerLoadFailed:"0032"};var eI=r(94306);class eU{static getErrorToReport(e){let t={errorMessage:e.toString(),stackTrace:q.WrappedError.getCauseMessage(e),errorCode:this.getErrorCodeByName(e.name),httpContext:void 0},r=e,i=new eI.HashMap;for(;void 0!==r&&!i.contains(r.name);)i.set(r.name,r),r=r.original;for(let e of Object.keys(eO)){let r=i.tryGet(e);if(void 0!==r){t.errorCode=this.getErrorCodeByName(r.name);break}}return t}static getErrorCodeByName(e){var t;return`1K-${null!==(t=eO[e])&&void 0!==t?t:eO.Unknown}`}}class eB{constructor(e,t){this._error$=e,this._warning$=t}reportGluonError(e){let t=eU.getErrorToReport(e);this._error$.next(t)}reportGluonWarning(e){this._warning$.next({errorCode:e.name,errorMessage:e.toString(),stackTrace:q.WrappedError.getCauseMessage(e),httpContext:void 0})}reportError(e){this.reportGluonError(q.WrappedError.wrap(e))}reportWarning(e){this.reportGluonWarning(q.WrappedError.wrap(e))}}var eL=r(71180),eN=r(16754);class eF{static create(e,t,r,i){return new eL.F(e,t,{resolve:e=>{if(void 0!==r)switch(e.keySystem){case f.v.FAIRPLAY_2_0:r.schema===g.L1.FAIRPLAY&&eW(e,r);break;case f.v.WIDEVINE:r.schema===g.L1.WIDEVINE&&eW(e,r);break;case f.v.PLAYREADY:case f.v.PLAYREADY_SL3000:r.schema===g.L1.PLAYREADY&&eW(e,r);break;case f.v.CLEARKEY:r.schema===g.L1.CLEARKEY&&eW(e,r)}return e}},i)}}function eW(e,t){let r=t.licenseServerUrl;void 0!==r&&(e.licenseServerUri=()=>Promise.resolve(r)),void 0!==t.certificateUrl&&t.schema===g.L1.FAIRPLAY&&(e.serverCertificate=new eN.Uri(t.certificateUrl))}var eV=r(7696);class eH{constructor(e,t,r,i){var o,s,c;this._activeTextCues$=new y.x,this.activeTextCues$=this._activeTextCues$.asObservable(),this._audioBitrateBps$=new y.x,this.audioBitrateBps$=this._audioBitrateBps$.asObservable(),this._audioCodec$=new y.x,this.audioCodec$=this._audioCodec$.asObservable(),this._audioTrackLanguage$=new y.x,this.audioTrackLanguage$=this._audioTrackLanguage$.asObservable(),this._availableTracks$=new y.x,this.availableTracks$=this._availableTracks$.asObservable(),this._bandwidth$=new y.x,this.bandwidth$=this._bandwidth$.asObservable(),this._bufferedRange$=new y.x,this.bufferedRange$=this._bufferedRange$.asObservable(),this._cdn$=new y.x,this.cdn$=this._cdn$.asObservable(),this._currentPDT$=new y.x,this.currentPDT$=this._currentPDT$.asObservable(),this._droppedFrames$=new y.x,this.droppedFrames$=this._droppedFrames$.asObservable(),this._error$=new y.x,this.error$=this._error$.asObservable(),this._isLive$=new y.x,this.isLive$=this._isLive$.asObservable().pipe((0,S.x)()),this._liveEnd$=new y.x,this.liveEnd$=this._liveEnd$.asObservable(),this._liveStart$=new y.x,this.liveStart$=this._liveStart$.asObservable(),this._livePresentationStartTime$=new y.x,this.livePresentationStartTime$=this._livePresentationStartTime$.asObservable(),this._playbackLicenseExpired$=new y.x,this.playbackLicenseExpired$=this._playbackLicenseExpired$.asObservable(),this._playbackState$=new y.x,this.playbackState$=this._playbackState$.asObservable(),this._seekableRange$=new y.x,this.seekableRange$=this._seekableRange$.asObservable(),this._selectedAudioTrack$=new y.x,this.selectedAudioTrack$=this._selectedAudioTrack$.asObservable(),this._selectedTextTrack$=new y.x,this.selectedTextTrack$=this._selectedTextTrack$.asObservable(),this._streamCurrentTime$=new y.x,this.streamCurrentTime$=this._streamCurrentTime$.asObservable(),this._streamDuration$=new y.x,this.streamDuration$=this._streamDuration$.asObservable(),this._textTrackFormat$=new y.x,this.textTrackFormat$=this._textTrackFormat$.asObservable(),this._textTrackLanguage$=new y.x,this.textTrackLanguage$=this._textTrackLanguage$.asObservable(),this._timedMetadata$=new y.x,this.timedMetadata$=this._timedMetadata$.asObservable(),this._totalFrames$=new y.x,this.totalFrames$=this._totalFrames$.asObservable(),this._videoBitrateBps$=new y.x,this.videoBitrateBps$=this._videoBitrateBps$.asObservable(),this._videoCodec$=new y.x,this.videoCodec$=this._videoCodec$.asObservable(),this._availableVideoPeriods$=new y.x,this.availableVideoPeriods$=this._availableVideoPeriods$.asObservable(),this._videoPeriod$=new y.x,this.videoPeriod$=this._videoPeriod$.asObservable(),this._videoSize$=new y.x,this.videoSize$=this._videoSize$.asObservable(),this._volume$=new y.x,this.volume$=this._volume$.asObservable(),this._warning$=new y.x,this.warning$=this._warning$.asObservable(),this._errorManager=new eB(this._error$,this._warning$),this._requestFilters=new Set,this._playbackState=g.wo.CLOSED,this._currentPosition=0,this._changedDisplayMode=!1,this._handledTimedEventsPeriod=new Set,this._cdnRequestFilter=e=>{if(e.type===m.p.VIDEO||e.type===m.p.AUDIO){this._requestFilters.delete(this._cdnRequestFilter);let t=new URL(e.resource);this._cdn$.next(t.hostname)}},this._handleInitialPosition=e=>{var t,r;(null===(t=e.videoState)||void 0===t?void 0:t.currentTime)!==void 0&&(this._livePresentationStartTime$.next(null===(r=this._player.getSession())||void 0===r?void 0:r.getLivePresentationStartTime()),this._startPositionReporting(),this._player.onStateChanged.off(this,this._handleInitialPosition))},this._videoElement=t,this._config=r,this._displaySwapper=i,void 0===this._config.hdcpConfig&&(this._config.hdcpConfig=n.HDCP_LEVEL_UNKNOWN),e.appendChild(this._videoElement),this.setResizeMode("contain"),this._systemInterface=this._getSystemInterface(),this._loadPromiseChain=new a.SequentialTaskRunner(this._systemInterface),this._loadPromiseChain.onError.on(this,e=>this._errorManager.reportGluonError(e)),this._loadPromiseChain.onWarning.on(this,e=>this._errorManager.reportGluonWarning(e)),this._capabilitiesProvider=new K(e,r),this._player=new u.J(this._systemInterface,this._systemInterface.wrapBrowserElement(this._videoElement),{relativeBuffer:(null===(o=r.bufferOptions)||void 0===o?void 0:o.bufferingGoal)?{start:0,end:r.bufferOptions.bufferingGoal}:void 0,relativeAppend:(null===(s=r.bufferOptions)||void 0===s?void 0:s.appendGoal)?{start:0,end:r.bufferOptions.appendGoal}:void 0,bufferForPlaybackSeconds:null===(c=r.bufferOptions)||void 0===c?void 0:c.bufferForPlaybackSeconds})}getPlayerVersion(){return u.J.getPlayerVersion()}getPlayerName(){return"GLUON_BROWSER"}load(e,t){return this._queueLoadPromise(async()=>{await this._clearPlayItem(),this._player.onError.once(this,e=>{this._setPlaybackState(g.wo.ERROR),this._errorManager.reportGluonError(e)}),this._player.onWarning.on(this,e=>{this._errorManager.reportGluonWarning(e)}),this._setPlaybackState(g.wo.PREPARING);try{await this._load(e,t)}catch(e){this._errorManager.reportError(e);return}this._player.onStateChanged.on(this,e=>this._handlePlayerStateChange(e)),this._player.onStateChanged.on(this,this._handleInitialPosition),this._player.onTextCueChange.on(this,e=>this._activeTextCues$.next(e))})}play(){this._player.setRateWhenReady(1).catch(e=>{this._errorManager.reportError(e)})}pause(){this._player.setRateWhenReady(0).catch(e=>{this._errorManager.reportError(e)})}seek(e){let t=e/1e3;this._lastEmittedDuration&&((t+=this._lastEmittedDuration.start)>=this._lastEmittedDuration.end&&(t=this._lastEmittedDuration.end-1),this._setPlaybackState(g.wo.SEEKING),this._player.setPositionWhenReady(t).catch(e=>{this._errorManager.reportError(e)}))}selectAudioTrack(e){if(void 0!==e){let{language:t,role:r}=e,i=r===g.uS.DESCRIPTIVE?_._.AUDIODESCRIPTION:_._.NONE;this._audioTrackPreference={streamType:p.j.AUDIO,language:t,attributes:i},this._applyTracksPreferences(),this._selectedAudioTrack$.next(e)}}selectTextTrack(e){if(void 0!==e){let{language:t,role:r,format:i}=e,n=_._.NONE;if(i===g.vy.CEA_608||i===g.vy.CEA_708)n=_._.TEXTEMBEDDEDCAPTION;else switch(r){case g.mO.CLOSED_CAPTION:n=_._.TEXTCAPTION;break;case g.mO.FORCED:n=_._.TEXTFORCEDSUBTITLE}this._textTrackPreference={streamType:p.j.TEXT,language:t,attributes:n}}else this._textTrackPreference=void 0;this._applyTracksPreferences(),this._selectedTextTrack$.next(e)}setResizeMode(e){switch(e){case"contain":this._videoElement.style.height="100%",this._videoElement.style.width="100%";break;case"scale":this._videoElement.style.height="",this._videoElement.style.width="100%"}}setVolume(e){this._player.setVolumeWhenReady(e).then(()=>{this._volume$.next(e)}).catch(e=>{this._errorManager.reportError(e)})}stop(){return this._queueLoadPromise(()=>this._clearPlayItem())}destroy(){var e;return null===(e=this._videoElement.parentElement)||void 0===e||e.removeChild(this._videoElement),Promise.resolve(this.stop()).finally(()=>{this._loadPromiseChain.onError.off(this),this._loadPromiseChain.onWarning.off(this),this._loadPromiseChain.destroy()})}getEngineCapabilities(){return this._capabilitiesProvider.getCapabilities()}getVideoElement(){return this._videoElement}async getThumbnailUrl(e,t,r){var i,n,o,a;let s=null===(n=null===(i=this._player.getSession())||void 0===i?void 0:i.getLoadedData())||void 0===n?void 0:n.manifest,u=(null===(o=this._player.getSession())||void 0===o?void 0:o.isLive)&&(null===(a=this._player.getSession())||void 0===a?void 0:a.getLiveStart())||0;if(void 0!==s){let i=await s.getImage({targetHeight:t,targetWidth:r,timeSeconds:e/1e3+u});if(void 0!==i)return i.createUri}}async _load(e,t){var r;let i;let n=this._getPlaybackSessionOptions(),o=new c.N(this._systemInterface,n);o.metricBus.bandwidthEstimation.on(this,e=>{eH._LAST_BANDWIDTH=e}),await this._player.setRateWhenReady(1);let a=e.url;this._drmConfig=null===(r=e.drm)||void 0===r?void 0:r[0],"number"==typeof t&&t>0?await this._player.setPositionWhenReady(t/1e3):"START_OVER"===t?i=!1:"LIVE_EDGE"===t&&(i=!0);let s=eF.create(this._systemInterface,a,this._drmConfig,{periodsFlattening:!0,timeoutMS:1e4});void 0!==this._displaySwapper&&this._player.onPeriodLoaded.once(this,this._maybeChangeDisplayMode.bind(this)),this._player.onPeriodLoaded.on(this,e=>this._handlePeriodLoad(e)),this._requestFilters.add(this._cdnRequestFilter),this._player.attach(o,s.load(),{startAtLivePoint:i}).then(()=>{this._ensureSessionAttached()}).catch(e=>{this._errorManager.reportError(e)})}_ensureSessionAttached(){var e;let t=null===(e=this._player.getSession())||void 0===e?void 0:e.getLoadedBuffer();void 0!==t&&(this._handleContentRangeChange(t.getContentRange()),t.onContentRangeChange.off(this),t.onContentRangeChange.on(this,e=>this._handleContentRangeChange(e)))}_getPeriodIndex(e){var t,r,i;return(null!==(i=null===(r=null===(t=this._player.getSession())||void 0===t?void 0:t.getLoadedBuffer())||void 0===r?void 0:r.getPeriods())&&void 0!==i?i:[]).findIndex(t=>t.id===e.id)}_getPlaybackSessionOptions(){var e,t,r,i,n,o,a,s,u,c,d,l,p,f,_,v;let m=new h.Y(w);if(m.abrOptions=null!==(e=m.abrOptions)&&void 0!==e?e:{},m.variantsToSizeOptions=null!==(t=m.variantsToSizeOptions)&&void 0!==t?t:{},m.bufferOptions=null!==(r=m.bufferOptions)&&void 0!==r?r:{},(null===(i=this._config.networkRequestRetry)||void 0===i?void 0:i.bufferRetryLogic)&&(m.bufferRetryLogic=this._config.networkRequestRetry.bufferRetryLogic),(null===(n=this._config.bufferOptions)||void 0===n?void 0:n.noAudio)!==void 0&&(m.bufferOptions.noAudio=this._config.bufferOptions.noAudio),void 0!==this._config.initialBandwidthFactor){let e=eH._LAST_BANDWIDTH,t=Math.max(0,Math.min(1,this._config.initialBandwidthFactor));(null===(o=this._config.abrOptions)||void 0===o?void 0:o.initialBandwidth)&&void 0===e&&(m.abrOptions.initialBandwidth=(null===(a=this._config.abrOptions)||void 0===a?void 0:a.initialBandwidth)*t),void 0!==e&&(m.abrOptions.initialBandwidth=e*t)}return(null===(s=this._config.abrOptions)||void 0===s?void 0:s.bandwidthForecastPolicy)&&(m.abrOptions.bandwidthForecastPolicy=null===(u=this._config.abrOptions)||void 0===u?void 0:u.bandwidthForecastPolicy),(null===(c=this._config.abrOptions)||void 0===c?void 0:c.maxBandwidth)&&(m.abrOptions.maxBandwidth=null===(d=this._config.abrOptions)||void 0===d?void 0:d.maxBandwidth),(null===(l=this._config.abrOptions)||void 0===l?void 0:l.protocol)&&(m.abrOptions.protocol=null===(p=this._config.abrOptions)||void 0===p?void 0:p.protocol),(null===(f=this._config.resolutionOverrides)||void 0===f?void 0:f.maxResolution)!==void 0?m.variantsToSizeOptions.maxSize=this._config.resolutionOverrides.maxResolution:m.variantsToSizeOptions.capToSize=!0,(null===(_=this._config.resolutionOverrides)||void 0===_?void 0:_.minResolution)!==void 0&&(m.variantsToSizeOptions.minSize=this._config.resolutionOverrides.minResolution),(null===(v=this._config.resolutionOverrides)||void 0===v?void 0:v.failWhenOutOfBounds)!==void 0?m.variantsToSizeOptions.fallbackToNearest=!this._config.resolutionOverrides.failWhenOutOfBounds:m.variantsToSizeOptions.fallbackToNearest=!0,m}_getSystemInterface(){let e=this._config.supportedVideoCodecs,t=this._config.supportedAudioCodecs,r=this._config.workaroundOptions?{multiPeriod:this._config.workaroundOptions.multiPeriod,stallSkipping:this._config.workaroundOptions.stallSkipping,seekOnTrackChange:this._config.workaroundOptions.seekOnTrackChange,safeSeek:this._config.workaroundOptions.safeSeek,injectPsshIntoInitSegments:this._config.workaroundOptions.injectPsshIntoInitSegments}:void 0;return new C({modifyNetworkRequest:e=>{var t,r;e.type===m.p.LICENSE&&(this._config.licenseRequestTimeout&&(e.timeoutMS=this._config.licenseRequestTimeout),(null===(t=this._drmConfig)||void 0===t?void 0:t.provider)===g.uZ.CONAX&&(null===(r=this._drmConfig)||void 0===r?void 0:r.token)&&l.NetworkHelpers.setLicenseHeaderValue(e,"Preauthorization",this._drmConfig.token)),this._requestFilters.forEach(t=>t(e))},keyTypeResolver:w,supportedHdrModes:e?function(){let t=[];return e.dvh&&t.push(v.K.DVH),e.hevcHdr&&t.push(v.K.HEVC_HDR),t}:void 0,canPlayDolbyAtmos:t?function(){return t.atmos}:void 0,supportedKeySystems:this._getSupportedKeySystems(),usePrefixedEme:this._config.usePrefixedEme,requireSingleKey:this._config.requireSingleKey,workaroundOptions:r},this._config.hdcpConfig)}_getSupportedKeySystems(){return[f.v.PLAYREADY_SL3000,f.v.PLAYREADY,f.v.WIDEVINE,f.v.FAIRPLAY_2_0,f.v.CLEARKEY]}_handleContentRangeChange(e){var t,r,i,n;this._maybeEmitDuration(e),this._isLive$.next(null===(t=this._player.getSession())||void 0===t?void 0:t.isLive),(null!==(n=null===(i=null===(r=this._player.getSession())||void 0===r?void 0:r.getLoadedBuffer())||void 0===i?void 0:i.getPeriods())&&void 0!==n?n:[]).forEach(e=>{this._handledTimedEventsPeriod.has(e.id)||(this._handledTimedEventsPeriod.add(e.id),e.events.forEach(e=>{this._handleTimedEvent(e)}))})}_maybeEmitDuration(e){var t,r,i;if(void 0!==e){this._liveStart$.next(null===(t=this._player.getSession())||void 0===t?void 0:t.getLiveStart()),this._lastEmittedDuration=e;let n=null!==(i=null===(r=this._player.getSession())||void 0===r?void 0:r.getLiveEdge())&&void 0!==i?i:e.end;this._streamDuration$.next({start:0,end:(n-e.start)*1e3})}}_applyTracksPreferences(){let e=this._player.getSession();if(e){let t=void 0!==this._textTrackPreference;this._player.setTextEnabled(t),e.setTrackPreferences(this._getTracksPreferences()).catch(e=>{this._errorManager.reportError(e)})}}_getTracksPreferences(){let e=[];return this._audioTrackPreference&&e.push(this._audioTrackPreference),this._textTrackPreference&&e.push(this._textTrackPreference),e}_populateAudioTracks(e){let t=[],r=e.audio,i=r.length;for(let e=0;e<i;e++){let i=r[e],n=g.uS.PROGRAM;i.attributes===_._.AUDIODESCRIPTION&&(n=g.uS.DESCRIPTIVE),t.push({role:n,language:i.language})}return t}_populateTextTracks(e){var t;let r=[],i=e.text,n=i.length;for(let e=0;e<n;e++){let t=i[e],n=g.mO.SUBTITLE;switch(t.attributes){case _._.TEXTCAPTION:n=g.mO.CLOSED_CAPTION;break;case _._.TEXTFORCEDSUBTITLE:n=g.mO.FORCED}r.push({role:n,language:t.language,format:g.vy.WEBVTT})}if(e.video.length>0){let i=null!==(t=e.video[0].embeddedCaptions)&&void 0!==t?t:[],n=i.length;for(let e=0;e<n;e++){let t=i[e];r.push({role:g.mO.CLOSED_CAPTION,language:t.language,format:g.vy.CEA_608})}}return r}_setPlaybackState(e){this._playbackState!==e&&(this._playbackState=e,this._playbackState$.next(this._playbackState))}_setDroppedFrames(e){void 0!==e&&void 0!==this._totalFrames&&this._totalFrames>0&&this._droppedFrames!==e&&(this._droppedFrames=e,this._droppedFrames$.next(this._droppedFrames))}_setTotalFrames(e){void 0!==e&&e>0&&this._totalFrames!==e&&(this._totalFrames=e,this._totalFrames$.next(this._totalFrames))}_setBufferedRange(e){void 0!==e&&this._bufferedRange!==e&&(this._bufferedRange=e,this._bufferedRange$.next(this._bufferedRange))}_setAudioDetails(e){var t;if(void 0!==e){let r=null!==(t=e.bandwidth)&&void 0!==t?t:0;this._audioBitrateBps!==r&&(this._audioBitrateBps=r,this._audioBitrateBps$.next(this._audioBitrateBps)),this._audioTrackLanguage!==e.language&&(this._audioTrackLanguage=e.language,this._audioTrackLanguage$.next(this._audioTrackLanguage));let i=this._calculateAudioCodecData(e);(void 0===this._audioCodec||i.audioCodec!==this._audioCodec.audioCodec||i.isSpatial!==this._audioCodec.isSpatial)&&(this._audioCodec=i,this._audioCodec$.next(i))}}_calculateAudioCodecData(e){if(void 0===e.codecs)return{};{let t=new d.CodecUtil().getAudioGroup(e)===eV.j.EC3_ATMOS;return{audioCodec:e.codecs,isSpatial:t}}}_setTextDetails(e){void 0!==e&&(this._textTrackFormat!==e.mimeType&&(this._textTrackFormat=e.mimeType,this._textTrackFormat$.next(this._textTrackFormat)),this._textTrackLanguage!==e.language&&(this._textTrackLanguage=e.language,this._textTrackLanguage$.next(this._textTrackLanguage)))}_setVideoDetails(e){var t,r,i;if(void 0!==e){let n=null!==(t=e.bandwidth)&&void 0!==t?t:0,o={height:null!==(r=e.height)&&void 0!==r?r:0,width:null!==(i=e.width)&&void 0!==i?i:0};this._videoBitrateBps!==n&&(this._videoBitrateBps=n,this._videoBitrateBps$.next(this._videoBitrateBps)),(void 0===this._videoSize||this._videoSize.height!==o.height||this._videoSize.width!==o.width)&&(this._videoSize=o,this._videoSize$.next(this._videoSize));let a=this._calculateVideoCodecData(e);(void 0===this._videoCodec||this._videoCodec.videoCodec!==a.videoCodec||this._videoCodec.colorGamut!==a.colorGamut)&&(this._videoCodec=a,this._videoCodec$.next(a))}}_calculateVideoCodecData(e){if(void 0===e.codecs)return{};{let t=g.dH.UNKNOWN;switch(new d.CodecUtil().getVideoGroup(e)){case"avc":t=g.dH.SDR;break;case"hevc-hdr":t=g.dH.HDR10;break;case"dvh":t=g.dH.DOLBY_VISION;break;default:t=g.dH.UNKNOWN}return{videoCodec:e.codecs,colorGamut:t}}}async _clearPlayItem(){var e;this._lastEmittedDuration=void 0,this._availableTracks=void 0,this._drmConfig=void 0,this._droppedFrames=void 0,this._totalFrames=void 0,this._bufferedRange=void 0,this._audioBitrateBps=void 0,this._audioCodec=void 0,this._audioTrackLanguage=void 0,this._textTrackFormat=void 0,this._textTrackLanguage=void 0,this._videoBitrateBps=void 0,this._videoCodec=void 0,this._videoSize=void 0,this._handledTimedEventsPeriod.clear(),this._changedDisplayMode&&void 0!==this._displaySwapper&&(await this._displaySwapper.requestDisplayMode("SDR"),this._changedDisplayMode=!1),this._removeBufferPhaseListener();try{let t=await this._player.detach();void 0!==t&&(t.metricBus.bandwidthEstimation.off(this),null===(e=t.getLoadedBuffer())||void 0===e||e.onContentRangeChange.off(this),await t.unload())}catch(e){this._errorManager.reportError(e)}this._player.onStateChanged.off(this),this._player.onError.off(this),this._player.onWarning.off(this),this._player.onTextCueChange.off(this),this._player.onPeriodLoaded.off(this),this._player.onReceiveTimedEvent.off(this),this._stopPositionReporting()}_queueLoadPromise(e){return this._loadPromiseChain.runWithoutReturn({type:"QueueLoad"},e)}_startPositionReporting(){void 0===this._positionReportingTimer&&(this._handlePositionReporting(),this._positionReportingTimer=window.setInterval(()=>{this._handlePositionReporting()},250))}_stopPositionReporting(){void 0!==this._positionReportingTimer&&(window.clearInterval(this._positionReportingTimer),this._positionReportingTimer=void 0)}_handlePositionReporting(){this._lastEmittedDuration&&this._streamCurrentTime$.next((this._currentPosition-this._lastEmittedDuration.start)*1e3)}_handleTracksChange(e){this._availableTracks={engineAudioTracks:this._populateAudioTracks(e),engineTextTracks:this._populateTextTracks(e),enginePositionMs:1e3*this._currentPosition,enginePeriodIndex:this._getPeriodIndex(e)},this._availableTracks$.next(this._availableTracks)}_handlePeriodLoad(e){this._handleTracksChange(e),this._ensureSessionAttached(),this._videoPeriod$.next({})}_removeBufferPhaseListener(){var e,t;null===(t=null===(e=this._player.getSession())||void 0===e?void 0:e.getLoadedBuffer())||void 0===t||t.onBufferItemPhaseChange.off(this)}_checkBufferPhaseChangeForHdr(e){if(e.pipeline.type!==p.j.VIDEO)return;let t=e.pipeline.getSourceType(),r=this._config.supportedVideoCodecs;if(void 0!==this._displaySwapper&&void 0!==r&&void 0!==t&&(!0===r.dvh||!0===r.hevcHdr)){let e;let r=new d.CodecUtil().getVideoGroup(t);r===v.K.DVH?e="DOVI":r===v.K.HEVC_HDR&&(e="HDR10"),void 0!==e&&(this._changedDisplayMode=!0,this._displaySwapper.requestDisplayMode(e).catch(e=>{this._errorManager.reportGluonError(e)}))}this._removeBufferPhaseListener()}_maybeChangeDisplayMode(){var e,t;null===(t=null===(e=this._player.getSession())||void 0===e?void 0:e.getLoadedBuffer())||void 0===t||t.onBufferItemPhaseChange.on(this,this._checkBufferPhaseChangeForHdr.bind(this))}_handlePlayerStateChange(e){var t;switch(void 0!==e.videoState&&(this._currentPosition=e.videoState.currentTime,this._setTotalFrames(e.videoState.totalVideoFrames),this._setDroppedFrames(e.videoState.droppedVideoFrames),this._setBufferedRange(null!==(t=e.videoState.buffered)&&void 0!==t?t:void 0)),void 0!==e.variant&&(this._setVideoDetails(e.variant.videoDetails),this._setAudioDetails(e.variant.audioDetails),this._setTextDetails(e.variant.textDetails)),e.playbackState){case s.q.ENDED:this._setPlaybackState(g.wo.ENDED);break;case s.q.SEEKING:this._setPlaybackState(g.wo.SEEKING);break;case s.q.STALLED:this._setPlaybackState(g.wo.BUFFERING);break;default:if(void 0!==e.videoState&&e.playbackState===s.q.READY){this._playbackState===g.wo.PREPARING&&this._setPlaybackState(g.wo.PREPARED);let t=e.videoState.playbackRate>0?g.wo.PLAYING:g.wo.PAUSED;this._setPlaybackState(t)}}}_handleTimedEvent(e){if(e.type===o.o.SCHEME){let t={encodingType:e.encoding,rawValue:e.value,type:e.schemeIdUri};this._timedMetadata$.next(t)}}static create(e,t={},r){let i=document.createElement("video");return i.setAttribute("data-testId","VideoElement"),new this(e,i,t,r)}}class ej{constructor(e,t){this._config=e,this._displaySwapper=t}create(e){return eH.create(e,this._config,this._displaySwapper)}}},95814:function(e,t,r){"use strict";r.d(t,{n:function(){return q}});var i,n,o=r(92132),a=r(2176),s=r(89873),u=r(58591),c=r(94662),d=r(55547),l=r(37594),h=r(42216),p=r(22970),f=r(75618),_=r(21111),v=r(58611);function m(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(!0===t){e();return}if(!1!==t){var n=new _.Hp({next:function(){n.unsubscribe(),e()}});return t.apply(void 0,(0,p.__spreadArray)([],(0,p.__read)(r))).subscribe(n)}}function g(e,t,r){var i,n,o,s,u,c,d,l,p,g,y,S,E,b=!1;return e&&"object"==typeof e?(E=void 0===(g=e.bufferSize)?1/0:g,t=void 0===(y=e.windowTime)?1/0:y,b=void 0!==(S=e.refCount)&&S,r=e.scheduler):E=null!=e?e:1/0,o=void 0===(n=(i={connector:function(){return new h.t(E,t,r)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:b}).connector)?function(){return new a.x}:n,u=void 0===(s=i.resetOnError)||s,d=void 0===(c=i.resetOnComplete)||c,p=void 0===(l=i.resetOnRefCountZero)||l,function(e){var t,r,i,n=0,a=!1,s=!1,c=function(){null==r||r.unsubscribe(),r=void 0},l=function(){c(),t=i=void 0,a=s=!1},h=function(){var e=t;l(),null==e||e.unsubscribe()};return(0,v.e)(function(e,v){n++,s||a||c();var g=i=null!=i?i:o();v.add(function(){0!=--n||s||a||(r=m(h,p))}),g.subscribe(v),!t&&n>0&&(t=new _.Hp({next:function(e){return g.next(e)},error:function(e){s=!0,c(),r=m(l,u,e),g.error(e)},complete:function(){a=!0,c(),r=m(l,d),g.complete()}}),(0,f.Xf)(e).subscribe(t))})(e)}}var y=r(89907);let S=[{codec:'video/mp4; codecs="hev1.1.6.H156.B0"',profile:"main10",level:"5.2"},{codec:'video/mp4; codecs="hev1.1.6.H153.B0"',profile:"main10",level:"5.1"},{codec:'video/mp4; codecs="hev1.1.6.H150.B0"',profile:"main10",level:"5"},{codec:'video/mp4; codecs="hev1.1.6.H123.B0"',profile:"main10",level:"4.1"},{codec:'video/mp4; codecs="hev1.1.6.H120.B0"',profile:"main10",level:"4"},{codec:'video/mp4; codecs="hev1.1.6.L156.B0"',profile:"main",level:"5.2"},{codec:'video/mp4; codecs="hev1.1.6.L153.B0"',profile:"main",level:"5.1"},{codec:'video/mp4; codecs="hev1.1.6.L150.B0"',profile:"main",level:"5"},{codec:'video/mp4; codecs="hev1.1.6.L123.B0"',profile:"main",level:"4.1"},{codec:'video/mp4; codecs="hev1.1.6.L120.B0"',profile:"main",level:"4"},{codec:'video/mp4; codecs="hev1.1.6.L93.B0"',profile:"main",level:"3.1"},{codec:'video/mp4; codecs="hev1.1.6.L90.B0"',profile:"main",level:"3"},{codec:'video/mp4; codecs="hev1.1.6.L63.B0"',profile:"main",level:"2.1"},{codec:'video/mp4; codecs="hev1.1.6.L60.B0"',profile:"main",level:"2"},{codec:'video/mp4; codecs="hev1.1.6.L30.B0"',profile:"main",level:"1"}];o.iL.H265;let E=[{codec:'video/mp4; codecs="avc1.640034"',profile:"high",level:"5.2"},{codec:'video/mp4; codecs="avc1.640033"',profile:"high",level:"5.1"},{codec:'video/mp4; codecs="avc1.640032"',profile:"high",level:"5"},{codec:'video/mp4; codecs="avc1.64002a"',profile:"high",level:"4.2"},{codec:'video/mp4; codecs="avc1.640029"',profile:"high",level:"4.1"},{codec:'video/mp4; codecs="avc1.640028"',profile:"high",level:"4"},{codec:'video/mp4; codecs="avc1.640020"',profile:"high",level:"3.2"},{codec:'video/mp4; codecs="avc1.64001f"',profile:"high",level:"3.1"},{codec:'video/mp4; codecs="avc1.64001e"',profile:"high",level:"3"},{codec:'video/mp4; codecs="avc1.640016"',profile:"high",level:"2.2"},{codec:'video/mp4; codecs="avc1.640015"',profile:"high",level:"2.1"},{codec:'video/mp4; codecs="avc1.640014"',profile:"high",level:"2"},{codec:'video/mp4; codecs="avc1.64000d"',profile:"high",level:"1.3"},{codec:'video/mp4; codecs="avc1.64000c"',profile:"high",level:"1.2"},{codec:'video/mp4; codecs="avc1.64000b"',profile:"high",level:"1.1"},{codec:'video/mp4; codecs="avc1.64000a"',profile:"high",level:"1"},{codec:'video/mp4; codecs="avc1.4d0034"',profile:"main",level:"5.2"},{codec:'video/mp4; codecs="avc1.4d0033"',profile:"main",level:"5.1"},{codec:'video/mp4; codecs="avc1.4d0032"',profile:"main",level:"5"},{codec:'video/mp4; codecs="avc1.4d002a"',profile:"main",level:"4.2"},{codec:'video/mp4; codecs="avc1.4d0029"',profile:"main",level:"4.1"},{codec:'video/mp4; codecs="avc1.4d0028"',profile:"main",level:"4"},{codec:'video/mp4; codecs="avc1.4d0020"',profile:"main",level:"3.2"},{codec:'video/mp4; codecs="avc1.4d001f"',profile:"main",level:"3.1"},{codec:'video/mp4; codecs="avc1.4d001e"',profile:"main",level:"3"},{codec:'video/mp4; codecs="avc1.4d0016"',profile:"main",level:"2.2"},{codec:'video/mp4; codecs="avc1.4d0015"',profile:"main",level:"2.1"},{codec:'video/mp4; codecs="avc1.4d0014"',profile:"main",level:"2"},{codec:'video/mp4; codecs="avc1.4d000d"',profile:"main",level:"1.3"},{codec:'video/mp4; codecs="avc1.4d000c"',profile:"main",level:"1.2"},{codec:'video/mp4; codecs="avc1.4d000b"',profile:"main",level:"1.1"},{codec:'video/mp4; codecs="avc1.4d000a"',profile:"main",level:"1"},{codec:'video/mp4; codecs="avc1.420034"',profile:"baseline",level:"5.2"},{codec:'video/mp4; codecs="avc1.420033"',profile:"baseline",level:"5.1"},{codec:'video/mp4; codecs="avc1.420032"',profile:"baseline",level:"5"},{codec:'video/mp4; codecs="avc1.42002a"',profile:"baseline",level:"4.2"},{codec:'video/mp4; codecs="avc1.420029"',profile:"baseline",level:"4.1"},{codec:'video/mp4; codecs="avc1.420028"',profile:"baseline",level:"4"},{codec:'video/mp4; codecs="avc1.420020"',profile:"baseline",level:"3.2"},{codec:'video/mp4; codecs="avc1.42001f"',profile:"baseline",level:"3.1"},{codec:'video/mp4; codecs="avc1.42001e"',profile:"baseline",level:"3"},{codec:'video/mp4; codecs="avc1.420016"',profile:"baseline",level:"2.2"},{codec:'video/mp4; codecs="avc1.420015"',profile:"baseline",level:"2.1"},{codec:'video/mp4; codecs="avc1.420014"',profile:"baseline",level:"2"},{codec:'video/mp4; codecs="avc1.42000d"',profile:"baseline",level:"1.3"},{codec:'video/mp4; codecs="avc1.42000c"',profile:"baseline",level:"1.2"},{codec:'video/mp4; codecs="avc1.42000b"',profile:"baseline",level:"1.1"},{codec:'video/mp4; codecs="avc1.42000a"',profile:"baseline",level:"1"}];o.iL.H264;let b=[{codec:'audio/mp4; codecs="mp4a.40.2"',profile:"lc"},{codec:'audio/mp4; codecs="mp4a.40.5"',profile:"hev"},{codec:'audio/mp4; codecs="mp4a.40.29"',profile:"hev2"}];o.dg.AAC;let w=[{codec:'audio/mp4; codecs="ac-3";'}];o.dg.AC3;let P=[{codec:'audio/mp4; codecs="ec-3"'}];o.dg.EAC3;let T=[{keySystem:"com.apple.fps.3_0",version:"3.0",initDataTypes:["cenc"]},{keySystem:"com.apple.fps.2_0",version:"2.0",initDataTypes:["sinf"]},{keySystem:"com.apple.fps.1_0",version:"1.0",initDataTypes:["cenc"]}];class C{constructor(e){this._containerElement=e}async getCapabilities(){return{audioDecoders:await this._getAudioDecodingCapabilities(),displayProperties:await this._getDisplayProperties(),drmInfo:await this._getDrmCapabilities(),manifests:this._getManifestsCapabilities(),segments:this._getSegmentsCapabilities(),videoDecoders:this._getVideoDecodingCapabilities()}}async _getAudioDecodingCapabilities(){let e,t,r;let i=b.length;for(let t=0;t<i;t++){let r=b[t];this._isSupportedCodec(r.codec)&&(void 0===e?e={codec:o.dg.AAC,profiles:[r.profile]}:e.profiles.push(r.profile))}let n=w.length;for(let e=0;e<n;e++){let r=w[e];if(this._isSupportedCodec(r.codec)){t={codec:o.dg.AC3,profiles:[]};break}}let a=P.length;for(let e=0;e<a;e++){let t=P[e];if(this._isSupportedCodec(t.codec)){r={codec:o.dg.EAC3,profiles:["atmos"]};break}}return{aac:e,ac3:t,eac3:r}}async _getDisplayProperties(){let e=this._containerElement.offsetHeight,t=this._containerElement.offsetWidth,r=screen.height,i=screen.width;return{hdrCapabilities:await this._getHdrCapabilities(),playerViewHeight:e,playerViewWidth:t,screenHeight:r,screenWidth:i}}async _getDrmCapabilities(){return{cdm:{clearKey:!1,widevine:void 0,playready:void 0,fairplay:await this._getFairplaySupport()},hdcp:{negotiatedLevel:""}}}async _getHdrCapabilities(){return[o.ho.SDR]}_getManifestsCapabilities(){return{formats:{hls:{}}}}_getSegmentsCapabilities(){return{formats:{}}}_getVideoDecodingCapabilities(){return{h264:this._getVideoCodecSupport(E,o.iL.H264),h265:this._getVideoCodecSupport(S,o.iL.H265)}}_getFairplaySupport(){return void 0===this._cachedFairplayCdmSupport&&(this._cachedFairplayCdmSupport=this._getFairplayCdmSupport()),this._cachedFairplayCdmSupport}async _getFairplayCdmSupport(){let e=T.length;for(let t=0;t<e;t++){let e=T[t];if(await this._isSupportedKeySystem(e.keySystem,[{initDataTypes:e.initDataTypes,audioCapabilities:[],videoCapabilities:[{contentType:'video/mp4;codecs="avc1.42E01E"'}]}]))return{version:e.version}}}async _isSupportedKeySystem(e,t){try{return await window.navigator.requestMediaKeySystemAccess(e,t),!0}catch(e){return!1}}_getVideoCodecSupport(e,t){let r;let i=e.length;for(let n=0;n<i;n++){let i=e[n];!(void 0!==r&&r.profiles.includes(i.profile))&&this._isSupportedCodec(i.codec)&&(void 0===r?r={codec:t,maxLevel:i.level,profiles:[i.profile]}:r.profiles.push(i.profile))}return r}_isSupportedCodec(e){try{return window.MediaSource.isTypeSupported(e)}catch{return!1}}}class M{constructor(e,t){this._error$=e,this._warning$=t}reportError(e){this._error$.next({errorCode:e.code,errorMessage:e.data,stackTrace:e.stackTrace,httpContext:void 0})}reportWarning(e){this._warning$.next({errorCode:e.code,errorMessage:e.data,stackTrace:e.stackTrace,httpContext:void 0})}}class k{constructor(e=100){this._seenMetadata=new Set,this._memorySize=e}getMetadata(e,t,r,i){if(e){let n=e.length;for(let o=0;o<n;o++){let n=e[o];if(n.value.key===t){let e=n.value.data;this._seenMetadata.has(e)||i.unshift({type:r,encodingType:"base64",rawValue:e}),this._seenMetadata.add(e),this._seenMetadata.size>this._memorySize&&this._seenMetadata.delete(this._seenMetadata.values().next().value)}}}}}(i=n||(n={})).SERVER_CERTIFICATE_REQUEST_FAILURE="1I-1001",i.LICENSE_REQUEST_FAILURE="1I-2001",i.INIT_DATA_ERROR="1I-3001",i.WEBKIT_KEY_ERROR="1I-4001",i.VIDEO_ELEMENT_GENERAL=" 1I-10001",i.PLAY_CALL_ERROR="1I-11001";let A=async e=>fetch(e).then(e=>e.ok?e.arrayBuffer():Promise.reject({code:n.SERVER_CERTIFICATE_REQUEST_FAILURE,data:`HTTP code: ${e.status}`})).then(e=>new Uint8Array(e)).catch(e=>Promise.reject({code:n.SERVER_CERTIFICATE_REQUEST_FAILURE,data:`Error: ${JSON.stringify(e)}`})),x=({licenseServerUrl:e,drmToken:t,message:r})=>fetch(e,{method:"POST",headers:{"Content-Type":"application/octet-stream",Accept:"application/json",...t?{PreAuthorization:t}:{}},body:r}).then(e=>200===e.status?e.json():Promise.reject({code:n.LICENSE_REQUEST_FAILURE,data:`HTTP code: ${e.status}`})).catch(e=>Promise.reject({code:n.LICENSE_REQUEST_FAILURE,data:`Error: ${JSON.stringify(e)}`})),D=e=>ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e),R=e=>new Uint16Array(new ArrayBuffer(2*e.length)).map((t,r)=>e.charCodeAt(r)),O=(e,t)=>{let r=new TextDecoder("utf-16").decode(e);if(t===o.uZ.CONAX)return{assetId:R(window.atob(r.split("skd://")[1].split("?")[0])),initData:e};let i=r.split("skd://")[1];return{assetId:R(i.split("?")[1]),licenseServerUrl:"https://"+i,initData:e}},I=(e,t,r)=>{let i=(ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)).slice(4),n=new ArrayBuffer(12+i.byteLength+r.byteLength+e.byteLength),o=0,a=e=>{new DataView(n).setUint32(o,e.byteLength,!0),new Uint8Array(n,o+=4,e.byteLength).set(ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)),o+=e.byteLength};return a(i),a(r),a(e),n},U=e=>{let t=window.atob(e);return Uint8Array.from(t,e=>e.charCodeAt(0))},B=e=>{},L=e=>{let t=[],r=e.length;for(let i=0;i<r;i++){let r,n;let a=e[i],{mode:s,kind:u,language:c}=a;if("hidden"!==s&&(a.mode="hidden"),c){if("subtitles"===u)r=o.mO.SUBTITLE,n=o.vy.WEBVTT;else{if("captions"!==u)continue;r=o.mO.CLOSED_CAPTION,n=o.vy.CEA_608}t.push({role:r,language:a.language,format:n})}}return t},N=e=>[].slice.call(e).filter(({kind:e})=>"metadata"===e).map(e=>("hidden"!==e.mode&&(e.mode="hidden"),e)),F=(e,t)=>{let r=[],i=e.length;for(let t=0;t<i;t++){let i=e[t],n=o.uS.PROGRAM;"qis"===i.language&&(n=o.uS.AMBIENT_SOUND),r.push({role:n,language:i.language,label:i.label})}return r.filter((e,r,i)=>{if(i.some((t,i)=>i!==r&&t.role===e.role&&t.language===e.language)){let r=e.label.toLowerCase().includes("atmos");return t?r:!r}return!0})},W=(e,t)=>{let r;for(let i=0;i<e.length;i++){let n=e[i];t&&n.language===t.language?(n.mode="hidden",r=n):"metadata"===n.kind?n.mode="hidden":"disabled"!==n.mode&&(n.mode="disabled")}return r},V=(e,t,r,i,n,a,s)=>{let{initData:u}=e;if(!u){B("init data missing in webkitneedkey event");return}let{assetId:c,licenseServerUrl:d}=O(u,a),l=D(I(r,u,c)),h=s.createSession(t,l);if(!h){B("could not create key session");return}let p=e=>{let t="verizon"===a?d:i;if(!t){B("licenseServerUrl not found");return}x({licenseServerUrl:t,drmToken:n||"",message:e.message}).then(e=>{let t;return t=a!==o.uZ.VERIZON?U(e.CkcMessage):U(e.ckc),h.update(t)}).catch(e=>{B(`error fetching license = ${e}`)})};return h.addEventListener("webkitkeymessage",p,!1),()=>{h.removeEventListener("webkitkeymessage",p)}},H=(e,t,r,i,n)=>{let o=e?e.engineTextTracks:[],a=e?e.engineAudioTracks:[];return"text"===t?o=L(r):"audio"===t&&(a=F(r,i)),{engineTextTracks:o,engineAudioTracks:a,enginePositionMs:1e3*n}},j=e=>{let t=e.indexOf("<");for(;t>=0;){let r=e.indexOf(">",t);if(-1===r)break;t=(e=e.substring(0,t)+e.substring(r+1)).indexOf("<")}return e.replace(/&(lt|gt|nbsp|amp);/g,(e,t)=>{switch(t){case"lt":return"<";case"gt":return">";case"nbsp":return" ";case"amp":return"&";default:return""}}).trim()};class K{constructor(e,t){this._activeTextCues$=new a.x,this.activeTextCues$=this._activeTextCues$.asObservable(),this._audioBitrateBps$=new a.x,this.audioBitrateBps$=this._audioBitrateBps$.asObservable(),this._audioCodec$=new a.x,this.audioCodec$=this._audioCodec$.asObservable(),this._audioTrackLanguage$=new a.x,this.audioTrackLanguage$=this._audioTrackLanguage$.asObservable(),this._availableTracks$=new a.x,this.availableTracks$=this._availableTracks$.asObservable(),this._bandwidth$=new a.x,this.bandwidth$=this._bandwidth$.asObservable(),this._bufferedRange$=new a.x,this.bufferedRange$=this._bufferedRange$.asObservable(),this._cdn$=new a.x,this.cdn$=this._cdn$.asObservable(),this._currentPDT$=new a.x,this.currentPDT$=this._currentPDT$.asObservable(),this._droppedFrames$=new a.x,this.droppedFrames$=this._droppedFrames$.asObservable(),this._error$=new a.x,this.error$=this._error$.asObservable(),this._isLive$=new a.x,this.isLive$=this._isLive$.asObservable(),this._liveEnd$=new a.x,this.liveEnd$=this._liveEnd$.asObservable(),this._livePresentationStartTime$=new a.x,this.livePresentationStartTime$=this._livePresentationStartTime$.asObservable(),this._playbackLicenseExpired$=new a.x,this.playbackLicenseExpired$=this._playbackLicenseExpired$.asObservable(),this._playbackState$=new a.x,this.playbackState$=this._playbackState$.asObservable(),this._seekableRange$=new a.x,this.seekableRange$=this._seekableRange$.asObservable(),this._selectedAudioTrack$=new a.x,this.selectedAudioTrack$=this._selectedAudioTrack$.asObservable(),this._selectedTextTrack$=new a.x,this.selectedTextTrack$=this._selectedTextTrack$.asObservable(),this._streamCurrentTime$=new a.x,this.streamCurrentTime$=this._streamCurrentTime$.asObservable(),this._textTrackFormat$=new a.x,this.textTrackFormat$=this._textTrackFormat$.asObservable(),this._textTrackLanguage$=new a.x,this.textTrackLanguage$=this._textTrackLanguage$.asObservable(),this._timedMetadata$=new a.x,this.timedMetadata$=this._timedMetadata$.asObservable(),this._timedMetadataTracks$=new a.x().asObservable(),this._metadataReader=new k,this._totalFrames$=new a.x,this.totalFrames$=this._totalFrames$.asObservable(),this._videoBitrateBps$=new a.x,this.videoBitrateBps$=this._videoBitrateBps$.asObservable(),this._videoCodec$=new a.x,this.videoCodec$=this._videoCodec$.asObservable(),this._availableVideoPeriods$=new a.x,this.availableVideoPeriods$=this._availableVideoPeriods$.asObservable(),this._videoPeriod$=new a.x,this.videoPeriod$=this._videoPeriod$.asObservable(),this._videoSize$=new a.x,this.videoSize$=this._videoSize$.asObservable(),this._volume$=new a.x,this.volume$=this._volume$.asObservable(),this._warning$=new a.x,this.warning$=this._warning$.asObservable(),this._playbackState=o.wo.CLOSED,this._errorManager=new M(this._error$,this._warning$),this._subscriptions=[],this._currentPosition=0,this._isDeviceAtmosCapable=!1,this._textTrackCueSubscribers={},this._videoElement=t,e.appendChild(this._videoElement),this.setResizeMode("contain"),this._capabilitiesProvider=new C(e),this._removeEventListeners$=new a.x,this._internalPlaying$=new a.x,this._internalTimeUpdate$=new a.x,this._internalWaiting$=new a.x,this.streamDuration$=(0,s.R)(this._videoElement,"progress").pipe((0,d.U)(({target:e})=>{let t=e.seekable,r=t.length-1;return{start:0,end:(t.end(r)-t.start(0))*1e3}}),(0,l.x)(function(e,t){return e.end===t.end}),g(1))}getPlayerVersion(){return"0.0.1"}getPlayerName(){return"SAFARI_BROWSER"}async load(e,t){if(this._reset(),this._setPlaybackState(o.wo.PREPARING),this._metadataReader=new k,this._setupVideoElementEventListeners(),"START_OVER"===t)this._videoElement.currentTime=.1;else if("LIVE_EDGE"===t){let e=this._videoElement.duration;isNaN(e)&&(e=0),this._videoElement.currentTime=e}else this._videoElement.currentTime=t/1e3;if(e&&e.drm&&e.drm.length>0){let t="com.apple.fps.1_0",r="video/mp4";if(!window.WebKitMediaKeys.isTypeSupported(t,r)){this._errorManager.reportError({code:n.WEBKIT_KEY_ERROR,data:`key system "${t}", "${r}" not supported`,stackTrace:Error().stack||""});return}if(this._videoElement.webkitSetMediaKeys(new window.WebKitMediaKeys(t)),!this._videoElement.webkitKeys){this._errorManager.reportError({code:n.WEBKIT_KEY_ERROR,data:"unable to set MediaKeys",stackTrace:Error().stack||""});return}let{certificateUrl:i,licenseServerUrl:a,token:s,provider:u}=e.drm[0];if(!i){this._errorManager.reportError({code:n.SERVER_CERTIFICATE_REQUEST_FAILURE,data:"no certificateUrl",stackTrace:Error().stack||""});return}A(i).then(t=>{let i=e=>{let i=V(e,r,t,a||"",s||"",u||o.uZ.CONAX,this._videoElement.webkitKeys);i&&this._subscriptions.push(this._removeEventListeners$.subscribe(i))};this._videoElement.addEventListener("webkitneedkey",i,!1),this._subscriptions.push(this._removeEventListeners$.subscribe(()=>{this._videoElement.removeEventListener("webkitneedkey",i)})),this._initiatePlayback(e.url)}).catch(e=>{this._errorManager.reportError({code:n.SERVER_CERTIFICATE_REQUEST_FAILURE,data:`error fetching FairPlay license = ${JSON.stringify(e)}`,stackTrace:e.stack||Error().stack||""})})}else this._initiatePlayback(e.url)}play(){this._videoElement.play().catch(e=>{this._errorManager.reportWarning({code:n.PLAY_CALL_ERROR,data:`play() on video element error = ${JSON.stringify(e)}`,stackTrace:e.stack||Error().stack||""})})}pause(){this._videoElement.pause()}seek(e){this._setPlaybackState(o.wo.SEEKING),this._videoElement.currentTime=e/1e3}selectAudioTrack(e){B(`SafariPlaybackEngine.selectAudioTrack audioTrackSelection = ${e}`);let t=this._videoElement.audioTracks;for(let r=0;r<t.length;r++){let i=t[r];i.enabled=!!e&&i.language===e.language}this._selectedAudioTrack$.next(e)}selectTextTrack(e){B(`SafariPlaybackEngine.selectTextTrack textTrackSelection = ${e}`);let t=W(this._videoElement.textTracks,e);this._setupTextTrackCues(t),this._selectedTextTrack$.next(e)}setResizeMode(e){switch(B(`SafariPlaybackEngine.setResizeMode mode = ${e}`),e){case"contain":this._videoElement.style.height="100%",this._videoElement.style.width="100%";break;case"scale":this._videoElement.style.height="",this._videoElement.style.width="100%"}}setVolume(e){this._videoElement.volume=e}stop(){this._reset()}destroy(){var e;null===(e=this._videoElement.parentElement)||void 0===e||e.removeChild(this._videoElement),this._reset(),this._removeEventListeners$.complete(),this._internalPlaying$.complete(),this._internalTimeUpdate$.complete(),this._internalWaiting$.complete()}_reset(){this._videoElement.src="",this._videoElement.removeAttribute("src"),this._removeEventListeners$.next(void 0),void 0!==this._positionReportingTimer&&(window.clearInterval(this._positionReportingTimer),this._positionReportingTimer=void 0),this._subscriptions.forEach(e=>e.unsubscribe())}getEngineCapabilities(){return this._capabilities?Promise.resolve(this._capabilities):this._capabilitiesProvider.getCapabilities().then(e=>(void 0!==e.audioDecoders.eac3&&e.audioDecoders.eac3.profiles.includes("atmos")&&(this._isDeviceAtmosCapable=!0),this._capabilities=e,this._capabilities))}getVideoElement(){return this._videoElement}async getThumbnailUrl(e,t,r){B(`SafariPlaybackEngine.getThumbnailUrl timeMs = ${e}, height = ${t} width = ${r}`)}static create(e){return new this(e,document.createElement("video"))}_setupTextTrackCues(e){if(e){let t=e.language+e.kind+e.label;if(!this._textTrackCueSubscribers[t]){let r=(0,s.R)(e,"cuechange").pipe((0,d.U)(()=>{let t=[].slice.call(null==e?void 0:e.activeCues).map(({text:e})=>e.split("\n").map(e=>({text:j(e),position:{positionAlignment:o.cu.CENTER,textAlignment:o.cu.CENTER}}))).flat();this._activeTextCues$.next(t)})).subscribe();this._textTrackCueSubscribers[t]=r,this._subscriptions.push(r)}}else this._activeTextCues$.next([])}_initiatePlayback(e){this._videoElement.setAttribute("playsinline",""),this._videoElement.src=e,this._videoElement.play().catch(e=>this._errorManager.reportWarning({code:n.PLAY_CALL_ERROR,data:`play() on video element error = ${JSON.stringify(e)}`,stackTrace:e.stack||Error().stack||""}))}_sendAvailableTracks(e,t){this._availableTracks=H(this._availableTracks,t,e.target,this._isDeviceAtmosCapable,this._currentPosition),this._availableTracks$.next(this._availableTracks)}_setupVideoElementEventListeners(){this._subscriptions.push((0,u.T)(this._internalPlaying$,this._internalWaiting$,this._internalTimeUpdate$).pipe((0,d.U)(()=>this._videoElement.readyState<=HTMLMediaElement.HAVE_CURRENT_DATA),(0,d.U)(e=>{e&&this._setPlaybackState(o.wo.BUFFERING)}),g(1)).subscribe(()=>{})),this._timedMetadataTracks$=(0,u.T)((0,s.R)(this._videoElement.textTracks,"addtrack"),(0,s.R)(this._videoElement.textTracks,"removetrack")).pipe((0,d.U)(()=>this._videoElement.textTracks),(0,d.U)(e=>N(e)),g(1)),this._subscriptions.push((0,c.a)(this._timedMetadataTracks$,this._internalTimeUpdate$).pipe((0,d.U)(([e])=>{let t=[];return e.forEach(e=>{this._metadataReader.getMetadata(e.cues,"X-COM-SPARX-INFO","com.sparx.sdk.breakEvent.v1",t)}),t}),(0,y.h)(e=>e.length>0),(0,l.x)(),g(1)).subscribe(e=>{this._timedMetadata$.next(e[0])})),this._subscriptions.push((0,u.T)((0,s.R)(this._videoElement.textTracks,"addtrack"),(0,s.R)(this._videoElement.textTracks,"removetrack")).pipe((0,d.U)(e=>this._sendAvailableTracks(e,"text")),g(1)).subscribe(()=>{})),this._subscriptions.push((0,u.T)((0,s.R)(this._videoElement.audioTracks,"addtrack"),(0,s.R)(this._videoElement.audioTracks,"removetrack")).pipe((0,d.U)(e=>this._sendAvailableTracks(e,"audio")),g(1)).subscribe(()=>{}));let e=()=>this._setPlaybackState(o.wo.PREPARED),t=()=>this._setPlaybackState(o.wo.SEEKING),r=()=>{this._setPlaybackState(o.wo.PLAYING),this._internalPlaying$.next(void 0)},i=()=>this._setPlaybackState(o.wo.PAUSED),a=()=>this._setPlaybackState(o.wo.ENDED),h=e=>this._internalWaiting$.next(void 0),p=e=>{this._errorManager.reportError({code:n.VIDEO_ELEMENT_GENERAL,data:`error thrown by video element ${JSON.stringify(e)}`,stackTrace:Error().stack||""}),this._setPlaybackState(o.wo.ERROR)},f=()=>{void 0===this._positionReportingTimer&&this._videoElement.currentTime>=0&&(this._handlePositionReporting(),this._positionReportingTimer=window.setInterval(()=>{this._handlePositionReporting()},250))};this._videoElement.addEventListener("canplay",e,!1),this._videoElement.addEventListener("seeking",t,!1),this._videoElement.addEventListener("playing",r,!1),this._videoElement.addEventListener("pause",i,!1),this._videoElement.addEventListener("timeupdate",f,!1),this._videoElement.addEventListener("ended",a,!1),this._videoElement.addEventListener("waiting",h,!1),this._videoElement.addEventListener("error",p,!1),this._subscriptions.push(this._removeEventListeners$.subscribe(()=>{this._videoElement.removeEventListener("loadeddata",e),this._videoElement.removeEventListener("seeking",t),this._videoElement.removeEventListener("playing",r),this._videoElement.removeEventListener("pause",i),this._videoElement.removeEventListener("timeupdate",f),this._videoElement.removeEventListener("ended",a),this._videoElement.removeEventListener("waiting",h),this._videoElement.removeEventListener("error",p)}))}_setPlaybackState(e){this._playbackState!==e&&(this._playbackState=e,this._playbackState$.next(this._playbackState))}_handlePositionReporting(){var e,t,r;if(this._internalTimeUpdate$.next(void 0),0===this._currentPosition){let i=(null===(e=this._videoElement)||void 0===e?void 0:e.getStartDate)!==void 0;if(this._isLive$.next(i),i){let e=null===(r=null===(t=this._videoElement)||void 0===t?void 0:t.getStartDate())||void 0===r?void 0:r.getTime();this._livePresentationStartTime$.next(e/1e3||0)}}this._currentPosition=this._videoElement.currentTime,this._streamCurrentTime$.next(1e3*this._currentPosition),this._liveEnd$.next(void 0)}}class q{constructor(){}create(e){return K.create(e)}}},35124:function(e,t,r){var i=r(39413),n=r(73620);function o(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}o.prototype=i(n.prototype),o.prototype.constructor=o,e.exports=o},45859:function(e,t,r){var i=r(39413),n=r(73620);function o(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}o.prototype=i(n.prototype),o.prototype.constructor=o,e.exports=o},49432:function(e){e.exports=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}},72517:function(e){e.exports=function(e,t){for(var r=-1,i=null==e?0:e.length;++r<i&&!1!==t(e[r],r,e););return e}},38333:function(e,t,r){var i=r(77832);e.exports=function(e,t){return!!(null==e?0:e.length)&&i(e,t,0)>-1}},60091:function(e,t,r){var i=r(13940),n=r(41225),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){var a=e[t];o.call(e,t)&&n(a,r)&&(void 0!==r||t in e)||i(e,t,r)}},67993:function(e,t,r){var i=r(752),n=r(90249);e.exports=function(e,t){return e&&i(t,n(t),e)}},55906:function(e,t,r){var i=r(752),n=r(18582);e.exports=function(e,t){return e&&i(t,n(t),e)}},13940:function(e,t,r){var i=r(83043);e.exports=function(e,t,r){"__proto__"==t&&i?i(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},18874:function(e,t,r){var i=r(86571),n=r(72517),o=r(60091),a=r(67993),s=r(55906),u=r(92175),c=r(51522),d=r(7680),l=r(19987),h=r(13483),p=r(76939),f=r(70940),_=r(99917),v=r(8222),m=r(78725),g=r(86152),y=r(73226),S=r(4714),E=r(29259),b=r(43679),w=r(90249),P=r(18582),T="[object Arguments]",C="[object Function]",M="[object Object]",k={};k[T]=k["[object Array]"]=k["[object ArrayBuffer]"]=k["[object DataView]"]=k["[object Boolean]"]=k["[object Date]"]=k["[object Float32Array]"]=k["[object Float64Array]"]=k["[object Int8Array]"]=k["[object Int16Array]"]=k["[object Int32Array]"]=k["[object Map]"]=k["[object Number]"]=k[M]=k["[object RegExp]"]=k["[object Set]"]=k["[object String]"]=k["[object Symbol]"]=k["[object Uint8Array]"]=k["[object Uint8ClampedArray]"]=k["[object Uint16Array]"]=k["[object Uint32Array]"]=!0,k["[object Error]"]=k[C]=k["[object WeakMap]"]=!1,e.exports=function e(t,r,A,x,D,R){var O,I=1&r,U=2&r,B=4&r;if(A&&(O=D?A(t,x,D,R):A(t)),void 0!==O)return O;if(!E(t))return t;var L=g(t);if(L){if(O=_(t),!I)return c(t,O)}else{var N=f(t),F=N==C||"[object GeneratorFunction]"==N;if(y(t))return u(t,I);if(N==M||N==T||F&&!D){if(O=U||F?{}:m(t),!I)return U?l(t,s(O,t)):d(t,a(O,t))}else{if(!k[N])return D?t:{};O=v(t,N,I)}}R||(R=new i);var W=R.get(t);if(W)return W;R.set(t,O),b(t)?t.forEach(function(i){O.add(e(i,r,A,i,t,R))}):S(t)&&t.forEach(function(i,n){O.set(n,e(i,r,A,n,t,R))});var V=B?U?p:h:U?P:w,H=L?void 0:V(t);return n(H||t,function(i,n){H&&(i=t[n=i]),o(O,n,e(i,r,A,n,t,R))}),O}},39413:function(e,t,r){var i=r(29259),n=Object.create,o=function(){function e(){}return function(t){if(!i(t))return{};if(n)return n(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();e.exports=o},21359:function(e){e.exports=function(e,t,r,i){for(var n=e.length,o=r+(i?1:-1);i?o--:++o<n;)if(t(e[o],o,e))return o;return -1}},62034:function(e,t,r){var i=r(65067),n=r(95882);e.exports=function e(t,r,o,a,s){var u=-1,c=t.length;for(o||(o=n),s||(s=[]);++u<c;){var d=t[u];r>0&&o(d)?r>1?e(d,r-1,o,a,s):i(s,d):a||(s[s.length]=d)}return s}},77832:function(e,t,r){var i=r(21359),n=r(22195),o=r(66024);e.exports=function(e,t,r){return t==t?o(e,t,r):i(e,n,r)}},74511:function(e,t,r){var i=r(70940),n=r(15125);e.exports=function(e){return n(e)&&"[object Map]"==i(e)}},22195:function(e){e.exports=function(e){return e!=e}},8109:function(e,t,r){var i=r(70940),n=r(15125);e.exports=function(e){return n(e)&&"[object Set]"==i(e)}},18390:function(e,t,r){var i=r(29259),n=r(16001),o=r(62966),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!i(e))return o(e);var t=n(e),r=[];for(var s in e)"constructor"==s&&(t||!a.call(e,s))||r.push(s);return r}},73620:function(e){e.exports=function(){}},54817:function(e,t,r){var i=r(23059),n=r(70529),o=n?function(e,t){return n.set(e,t),e}:i;e.exports=o},86532:function(e,t,r){var i=r(86874),n=r(83043),o=r(23059),a=n?function(e,t){return n(e,"toString",{configurable:!0,enumerable:!1,value:i(t),writable:!0})}:o;e.exports=a},79882:function(e,t,r){var i=r(79162);e.exports=function(e){var t=new e.constructor(e.byteLength);return new i(t).set(new i(e)),t}},92175:function(e,t,r){e=r.nmd(e);var i=r(37772),n=t&&!t.nodeType&&t,o=n&&e&&!e.nodeType&&e,a=o&&o.exports===n?i.Buffer:void 0,s=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,i=s?s(r):new e.constructor(r);return e.copy(i),i}},34727:function(e,t,r){var i=r(79882);e.exports=function(e,t){var r=t?i(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}},96058:function(e){var t=/\w*$/;e.exports=function(e){var r=new e.constructor(e.source,t.exec(e));return r.lastIndex=e.lastIndex,r}},70169:function(e,t,r){var i=r(50857),n=i?i.prototype:void 0,o=n?n.valueOf:void 0;e.exports=function(e){return o?Object(o.call(e)):{}}},6190:function(e,t,r){var i=r(79882);e.exports=function(e,t){var r=t?i(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}},11495:function(e){var t=Math.max;e.exports=function(e,r,i,n){for(var o=-1,a=e.length,s=i.length,u=-1,c=r.length,d=t(a-s,0),l=Array(c+d),h=!n;++u<c;)l[u]=r[u];for(;++o<s;)(h||o<a)&&(l[i[o]]=e[o]);for(;d--;)l[u++]=e[o++];return l}},152:function(e){var t=Math.max;e.exports=function(e,r,i,n){for(var o=-1,a=e.length,s=-1,u=i.length,c=-1,d=r.length,l=t(a-u,0),h=Array(l+d),p=!n;++o<l;)h[o]=e[o];for(var f=o;++c<d;)h[f+c]=r[c];for(;++s<u;)(p||o<a)&&(h[f+i[s]]=e[o++]);return h}},51522:function(e){e.exports=function(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}},752:function(e,t,r){var i=r(60091),n=r(13940);e.exports=function(e,t,r,o){var a=!r;r||(r={});for(var s=-1,u=t.length;++s<u;){var c=t[s],d=o?o(r[c],e[c],c,r,e):void 0;void 0===d&&(d=e[c]),a?n(r,c,d):i(r,c,d)}return r}},7680:function(e,t,r){var i=r(752),n=r(80633);e.exports=function(e,t){return i(e,n(e),t)}},19987:function(e,t,r){var i=r(752),n=r(12680);e.exports=function(e,t){return i(e,n(e),t)}},61176:function(e){e.exports=function(e,t){for(var r=e.length,i=0;r--;)e[r]===t&&++i;return i}},23485:function(e,t,r){var i=r(52248),n=r(37772);e.exports=function(e,t,r){var o=1&t,a=i(e);return function t(){return(this&&this!==n&&this instanceof t?a:e).apply(o?r:this,arguments)}}},52248:function(e,t,r){var i=r(39413),n=r(29259);e.exports=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=i(e.prototype),o=e.apply(r,t);return n(o)?o:r}}},98462:function(e,t,r){var i=r(49432),n=r(52248),o=r(90764),a=r(57891),s=r(13325),u=r(90527),c=r(37772);e.exports=function(e,t,r){var d=n(e);return function n(){for(var l=arguments.length,h=Array(l),p=l,f=s(n);p--;)h[p]=arguments[p];var _=l<3&&h[0]!==f&&h[l-1]!==f?[]:u(h,f);return(l-=_.length)<r?a(e,t,o,n.placeholder,void 0,h,_,void 0,void 0,r-l):i(this&&this!==c&&this instanceof n?d:e,this,h)}}},37541:function(e,t,r){var i=r(45859),n=r(29097),o=r(78203),a=r(59350),s=r(86152),u=r(93735);e.exports=function(e){return n(function(t){var r=t.length,n=r,c=i.prototype.thru;for(e&&t.reverse();n--;){var d=t[n];if("function"!=typeof d)throw TypeError("Expected a function");if(c&&!l&&"wrapper"==a(d))var l=new i([],!0)}for(n=l?n:r;++n<r;){var h=a(d=t[n]),p="wrapper"==h?o(d):void 0;l=p&&u(p[0])&&424==p[1]&&!p[4].length&&1==p[9]?l[a(p[0])].apply(l,p[3]):1==d.length&&u(d)?l[h]():l.thru(d)}return function(){var e=arguments,i=e[0];if(l&&1==e.length&&s(i))return l.plant(i).value();for(var n=0,o=r?t[n].apply(this,e):i;++n<r;)o=t[n].call(this,o);return o}})}},90764:function(e,t,r){var i=r(11495),n=r(152),o=r(61176),a=r(52248),s=r(57891),u=r(13325),c=r(33418),d=r(90527),l=r(37772);e.exports=function e(t,r,h,p,f,_,v,m,g,y){var S=128&r,E=1&r,b=2&r,w=24&r,P=512&r,T=b?void 0:a(t);return function C(){for(var M=arguments.length,k=Array(M),A=M;A--;)k[A]=arguments[A];if(w)var x=u(C),D=o(k,x);if(p&&(k=i(k,p,f,w)),_&&(k=n(k,_,v,w)),M-=D,w&&M<y){var R=d(k,x);return s(t,r,e,C.placeholder,h,k,R,m,g,y-M)}var O=E?h:this,I=b?O[t]:t;return M=k.length,m?k=c(k,m):P&&M>1&&k.reverse(),S&&g<M&&(k.length=g),this&&this!==l&&this instanceof C&&(I=T||a(I)),I.apply(O,k)}}},85468:function(e,t,r){var i=r(49432),n=r(52248),o=r(37772);e.exports=function(e,t,r,a){var s=1&t,u=n(e);return function t(){for(var n=-1,c=arguments.length,d=-1,l=a.length,h=Array(l+c);++d<l;)h[d]=a[d];for(;c--;)h[d++]=arguments[++n];return i(this&&this!==o&&this instanceof t?u:e,s?r:this,h)}}},57891:function(e,t,r){var i=r(93735),n=r(29890),o=r(15877);e.exports=function(e,t,r,a,s,u,c,d,l,h){var p=8&t;t|=p?32:64,4&(t&=~(p?64:32))||(t&=-4);var f=[e,t,s,p?u:void 0,p?c:void 0,p?void 0:u,p?void 0:c,d,l,h],_=r.apply(void 0,f);return i(e)&&n(_,f),_.placeholder=a,o(_,e,t)}},87902:function(e,t,r){var i=r(54817),n=r(23485),o=r(98462),a=r(90764),s=r(85468),u=r(78203),c=r(79e3),d=r(29890),l=r(15877),h=r(38101),p=Math.max;e.exports=function(e,t,r,f,_,v,m,g){var y=2&t;if(!y&&"function"!=typeof e)throw TypeError("Expected a function");var S=f?f.length:0;if(S||(t&=-97,f=_=void 0),m=void 0===m?m:p(h(m),0),g=void 0===g?g:h(g),S-=_?_.length:0,64&t){var E=f,b=_;f=_=void 0}var w=y?void 0:u(e),P=[e,t,r,f,_,E,b,v,m,g];if(w&&c(P,w),e=P[0],t=P[1],r=P[2],f=P[3],_=P[4],(g=P[9]=void 0===P[9]?y?0:e.length:p(P[9]-S,0))||!(24&t)||(t&=-25),t&&1!=t)T=8==t||16==t?o(e,t,g):32!=t&&33!=t||_.length?a.apply(void 0,P):s(e,t,r,f);else var T=n(e,t,r);return l((w?i:d)(T,P),e,t)}},83043:function(e,t,r){var i=r(38761),n=function(){try{var e=i(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=n},29097:function(e,t,r){var i=r(35676),n=r(43114),o=r(75251);e.exports=function(e){return o(n(e,void 0,i),e+"")}},76939:function(e,t,r){var i=r(1897),n=r(12680),o=r(18582);e.exports=function(e){return i(e,o,n)}},78203:function(e,t,r){var i=r(70529),n=r(34291),o=i?function(e){return i.get(e)}:n;e.exports=o},59350:function(e,t,r){var i=r(29212),n=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",r=i[t],o=n.call(i,t)?r.length:0;o--;){var a=r[o],s=a.func;if(null==s||s==e)return a.name}return t}},13325:function(e){e.exports=function(e){return e.placeholder}},47353:function(e,t,r){var i=r(60241)(Object.getPrototypeOf,Object);e.exports=i},12680:function(e,t,r){var i=r(65067),n=r(47353),o=r(80633),a=r(30981),s=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)i(t,o(e)),e=n(e);return t}:a;e.exports=s},74842:function(e){var t=/\{\n\/\* \[wrapped with (.+)\] \*/,r=/,? & /;e.exports=function(e){var i=e.match(t);return i?i[1].split(r):[]}},99917:function(e){var t=Object.prototype.hasOwnProperty;e.exports=function(e){var r=e.length,i=new e.constructor(r);return r&&"string"==typeof e[0]&&t.call(e,"index")&&(i.index=e.index,i.input=e.input),i}},8222:function(e,t,r){var i=r(79882),n=r(34727),o=r(96058),a=r(70169),s=r(6190);e.exports=function(e,t,r){var u=e.constructor;switch(t){case"[object ArrayBuffer]":return i(e);case"[object Boolean]":case"[object Date]":return new u(+e);case"[object DataView]":return n(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(e,r);case"[object Map]":case"[object Set]":return new u;case"[object Number]":case"[object String]":return new u(e);case"[object RegExp]":return o(e);case"[object Symbol]":return a(e)}}},78725:function(e,t,r){var i=r(39413),n=r(47353),o=r(16001);e.exports=function(e){return"function"!=typeof e.constructor||o(e)?{}:i(n(e))}},68442:function(e){var t=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=function(e,r){var i=r.length;if(!i)return e;var n=i-1;return r[n]=(i>1?"& ":"")+r[n],r=r.join(i>2?", ":" "),e.replace(t,"{\n/* [wrapped with "+r+"] */\n")}},95882:function(e,t,r){var i=r(50857),n=r(79631),o=r(86152),a=i?i.isConcatSpreadable:void 0;e.exports=function(e){return o(e)||n(e)||!!(a&&e&&e[a])}},93735:function(e,t,r){var i=r(35124),n=r(78203),o=r(59350),a=r(68674);e.exports=function(e){var t=o(e),r=a[t];if("function"!=typeof r||!(t in i.prototype))return!1;if(e===r)return!0;var s=n(r);return!!s&&e===s[0]}},79e3:function(e,t,r){var i=r(11495),n=r(152),o=r(90527),a="__lodash_placeholder__",s=Math.min;e.exports=function(e,t){var r=e[1],u=t[1],c=r|u,d=c<131,l=128==u&&8==r||128==u&&256==r&&e[7].length<=t[8]||384==u&&t[7].length<=t[8]&&8==r;if(!(d||l))return e;1&u&&(e[2]=t[2],c|=1&r?0:4);var h=t[3];if(h){var p=e[3];e[3]=p?i(p,h,t[4]):h,e[4]=p?o(e[3],a):t[4]}return(h=t[5])&&(p=e[5],e[5]=p?n(p,h,t[6]):h,e[6]=p?o(e[5],a):t[6]),(h=t[7])&&(e[7]=h),128&u&&(e[8]=null==e[8]?t[8]:s(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=c,e}},70529:function(e,t,r){var i=r(93215),n=i&&new i;e.exports=n},62966:function(e){e.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}},43114:function(e,t,r){var i=r(49432),n=Math.max;e.exports=function(e,t,r){return t=n(void 0===t?e.length-1:t,0),function(){for(var o=arguments,a=-1,s=n(o.length-t,0),u=Array(s);++a<s;)u[a]=o[t+a];a=-1;for(var c=Array(t+1);++a<t;)c[a]=o[a];return c[t]=r(u),i(e,this,c)}}},29212:function(e){e.exports={}},33418:function(e,t,r){var i=r(51522),n=r(39045),o=Math.min;e.exports=function(e,t){for(var r=e.length,a=o(t.length,r),s=i(e);a--;){var u=t[a];e[a]=n(u,r)?s[u]:void 0}return e}},90527:function(e){var t="__lodash_placeholder__";e.exports=function(e,r){for(var i=-1,n=e.length,o=0,a=[];++i<n;){var s=e[i];(s===r||s===t)&&(e[i]=t,a[o++]=i)}return a}},29890:function(e,t,r){var i=r(54817),n=r(97787)(i);e.exports=n},75251:function(e,t,r){var i=r(86532),n=r(97787)(i);e.exports=n},15877:function(e,t,r){var i=r(74842),n=r(68442),o=r(75251),a=r(16985);e.exports=function(e,t,r){var s=t+"";return o(e,n(s,a(i(s),r)))}},97787:function(e){var t=Date.now;e.exports=function(e){var r=0,i=0;return function(){var n=t(),o=16-(n-i);if(i=n,o>0){if(++r>=800)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}},66024:function(e){e.exports=function(e,t,r){for(var i=r-1,n=e.length;++i<n;)if(e[i]===t)return i;return -1}},16985:function(e,t,r){var i=r(72517),n=r(38333),o=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=function(e,t){return i(o,function(r){var i="_."+r[0];t&r[1]&&!n(e,i)&&e.push(i)}),e.sort()}},67366:function(e,t,r){var i=r(35124),n=r(45859),o=r(51522);e.exports=function(e){if(e instanceof i)return e.clone();var t=new n(e.__wrapped__,e.__chain__);return t.__actions__=o(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},19534:function(e,t,r){var i=r(87902);e.exports=function(e,t,r){return t=r?void 0:t,t=e&&null==t?e.length:t,i(e,128,void 0,void 0,void 0,void 0,t)}},54004:function(e,t,r){var i=r(18874);e.exports=function(e){return i(e,4)}},86874:function(e){e.exports=function(e){return function(){return e}}},12957:function(e,t,r){var i=r(87902);function n(e,t,r){var o=i(e,8,void 0,void 0,void 0,void 0,void 0,t=r?void 0:t);return o.placeholder=n.placeholder,o}n.placeholder={},e.exports=n},35676:function(e,t,r){var i=r(62034);e.exports=function(e){return(null==e?0:e.length)?i(e,1):[]}},58332:function(e,t,r){var i=r(37541)(!0);e.exports=i},18620:function(e,t,r){var i=r(80973),n=r(54652),o=Array.prototype.push;function a(e,t){return 2==t?function(t,r){return e(t,r)}:function(t){return e(t)}}function s(e){for(var t=e?e.length:0,r=Array(t);t--;)r[t]=e[t];return r}function u(e,t){return function(){var r=arguments.length;if(r){for(var i=Array(r);r--;)i[r]=arguments[r];var n=i[0]=t.apply(void 0,i);return e.apply(void 0,i),n}}}e.exports=function e(t,r,c,d){var l="function"==typeof r,h=r===Object(r);if(h&&(d=c,c=r,r=void 0),null==c)throw TypeError();d||(d={});var p={cap:!("cap"in d)||d.cap,curry:!("curry"in d)||d.curry,fixed:!("fixed"in d)||d.fixed,immutable:!("immutable"in d)||d.immutable,rearg:!("rearg"in d)||d.rearg},f=l?c:n,_="curry"in d&&d.curry,v="fixed"in d&&d.fixed,m="rearg"in d&&d.rearg,g=l?c.runInContext():void 0,y=l?c:{ary:t.ary,assign:t.assign,clone:t.clone,curry:t.curry,forEach:t.forEach,isArray:t.isArray,isError:t.isError,isFunction:t.isFunction,isWeakMap:t.isWeakMap,iteratee:t.iteratee,keys:t.keys,rearg:t.rearg,toInteger:t.toInteger,toPath:t.toPath},S=y.ary,E=y.assign,b=y.clone,w=y.curry,P=y.forEach,T=y.isArray,C=y.isError,M=y.isFunction,k=y.isWeakMap,A=y.keys,x=y.rearg,D=y.toInteger,R=y.toPath,O=A(i.aryMethod),I={castArray:function(e){return function(){var t=arguments[0];return T(t)?e(s(t)):e.apply(void 0,arguments)}},iteratee:function(e){return function(){var t=arguments[0],r=arguments[1],i=e(t,r),n=i.length;return p.cap&&"number"==typeof r?(r=r>2?r-2:1,n&&n<=r?i:a(i,r)):i}},mixin:function(e){return function(t){var r=this;if(!M(r))return e(r,Object(t));var i=[];return P(A(t),function(e){M(t[e])&&i.push([e,r.prototype[e]])}),e(r,Object(t)),P(i,function(e){var t=e[1];M(t)?r.prototype[e[0]]=t:delete r.prototype[e[0]]}),r}},nthArg:function(e){return function(t){var r=t<0?1:D(t)+1;return w(e(t),r)}},rearg:function(e){return function(t,r){var i=r?r.length:0;return w(e(t,r),i)}},runInContext:function(r){return function(i){return e(t,r(i),d)}}};function U(e,t,r){if(p.fixed&&(v||!i.skipFixed[e])){var n=i.methodSpread[e],a=n&&n.start;return void 0===a?S(t,r):function(){for(var e=arguments.length,r=e-1,i=Array(e);e--;)i[e]=arguments[e];var n=i[a],s=i.slice(0,a);return n&&o.apply(s,n),a!=r&&o.apply(s,i.slice(a+1)),t.apply(this,s)}}return t}function B(e,t,r){return p.rearg&&r>1&&(m||!i.skipRearg[e])?x(t,i.methodRearg[e]||i.aryRearg[r]):t}function L(e,t){t=R(t);for(var r=-1,i=t.length,n=i-1,o=b(Object(e)),a=o;null!=a&&++r<i;){var s=t[r],u=a[s];null==u||M(u)||C(u)||k(u)||(a[s]=b(r==n?u:Object(u))),a=a[s]}return o}function N(t,r){var n=i.aliasToReal[t]||t,o=i.remap[n]||n,a=d;return function(t){var i=l?g[o]:r;return e(l?g:y,n,i,E(E({},a),t))}}function F(e,t){return function(){var r=arguments.length;if(!r)return e();for(var i=Array(r);r--;)i[r]=arguments[r];var n=p.rearg?0:r-1;return i[n]=t(i[n]),e.apply(void 0,i)}}function W(e,t,r){var n,o=i.aliasToReal[e]||e,c=t,d=I[o];return d?c=d(t):p.immutable&&(i.mutate.array[o]?c=u(t,s):i.mutate.object[o]?c=u(t,function(e){return t({},e)}):i.mutate.set[o]&&(c=u(t,L))),P(O,function(e){return P(i.aryMethod[e],function(t){if(o==t){var r,s=i.methodSpread[o];return n=s&&s.afterRearg?U(o,B(o,c,e),e):B(o,U(o,c,e),e),r=n=function(e,t){if(p.cap){var r=i.iterateeRearg[e];if(r)return F(t,function(e){var t,i=r.length;return t=x(a(e,i),r),2==i?function(e,r){return t.apply(void 0,arguments)}:function(e){return t.apply(void 0,arguments)}});var n=!l&&i.iterateeAry[e];if(n)return F(t,function(e){return"function"==typeof e?a(e,n):e})}return t}(o,n),n=_||p.curry&&e>1?w(r,e):r,!1}}),!n}),n||(n=c),n==t&&(n=_?w(n,1):function(){return t.apply(this,arguments)}),n.convert=N(o,t),n.placeholder=t.placeholder=r,n}if(!h)return W(r,c,f);var V=c,H=[];return P(O,function(e){P(i.aryMethod[e],function(e){var t=V[i.remap[e]||e];t&&H.push([e,W(e,t,V)])})}),P(A(V),function(e){var t=V[e];if("function"==typeof t){for(var r=H.length;r--;)if(H[r][0]==e)return;t.convert=N(e,t),H.push([e,t])}}),P(H,function(e){V[e[0]]=e[1]}),V.convert=function(e){return V.runInContext.convert(e)(void 0)},V.placeholder=V,P(A(V),function(e){P(i.realToAlias[e]||[],function(t){V[t]=V[e]})}),V}},80973:function(e,t){t.aliasToReal={each:"forEach",eachRight:"forEachRight",entries:"toPairs",entriesIn:"toPairsIn",extend:"assignIn",extendAll:"assignInAll",extendAllWith:"assignInAllWith",extendWith:"assignInWith",first:"head",conforms:"conformsTo",matches:"isMatch",property:"get",__:"placeholder",F:"stubFalse",T:"stubTrue",all:"every",allPass:"overEvery",always:"constant",any:"some",anyPass:"overSome",apply:"spread",assoc:"set",assocPath:"set",complement:"negate",compose:"flowRight",contains:"includes",dissoc:"unset",dissocPath:"unset",dropLast:"dropRight",dropLastWhile:"dropRightWhile",equals:"isEqual",identical:"eq",indexBy:"keyBy",init:"initial",invertObj:"invert",juxt:"over",omitAll:"omit",nAry:"ary",path:"get",pathEq:"matchesProperty",pathOr:"getOr",paths:"at",pickAll:"pick",pipe:"flow",pluck:"map",prop:"get",propEq:"matchesProperty",propOr:"getOr",props:"at",symmetricDifference:"xor",symmetricDifferenceBy:"xorBy",symmetricDifferenceWith:"xorWith",takeLast:"takeRight",takeLastWhile:"takeRightWhile",unapply:"rest",unnest:"flatten",useWith:"overArgs",where:"conformsTo",whereEq:"isMatch",zipObj:"zipObject"},t.aryMethod={1:["assignAll","assignInAll","attempt","castArray","ceil","create","curry","curryRight","defaultsAll","defaultsDeepAll","floor","flow","flowRight","fromPairs","invert","iteratee","memoize","method","mergeAll","methodOf","mixin","nthArg","over","overEvery","overSome","rest","reverse","round","runInContext","spread","template","trim","trimEnd","trimStart","uniqueId","words","zipAll"],2:["add","after","ary","assign","assignAllWith","assignIn","assignInAllWith","at","before","bind","bindAll","bindKey","chunk","cloneDeepWith","cloneWith","concat","conformsTo","countBy","curryN","curryRightN","debounce","defaults","defaultsDeep","defaultTo","delay","difference","divide","drop","dropRight","dropRightWhile","dropWhile","endsWith","eq","every","filter","find","findIndex","findKey","findLast","findLastIndex","findLastKey","flatMap","flatMapDeep","flattenDepth","forEach","forEachRight","forIn","forInRight","forOwn","forOwnRight","get","groupBy","gt","gte","has","hasIn","includes","indexOf","intersection","invertBy","invoke","invokeMap","isEqual","isMatch","join","keyBy","lastIndexOf","lt","lte","map","mapKeys","mapValues","matchesProperty","maxBy","meanBy","merge","mergeAllWith","minBy","multiply","nth","omit","omitBy","overArgs","pad","padEnd","padStart","parseInt","partial","partialRight","partition","pick","pickBy","propertyOf","pull","pullAll","pullAt","random","range","rangeRight","rearg","reject","remove","repeat","restFrom","result","sampleSize","some","sortBy","sortedIndex","sortedIndexOf","sortedLastIndex","sortedLastIndexOf","sortedUniqBy","split","spreadFrom","startsWith","subtract","sumBy","take","takeRight","takeRightWhile","takeWhile","tap","throttle","thru","times","trimChars","trimCharsEnd","trimCharsStart","truncate","union","uniqBy","uniqWith","unset","unzipWith","without","wrap","xor","zip","zipObject","zipObjectDeep"],3:["assignInWith","assignWith","clamp","differenceBy","differenceWith","findFrom","findIndexFrom","findLastFrom","findLastIndexFrom","getOr","includesFrom","indexOfFrom","inRange","intersectionBy","intersectionWith","invokeArgs","invokeArgsMap","isEqualWith","isMatchWith","flatMapDepth","lastIndexOfFrom","mergeWith","orderBy","padChars","padCharsEnd","padCharsStart","pullAllBy","pullAllWith","rangeStep","rangeStepRight","reduce","reduceRight","replace","set","slice","sortedIndexBy","sortedLastIndexBy","transform","unionBy","unionWith","update","xorBy","xorWith","zipWith"],4:["fill","setWith","updateWith"]},t.aryRearg={2:[1,0],3:[2,0,1],4:[3,2,0,1]},t.iterateeAry={dropRightWhile:1,dropWhile:1,every:1,filter:1,find:1,findFrom:1,findIndex:1,findIndexFrom:1,findKey:1,findLast:1,findLastFrom:1,findLastIndex:1,findLastIndexFrom:1,findLastKey:1,flatMap:1,flatMapDeep:1,flatMapDepth:1,forEach:1,forEachRight:1,forIn:1,forInRight:1,forOwn:1,forOwnRight:1,map:1,mapKeys:1,mapValues:1,partition:1,reduce:2,reduceRight:2,reject:1,remove:1,some:1,takeRightWhile:1,takeWhile:1,times:1,transform:2},t.iterateeRearg={mapKeys:[1],reduceRight:[1,0]},t.methodRearg={assignInAllWith:[1,0],assignInWith:[1,2,0],assignAllWith:[1,0],assignWith:[1,2,0],differenceBy:[1,2,0],differenceWith:[1,2,0],getOr:[2,1,0],intersectionBy:[1,2,0],intersectionWith:[1,2,0],isEqualWith:[1,2,0],isMatchWith:[2,1,0],mergeAllWith:[1,0],mergeWith:[1,2,0],padChars:[2,1,0],padCharsEnd:[2,1,0],padCharsStart:[2,1,0],pullAllBy:[2,1,0],pullAllWith:[2,1,0],rangeStep:[1,2,0],rangeStepRight:[1,2,0],setWith:[3,1,2,0],sortedIndexBy:[2,1,0],sortedLastIndexBy:[2,1,0],unionBy:[1,2,0],unionWith:[1,2,0],updateWith:[3,1,2,0],xorBy:[1,2,0],xorWith:[1,2,0],zipWith:[1,2,0]},t.methodSpread={assignAll:{start:0},assignAllWith:{start:0},assignInAll:{start:0},assignInAllWith:{start:0},defaultsAll:{start:0},defaultsDeepAll:{start:0},invokeArgs:{start:2},invokeArgsMap:{start:2},mergeAll:{start:0},mergeAllWith:{start:0},partial:{start:1},partialRight:{start:1},without:{start:1},zipAll:{start:0}},t.mutate={array:{fill:!0,pull:!0,pullAll:!0,pullAllBy:!0,pullAllWith:!0,pullAt:!0,remove:!0,reverse:!0},object:{assign:!0,assignAll:!0,assignAllWith:!0,assignIn:!0,assignInAll:!0,assignInAllWith:!0,assignInWith:!0,assignWith:!0,defaults:!0,defaultsAll:!0,defaultsDeep:!0,defaultsDeepAll:!0,merge:!0,mergeAll:!0,mergeAllWith:!0,mergeWith:!0},set:{set:!0,setWith:!0,unset:!0,update:!0,updateWith:!0}},t.realToAlias=function(){var e=Object.prototype.hasOwnProperty,r=t.aliasToReal,i={};for(var n in r){var o=r[n];e.call(i,o)?i[o].push(n):i[o]=[n]}return i}(),t.remap={assignAll:"assign",assignAllWith:"assignWith",assignInAll:"assignIn",assignInAllWith:"assignInWith",curryN:"curry",curryRightN:"curryRight",defaultsAll:"defaults",defaultsDeepAll:"defaultsDeep",findFrom:"find",findIndexFrom:"findIndex",findLastFrom:"findLast",findLastIndexFrom:"findLastIndex",getOr:"get",includesFrom:"includes",indexOfFrom:"indexOf",invokeArgs:"invoke",invokeArgsMap:"invokeMap",lastIndexOfFrom:"lastIndexOf",mergeAll:"merge",mergeAllWith:"mergeWith",padChars:"pad",padCharsEnd:"padEnd",padCharsStart:"padStart",propertyOf:"get",rangeStep:"range",rangeStepRight:"rangeRight",restFrom:"rest",spreadFrom:"spread",trimChars:"trim",trimCharsEnd:"trimEnd",trimCharsStart:"trimStart",zipAll:"zip"},t.skipFixed={castArray:!0,flow:!0,flowRight:!0,iteratee:!0,mixin:!0,rearg:!0,runInContext:!0},t.skipRearg={add:!0,assign:!0,assignIn:!0,bind:!0,bindKey:!0,concat:!0,difference:!0,divide:!0,eq:!0,gt:!0,gte:!0,isEqual:!0,lt:!0,lte:!0,matchesProperty:!0,merge:!0,multiply:!0,overArgs:!0,partial:!0,partialRight:!0,propertyOf:!0,random:!0,range:!0,rangeRight:!0,subtract:!0,zip:!0,zipObject:!0,zipObjectDeep:!0}},30481:function(e,t,r){e.exports={ary:r(19534),assign:r(67993),clone:r(54004),curry:r(12957),forEach:r(72517),isArray:r(86152),isError:r(85121),isFunction:r(61049),isWeakMap:r(8266),iteratee:r(71510),keys:r(86411),rearg:r(30577),toInteger:r(38101),toPath:r(25497)}},52602:function(e,t,r){e.exports=r(68927)},42003:function(e,t,r){var i=r(18620),n=r(30481);e.exports=function(e,t,r){return i(n,e,t,r)}},68927:function(e,t,r){var i=r(42003)("flowRight",r(58332));i.placeholder=r(54652),e.exports=i},54652:function(e){e.exports={}},85121:function(e,t,r){var i=r(53366),n=r(15125),o=r(97030);e.exports=function(e){if(!n(e))return!1;var t=i(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!o(e)}},4714:function(e,t,r){var i=r(74511),n=r(47826),o=r(4146),a=o&&o.isMap,s=a?n(a):i;e.exports=s},97030:function(e,t,r){var i=r(53366),n=r(47353),o=r(15125),a=Object.prototype,s=Function.prototype.toString,u=a.hasOwnProperty,c=s.call(Object);e.exports=function(e){if(!o(e)||"[object Object]"!=i(e))return!1;var t=n(e);if(null===t)return!0;var r=u.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&s.call(r)==c}},43679:function(e,t,r){var i=r(8109),n=r(47826),o=r(4146),a=o&&o.isSet,s=a?n(a):i;e.exports=s},8266:function(e,t,r){var i=r(70940),n=r(15125);e.exports=function(e){return n(e)&&"[object WeakMap]"==i(e)}},71510:function(e,t,r){var i=r(18874),n=r(68286);e.exports=function(e){return n("function"==typeof e?e:i(e,1))}},18582:function(e,t,r){var i=r(1634),n=r(18390),o=r(67878);e.exports=function(e){return o(e)?i(e,!0):n(e)}},34291:function(e){e.exports=function(){}},30577:function(e,t,r){var i=r(87902),n=r(29097)(function(e,t){return i(e,256,void 0,void 0,void 0,t)});e.exports=n},5707:function(e,t,r){var i=r(7642),n=1/0;e.exports=function(e){return e?(e=i(e))===n||e===-n?(e<0?-1:1)*17976931348623157e292:e==e?e:0:0===e?e:0}},38101:function(e,t,r){var i=r(5707);e.exports=function(e){var t=i(e),r=t%1;return t==t?r?t-r:t:0}},25497:function(e,t,r){var i=r(50343),n=r(51522),o=r(86152),a=r(4795),s=r(54452),u=r(33812),c=r(66188);e.exports=function(e){return o(e)?i(e,u):a(e)?[e]:n(s(c(e)))}},68674:function(e,t,r){var i=r(35124),n=r(45859),o=r(73620),a=r(86152),s=r(15125),u=r(67366),c=Object.prototype.hasOwnProperty;function d(e){if(s(e)&&!a(e)&&!(e instanceof i)){if(e instanceof n)return e;if(c.call(e,"__wrapped__"))return u(e)}return new n(e)}d.prototype=o.prototype,d.prototype.constructor=d,e.exports=d},89873:function(e,t,r){"use strict";r.d(t,{R:function(){return function e(t,r,f,_){if((0,u.m)(f)&&(_=f,f=void 0),_)return e(t,r,f).pipe((0,c.Z)(_));var v=(0,i.__read)((0,u.m)(t.addEventListener)&&(0,u.m)(t.removeEventListener)?l.map(function(e){return function(i){return t[e](r,i,f)}}):(0,u.m)(t.addListener)&&(0,u.m)(t.removeListener)?d.map(p(t,r)):(0,u.m)(t.on)&&(0,u.m)(t.off)?h.map(p(t,r)):[],2),m=v[0],g=v[1];if(!m&&(0,s.z)(t))return(0,a.z)(function(t){return e(t,r,f)})((0,n.Xf)(t));if(!m)throw TypeError("Invalid event target");return new o.y(function(e){var t=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.next(1<t.length?t:t[0])};return m(t),function(){return g(t)}})}}});var i=r(22970),n=r(75618),o=r(317),a=r(15201),s=r(62348),u=r(66895),c=r(63778),d=["addListener","removeListener"],l=["addEventListener","removeEventListener"],h=["on","off"];function p(e,t){return function(r){return function(i){return e[r](t,i)}}}},37594:function(e,t,r){"use strict";r.d(t,{x:function(){return a}});var i=r(14737),n=r(58611),o=r(78779);function a(e,t){return void 0===t&&(t=i.y),e=null!=e?e:s,(0,n.e)(function(r,i){var n,a=!0;r.subscribe((0,o.x)(i,function(r){var o=t(r);(a||!e(n,o))&&(a=!1,n=o,i.next(r))}))})}function s(e,t){return e===t}},89907:function(e,t,r){"use strict";r.d(t,{h:function(){return o}});var i=r(58611),n=r(78779);function o(e,t){return(0,i.e)(function(r,i){var o=0;r.subscribe((0,n.x)(i,function(r){return e.call(t,r,o++)&&i.next(r)}))})}},46784:function(e,t,r){"use strict";r.d(t,{P:function(){return c}});var i=(0,r(11756).d)(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}}),n=r(89907),o=r(17850),a=r(58611),s=r(78779),u=r(14737);function c(e,t){var r=arguments.length>=2;return function(c){var d;return c.pipe(e?(0,n.h)(function(t,r){return e(t,r,c)}):u.y,(0,o.q)(1),r?(0,a.e)(function(e,r){var i=!1;e.subscribe((0,s.x)(r,function(e){i=!0,r.next(e)},function(){i||r.next(t),r.complete()}))}):(d=function(){return new i},(0,a.e)(function(e,t){var r=!1;e.subscribe((0,s.x)(t,function(e){r=!0,t.next(e)},function(){return r?t.complete():t.error(d())}))})))}}},80376:function(e,t,r){"use strict";r.d(t,{r:function(){return v}});var i=r(96542),n=r(58611),o=r(78779),a=r(75618),s=r(317),u=r(22970),c=function(e){function t(t,r){return e.call(this)||this}return(0,u.__extends)(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(r(49713).w0),d={setInterval:function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var n=d.delegate;return(null==n?void 0:n.setInterval)?n.setInterval.apply(n,(0,u.__spreadArray)([e,t],(0,u.__read)(r))):setInterval.apply(void 0,(0,u.__spreadArray)([e,t],(0,u.__read)(r)))},clearInterval:function(e){var t=d.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},l=r(92845),h=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i.scheduler=t,i.work=r,i.pending=!1,i}return(0,u.__extends)(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r,i=this.id,n=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(n,i,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(n,this.id,t),this},t.prototype.requestAsyncId=function(e,t,r){return void 0===r&&(r=0),d.setInterval(e.flush.bind(e,this),r)},t.prototype.recycleAsyncId=function(e,t,r){if(void 0===r&&(r=0),null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&d.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return Error("executing a cancelled action");this.pending=!1;var r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var r,i=!1;try{this.work(e)}catch(e){i=!0,r=e||Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,r=this.scheduler,i=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,(0,l.P)(i,this),null!=t&&(this.id=this.recycleAsyncId(r,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(c),p=r(31931),f=function(){function e(t,r){void 0===r&&(r=e.now),this.schedulerActionCtor=t,this.now=r}return e.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},e.now=p.l.now,e}(),_=new(function(e){function t(t,r){void 0===r&&(r=f.now);var i=e.call(this,t,r)||this;return i.actions=[],i._active=!1,i}return(0,u.__extends)(t,e),t.prototype.flush=function(e){var t,r=this.actions;if(this._active){r.push(e);return}this._active=!0;do if(t=e.execute(e.state,e.delay))break;while(e=r.shift());if(this._active=!1,t){for(;e=r.shift();)e.unsubscribe();throw t}},t}(f))(h);function v(e){var t,r,u=1/0;return null!=e&&("object"==typeof e?(u=void 0===(t=e.count)?1/0:t,r=e.delay):u=e),u<=0?function(){return i.E}:(0,n.e)(function(e,t){var i,n=0,c=function(){if(null==i||i.unsubscribe(),i=null,null!=r){var e,u,c="number"==typeof r?(void 0===(e=r)&&(e=0),void 0===u&&(u=_),new s.y(function(t){var r,i=(r=e)instanceof Date&&!isNaN(r)?+e-u.now():e;i<0&&(i=0);var n=0;return u.schedule(function(){t.closed||(t.next(n++),t.complete())},i)})):(0,a.Xf)(r(n)),l=(0,o.x)(t,function(){l.unsubscribe(),d()});c.subscribe(l)}else d()},d=function(){var r=!1;i=e.subscribe((0,o.x)(t,void 0,function(){++n<u?i?c():r=!0:t.complete()})),r&&c()};d()})}r(94016)},17850:function(e,t,r){"use strict";r.d(t,{q:function(){return a}});var i=r(96542),n=r(58611),o=r(78779);function a(e){return e<=0?function(){return i.E}:(0,n.e)(function(t,r){var i=0;t.subscribe((0,o.x)(r,function(t){++i<=e&&(r.next(t),e<=i&&r.complete())}))})}},92232:function(e,t,r){"use strict";r.d(t,{R:function(){return s}});var i=r(58611),n=r(78779),o=r(75618),a=r(15179);function s(e){return(0,i.e)(function(t,r){(0,o.Xf)(e).subscribe((0,n.x)(r,function(){return r.complete()},a.Z)),r.closed||t.subscribe(r)})}},30908:function(e,t,r){"use strict";r.d(t,{Z:function(){return j}});var i=r(56666);function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var a=r(85942),s=r(76854),u=r(86522),c=r(12524),d=r.n(c),l=r(2784);function h(e){var t=l.useRef();return t.current=e,l.useCallback(function(){for(var e,r=arguments.length,i=Array(r),n=0;n<r;n++)i[n]=arguments[n];return null===(e=t.current)||void 0===e?void 0:e.call.apply(e,[t].concat(i))},[])}var p="undefined"!=typeof window&&window.document&&window.document.createElement?l.useLayoutEffect:l.useEffect,f=function(e,t){var r=l.useRef(!0);p(function(){return e(r.current)},t),p(function(){return r.current=!1,function(){r.current=!0}},[])},_=function(e,t){f(function(t){if(!t)return e()},t)};function v(e){var t=l.useRef(!1),r=l.useState(e),i=(0,s.Z)(r,2),n=i[0],o=i[1];return l.useEffect(function(){return t.current=!1,function(){t.current=!0}},[]),[n,function(e,r){r&&t.current||o(e)}]}function m(e){return void 0!==e}var g={},y=[];function S(e,t){}function E(e,t){}function b(e,t,r){t||g[r]||(e(!1,r),g[r]=!0)}function w(e,t){b(S,e,t)}w.preMessage=function(e){y.push(e)},w.resetWarned=function(){g={}},w.noteOnce=function(e,t){b(E,e,t)};var P=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=new Set;return function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=i.has(t);if(w(!a,"Warning: There may be circular references"),a)return!1;if(t===n)return!0;if(r&&o>1)return!1;i.add(t);var s=o+1;if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(var c=0;c<t.length;c++)if(!e(t[c],n[c],s))return!1;return!0}if(t&&n&&"object"===(0,u.Z)(t)&&"object"===(0,u.Z)(n)){var d=Object.keys(t);return d.length===Object.keys(n).length&&d.every(function(r){return e(t[r],n[r],s)})}return!1}(e,t)},T=r(7896),C=r(59740);function M(e,t,r,i){var n=(t-r)/(i-r),o={};switch(e){case"rtl":o.right="".concat(100*n,"%"),o.transform="translateX(50%)";break;case"btt":o.bottom="".concat(100*n,"%"),o.transform="translateY(50%)";break;case"ttb":o.top="".concat(100*n,"%"),o.transform="translateY(-50%)";break;default:o.left="".concat(100*n,"%"),o.transform="translateX(-50%)"}return o}function k(e,t){return Array.isArray(e)?e[t]:e}var A={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var t=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||t>=A.F1&&t<=A.F12)return!1;switch(t){case A.ALT:case A.CAPS_LOCK:case A.CONTEXT_MENU:case A.CTRL:case A.DOWN:case A.END:case A.ESC:case A.HOME:case A.INSERT:case A.LEFT:case A.MAC_FF_META:case A.META:case A.NUMLOCK:case A.NUM_CENTER:case A.PAGE_DOWN:case A.PAGE_UP:case A.PAUSE:case A.PRINT_SCREEN:case A.RIGHT:case A.SHIFT:case A.UP:case A.WIN_KEY:case A.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=A.ZERO&&e<=A.NINE||e>=A.NUM_ZERO&&e<=A.NUM_MULTIPLY||e>=A.A&&e<=A.Z||-1!==window.navigator.userAgent.indexOf("WebKit")&&0===e)return!0;switch(e){case A.SPACE:case A.QUESTION_MARK:case A.NUM_PLUS:case A.NUM_MINUS:case A.NUM_PERIOD:case A.NUM_DIVISION:case A.SEMICOLON:case A.DASH:case A.EQUALS:case A.COMMA:case A.PERIOD:case A.SLASH:case A.APOSTROPHE:case A.SINGLE_QUOTE:case A.OPEN_SQUARE_BRACKET:case A.BACKSLASH:case A.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},x=l.createContext({min:0,max:0,direction:"ltr",step:1,includedStart:0,includedEnd:0,tabIndex:0,keyboard:!0,styles:{},classNames:{}}),D=["prefixCls","value","valueIndex","onStartMove","style","render","dragging","onOffsetChange","onChangeComplete","onFocus","onMouseEnter"],R=l.forwardRef(function(e,t){var r,n=e.prefixCls,a=e.value,s=e.valueIndex,u=e.onStartMove,c=e.style,h=e.render,p=e.dragging,f=e.onOffsetChange,_=e.onChangeComplete,v=e.onFocus,m=e.onMouseEnter,g=(0,C.Z)(e,D),y=l.useContext(x),S=y.min,E=y.max,b=y.direction,w=y.disabled,P=y.keyboard,R=y.range,O=y.tabIndex,I=y.ariaLabelForHandle,U=y.ariaLabelledByForHandle,B=y.ariaValueTextFormatterForHandle,L=y.styles,N=y.classNames,F="".concat(n,"-handle"),W=function(e){w||u(e,s)},V=M(b,a,S,E),H={};null!==s&&(H={tabIndex:w?null:k(O,s),role:"slider","aria-valuemin":S,"aria-valuemax":E,"aria-valuenow":a,"aria-disabled":w,"aria-label":k(I,s),"aria-labelledby":k(U,s),"aria-valuetext":null===(r=k(B,s))||void 0===r?void 0:r(a),"aria-orientation":"ltr"===b||"rtl"===b?"horizontal":"vertical",onMouseDown:W,onTouchStart:W,onFocus:function(e){null==v||v(e,s)},onMouseEnter:function(e){m(e,s)},onKeyDown:function(e){if(!w&&P){var t=null;switch(e.which||e.keyCode){case A.LEFT:t="ltr"===b||"btt"===b?-1:1;break;case A.RIGHT:t="ltr"===b||"btt"===b?1:-1;break;case A.UP:t="ttb"!==b?1:-1;break;case A.DOWN:t="ttb"!==b?-1:1;break;case A.HOME:t="min";break;case A.END:t="max";break;case A.PAGE_UP:t=2;break;case A.PAGE_DOWN:t=-2}null!==t&&(e.preventDefault(),f(t,s))}},onKeyUp:function(e){switch(e.which||e.keyCode){case A.LEFT:case A.RIGHT:case A.UP:case A.DOWN:case A.HOME:case A.END:case A.PAGE_UP:case A.PAGE_DOWN:null==_||_()}}});var j=l.createElement("div",(0,T.Z)({ref:t,className:d()(F,(0,i.Z)((0,i.Z)({},"".concat(F,"-").concat(s+1),null!==s&&R),"".concat(F,"-dragging"),p),N.handle),style:o(o(o({},V),c),L.handle)},H,g));return h&&(j=h(j,{index:s,prefixCls:n,value:a,dragging:p})),j}),O=["prefixCls","style","onStartMove","onOffsetChange","values","handleRender","activeHandleRender","draggingIndex","onFocus"],I=l.forwardRef(function(e,t){var r=e.prefixCls,i=e.style,n=e.onStartMove,a=e.onOffsetChange,u=e.values,c=e.handleRender,d=e.activeHandleRender,h=e.draggingIndex,p=e.onFocus,f=(0,C.Z)(e,O),_=l.useRef({});l.useImperativeHandle(t,function(){return{focus:function(e){var t;null===(t=_.current[e])||void 0===t||t.focus()}}});var v=l.useState(-1),m=(0,s.Z)(v,2),g=m[0],y=m[1],S=o({prefixCls:r,onStartMove:n,onOffsetChange:a,render:c,onFocus:function(e,t){y(t),null==p||p(e)},onMouseEnter:function(e,t){y(t)}},f);return l.createElement(l.Fragment,null,u.map(function(e,t){return l.createElement(R,(0,T.Z)({ref:function(e){e?_.current[t]=e:delete _.current[t]},dragging:h===t,style:k(i,t),key:t,value:e,valueIndex:t},S))}),d&&l.createElement(R,(0,T.Z)({key:"a11y"},S,{value:u[g],valueIndex:null,dragging:-1!==h,render:d,style:{pointerEvents:"none"},tabIndex:null,"aria-hidden":!0})))}),U=function(e){var t=e.prefixCls,r=e.style,n=e.children,a=e.value,s=e.onClick,u=l.useContext(x),c=u.min,h=u.max,p=u.direction,f=u.includedStart,_=u.includedEnd,v=u.included,m="".concat(t,"-text"),g=M(p,a,c,h);return l.createElement("span",{className:d()(m,(0,i.Z)({},"".concat(m,"-active"),v&&f<=a&&a<=_)),style:o(o({},g),r),onMouseDown:function(e){e.stopPropagation()},onClick:function(){s(a)}},n)},B=function(e){var t=e.prefixCls,r=e.marks,i=e.onClick,n="".concat(t,"-mark");return r.length?l.createElement("div",{className:n},r.map(function(e){var t=e.value,r=e.style,o=e.label;return l.createElement(U,{key:t,prefixCls:n,style:r,value:t,onClick:i},o)})):null},L=function(e){var t=e.prefixCls,r=e.value,n=e.style,a=e.activeStyle,s=l.useContext(x),u=s.min,c=s.max,h=s.direction,p=s.included,f=s.includedStart,_=s.includedEnd,v="".concat(t,"-dot"),m=p&&f<=r&&r<=_,g=o(o({},M(h,r,u,c)),"function"==typeof n?n(r):n);return m&&(g=o(o({},g),"function"==typeof a?a(r):a)),l.createElement("span",{className:d()(v,(0,i.Z)({},"".concat(v,"-active"),m)),style:g})},N=function(e){var t=e.prefixCls,r=e.marks,i=e.dots,n=e.style,o=e.activeStyle,a=l.useContext(x),s=a.min,u=a.max,c=a.step,d=l.useMemo(function(){var e=new Set;if(r.forEach(function(t){e.add(t.value)}),i&&null!==c)for(var t=s;t<=u;)e.add(t),t+=c;return Array.from(e)},[s,u,c,i,r]);return l.createElement("div",{className:"".concat(t,"-step")},d.map(function(e){return l.createElement(L,{prefixCls:t,key:e,value:e,style:n,activeStyle:o})}))},F=function(e){var t=e.prefixCls,r=e.style,n=e.start,a=e.end,s=e.index,u=e.onStartMove,c=e.replaceCls,h=l.useContext(x),p=h.direction,f=h.min,_=h.max,v=h.disabled,m=h.range,g=h.classNames,y="".concat(t,"-track"),S=(n-f)/(_-f),E=(a-f)/(_-f),b=function(e){!v&&u&&u(e,-1)},w={};switch(p){case"rtl":w.right="".concat(100*S,"%"),w.width="".concat(100*E-100*S,"%");break;case"btt":w.bottom="".concat(100*S,"%"),w.height="".concat(100*E-100*S,"%");break;case"ttb":w.top="".concat(100*S,"%"),w.height="".concat(100*E-100*S,"%");break;default:w.left="".concat(100*S,"%"),w.width="".concat(100*E-100*S,"%")}var P=c||d()(y,(0,i.Z)((0,i.Z)({},"".concat(y,"-").concat(s+1),null!==s&&m),"".concat(t,"-track-draggable"),u),g.track);return l.createElement("div",{className:P,style:o(o({},w),r),onMouseDown:b,onTouchStart:b})},W=function(e){var t=e.prefixCls,r=e.style,i=e.values,n=e.startPoint,a=e.onStartMove,s=l.useContext(x),u=s.included,c=s.range,h=s.min,p=s.styles,f=s.classNames,_=l.useMemo(function(){if(!c){if(0===i.length)return[];var e=null!=n?n:h,t=i[0];return[{start:Math.min(e,t),end:Math.max(e,t)}]}for(var r=[],o=0;o<i.length-1;o+=1)r.push({start:i[o],end:i[o+1]});return r},[i,c,n,h]);if(!u)return null;var v=f.tracks||p.tracks?l.createElement(F,{index:null,prefixCls:t,start:_[0].start,end:_[_.length-1].end,replaceCls:d()(f.tracks,"".concat(t,"-tracks")),style:p.tracks}):null;return l.createElement(l.Fragment,null,v,_.map(function(e,i){var n=e.start,s=e.end;return l.createElement(F,{index:i,prefixCls:t,style:o(o({},k(r,i)),p.track),start:n,end:s,key:i,onStartMove:a})}))};function V(e){var t="touches"in e?e.touches[0]:e;return{pageX:t.pageX,pageY:t.pageY}}r(71818),l.version.split(".")[0];var H=function(e,t,r,i,n,o,u,c,d){var p=l.useState(null),f=(0,s.Z)(p,2),_=f[0],v=f[1],m=l.useState(-1),g=(0,s.Z)(m,2),y=g[0],S=g[1],E=l.useState(r),b=(0,s.Z)(E,2),w=b[0],P=b[1],T=l.useState(r),C=(0,s.Z)(T,2),M=C[0],k=C[1],A=l.useRef(null),x=l.useRef(null);l.useLayoutEffect(function(){-1===y&&P(r)},[r,y]),l.useEffect(function(){return function(){document.removeEventListener("mousemove",A.current),document.removeEventListener("mouseup",x.current),document.removeEventListener("touchmove",A.current),document.removeEventListener("touchend",x.current)}},[]);var D=function(e,t){w.some(function(t,r){return t!==e[r]})&&(void 0!==t&&v(t),P(e),u(e))},R=h(function(e,t){if(-1===e){var r=M[0],s=M[M.length-1],u=t*(n-i);u=Math.min(u=Math.max(u,i-r),n-s),u=o(r+u)-r,D(M.map(function(e){return e+u}))}else{var c=(0,a.Z)(w);c[e]=M[e];var l=d(c,(n-i)*t,e,"dist");D(l.values,l.value)}});return[y,_,l.useMemo(function(){var e=(0,a.Z)(r).sort(function(e,t){return e-t}),t=(0,a.Z)(w).sort(function(e,t){return e-t});return e.every(function(e,r){return e===t[r]})?w:r},[r,w]),function(i,n,o){i.stopPropagation();var a=o||r,s=a[n];S(n),v(s),k(a);var u=V(i),d=u.pageX,l=u.pageY,h=function(r){r.preventDefault();var i,o=V(r),a=o.pageX,s=o.pageY,u=a-d,c=s-l,h=e.current.getBoundingClientRect(),p=h.width,f=h.height;switch(t){case"btt":i=-c/f;break;case"ttb":i=c/f;break;case"rtl":i=-u/p;break;default:i=u/p}R(n,i)},p=function e(t){t.preventDefault(),document.removeEventListener("mouseup",e),document.removeEventListener("mousemove",h),document.removeEventListener("touchend",e),document.removeEventListener("touchmove",h),A.current=null,x.current=null,S(-1),c()};document.addEventListener("mouseup",p),document.addEventListener("mousemove",h),document.addEventListener("touchend",p),document.addEventListener("touchmove",h),A.current=h,x.current=p}]},j=l.forwardRef(function(e,t){var r,n,c,p,f,g,y,S,E,b,T,C,M,k,A,D,R,O,U,L,F,V,j,K=e.prefixCls,q=void 0===K?"rc-slider":K,z=e.className,G=e.style,$=e.classNames,Y=e.styles,X=e.disabled,Q=void 0!==X&&X,Z=e.keyboard,J=void 0===Z||Z,ee=e.autoFocus,et=e.onFocus,er=e.onBlur,ei=e.min,en=void 0===ei?0:ei,eo=e.max,ea=void 0===eo?100:eo,es=e.step,eu=void 0===es?1:es,ec=e.value,ed=e.defaultValue,el=e.range,eh=e.count,ep=e.onChange,ef=e.onBeforeChange,e_=e.onAfterChange,ev=e.onChangeComplete,em=e.allowCross,eg=e.pushable,ey=void 0!==eg&&eg,eS=e.draggableTrack,eE=e.reverse,eb=e.vertical,ew=e.included,eP=void 0===ew||ew,eT=e.startPoint,eC=e.trackStyle,eM=e.handleStyle,ek=e.railStyle,eA=e.dotStyle,ex=e.activeDotStyle,eD=e.marks,eR=e.dots,eO=e.handleRender,eI=e.activeHandleRender,eU=e.tabIndex,eB=void 0===eU?0:eU,eL=e.ariaLabelForHandle,eN=e.ariaLabelledByForHandle,eF=e.ariaValueTextFormatterForHandle,eW=l.useRef(null),eV=l.useRef(null),eH=l.useMemo(function(){return eb?eE?"ttb":"btt":eE?"rtl":"ltr"},[eE,eb]),ej=l.useMemo(function(){return isFinite(en)?en:0},[en]),eK=l.useMemo(function(){return isFinite(ea)?ea:100},[ea]),eq=l.useMemo(function(){return null!==eu&&eu<=0?1:eu},[eu]),ez=l.useMemo(function(){return"boolean"==typeof ey?!!ey&&eq:ey>=0&&ey},[ey,eq]),eG=l.useMemo(function(){return Object.keys(eD||{}).map(function(e){var t=eD[e],r={value:Number(e)};return t&&"object"===(0,u.Z)(t)&&!l.isValidElement(t)&&("label"in t||"style"in t)?(r.style=t.style,r.label=t.label):r.label=t,r}).filter(function(e){var t=e.label;return t||"number"==typeof t}).sort(function(e,t){return e.value-t.value})},[eD]),e$=(r=void 0===em||em,n=l.useCallback(function(e){return Math.max(ej,Math.min(eK,e))},[ej,eK]),c=l.useCallback(function(e){if(null!==eq){var t=ej+Math.round((n(e)-ej)/eq)*eq,r=function(e){return(String(e).split(".")[1]||"").length},i=Math.max(r(eq),r(eK),r(ej)),o=Number(t.toFixed(i));return ej<=o&&o<=eK?o:null}return null},[eq,ej,eK,n]),p=l.useCallback(function(e){var t=n(e),r=eG.map(function(e){return e.value});null!==eq&&r.push(c(e)),r.push(ej,eK);var i=r[0],o=eK-ej;return r.forEach(function(e){var r=Math.abs(t-e);r<=o&&(i=e,o=r)}),i},[ej,eK,eG,eq,n,c]),f=function e(t,r,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unit";if("number"==typeof r){var o,s=t[i],u=s+r,d=[];eG.forEach(function(e){d.push(e.value)}),d.push(ej,eK),d.push(c(s));var l=r>0?1:-1;"unit"===n?d.push(c(s+l*eq)):d.push(c(u)),d=d.filter(function(e){return null!==e}).filter(function(e){return r<0?e<=s:e>=s}),"unit"===n&&(d=d.filter(function(e){return e!==s}));var h="unit"===n?s:u,p=Math.abs((o=d[0])-h);if(d.forEach(function(e){var t=Math.abs(e-h);t<p&&(o=e,p=t)}),void 0===o)return r<0?ej:eK;if("dist"===n)return o;if(Math.abs(r)>1){var f=(0,a.Z)(t);return f[i]=o,e(f,r-l,i,n)}return o}return"min"===r?ej:"max"===r?eK:void 0},g=function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unit",n=e[r],o=f(e,t,r,i);return{value:o,changed:o!==n}},y=function(e){return null===ez&&0===e||"number"==typeof ez&&e<ez},[p,function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unit",o=e.map(p),a=o[i],s=f(o,t,i,n);if(o[i]=s,!1===r){var u=ez||0;i>0&&o[i-1]!==a&&(o[i]=Math.max(o[i],o[i-1]+u)),i<o.length-1&&o[i+1]!==a&&(o[i]=Math.min(o[i],o[i+1]-u))}else if("number"==typeof ez||null===ez){for(var c=i+1;c<o.length;c+=1)for(var d=!0;y(o[c]-o[c-1])&&d;){var l=g(o,1,c);o[c]=l.value,d=l.changed}for(var h=i;h>0;h-=1)for(var _=!0;y(o[h]-o[h-1])&&_;){var v=g(o,-1,h-1);o[h-1]=v.value,_=v.changed}for(var m=o.length-1;m>0;m-=1)for(var S=!0;y(o[m]-o[m-1])&&S;){var E=g(o,-1,m-1);o[m-1]=E.value,S=E.changed}for(var b=0;b<o.length-1;b+=1)for(var w=!0;y(o[b+1]-o[b])&&w;){var P=g(o,1,b+1);o[b+1]=P.value,w=P.changed}}return{value:o[i],values:o}}]),eY=(0,s.Z)(e$,2),eX=eY[0],eQ=eY[1],eZ=(E=(S={value:ec}).defaultValue,b=S.value,T=S.onChange,C=S.postState,M=v(function(){return m(b)?b:m(E)?"function"==typeof E?E():E:"function"==typeof ed?ed():ed}),A=(k=(0,s.Z)(M,2))[0],D=k[1],R=void 0!==b?b:A,O=C?C(R):R,U=h(T),L=v([R]),V=(F=(0,s.Z)(L,2))[0],j=F[1],_(function(){var e=V[0];A!==e&&U(A,e)},[V]),_(function(){m(b)||D(b)},[b]),[O,h(function(e,t){D(e,t),j([R],t)})]),eJ=(0,s.Z)(eZ,2),e0=eJ[0],e1=eJ[1],e2=l.useMemo(function(){var e=null==e0?[]:Array.isArray(e0)?e0:[e0],t=(0,s.Z)(e,1)[0],r=void 0===t?ej:t,i=null===e0?[]:[r];if(el){if(i=(0,a.Z)(e),eh||void 0===e0){var n,o=eh>=0?eh+1:2;for(i=i.slice(0,o);i.length<o;)i.push(null!==(n=i[i.length-1])&&void 0!==n?n:ej)}i.sort(function(e,t){return e-t})}return i.forEach(function(e,t){i[t]=eX(e)}),i},[e0,el,ej,eh,eX]),e4=l.useRef(e2);e4.current=e2;var e3=function(e){return el?e:e[0]},e6=function(e){var t=(0,a.Z)(e).sort(function(e,t){return e-t});ep&&!P(t,e4.current,!0)&&ep(e3(t)),e1(t)},e5=function(){var e=e3(e4.current);null==e_||e_(e),w(!e_,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),null==ev||ev(e)},e7=H(eV,eH,e2,ej,eK,eX,e6,e5,eQ),e9=(0,s.Z)(e7,4),e8=e9[0],te=e9[1],tt=e9[2],tr=e9[3],ti=function(e,t){if(!Q){var r,i,n=0,o=eK-ej;e2.forEach(function(t,r){var i=Math.abs(e-t);i<=o&&(o=i,n=r)});var s=(0,a.Z)(e2);s[n]=e,el&&!e2.length&&void 0===eh&&s.push(e),null==ef||ef(e3(s)),e6(s),t&&(null===(r=document.activeElement)||void 0===r||null===(i=r.blur)||void 0===i||i.call(r),eW.current.focus(n),tr(t,n,s))}},tn=l.useState(null),to=(0,s.Z)(tn,2),ta=to[0],ts=to[1];l.useEffect(function(){if(null!==ta){var e=e2.indexOf(ta);e>=0&&eW.current.focus(e)}ts(null)},[ta]);var tu=l.useMemo(function(){return(!eS||null!==eq)&&eS},[eS,eq]),tc=function(e,t){tr(e,t),null==ef||ef(e3(e4.current))},td=-1!==e8;l.useEffect(function(){if(!td){var e=e2.lastIndexOf(te);eW.current.focus(e)}},[td]);var tl=l.useMemo(function(){return(0,a.Z)(tt).sort(function(e,t){return e-t})},[tt]),th=l.useMemo(function(){return el?[tl[0],tl[tl.length-1]]:[ej,tl[0]]},[tl,el,ej]),tp=(0,s.Z)(th,2),tf=tp[0],t_=tp[1];l.useImperativeHandle(t,function(){return{focus:function(){eW.current.focus(0)},blur:function(){var e,t=document.activeElement;null!==(e=eV.current)&&void 0!==e&&e.contains(t)&&(null==t||t.blur())}}}),l.useEffect(function(){ee&&eW.current.focus(0)},[]);var tv=l.useMemo(function(){return{min:ej,max:eK,direction:eH,disabled:Q,keyboard:J,step:eq,included:eP,includedStart:tf,includedEnd:t_,range:el,tabIndex:eB,ariaLabelForHandle:eL,ariaLabelledByForHandle:eN,ariaValueTextFormatterForHandle:eF,styles:Y||{},classNames:$||{}}},[ej,eK,eH,Q,J,eq,eP,tf,t_,el,eB,eL,eN,eF,Y,$]);return l.createElement(x.Provider,{value:tv},l.createElement("div",{ref:eV,className:d()(q,z,(0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)({},"".concat(q,"-disabled"),Q),"".concat(q,"-vertical"),eb),"".concat(q,"-horizontal"),!eb),"".concat(q,"-with-marks"),eG.length)),style:G,onMouseDown:function(e){e.preventDefault();var t,r=eV.current.getBoundingClientRect(),i=r.width,n=r.height,o=r.left,a=r.top,s=r.bottom,u=r.right,c=e.clientX,d=e.clientY;switch(eH){case"btt":t=(s-d)/n;break;case"ttb":t=(d-a)/n;break;case"rtl":t=(u-c)/i;break;default:t=(c-o)/i}ti(eX(ej+t*(eK-ej)),e)}},l.createElement("div",{className:d()("".concat(q,"-rail"),null==$?void 0:$.rail),style:o(o({},ek),null==Y?void 0:Y.rail)}),l.createElement(W,{prefixCls:q,style:eC,values:tl,startPoint:eT,onStartMove:tu?tc:void 0}),l.createElement(N,{prefixCls:q,marks:eG,dots:eR,style:eA,activeStyle:ex}),l.createElement(I,{ref:eW,prefixCls:q,style:eM,values:tt,draggingIndex:e8,onStartMove:tc,onOffsetChange:function(e,t){if(!Q){var r=eQ(e2,e,t);null==ef||ef(e3(e2)),e6(r.values),ts(r.value)}},onFocus:et,onBlur:er,handleRender:eO,activeHandleRender:eI,onChangeComplete:e5}),l.createElement(B,{prefixCls:q,marks:eG,onClick:ti})))})},57467:function(e,t){"use strict";/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=Symbol.for("react.element"),i=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.server_context"),d=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),f=Symbol.for("react.lazy");Symbol.for("react.offscreen"),Symbol.for("react.module.reference"),t.isFragment=function(e){return function(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case n:case a:case o:case l:case h:return e;default:switch(e=e&&e.$$typeof){case c:case u:case d:case f:case p:case s:return e;default:return t}}case i:return t}}}(e)===n}},71818:function(e,t,r){"use strict";e.exports=r(57467)},66582:function(e,t,r){"use strict";var i,n,o,a,s,u,c=r(2784);c&&"object"==typeof c&&"default"in c&&c.default;var d=r(2897),l=new d,h=l.getBrowser(),p=l.getCPU(),f=l.getDevice(),_=l.getEngine(),v=l.getOS(),m=l.getUA(),g={Mobile:"mobile",Tablet:"tablet",SmartTv:"smarttv",Console:"console",Wearable:"wearable",Embedded:"embedded",Browser:void 0},y={Chrome:"Chrome",Firefox:"Firefox",Opera:"Opera",Yandex:"Yandex",Safari:"Safari",InternetExplorer:"Internet Explorer",Edge:"Edge",Chromium:"Chromium",Ie:"IE",MobileSafari:"Mobile Safari",MIUI:"MIUI Browser",SamsungBrowser:"Samsung Browser"},S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";return e||t},E=function(){return!!("undefined"!=typeof window&&(window.navigator||navigator))&&(window.navigator||navigator)},b=function(e){var t=E();return t&&t.platform&&(-1!==t.platform.indexOf(e)||"MacIntel"===t.platform&&t.maxTouchPoints>1&&!window.MSStream)},w=function(e){return e.type===g.Browser},P=function(e){return e.name===y.Edge},T=function(e){return"string"==typeof e&&-1!==e.indexOf("Edg/")},C=function(){return b("iPad")};f.type,g.SmartTv,f.type,g.Console,f.type,g.Wearable,f.type,g.Embedded,h.name===y.MobileSafari||C(),h.name,y.Chromium;var M=(i=f.type)===g.Mobile||i===g.Tablet||C();f.type,g.Mobile,f.type===g.Tablet||C(),w(f),w(f),v.name,v.name,"iOS"===v.name||C(),h.name,y.Chrome,h.name,y.Firefox,(n=h.name)===y.Safari||y.MobileSafari,h.name,y.Opera,(o=h.name)===y.InternetExplorer||y.Ie,S(v.version),S(v.name),S(h.version),S(h.major),S(h.name),S(f.vendor),S(f.model),S(_.name),S(_.version),S(m),P(h)||T(m),h.name,y.Yandex,S(f.type,"browser"),(a=E())&&(/iPad|iPhone|iPod/.test(a.platform)||"MacIntel"===a.platform&&a.maxTouchPoints>1)&&window.MSStream,C(),b("iPhone"),b("iPod"),"string"==typeof(u=(s=E())&&s.userAgent&&s.userAgent.toLowerCase())&&/electron/.test(u),T(m),P(h)&&T(m),v.name,v.name,h.name,y.MIUI,h.name,y.SamsungBrowser,t.tq=M},71301:function(e){!/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/function(){"use strict";var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},r=e.exports,i=function(){for(var e,r=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=0,n=r.length,o={};i<n;i++)if((e=r[i])&&e[1]in t){for(i=0;i<e.length;i++)o[r[0][i]]=e[i];return o}return!1}(),n={change:i.fullscreenchange,error:i.fullscreenerror},o={request:function(e,r){return new Promise((function(n,o){var a=(function(){this.off("change",a),n()}).bind(this);this.on("change",a);var s=(e=e||t.documentElement)[i.requestFullscreen](r);s instanceof Promise&&s.then(a).catch(o)}).bind(this))},exit:function(){return new Promise((function(e,r){if(!this.isFullscreen){e();return}var n=(function(){this.off("change",n),e()}).bind(this);this.on("change",n);var o=t[i.exitFullscreen]();o instanceof Promise&&o.then(n).catch(r)}).bind(this))},toggle:function(e,t){return this.isFullscreen?this.exit():this.request(e,t)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,r){var i=n[e];i&&t.addEventListener(i,r,!1)},off:function(e,r){var i=n[e];i&&t.removeEventListener(i,r,!1)},raw:i};if(!i){r?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(o,{isFullscreen:{get:function(){return!!t[i.fullscreenElement]}},element:{enumerable:!0,get:function(){return t[i.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!t[i.fullscreenEnabled]}}}),r?e.exports=o:window.screenfull=o}()},2897:function(e,t,r){var i;!function(n,o){"use strict";var a="function",s="undefined",u="object",c="string",d="major",l="model",h="name",p="type",f="vendor",_="version",v="architecture",m="console",g="mobile",y="tablet",S="smarttv",E="wearable",b="embedded",w="Amazon",P="Apple",T="ASUS",C="BlackBerry",M="Browser",k="Chrome",A="Firefox",x="Google",D="Huawei",R="Microsoft",O="Motorola",I="Opera",U="Samsung",B="Sharp",L="Sony",N="Xiaomi",F="Zebra",W="Facebook",V="Chromium OS",H="Mac OS",j=function(e,t){var r={};for(var i in e)t[i]&&t[i].length%2==0?r[i]=t[i].concat(e[i]):r[i]=e[i];return r},K=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},q=function(e,t){return typeof e===c&&-1!==z(t).indexOf(z(e))},z=function(e){return e.toLowerCase()},G=function(e,t){if(typeof e===c)return e=e.replace(/^\s\s*/,""),typeof t===s?e:e.substring(0,500)},$=function(e,t){for(var r,i,n,s,c,d,l=0;l<t.length&&!c;){var h=t[l],p=t[l+1];for(r=i=0;r<h.length&&!c&&h[r];)if(c=h[r++].exec(e))for(n=0;n<p.length;n++)d=c[++i],typeof(s=p[n])===u&&s.length>0?2===s.length?typeof s[1]==a?this[s[0]]=s[1].call(this,d):this[s[0]]=s[1]:3===s.length?typeof s[1]!==a||s[1].exec&&s[1].test?this[s[0]]=d?d.replace(s[1],s[2]):void 0:this[s[0]]=d?s[1].call(this,d,s[2]):void 0:4===s.length&&(this[s[0]]=d?s[3].call(this,d.replace(s[1],s[2])):void 0):this[s]=d||o;l+=2}},Y=function(e,t){for(var r in t)if(typeof t[r]===u&&t[r].length>0){for(var i=0;i<t[r].length;i++)if(q(t[r][i],e))return"?"===r?o:r}else if(q(t[r],e))return"?"===r?o:r;return e},X={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Q={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[_,[h,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[_,[h,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[h,_],[/opios[\/ ]+([\w\.]+)/i],[_,[h,I+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[_,[h,I+" GX"]],[/\bopr\/([\w\.]+)/i],[_,[h,I]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[_,[h,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[h,_],[/\bddg\/([\w\.]+)/i],[_,[h,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[_,[h,"UC"+M]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[_,[h,"WeChat"]],[/konqueror\/([\w\.]+)/i],[_,[h,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[_,[h,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[_,[h,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[_,[h,"Smart Lenovo "+M]],[/(avast|avg)\/([\w\.]+)/i],[[h,/(.+)/,"$1 Secure "+M],_],[/\bfocus\/([\w\.]+)/i],[_,[h,A+" Focus"]],[/\bopt\/([\w\.]+)/i],[_,[h,I+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[_,[h,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[_,[h,"Dolphin"]],[/coast\/([\w\.]+)/i],[_,[h,I+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[_,[h,"MIUI "+M]],[/fxios\/([-\w\.]+)/i],[_,[h,A]],[/\bqihu|(qi?ho?o?|360)browser/i],[[h,"360 "+M]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[h,/(.+)/,"$1 "+M],_],[/samsungbrowser\/([\w\.]+)/i],[_,[h,U+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[h,/_/g," "],_],[/metasr[\/ ]?([\d\.]+)/i],[_,[h,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[h,"Sogou Mobile"],_],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[h,_],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[h],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[h,W],_],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[h,_],[/\bgsa\/([\w\.]+) .*safari\//i],[_,[h,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[_,[h,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[_,[h,k+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[h,k+" WebView"],_],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[_,[h,"Android "+M]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[h,_],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[_,[h,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[_,h],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[h,[_,Y,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[h,_],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[h,"Netscape"],_],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[_,[h,A+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[h,_],[/(cobalt)\/([\w\.]+)/i],[h,[_,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[v,"amd64"]],[/(ia32(?=;))/i],[[v,z]],[/((?:i[346]|x)86)[;\)]/i],[[v,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[v,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[v,"armhf"]],[/windows (ce|mobile); ppc;/i],[[v,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[v,/ower/,"",z]],[/(sun4\w)[;\)]/i],[[v,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[v,z]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[l,[f,U],[p,y]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[l,[f,U],[p,g]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[l,[f,P],[p,g]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[l,[f,P],[p,y]],[/(macintosh);/i],[l,[f,P]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[l,[f,B],[p,g]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[l,[f,D],[p,y]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[l,[f,D],[p,g]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[l,/_/g," "],[f,N],[p,g]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[l,/_/g," "],[f,N],[p,y]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[l,[f,"OPPO"],[p,g]],[/\b(opd2\d{3}a?) bui/i],[l,[f,"OPPO"],[p,y]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[l,[f,"Vivo"],[p,g]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[l,[f,"Realme"],[p,g]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[l,[f,O],[p,g]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[l,[f,O],[p,y]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[l,[f,"LG"],[p,y]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[l,[f,"LG"],[p,g]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[l,[f,"Lenovo"],[p,y]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[l,/_/g," "],[f,"Nokia"],[p,g]],[/(pixel c)\b/i],[l,[f,x],[p,y]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[l,[f,x],[p,g]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[l,[f,L],[p,g]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[l,"Xperia Tablet"],[f,L],[p,y]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[l,[f,"OnePlus"],[p,g]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[l,[f,w],[p,y]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[l,/(.+)/g,"Fire Phone $1"],[f,w],[p,g]],[/(playbook);[-\w\),; ]+(rim)/i],[l,f,[p,y]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[l,[f,C],[p,g]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[l,[f,T],[p,y]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[l,[f,T],[p,g]],[/(nexus 9)/i],[l,[f,"HTC"],[p,y]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[f,[l,/_/g," "],[p,g]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[l,[f,"Acer"],[p,y]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[l,[f,"Meizu"],[p,g]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[l,[f,"Ulefone"],[p,g]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[f,l,[p,g]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[f,l,[p,y]],[/(surface duo)/i],[l,[f,R],[p,y]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[l,[f,"Fairphone"],[p,g]],[/(u304aa)/i],[l,[f,"AT&T"],[p,g]],[/\bsie-(\w*)/i],[l,[f,"Siemens"],[p,g]],[/\b(rct\w+) b/i],[l,[f,"RCA"],[p,y]],[/\b(venue[\d ]{2,7}) b/i],[l,[f,"Dell"],[p,y]],[/\b(q(?:mv|ta)\w+) b/i],[l,[f,"Verizon"],[p,y]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[l,[f,"Barnes & Noble"],[p,y]],[/\b(tm\d{3}\w+) b/i],[l,[f,"NuVision"],[p,y]],[/\b(k88) b/i],[l,[f,"ZTE"],[p,y]],[/\b(nx\d{3}j) b/i],[l,[f,"ZTE"],[p,g]],[/\b(gen\d{3}) b.+49h/i],[l,[f,"Swiss"],[p,g]],[/\b(zur\d{3}) b/i],[l,[f,"Swiss"],[p,y]],[/\b((zeki)?tb.*\b) b/i],[l,[f,"Zeki"],[p,y]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[f,"Dragon Touch"],l,[p,y]],[/\b(ns-?\w{0,9}) b/i],[l,[f,"Insignia"],[p,y]],[/\b((nxa|next)-?\w{0,9}) b/i],[l,[f,"NextBook"],[p,y]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[f,"Voice"],l,[p,g]],[/\b(lvtel\-)?(v1[12]) b/i],[[f,"LvTel"],l,[p,g]],[/\b(ph-1) /i],[l,[f,"Essential"],[p,g]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[l,[f,"Envizen"],[p,y]],[/\b(trio[-\w\. ]+) b/i],[l,[f,"MachSpeed"],[p,y]],[/\btu_(1491) b/i],[l,[f,"Rotor"],[p,y]],[/(shield[\w ]+) b/i],[l,[f,"Nvidia"],[p,y]],[/(sprint) (\w+)/i],[f,l,[p,g]],[/(kin\.[onetw]{3})/i],[[l,/\./g," "],[f,R],[p,g]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[l,[f,F],[p,y]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[l,[f,F],[p,g]],[/smart-tv.+(samsung)/i],[f,[p,S]],[/hbbtv.+maple;(\d+)/i],[[l,/^/,"SmartTV"],[f,U],[p,S]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[f,"LG"],[p,S]],[/(apple) ?tv/i],[f,[l,P+" TV"],[p,S]],[/crkey/i],[[l,k+"cast"],[f,x],[p,S]],[/droid.+aft(\w+)( bui|\))/i],[l,[f,w],[p,S]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[l,[f,B],[p,S]],[/(bravia[\w ]+)( bui|\))/i],[l,[f,L],[p,S]],[/(mitv-\w{5}) bui/i],[l,[f,N],[p,S]],[/Hbbtv.*(technisat) (.*);/i],[f,l,[p,S]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[f,G],[l,G],[p,S]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[p,S]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[f,l,[p,m]],[/droid.+; (shield) bui/i],[l,[f,"Nvidia"],[p,m]],[/(playstation [345portablevi]+)/i],[l,[f,L],[p,m]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[l,[f,R],[p,m]],[/((pebble))app/i],[f,l,[p,E]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[l,[f,P],[p,E]],[/droid.+; (glass) \d/i],[l,[f,x],[p,E]],[/droid.+; (wt63?0{2,3})\)/i],[l,[f,F],[p,E]],[/(quest( \d| pro)?)/i],[l,[f,W],[p,E]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[f,[p,b]],[/(aeobc)\b/i],[l,[f,w],[p,b]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[l,[p,g]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[l,[p,y]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[p,y]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[p,g]],[/(android[-\w\. ]{0,9});.+buil/i],[l,[f,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[_,[h,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[_,[h,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[h,_],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[_,h]],os:[[/microsoft (windows) (vista|xp)/i],[h,_],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[h,[_,Y,X]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[_,Y,X],[h,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[_,/_/g,"."],[h,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[h,H],[_,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[_,h],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[h,_],[/\(bb(10);/i],[_,[h,C]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[_,[h,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[_,[h,A+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[_,[h,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[_,[h,"watchOS"]],[/crkey\/([\d\.]+)/i],[_,[h,k+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[h,V],_],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[h,_],[/(sunos) ?([\w\.\d]*)/i],[[h,"Solaris"],_],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[h,_]]},Z=function(e,t){if(typeof e===u&&(t=e,e=o),!(this instanceof Z))return new Z(e,t).getResult();var r=typeof n!==s&&n.navigator?n.navigator:o,i=e||(r&&r.userAgent?r.userAgent:""),m=r&&r.userAgentData?r.userAgentData:o,S=t?j(Q,t):Q,E=r&&r.userAgent==i;return this.getBrowser=function(){var e,t={};return t[h]=o,t[_]=o,$.call(t,i,S.browser),t[d]=typeof(e=t[_])===c?e.replace(/[^\d\.]/g,"").split(".")[0]:o,E&&r&&r.brave&&typeof r.brave.isBrave==a&&(t[h]="Brave"),t},this.getCPU=function(){var e={};return e[v]=o,$.call(e,i,S.cpu),e},this.getDevice=function(){var e={};return e[f]=o,e[l]=o,e[p]=o,$.call(e,i,S.device),E&&!e[p]&&m&&m.mobile&&(e[p]=g),E&&"Macintosh"==e[l]&&r&&typeof r.standalone!==s&&r.maxTouchPoints&&r.maxTouchPoints>2&&(e[l]="iPad",e[p]=y),e},this.getEngine=function(){var e={};return e[h]=o,e[_]=o,$.call(e,i,S.engine),e},this.getOS=function(){var e={};return e[h]=o,e[_]=o,$.call(e,i,S.os),E&&!e[h]&&m&&m.platform&&"Unknown"!=m.platform&&(e[h]=m.platform.replace(/chrome os/i,V).replace(/macos/i,H)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=typeof e===c&&e.length>500?G(e,500):e,this},this.setUA(i),this};Z.VERSION="1.0.38",Z.BROWSER=K([h,_,d]),Z.CPU=K([v]),Z.DEVICE=K([l,f,p,m,g,S,y,E,b]),Z.ENGINE=Z.OS=K([h,_]),typeof t!==s?(e.exports&&(t=e.exports=Z),t.UAParser=Z):r.amdO?o!==(i=(function(){return Z}).call(t,r,t,e))&&(e.exports=i):typeof n!==s&&(n.UAParser=Z);var J=typeof n!==s&&(n.jQuery||n.Zepto);if(J&&!J.ua){var ee=new Z;J.ua=ee.getResult(),J.ua.get=function(){return ee.getUA()},J.ua.set=function(e){ee.setUA(e);var t=ee.getResult();for(var r in t)J.ua[r]=t[r]}}}("object"==typeof window?window:this)},7415:function(e,t,r){"use strict";r.d(t,{Y:function(){return o},Z:function(){return o}});var i=r(2784),n=function(){};function o(e,t,r){var o=(0,i.useRef)(n);(0,i.useEffect)(function(){o.current=e}),(0,i.useEffect)(function(){r&&null!==t&&!1!==t&&o.current()},[r]),(0,i.useEffect)(function(){if(null!==t&&!1!==t){var e=setInterval(function(){return o.current()},t);return function(){return clearInterval(e)}}},[t])}}}]);
//# sourceMappingURL=5615-dcfd808bb524946a.js.map